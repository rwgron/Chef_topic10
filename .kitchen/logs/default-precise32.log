I, [2015-04-24T10:59:28.891964 #6654]  INFO -- default-precise32: -----> Creating <default-precise32>...
I, [2015-04-24T11:00:30.982608 #6654]  INFO -- default-precise32: Bringing machine 'default' up with 'virtualbox' provider...==> default: Importing base box 'precise32'...[KProgress: 30%[KProgress: 40%[KProgress: 50%[KProgress: 80%[KProgress: 90%[K==> default: Matching MAC address for NAT networking...==> default: Setting the name of the VM: kitchen-task10-default-precise32_default_1429862383299_80754==> default: Clearing any previously set network interfaces...==> default: Preparing network interfaces based on configuration...    default: Adapter 1: nat==> default: Forwarding ports...    default: 22 => 2222 (adapter 1)==> default: Booting VM...==> default: Waiting for machine to boot. This may take a few minutes...    default: SSH address: 127.0.0.1:2222    default: SSH username: vagrant    default: SSH auth method: private key    default: Warning: Connection timeout. Retrying...    default: Warning: Connection timeout. Retrying...    default: 
I, [2015-04-24T11:00:30.982706 #6654]  INFO -- default-precise32:     default: Vagrant insecure key detected. Vagrant will automatically replace
I, [2015-04-24T11:00:38.195562 #6654]  INFO -- default-precise32:     default: 
I, [2015-04-24T11:00:46.961827 #6654]  INFO -- default-precise32:     default: Removing insecure key from the guest if its present...    default: Key inserted! Disconnecting and reconnecting using new SSH key...==> default: Machine booted and ready!==> default: Checking for guest additions in VM...    default: The guest additions on this VM do not match the installed version of
I, [2015-04-24T11:00:46.961913 #6654]  INFO -- default-precise32:     default: VirtualBox! In most cases this is fine, but in rare cases it can
I, [2015-04-24T11:00:46.961970 #6654]  INFO -- default-precise32:     default: prevent things such as shared folders from working properly. If you see
I, [2015-04-24T11:00:46.961992 #6654]  INFO -- default-precise32:     default: shared folder errors, please make sure the guest additions within the
I, [2015-04-24T11:00:46.962041 #6654]  INFO -- default-precise32:     default: virtual machine match the version of VirtualBox you have installed on
I, [2015-04-24T11:00:46.962064 #6654]  INFO -- default-precise32:     default: your host and reload your VM.
I, [2015-04-24T11:00:46.962091 #6654]  INFO -- default-precise32:     default: 
I, [2015-04-24T11:00:46.962111 #6654]  INFO -- default-precise32:     default: Guest Additions Version: 4.2.0
I, [2015-04-24T11:00:57.849162 #6654]  INFO -- default-precise32: Vagrant instance <default-precise32> created.
I, [2015-04-24T11:00:57.868796 #6654]  INFO -- default-precise32: Finished creating <default-precise32> (1m28.96s).
I, [2015-04-24T11:01:44.758386 #8666]  INFO -- default-precise32: -----> Converging <default-precise32>...
I, [2015-04-24T11:01:44.759092 #8666]  INFO -- default-precise32: Preparing files for transfer
I, [2015-04-24T11:01:44.759150 #8666]  INFO -- default-precise32: Preparing dna.json
I, [2015-04-24T11:01:44.759442 #8666]  INFO -- default-precise32: Resolving cookbook dependencies with Berkshelf 3.2.3...
I, [2015-04-24T11:01:45.057165 #8666]  INFO -- default-precise32: Removing non-cookbook files before transfer
I, [2015-04-24T11:01:45.060363 #8666]  INFO -- default-precise32: Preparing data_bags
I, [2015-04-24T11:01:45.060632 #8666]  INFO -- default-precise32: Preparing environments
I, [2015-04-24T11:01:45.060765 #8666]  INFO -- default-precise32: Preparing nodes
I, [2015-04-24T11:01:45.061085 #8666]  INFO -- default-precise32: Preparing roles
I, [2015-04-24T11:01:45.061276 #8666]  INFO -- default-precise32: Preparing solo.rb
I, [2015-04-24T11:01:45.790049 #8666]  INFO -- default-precise32: -----> Installing Chef Omnibus (install only if missing)
I, [2015-04-24T11:01:45.791534 #8666]  INFO -- default-precise32: downloading https://www.chef.io/chef/install.sh
I, [2015-04-24T11:01:45.793489 #8666]  INFO -- default-precise32:   to file /tmp/install.sh
I, [2015-04-24T11:01:45.796187 #8666]  INFO -- default-precise32: trying wget...
I, [2015-04-24T11:01:46.673154 #8666]  INFO -- default-precise32: Downloading Chef  for ubuntu...
I, [2015-04-24T11:01:46.674647 #8666]  INFO -- default-precise32: downloading https://www.chef.io/chef/metadata?v=&prerelease=false&nightlies=false&p=ubuntu&pv=12.04&m=i686
I, [2015-04-24T11:01:46.676574 #8666]  INFO -- default-precise32:   to file /tmp/install.sh.1255/metadata.txt
I, [2015-04-24T11:01:46.678586 #8666]  INFO -- default-precise32: trying wget...
I, [2015-04-24T11:01:47.439232 #8666]  INFO -- default-precise32: url	https://opscode-omnibus-packages.s3.amazonaws.com/ubuntu/12.04/i686/chef_12.2.1-1_i386.deb
I, [2015-04-24T11:01:47.442096 #8666]  INFO -- default-precise32: md5	0c7c11da89b66bae5542b90ad9201781
I, [2015-04-24T11:01:47.444878 #8666]  INFO -- default-precise32: sha256	a7f745835dc7f586dd7a5fb3d585ba39b2fe5e02e69a239eaaa77c18277c4624
I, [2015-04-24T11:01:47.533183 #8666]  INFO -- default-precise32: downloaded metadata file looks valid...
I, [2015-04-24T11:01:47.746365 #8666]  INFO -- default-precise32: downloading https://opscode-omnibus-packages.s3.amazonaws.com/ubuntu/12.04/i686/chef_12.2.1-1_i386.deb
I, [2015-04-24T11:01:47.747301 #8666]  INFO -- default-precise32:   to file /tmp/install.sh.1255/chef_12.2.1-1_i386.deb
I, [2015-04-24T11:01:47.748879 #8666]  INFO -- default-precise32: trying wget...
I, [2015-04-24T11:02:13.416987 #8666]  INFO -- default-precise32: Comparing checksum with sha256sum...
I, [2015-04-24T11:02:13.957304 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:02:13.958950 #8666]  INFO -- default-precise32: WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING
I, [2015-04-24T11:02:13.959981 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:02:13.961328 #8666]  INFO -- default-precise32: You are installing an omnibus package without a version pin.  If you are installing
I, [2015-04-24T11:02:13.962602 #8666]  INFO -- default-precise32: on production servers via an automated process this is DANGEROUS and you will
I, [2015-04-24T11:02:13.964305 #8666]  INFO -- default-precise32: be upgraded without warning on new releases, even to new major release.
I, [2015-04-24T11:02:13.965575 #8666]  INFO -- default-precise32: Letting the version float is only appropriate in desktop, test, development or
I, [2015-04-24T11:02:13.967090 #8666]  INFO -- default-precise32: CI/CD environments.
I, [2015-04-24T11:02:13.968962 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:02:13.971763 #8666]  INFO -- default-precise32: WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING
I, [2015-04-24T11:02:13.973384 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:02:13.976918 #8666]  INFO -- default-precise32: Installing Chef 
I, [2015-04-24T11:02:13.978906 #8666]  INFO -- default-precise32: installing with dpkg...
I, [2015-04-24T11:02:14.436509 #8666]  INFO -- default-precise32: Selecting previously unselected package chef.
I, [2015-04-24T11:02:15.117038 #8666]  INFO -- default-precise32: (Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 29361 files and directories currently installed.)
I, [2015-04-24T11:02:15.119825 #8666]  INFO -- default-precise32: Unpacking chef (from .../chef_12.2.1-1_i386.deb) ...
I, [2015-04-24T11:03:10.505466 #8666]  INFO -- default-precise32: Setting up chef (12.2.1-1) ...
I, [2015-04-24T11:03:12.679673 #8666]  INFO -- default-precise32: Thank you for installing Chef!
I, [2015-04-24T11:03:13.505320 #8666]  INFO -- default-precise32: Transferring files to <default-precise32>
I, [2015-04-24T11:03:27.890236 #8666]  INFO -- default-precise32: Starting Chef Client, version 12.2.1
I, [2015-04-24T11:03:35.809245 #8666]  INFO -- default-precise32: Compiling Cookbooks...
I, [2015-04-24T11:03:35.941531 #8666]  INFO -- default-precise32: Converging 86 resources
I, [2015-04-24T11:03:35.948304 #8666]  INFO -- default-precise32: Recipe: apache2::default
I, [2015-04-24T11:04:50.753995 #8666]  INFO -- default-precise32:   * apt_package[apache2] action install
I, [2015-04-24T11:04:50.761150 #8666]  INFO -- default-precise32:     - install version 2.2.22-1ubuntu1 of package apache2
I, [2015-04-24T11:04:50.794442 #8666]  INFO -- default-precise32:   * directory[/etc/apache2/sites-available] action create (up to date)
I, [2015-04-24T11:04:50.806610 #8666]  INFO -- default-precise32:   * directory[/etc/apache2/sites-enabled] action create (up to date)
I, [2015-04-24T11:04:50.819984 #8666]  INFO -- default-precise32:   * directory[/etc/apache2/mods-available] action create (up to date)
I, [2015-04-24T11:04:50.833033 #8666]  INFO -- default-precise32:   * directory[/etc/apache2/mods-enabled] action create (up to date)
I, [2015-04-24T11:04:50.840237 #8666]  INFO -- default-precise32:   * directory[/etc/apache2/conf-available] action create
I, [2015-04-24T11:04:50.850424 #8666]  INFO -- default-precise32:     - create new directory /etc/apache2/conf-available
I, [2015-04-24T11:04:50.853953 #8666]  INFO -- default-precise32:     - change mode from '' to '0755'
I, [2015-04-24T11:04:50.857096 #8666]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:04:50.864847 #8666]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:04:50.871615 #8666]  INFO -- default-precise32:   * directory[/etc/apache2/conf-enabled] action create
I, [2015-04-24T11:04:50.880871 #8666]  INFO -- default-precise32:     - create new directory /etc/apache2/conf-enabled
I, [2015-04-24T11:04:50.884073 #8666]  INFO -- default-precise32:     - change mode from '' to '0755'
I, [2015-04-24T11:04:50.887942 #8666]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:04:50.892486 #8666]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:04:50.900814 #8666]  INFO -- default-precise32:   * link[/etc/apache2/sites-enabled/default] action delete (up to date)
I, [2015-04-24T11:04:50.914372 #8666]  INFO -- default-precise32:   * file[/etc/apache2/sites-available/default] action delete
I, [2015-04-24T11:04:50.917846 #8666]  INFO -- default-precise32:     - delete file /etc/apache2/sites-available/default
I, [2015-04-24T11:04:50.923311 #8666]  INFO -- default-precise32:   * link[/etc/apache2/sites-enabled/000-default] action delete
I, [2015-04-24T11:04:50.926682 #8666]  INFO -- default-precise32:     - delete link at /etc/apache2/sites-enabled/000-default
I, [2015-04-24T11:04:50.933903 #8666]  INFO -- default-precise32:   * file[/etc/apache2/sites-available/000-default] action delete (up to date)
I, [2015-04-24T11:04:50.950807 #8666]  INFO -- default-precise32:   * directory[/etc/apache2/conf.d] action delete
I, [2015-04-24T11:04:50.954509 #8666]  INFO -- default-precise32:     - delete existing directory /etc/apache2/conf.d
I, [2015-04-24T11:04:50.963060 #8666]  INFO -- default-precise32:   * directory[/var/log/apache2] action create
I, [2015-04-24T11:04:50.967695 #8666]  INFO -- default-precise32:     - change mode from '0750' to '0755'
I, [2015-04-24T11:04:51.324734 #8666]  INFO -- default-precise32:   * apt_package[perl] action install (up to date)
I, [2015-04-24T11:04:51.341655 #8666]  INFO -- default-precise32:   * link[/usr/sbin/a2ensite] action delete
I, [2015-04-24T11:04:51.345077 #8666]  INFO -- default-precise32:     - delete link at /usr/sbin/a2ensite
I, [2015-04-24T11:04:51.770100 #8666]  INFO -- default-precise32:   * template[/usr/sbin/a2ensite] action create
I, [2015-04-24T11:04:51.818421 #8666]  INFO -- default-precise32:     - create new file /usr/sbin/a2ensite
I, [2015-04-24T11:04:51.820214 #8666]  INFO -- default-precise32:     - update content in file /usr/sbin/a2ensite from none to ce53f4
I, [2015-04-24T11:04:51.824174 #8666]  INFO -- default-precise32:     --- /usr/sbin/a2ensite	2015-04-24 08:04:51.764773748 +0000
I, [2015-04-24T11:04:51.829195 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-1eksfhs	2015-04-24 08:04:51.760773798 +0000
I, [2015-04-24T11:04:51.831334 #8666]  INFO -- default-precise32:     @@ -1 +1,533 @@
I, [2015-04-24T11:04:51.833738 #8666]  INFO -- default-precise32:     +#!/usr/bin/perl -w
I, [2015-04-24T11:04:51.836181 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:51.838366 #8666]  INFO -- default-precise32:     +# a2enmod by Stefan Fritsch <sf@debian.org>
I, [2015-04-24T11:04:51.842205 #8666]  INFO -- default-precise32:     +# Licensed under Apache License 2.0
I, [2015-04-24T11:04:51.844188 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:51.846196 #8666]  INFO -- default-precise32:     +# The coding style is "perltidy -pbp"
I, [2015-04-24T11:04:51.849168 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:51.850957 #8666]  INFO -- default-precise32:     +use strict;
I, [2015-04-24T11:04:51.853331 #8666]  INFO -- default-precise32:     +use Cwd 'realpath';
I, [2015-04-24T11:04:51.855311 #8666]  INFO -- default-precise32:     +use File::Spec;
I, [2015-04-24T11:04:51.857363 #8666]  INFO -- default-precise32:     +use File::Basename;
I, [2015-04-24T11:04:51.859866 #8666]  INFO -- default-precise32:     +use File::Path;
I, [2015-04-24T11:04:51.863027 #8666]  INFO -- default-precise32:     +use Getopt::Long;
I, [2015-04-24T11:04:51.864256 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:51.866365 #8666]  INFO -- default-precise32:     +my $quiet;
I, [2015-04-24T11:04:51.869191 #8666]  INFO -- default-precise32:     +my $force;
I, [2015-04-24T11:04:51.870972 #8666]  INFO -- default-precise32:     +my $maintmode;
I, [2015-04-24T11:04:51.874165 #8666]  INFO -- default-precise32:     +my $purge;
I, [2015-04-24T11:04:51.875696 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:51.880896 #8666]  INFO -- default-precise32:     +Getopt::Long::Configure('bundling');
I, [2015-04-24T11:04:51.883273 #8666]  INFO -- default-precise32:     +GetOptions(
I, [2015-04-24T11:04:51.885334 #8666]  INFO -- default-precise32:     +    'quiet|q'     => \$quiet,
I, [2015-04-24T11:04:51.888171 #8666]  INFO -- default-precise32:     +    'force|f'     => \$force,
I, [2015-04-24T11:04:51.890954 #8666]  INFO -- default-precise32:     +    'maintmode|m' => \$maintmode,
I, [2015-04-24T11:04:51.893168 #8666]  INFO -- default-precise32:     +    'purge|p'     => \$purge
I, [2015-04-24T11:04:51.895191 #8666]  INFO -- default-precise32:     +) or exit 2;
I, [2015-04-24T11:04:51.897325 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:51.899878 #8666]  INFO -- default-precise32:     +my $basename = basename($0);
I, [2015-04-24T11:04:51.903198 #8666]  INFO -- default-precise32:     +$basename =~ /^a2(en|dis)(mod|site|conf)((?:-.+)?)$/
I, [2015-04-24T11:04:51.905179 #8666]  INFO -- default-precise32:     +    or die "$basename call name unknown\n";
I, [2015-04-24T11:04:51.907169 #8666]  INFO -- default-precise32:     +my $act        = $1;
I, [2015-04-24T11:04:51.910178 #8666]  INFO -- default-precise32: +my $obj        = $2;
I, [2015-04-24T11:04:51.910210 #8666]  INFO -- default-precise32:     +my $dir_suffix = $3;
I, [2015-04-24T11:04:51.910255 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:51.913192 #8666]  INFO -- default-precise32:     +my $env_file = $ENV{APACHE_ENVVARS}
I, [2015-04-24T11:04:51.915309 #8666]  INFO -- default-precise32:     +    || (
I, [2015-04-24T11:04:51.917932 #8666]  INFO -- default-precise32:     +    $ENV{APACHE_CONFDIR}
I, [2015-04-24T11:04:51.921128 #8666]  INFO -- default-precise32:     +    ? "$ENV{APACHE_CONFDIR}/envvars"
I, [2015-04-24T11:04:51.923192 #8666]  INFO -- default-precise32:     +    : "/etc/apache2$dir_suffix/envvars"
I, [2015-04-24T11:04:51.925452 #8666]  INFO -- default-precise32:     +    );
I, [2015-04-24T11:04:51.927806 #8666]  INFO -- default-precise32:     +$ENV{LANG} = 'C';
I, [2015-04-24T11:04:51.930212 #8666]  INFO -- default-precise32:     +read_env_file($env_file);
I, [2015-04-24T11:04:51.933192 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:51.935170 #8666]  INFO -- default-precise32:     +$act .= 'able';
I, [2015-04-24T11:04:51.936747 #8666]  INFO -- default-precise32: +my ( $name, $dir, $sffx, $reload );
I, [2015-04-24T11:04:51.937886 #8666]  INFO -- default-precise32:     +if ( $obj eq 'mod' ) {
I, [2015-04-24T11:04:51.940157 #8666]  INFO -- default-precise32:     +    $obj    = 'module';
I, [2015-04-24T11:04:51.942341 #8666]  INFO -- default-precise32:     +    $dir    = 'mods';
I, [2015-04-24T11:04:51.942373 #8666]  INFO -- default-precise32:     +    $sffx   = '.load';
I, [2015-04-24T11:04:51.944188 #8666]  INFO -- default-precise32: +    $reload = 'restart';
I, [2015-04-24T11:04:51.946809 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:51.950192 #8666]  INFO -- default-precise32:     +elsif ( $obj eq 'conf' ) {
I, [2015-04-24T11:04:51.951679 #8666]  INFO -- default-precise32:     +    $obj    = 'conf';
I, [2015-04-24T11:04:51.954184 #8666]  INFO -- default-precise32:     +    $dir    = 'conf';
I, [2015-04-24T11:04:51.956859 #8666]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:04:51.959096 #8666]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:04:51.961669 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:51.961700 #8666]  INFO -- default-precise32:     +else {
I, [2015-04-24T11:04:51.963170 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:51.964068 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:51.966603 #8666]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:04:51.968946 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:51.971185 #8666]  INFO -- default-precise32:     +$name = ucfirst($obj);
I, [2015-04-24T11:04:51.973325 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:51.975785 #8666]  INFO -- default-precise32:     +my $confdir = $ENV{APACHE_CONFDIR} || "/etc/apache2$dir_suffix";
I, [2015-04-24T11:04:51.978266 #8666]  INFO -- default-precise32:     +my $availdir = $ENV{ uc("APACHE_${dir}_AVAILABLE") }
I, [2015-04-24T11:04:51.980883 #8666]  INFO -- default-precise32:     +    || "$confdir/$dir-available";
I, [2015-04-24T11:04:51.983175 #8666]  INFO -- default-precise32:     +my $enabldir = $ENV{ uc("APACHE_${dir}_ENABLED") } || "$confdir/$dir-enabled";
I, [2015-04-24T11:04:51.985925 #8666]  INFO -- default-precise32:     +my $statedir = $ENV{ uc("APACHE_STATE_DIRECTORY") } || "/usr/lib/apache2";
I, [2015-04-24T11:04:51.988049 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:51.990174 #8666]  INFO -- default-precise32:     +$statedir .= "/$obj";
I, [2015-04-24T11:04:51.992606 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:51.994963 #8666]  INFO -- default-precise32:     +my $choicedir = $act eq 'enable' ? $availdir : $enabldir;
I, [2015-04-24T11:04:51.998189 #8666]  INFO -- default-precise32:     +my $linkdir = File::Spec->abs2rel( $availdir, $enabldir );
I, [2015-04-24T11:04:52.000099 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.002366 #8666]  INFO -- default-precise32:     +my $request_reload = 0;
I, [2015-04-24T11:04:52.004834 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.007161 #8666]  INFO -- default-precise32:     +my $rc = 0;
I, [2015-04-24T11:04:52.009324 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.012172 #8666]  INFO -- default-precise32:     +if ( !scalar @ARGV ) {
I, [2015-04-24T11:04:52.014709 #8666]  INFO -- default-precise32:     +    my @choices = myglob('*');
I, [2015-04-24T11:04:52.017073 #8666]  INFO -- default-precise32:     +    print "Your choices are: @choices\n";
I, [2015-04-24T11:04:52.019167 #8666]  INFO -- default-precise32:     +    print "Which ${obj}(s) do you want to $act (wildcards ok)?\n";
I, [2015-04-24T11:04:52.021898 #8666]  INFO -- default-precise32:     +    my $input = <>;
I, [2015-04-24T11:04:52.024018 #8666]  INFO -- default-precise32:     +    @ARGV = split /\s+/, $input;
I, [2015-04-24T11:04:52.026222 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.029165 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:52.031125 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.033666 #8666]  INFO -- default-precise32:     +my @objs;
I, [2015-04-24T11:04:52.036214 #8666]  INFO -- default-precise32:     +foreach my $arg (@ARGV) {
I, [2015-04-24T11:04:52.038927 #8666]  INFO -- default-precise32:     +    $arg =~ s/${sffx}$//;
I, [2015-04-24T11:04:52.041535 #8666]  INFO -- default-precise32:     +    my @glob = myglob($arg);
I, [2015-04-24T11:04:52.043736 #8666]  INFO -- default-precise32:     +    if ( !@glob ) {
I, [2015-04-24T11:04:52.046074 #8666]  INFO -- default-precise32:     +        error("No $obj found matching $arg!\n");
I, [2015-04-24T11:04:52.048188 #8666]  INFO -- default-precise32:     +        $rc = 1;
I, [2015-04-24T11:04:52.050714 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.053103 #8666]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:04:52.055333 #8666]  INFO -- default-precise32:     +        push @objs, @glob;
I, [2015-04-24T11:04:52.057932 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.060770 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:52.062616 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.065034 #8666]  INFO -- default-precise32:     +foreach my $acton (@objs) {
I, [2015-04-24T11:04:52.067196 #8666]  INFO -- default-precise32:     +    doit($acton) or $rc = 1;
I, [2015-04-24T11:04:52.070198 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:52.072658 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.074932 #8666]  INFO -- default-precise32:     +info(
I, [2015-04-24T11:04:52.077272 #8666]  INFO -- default-precise32:     +    "To activate the new configuration, you need to run:\n  service apache2 $reload\n"
I, [2015-04-24T11:04:52.079758 #8666]  INFO -- default-precise32:     +) if $request_reload;
I, [2015-04-24T11:04:52.081959 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.084173 #8666]  INFO -- default-precise32:     +exit($rc);
I, [2015-04-24T11:04:52.086187 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.088718 #8666]  INFO -- default-precise32:     +##############################################################################
I, [2015-04-24T11:04:52.094186 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.096909 #8666]  INFO -- default-precise32:     +sub myglob {
I, [2015-04-24T11:04:52.099189 #8666]  INFO -- default-precise32:     +    my $arg = shift;
I, [2015-04-24T11:04:52.101602 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.103511 #8666]  INFO -- default-precise32:     +    my @glob = map {
I, [2015-04-24T11:04:52.105985 #8666]  INFO -- default-precise32:     +        s{^$choicedir/}{};
I, [2015-04-24T11:04:52.108126 #8666]  INFO -- default-precise32:     +        s{$sffx$}{};
I, [2015-04-24T11:04:52.110756 #8666]  INFO -- default-precise32:     +        $_
I, [2015-04-24T11:04:52.113187 #8666]  INFO -- default-precise32:     +    } glob("$choicedir/$arg$sffx");
I, [2015-04-24T11:04:52.115246 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.117694 #8666]  INFO -- default-precise32:     +    return @glob;
I, [2015-04-24T11:04:52.120180 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:52.122186 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.124794 #8666]  INFO -- default-precise32:     +sub doit {
I, [2015-04-24T11:04:52.127174 #8666]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:04:52.129743 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.132779 #8666]  INFO -- default-precise32:     +    my ( $conftgt, $conflink );
I, [2015-04-24T11:04:52.134954 #8666]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:04:52.137170 #8666]  INFO -- default-precise32:     +        if ( $acton eq 'cgi' && threaded() ) {
I, [2015-04-24T11:04:52.139339 #8666]  INFO -- default-precise32:     +            print
I, [2015-04-24T11:04:52.141498 #8666]  INFO -- default-precise32:     +                "Your MPM seems to be threaded. Selecting cgid instead of cgi.\n";
I, [2015-04-24T11:04:52.144054 #8666]  INFO -- default-precise32:     +            $acton = 'cgid';
I, [2015-04-24T11:04:52.146169 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.148615 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.150828 #8666]  INFO -- default-precise32:     +        $conftgt = "$availdir/$acton.conf";
I, [2015-04-24T11:04:52.153100 #8666]  INFO -- default-precise32:     +        if ( -e $conftgt ) {
I, [2015-04-24T11:04:52.155335 #8666]  INFO -- default-precise32:     +            $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:04:52.157894 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.160180 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.162471 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.164950 #8666]  INFO -- default-precise32:     +    my $tgt  = "$availdir/$acton$sffx";
I, [2015-04-24T11:04:52.166972 #8666]  INFO -- default-precise32:     +    my $link = "$enabldir/$acton$sffx";
I, [2015-04-24T11:04:52.169248 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.171323 #8666]  INFO -- default-precise32:     +    if ( !-e $tgt ) {
I, [2015-04-24T11:04:52.173939 #8666]  INFO -- default-precise32:     +        if ( -l $link && !-e $link ) {
I, [2015-04-24T11:04:52.176164 #8666]  INFO -- default-precise32:     +            if ( $act eq 'disable' ) {
I, [2015-04-24T11:04:52.178681 #8666]  INFO -- default-precise32:     +                info("removing dangling symlink $link\n");
I, [2015-04-24T11:04:52.181350 #8666]  INFO -- default-precise32:     +                unlink($link);
I, [2015-04-24T11:04:52.188926 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.191213 #8666]  INFO -- default-precise32:     +                # force a .conf path. It may exist as dangling link, too
I, [2015-04-24T11:04:52.193487 #8666]  INFO -- default-precise32:     +                $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:04:52.195847 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.198176 #8666]  INFO -- default-precise32:     +                if ( -l $conflink && !-e $conflink ) {
I, [2015-04-24T11:04:52.200751 #8666]  INFO -- default-precise32:     +                    info("removing dangling symlink $conflink\n");
I, [2015-04-24T11:04:52.202916 #8666]  INFO -- default-precise32:     +                    unlink($conflink);
I, [2015-04-24T11:04:52.205184 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:52.207171 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.209665 #8666]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:04:52.211448 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:52.214176 #8666]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:04:52.217502 #8666]  INFO -- default-precise32:     +                error("$link is a dangling symlink!\n");
I, [2015-04-24T11:04:52.219464 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:52.222175 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.224130 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.226271 #8666]  INFO -- default-precise32:     +        if ( $purge ) {
I, [2015-04-24T11:04:52.228746 #8666]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:52.231458 #8666]  INFO -- default-precise32:     +            # exit silently, we are purging anyway
I, [2015-04-24T11:04:52.233986 #8666]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:04:52.237176 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.238896 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.241131 #8666]  INFO -- default-precise32:     +        error("$name $acton does not exist!\n");
I, [2015-04-24T11:04:52.243297 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:52.246211 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.248190 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.250571 #8666]  INFO -- default-precise32:     +    # handle module dependencies
I, [2015-04-24T11:04:52.253085 #8666]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:04:52.255182 #8666]  INFO -- default-precise32:     +        if ( $act eq 'enable' ) {
I, [2015-04-24T11:04:52.257807 #8666]  INFO -- default-precise32:     +            if ( $acton eq 'mpm_itk' ) {
I, [2015-04-24T11:04:52.260419 #8666]  INFO -- default-precise32:     +                warning(  "MPM_ITK is a third party module that is not part "
I, [2015-04-24T11:04:52.262784 #8666]  INFO -- default-precise32:     +                        . "of the official Apache HTTPD. It has seen less "
I, [2015-04-24T11:04:52.265072 #8666]  INFO -- default-precise32:     +                        . "testing than the official MPM modules." );
I, [2015-04-24T11:04:52.267161 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:52.269302 #8666]  INFO -- default-precise32:     +            my @depends = get_deps("$availdir/$acton.load");
I, [2015-04-24T11:04:52.271463 #8666]  INFO -- default-precise32:     +            do_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:04:52.273949 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.276530 #8666]  INFO -- default-precise32:     +            my @conflicts = get_deps( "$availdir/$acton.load", "Conflicts" );
I, [2015-04-24T11:04:52.278959 #8666]  INFO -- default-precise32:     +            check_conflicts( $acton, @conflicts ) or return 0;
I, [2015-04-24T11:04:52.281238 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.283308 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:52.285431 #8666]  INFO -- default-precise32:     +            my @depending;
I, [2015-04-24T11:04:52.287927 #8666]  INFO -- default-precise32:     +            foreach my $d ( glob("$enabldir/*.load") ) {
I, [2015-04-24T11:04:52.290168 #8666]  INFO -- default-precise32:     +                my @deps = get_deps($d);
I, [2015-04-24T11:04:52.295154 #8666]  INFO -- default-precise32:     +                if ( is_in( $acton, @deps ) ) {
I, [2015-04-24T11:04:52.297349 #8666]  INFO -- default-precise32:     +                    $d =~ m,/([^/]+).load$,;
I, [2015-04-24T11:04:52.299499 #8666]  INFO -- default-precise32:     +                    push @depending, $1;
I, [2015-04-24T11:04:52.301957 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:52.304622 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:52.307953 #8666]  INFO -- default-precise32:     +            if ( scalar @depending ) {
I, [2015-04-24T11:04:52.310313 #8666]  INFO -- default-precise32:     +                if ($force) {
I, [2015-04-24T11:04:52.312961 #8666]  INFO -- default-precise32:     +                    do_deps( $acton, @depending ) or return 0;
I, [2015-04-24T11:04:52.315086 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:52.317278 #8666]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:04:52.320042 #8666]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:04:52.322357 #8666]  INFO -- default-precise32:     +                        "The following modules depend on $acton ",
I, [2015-04-24T11:04:52.325120 #8666]  INFO -- default-precise32:     +                        "and need to be disabled first: @depending\n"
I, [2015-04-24T11:04:52.327255 #8666]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:04:52.329763 #8666]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:04:52.332183 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:52.334814 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:52.337208 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.340117 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.342199 #8666]  INFO -- default-precise32:     +    elsif ( $act eq 'enable' ) {
I, [2015-04-24T11:04:52.344569 #8666]  INFO -- default-precise32:     +        my @depends = get_deps("$availdir/$acton$sffx");
I, [2015-04-24T11:04:52.347089 #8666]  INFO -- default-precise32:     +        warn_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:04:52.350325 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.351548 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.353902 #8666]  INFO -- default-precise32:     +    if ( $act eq 'enable' ) {
I, [2015-04-24T11:04:52.356174 #8666]  INFO -- default-precise32:     +        my $check = check_link( $tgt, $link );
I, [2015-04-24T11:04:52.358684 #8666]  INFO -- default-precise32:     +        if ( $check eq 'ok' ) {
I, [2015-04-24T11:04:52.361178 #8666]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:04:52.363200 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.365916 #8666]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:04:52.368060 #8666]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:04:52.370290 #8666]  INFO -- default-precise32:     +                if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:04:52.372730 #8666]  INFO -- default-precise32:     +                    info("$name $acton already enabled\n");
I, [2015-04-24T11:04:52.374948 #8666]  INFO -- default-precise32:     +                    return 1;
I, [2015-04-24T11:04:52.378533 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:52.380954 #8666]  INFO -- default-precise32:     +                elsif ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:04:52.383056 #8666]  INFO -- default-precise32:     +                    print "Enabling config file $acton.conf.\n";
I, [2015-04-24T11:04:52.385189 #8666]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:04:52.387311 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:52.389518 #8666]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:04:52.391829 #8666]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:04:52.394348 #8666]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:04:52.397046 #8666]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:04:52.399182 #8666]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:04:52.402187 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:52.405497 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:52.407477 #8666]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:04:52.409862 #8666]  INFO -- default-precise32:     +                info("$name $acton already enabled\n");
I, [2015-04-24T11:04:52.412437 #8666]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:04:52.414746 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:52.417223 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.419340 #8666]  INFO -- default-precise32:     +        elsif ( $check eq 'missing' ) {
I, [2015-04-24T11:04:52.422183 #8666]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:04:52.424444 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.426486 #8666]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:04:52.428922 #8666]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:04:52.431132 #8666]  INFO -- default-precise32:     +                if ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:04:52.433341 #8666]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:04:52.435987 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:52.438139 #8666]  INFO -- default-precise32:     +                elsif ( $confcheck ne 'ok' ) {
I, [2015-04-24T11:04:52.440589 #8666]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:04:52.442485 #8666]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:04:52.444919 #8666]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:04:52.447033 #8666]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:04:52.449240 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:52.451311 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:52.453485 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.456165 #8666]  INFO -- default-precise32:     +            print "Enabling $obj $acton.\n";
I, [2015-04-24T11:04:52.458311 #8666]  INFO -- default-precise32:     +            if ( $acton eq 'ssl' ) {
I, [2015-04-24T11:04:52.460843 #8666]  INFO -- default-precise32:     +                info(     "See /usr/share/doc/apache2/README.Debian.gz on "
I, [2015-04-24T11:04:52.463105 #8666]  INFO -- default-precise32:     +                        . "how to configure SSL and create self-signed certificates.\n"
I, [2015-04-24T11:04:52.465339 #8666]  INFO -- default-precise32:     +                );
I, [2015-04-24T11:04:52.467473 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:52.469977 #8666]  INFO -- default-precise32:     +            return add_link( $tgt, $link )
I, [2015-04-24T11:04:52.472433 #8666]  INFO -- default-precise32:     +                && switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:52.474419 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.476794 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:52.479014 #8666]  INFO -- default-precise32:     +            error("$name $acton not properly enabled: $check\n");
I, [2015-04-24T11:04:52.481311 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:52.483848 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.486079 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.488304 #8666]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:04:52.490806 #8666]  INFO -- default-precise32:     +        if ( -e $link || -l $link ) {
I, [2015-04-24T11:04:52.493217 #8666]  INFO -- default-precise32:     +            remove_link($link);
I, [2015-04-24T11:04:52.495327 #8666]  INFO -- default-precise32:     +            if ( $conflink && -e $conflink ) {
I, [2015-04-24T11:04:52.497520 #8666]  INFO -- default-precise32:     +                remove_link($conflink);
I, [2015-04-24T11:04:52.499947 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:52.502315 #8666]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:52.504341 #8666]  INFO -- default-precise32:     +            print "$name $acton disabled.\n";
I, [2015-04-24T11:04:52.508167 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.510329 #8666]  INFO -- default-precise32:     +        elsif ( $conflink && -e $conflink ) {
I, [2015-04-24T11:04:52.513566 #8666]  INFO -- default-precise32:     +            print "Disabling stale config file $acton.conf.\n";
I, [2015-04-24T11:04:52.515830 #8666]  INFO -- default-precise32:     +            remove_link($conflink);
I, [2015-04-24T11:04:52.518138 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.520589 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:52.522777 #8666]  INFO -- default-precise32:     +            info("$name $acton already disabled\n");
I, [2015-04-24T11:04:52.525013 #8666]  INFO -- default-precise32:     +            if ( $purge ) {
I, [2015-04-24T11:04:52.527148 #8666]  INFO -- default-precise32:     +                switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:52.529491 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:52.531923 #8666]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:04:52.534085 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.536994 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.538590 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.540841 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:52.543239 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:52.545439 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.547449 #8666]  INFO -- default-precise32:     +sub get_deps {
I, [2015-04-24T11:04:52.549859 #8666]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:04:52.552165 #8666]  INFO -- default-precise32:     +    my $type = shift || "Depends";
I, [2015-04-24T11:04:52.554230 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.556745 #8666]  INFO -- default-precise32:     +    my $fd;
I, [2015-04-24T11:04:52.558731 #8666]  INFO -- default-precise32:     +    if ( !open( $fd, '<', $file ) ) {
I, [2015-04-24T11:04:52.560922 #8666]  INFO -- default-precise32:     +        error("Can't open $file: $!");
I, [2015-04-24T11:04:52.562851 #8666]  INFO -- default-precise32:     +        return;
I, [2015-04-24T11:04:52.564742 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.566360 #8666]  INFO -- default-precise32:     +    my $line;
I, [2015-04-24T11:04:52.568334 #8666]  INFO -- default-precise32:     +    while ( defined( $line = <$fd> ) ) {
I, [2015-04-24T11:04:52.570295 #8666]  INFO -- default-precise32:     +        chomp $line;
I, [2015-04-24T11:04:52.572928 #8666]  INFO -- default-precise32:     +        if ( $line =~ /^# $type:\s+(.*?)\s*$/ ) {
I, [2015-04-24T11:04:52.575066 #8666]  INFO -- default-precise32:     +            my $deps = $1;
I, [2015-04-24T11:04:52.577233 #8666]  INFO -- default-precise32:     +            return split( /[\n\s]+/, $deps );
I, [2015-04-24T11:04:52.579208 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.581192 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.582817 #8666]  INFO -- default-precise32:     +        # only check until the first non-empty non-comment line
I, [2015-04-24T11:04:52.585060 #8666]  INFO -- default-precise32:     +        last if ( $line !~ /^\s*(?:#.*)?$/ );
I, [2015-04-24T11:04:52.586788 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.588972 #8666]  INFO -- default-precise32:     +    return;
I, [2015-04-24T11:04:52.591356 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:52.592894 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.594777 #8666]  INFO -- default-precise32:     +sub do_deps {
I, [2015-04-24T11:04:52.596759 #8666]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:04:52.598437 #8666]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:04:52.601421 #8666]  INFO -- default-precise32:     +        info("Considering dependency $d for $acton:\n");
I, [2015-04-24T11:04:52.603472 #8666]  INFO -- default-precise32:     +        if ( !doit($d) ) {
I, [2015-04-24T11:04:52.605468 #8666]  INFO -- default-precise32:     +            error("Could not $act dependency $d for $acton, aborting\n");
I, [2015-04-24T11:04:52.607996 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:52.610312 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.612891 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.615030 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:52.617315 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:52.619848 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.621941 #8666]  INFO -- default-precise32:     +sub warn_deps {
I, [2015-04-24T11:04:52.624185 #8666]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:04:52.626656 #8666]  INFO -- default-precise32:     +    my $modsenabldir = $ENV{APACHE_MODS_ENABLED} || "$confdir/mods-enabled";
I, [2015-04-24T11:04:52.629037 #8666]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:04:52.631272 #8666]  INFO -- default-precise32:     +        info("Checking dependency $d for $acton:\n");
I, [2015-04-24T11:04:52.633884 #8666]  INFO -- default-precise32:     +        if ( !-e "$modsenabldir/$d.load" ) {
I, [2015-04-24T11:04:52.636111 #8666]  INFO -- default-precise32:     +            warning(
I, [2015-04-24T11:04:52.638880 #8666]  INFO -- default-precise32:     +                "Module $d is not enabled, but $acton depends on it, aborting\n"
I, [2015-04-24T11:04:52.641165 #8666]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:04:52.643303 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:52.645909 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.648840 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.651053 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:52.653304 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:52.655349 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.657994 #8666]  INFO -- default-precise32:     +sub check_conflicts {
I, [2015-04-24T11:04:52.660573 #8666]  INFO -- default-precise32:     +    my $acton    = shift;
I, [2015-04-24T11:04:52.663034 #8666]  INFO -- default-precise32:     +    my $haderror = 0;
I, [2015-04-24T11:04:52.665256 #8666]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:04:52.667331 #8666]  INFO -- default-precise32:     +        info("Considering conflict $d for $acton:\n");
I, [2015-04-24T11:04:52.669704 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.671968 #8666]  INFO -- default-precise32:     +        my $tgt  = "$availdir/$d$sffx";
I, [2015-04-24T11:04:52.674183 #8666]  INFO -- default-precise32:     +        my $link = "$enabldir/$d$sffx";
I, [2015-04-24T11:04:52.676377 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.678468 #8666]  INFO -- default-precise32:     +        my $confcheck = check_link( $tgt, $link );
I, [2015-04-24T11:04:52.680957 #8666]  INFO -- default-precise32:     +        if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:04:52.683093 #8666]  INFO -- default-precise32:     +            error(
I, [2015-04-24T11:04:52.685365 #8666]  INFO -- default-precise32:     +                "Module $d is enabled - cannot proceed due to conflicts. It needs to be disabled first!\n"
I, [2015-04-24T11:04:52.687463 #8666]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:04:52.689956 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.692416 #8666]  INFO -- default-precise32:     +            # Don't return immediately, there could be several conflicts
I, [2015-04-24T11:04:52.694757 #8666]  INFO -- default-precise32:     +            $haderror++;
I, [2015-04-24T11:04:52.697040 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.699379 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.702017 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.704547 #8666]  INFO -- default-precise32:     +    if ($haderror) {
I, [2015-04-24T11:04:52.708087 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:52.710717 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.713138 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.715480 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:52.718108 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:52.720210 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.722798 #8666]  INFO -- default-precise32:     +sub add_link {
I, [2015-04-24T11:04:52.725374 #8666]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:04:52.727306 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.729635 #8666]  INFO -- default-precise32:     +    # create relative link
I, [2015-04-24T11:04:52.731971 #8666]  INFO -- default-precise32:     +    if ( !symlink( File::Spec->abs2rel( $tgt, dirname($link) ), $link ) ) {
I, [2015-04-24T11:04:52.734146 #8666]  INFO -- default-precise32:     +        die("Could not create $link: $!\n");
I, [2015-04-24T11:04:52.735867 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.737732 #8666]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:04:52.739829 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:52.742242 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:52.744714 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.747070 #8666]  INFO -- default-precise32:     +sub check_link {
I, [2015-04-24T11:04:52.749691 #8666]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:04:52.752549 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.755164 #8666]  INFO -- default-precise32:     +    if ( !-e $link ) {
I, [2015-04-24T11:04:52.758187 #8666]  INFO -- default-precise32:     +        if ( -l $link ) {
I, [2015-04-24T11:04:52.760861 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.763678 #8666]  INFO -- default-precise32:     +            # points to nowhere
I, [2015-04-24T11:04:52.767121 #8666]  INFO -- default-precise32:     +            info("Removing dangling link $link");
I, [2015-04-24T11:04:52.770890 #8666]  INFO -- default-precise32: +            unlink($link) or die "Could not remove $link\n";
I, [2015-04-24T11:04:52.773217 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.775316 #8666]  INFO -- default-precise32:     +        return 'missing';
I, [2015-04-24T11:04:52.783135 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.783181 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.783202 #8666]  INFO -- default-precise32:     +    if ( -e $link && !-l $link ) {
I, [2015-04-24T11:04:52.783222 #8666]  INFO -- default-precise32:     +        return "$link is a real file, not touching it";
I, [2015-04-24T11:04:52.783242 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.784907 #8666]  INFO -- default-precise32:     +    if ( realpath($link) ne realpath($tgt) ) {
I, [2015-04-24T11:04:52.787492 #8666]  INFO -- default-precise32:     +        return "$link exists but does not point to $tgt, not touching it";
I, [2015-04-24T11:04:52.787673 #8666]  INFO -- default-precise32: +    }
I, [2015-04-24T11:04:52.792164 #8666]  INFO -- default-precise32:     +    return 'ok';
I, [2015-04-24T11:04:52.792406 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:52.793845 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.795886 #8666]  INFO -- default-precise32:     +sub remove_link {
I, [2015-04-24T11:04:52.798199 #8666]  INFO -- default-precise32:     +    my ($link) = @_;
I, [2015-04-24T11:04:52.799631 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.803666 #8666]  INFO -- default-precise32:     +    if ( -l $link ) {
I, [2015-04-24T11:04:52.807772 #8666]  INFO -- default-precise32:     +        unlink($link) or die "Could not remove $link: $!\n";
I, [2015-04-24T11:04:52.816069 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.820419 #8666]  INFO -- default-precise32:     +    elsif ( -e $link ) {
I, [2015-04-24T11:04:52.824405 #8666]  INFO -- default-precise32:     +        error("$link is not a symbolic link, not deleting\n");
I, [2015-04-24T11:04:52.828625 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:52.833300 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:52.838012 #8666]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:04:52.842747 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:52.846649 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:52.850207 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.853973 #8666]  INFO -- default-precise32:     +sub threaded {
I, [2015-04-24T11:04:52.857398 #8666]  INFO -- default-precise32:     +    my $result = "";
I, [2015-04-24T11:04:52.860856 #8666]  INFO -- default-precise32:     +    $result = qx{/usr/sbin/apache2ctl -V | grep 'threaded'}
I, [2015-04-24T11:04:52.865155 #8666]  INFO -- default-precise32:     +        if -x '/usr/sbin/apache2ctl';
I, [2015-04-24T11:04:52.870097 #8666]  INFO -- default-precise32:     +    if ( $? != 0 ) {
I, [2015-04-24T11:04:52.874082 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.877926 #8666]  INFO -- default-precise32:     +        # config doesn't work
I, [2015-04-24T11:04:52.882199 #8666]  INFO -- default-precise32:     +        if ( -e "$enabldir/mpm_prefork.load" || -e "$enabldir/mpm_itk.load" )
I, [2015-04-24T11:04:52.886179 #8666]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:04:52.890114 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:52.894104 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.899925 #8666]  INFO -- default-precise32:     +        elsif (-e "$enabldir/mpm_worker.load"
I, [2015-04-24T11:04:52.904628 #8666]  INFO -- default-precise32:     +            || -e "$enabldir/mpm_event.load" )
I, [2015-04-24T11:04:52.908751 #8666]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:04:52.912710 #8666]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:04:52.916947 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:52.932106 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:52.972186 #8666]  INFO -- default-precise32:     +            error("Can't determine enabled MPM");
I, [2015-04-24T11:04:52.972286 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:52.981864 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:53.021592 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:53.021673 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:53.057046 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.057107 #8666]  INFO -- default-precise32:     +    if ( $result =~ / no/ ) {
I, [2015-04-24T11:04:53.057129 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:53.057155 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.057176 #8666]  INFO -- default-precise32:     +    elsif ( $result =~ / yes/ ) {
I, [2015-04-24T11:04:53.057194 #8666]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:04:53.057220 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.064933 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:53.093785 #8666]  INFO -- default-precise32:     +        die("Can't parse output from apache2ctl -V:\n$result\n");
I, [2015-04-24T11:04:53.104386 #8666]  INFO -- default-precise32: +    }
I, [2015-04-24T11:04:53.122973 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:53.138071 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.157283 #8666]  INFO -- default-precise32:     +sub info {
I, [2015-04-24T11:04:53.161099 #8666]  INFO -- default-precise32:     +    print @_ if !$quiet;
I, [2015-04-24T11:04:53.163440 #8666]  INFO -- default-precise32: +}
I, [2015-04-24T11:04:53.163485 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.164439 #8666]  INFO -- default-precise32: +sub error {
I, [2015-04-24T11:04:53.166418 #8666]  INFO -- default-precise32:     +    print STDERR 'ERROR: ', @_;
I, [2015-04-24T11:04:53.169245 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:53.171649 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.177529 #8666]  INFO -- default-precise32:     +sub warning {
I, [2015-04-24T11:04:53.177562 #8666]  INFO -- default-precise32:     +    print STDERR 'WARNING: ', @_;
I, [2015-04-24T11:04:53.177583 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:53.177601 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.177620 #8666]  INFO -- default-precise32:     +sub is_in {
I, [2015-04-24T11:04:53.177638 #8666]  INFO -- default-precise32:     +    my $needle = shift;
I, [2015-04-24T11:04:53.177657 #8666]  INFO -- default-precise32:     +    foreach my $e (@_) {
I, [2015-04-24T11:04:53.177675 #8666]  INFO -- default-precise32:     +        return 1 if $needle eq $e;
I, [2015-04-24T11:04:53.177693 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.177724 #8666]  INFO -- default-precise32:     +    return 0;
I, [2015-04-24T11:04:53.177743 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:53.177760 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.177778 #8666]  INFO -- default-precise32:     +sub read_env_file {
I, [2015-04-24T11:04:53.177796 #8666]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:04:53.177813 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.177831 #8666]  INFO -- default-precise32:     +    -r $file or return;
I, [2015-04-24T11:04:53.177849 #8666]  INFO -- default-precise32:     +    my @lines = qx{env - sh -c '. $file && env'};
I, [2015-04-24T11:04:53.177868 #8666]  INFO -- default-precise32:     +    if ($?) {
I, [2015-04-24T11:04:53.177886 #8666]  INFO -- default-precise32:     +        die "Could not read $file\n";
I, [2015-04-24T11:04:53.177904 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.177921 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.177939 #8666]  INFO -- default-precise32:     +    foreach my $l (@lines) {
I, [2015-04-24T11:04:53.177957 #8666]  INFO -- default-precise32:     +        chomp $l;
I, [2015-04-24T11:04:53.177975 #8666]  INFO -- default-precise32:     +        $l =~ /^(.*)?=(.*)$/ or die "Could not parse $file\n";
I, [2015-04-24T11:04:53.177994 #8666]  INFO -- default-precise32:     +        $ENV{$1} = $2;
I, [2015-04-24T11:04:53.178012 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.178029 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:53.178047 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.178076 #8666]  INFO -- default-precise32:     +sub switch_marker {
I, [2015-04-24T11:04:53.178095 #8666]  INFO -- default-precise32:     +    die('usage: switch_marker([module|site|conf], [enable|disable], $name)')
I, [2015-04-24T11:04:53.178113 #8666]  INFO -- default-precise32:     +        if @_ != 3;
I, [2015-04-24T11:04:53.178131 #8666]  INFO -- default-precise32:     +    my $which = shift;
I, [2015-04-24T11:04:53.178161 #8666]  INFO -- default-precise32:     +    my $what  = shift;
I, [2015-04-24T11:04:53.178180 #8666]  INFO -- default-precise32:     +    my $name  = shift;
I, [2015-04-24T11:04:53.178198 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.178216 #8666]  INFO -- default-precise32:     +    my $mode = "admin";
I, [2015-04-24T11:04:53.178234 #8666]  INFO -- default-precise32:     +    $mode = "maint" if $maintmode;
I, [2015-04-24T11:04:53.178280 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.178315 #8666]  INFO -- default-precise32:     +    #print("switch_marker $which $what $name\n");
I, [2015-04-24T11:04:53.178349 #8666]  INFO -- default-precise32:     +    # TODO: get rid of the magic string(s)
I, [2015-04-24T11:04:53.178384 #8666]  INFO -- default-precise32:     +    my $state_marker_dir = "$statedir/$what" . "d" . "_by_$mode";
I, [2015-04-24T11:04:53.178409 #8666]  INFO -- default-precise32:     +    my $state_marker     = "$state_marker_dir/$name";
I, [2015-04-24T11:04:53.178428 #8666]  INFO -- default-precise32:     +    if ( !-d $state_marker_dir ) {
I, [2015-04-24T11:04:53.178447 #8666]  INFO -- default-precise32:     +        File::Path::mkpath("$state_marker_dir")
I, [2015-04-24T11:04:53.178465 #8666]  INFO -- default-precise32:     +            || error(
I, [2015-04-24T11:04:53.178484 #8666]  INFO -- default-precise32:     +            "Failed to create marker directory: '$state_marker_dir'\n");
I, [2015-04-24T11:04:53.178502 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.178520 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.178538 #8666]  INFO -- default-precise32:     +    # XXX: swap find with perl alternative
I, [2015-04-24T11:04:53.178556 #8666]  INFO -- default-precise32:     +    my @markers = qx{find "$statedir" -type f -a -name "$name"};
I, [2015-04-24T11:04:53.178574 #8666]  INFO -- default-precise32:     +    chomp(@markers);
I, [2015-04-24T11:04:53.178592 #8666]  INFO -- default-precise32:     +    foreach (@markers) {
I, [2015-04-24T11:04:53.178610 #8666]  INFO -- default-precise32:     +        unless ( unlink $_ ) {
I, [2015-04-24T11:04:53.178629 #8666]  INFO -- default-precise32:     +            error("Failed to remove old marker '$_'!\n") && return 0;
I, [2015-04-24T11:04:53.178647 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:53.178665 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.178683 #8666]  INFO -- default-precise32:     +    unless ($purge) {
I, [2015-04-24T11:04:53.178701 #8666]  INFO -- default-precise32:     +        qx{touch "$state_marker"};
I, [2015-04-24T11:04:53.178720 #8666]  INFO -- default-precise32:     +        if ( $? != 0 ) {
I, [2015-04-24T11:04:53.178738 #8666]  INFO -- default-precise32:     +            error("Failed to create marker '$state_marker'!\n") && return 0;
I, [2015-04-24T11:04:53.178757 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:53.178782 #8666]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:04:53.178800 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.178818 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:53.178836 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.186659 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:53.190240 #8666]  INFO -- default-precise32:     - change mode from '' to '0700'
I, [2015-04-24T11:04:53.191309 #8666]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:04:53.195728 #8666]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:04:53.201249 #8666]  INFO -- default-precise32:   * link[/usr/sbin/a2dissite] action delete
I, [2015-04-24T11:04:53.203310 #8666]  INFO -- default-precise32:     - delete link at /usr/sbin/a2dissite
I, [2015-04-24T11:04:53.211122 #8666]  INFO -- default-precise32:   * template[/usr/sbin/a2dissite] action create
I, [2015-04-24T11:04:53.226256 #8666]  INFO -- default-precise32:     - create new file /usr/sbin/a2dissite
I, [2015-04-24T11:04:53.228277 #8666]  INFO -- default-precise32:     - update content in file /usr/sbin/a2dissite from none to ce53f4
I, [2015-04-24T11:04:53.230765 #8666]  INFO -- default-precise32:     --- /usr/sbin/a2dissite	2015-04-24 08:04:53.204755646 +0000
I, [2015-04-24T11:04:53.234302 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-1hjy7yq	2015-04-24 08:04:53.204755646 +0000
I, [2015-04-24T11:04:53.236217 #8666]  INFO -- default-precise32:     @@ -1 +1,533 @@
I, [2015-04-24T11:04:53.238218 #8666]  INFO -- default-precise32:     +#!/usr/bin/perl -w
I, [2015-04-24T11:04:53.239761 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:53.242155 #8666]  INFO -- default-precise32:     +# a2enmod by Stefan Fritsch <sf@debian.org>
I, [2015-04-24T11:04:53.244215 #8666]  INFO -- default-precise32:     +# Licensed under Apache License 2.0
I, [2015-04-24T11:04:53.246642 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:53.248827 #8666]  INFO -- default-precise32:     +# The coding style is "perltidy -pbp"
I, [2015-04-24T11:04:53.251096 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.256274 #8666]  INFO -- default-precise32:     +use strict;
I, [2015-04-24T11:04:53.256565 #8666]  INFO -- default-precise32:     +use Cwd 'realpath';
I, [2015-04-24T11:04:53.257750 #8666]  INFO -- default-precise32:     +use File::Spec;
I, [2015-04-24T11:04:53.259290 #8666]  INFO -- default-precise32:     +use File::Basename;
I, [2015-04-24T11:04:53.261480 #8666]  INFO -- default-precise32:     +use File::Path;
I, [2015-04-24T11:04:53.263602 #8666]  INFO -- default-precise32:     +use Getopt::Long;
I, [2015-04-24T11:04:53.265926 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.267635 #8666]  INFO -- default-precise32:     +my $quiet;
I, [2015-04-24T11:04:53.269669 #8666]  INFO -- default-precise32:     +my $force;
I, [2015-04-24T11:04:53.271766 #8666]  INFO -- default-precise32:     +my $maintmode;
I, [2015-04-24T11:04:53.274110 #8666]  INFO -- default-precise32:     +my $purge;
I, [2015-04-24T11:04:53.275602 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.277837 #8666]  INFO -- default-precise32:     +Getopt::Long::Configure('bundling');
I, [2015-04-24T11:04:53.280071 #8666]  INFO -- default-precise32:     +GetOptions(
I, [2015-04-24T11:04:53.281537 #8666]  INFO -- default-precise32: +    'quiet|q'     => \$quiet,
I, [2015-04-24T11:04:53.285184 #8666]  INFO -- default-precise32: +    'force|f'     => \$force,
I, [2015-04-24T11:04:53.285356 #8666]  INFO -- default-precise32: +    'maintmode|m' => \$maintmode,
I, [2015-04-24T11:04:53.286780 #8666]  INFO -- default-precise32:     +    'purge|p'     => \$purge
I, [2015-04-24T11:04:53.289011 #8666]  INFO -- default-precise32:     +) or exit 2;
I, [2015-04-24T11:04:53.291215 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.291249 #8666]  INFO -- default-precise32:     +my $basename = basename($0);
I, [2015-04-24T11:04:53.291284 #8666]  INFO -- default-precise32:     +$basename =~ /^a2(en|dis)(mod|site|conf)((?:-.+)?)$/
I, [2015-04-24T11:04:53.294272 #8666]  INFO -- default-precise32:     +    or die "$basename call name unknown\n";
I, [2015-04-24T11:04:53.294307 #8666]  INFO -- default-precise32:     +my $act        = $1;
I, [2015-04-24T11:04:53.294441 #8666]  INFO -- default-precise32: +my $obj        = $2;
I, [2015-04-24T11:04:53.296460 #8666]  INFO -- default-precise32:     +my $dir_suffix = $3;
I, [2015-04-24T11:04:53.298708 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.300820 #8666]  INFO -- default-precise32:     +my $env_file = $ENV{APACHE_ENVVARS}
I, [2015-04-24T11:04:53.303091 #8666]  INFO -- default-precise32:     +    || (
I, [2015-04-24T11:04:53.305241 #8666]  INFO -- default-precise32:     +    $ENV{APACHE_CONFDIR}
I, [2015-04-24T11:04:53.307264 #8666]  INFO -- default-precise32:     +    ? "$ENV{APACHE_CONFDIR}/envvars"
I, [2015-04-24T11:04:53.307299 #8666]  INFO -- default-precise32:     +    : "/etc/apache2$dir_suffix/envvars"
I, [2015-04-24T11:04:53.309114 #8666]  INFO -- default-precise32:     +    );
I, [2015-04-24T11:04:53.310579 #8666]  INFO -- default-precise32:     +$ENV{LANG} = 'C';
I, [2015-04-24T11:04:53.312055 #8666]  INFO -- default-precise32:     +read_env_file($env_file);
I, [2015-04-24T11:04:53.314587 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.317308 #8666]  INFO -- default-precise32:     +$act .= 'able';
I, [2015-04-24T11:04:53.317369 #8666]  INFO -- default-precise32:     +my ( $name, $dir, $sffx, $reload );
I, [2015-04-24T11:04:53.320182 #8666]  INFO -- default-precise32:     +if ( $obj eq 'mod' ) {
I, [2015-04-24T11:04:53.322483 #8666]  INFO -- default-precise32:     +    $obj    = 'module';
I, [2015-04-24T11:04:53.324851 #8666]  INFO -- default-precise32:     +    $dir    = 'mods';
I, [2015-04-24T11:04:53.327170 #8666]  INFO -- default-precise32:     +    $sffx   = '.load';
I, [2015-04-24T11:04:53.329892 #8666]  INFO -- default-precise32:     +    $reload = 'restart';
I, [2015-04-24T11:04:53.332132 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:53.334311 #8666]  INFO -- default-precise32:     +elsif ( $obj eq 'conf' ) {
I, [2015-04-24T11:04:53.337186 #8666]  INFO -- default-precise32:     +    $obj    = 'conf';
I, [2015-04-24T11:04:53.339192 #8666]  INFO -- default-precise32:     +    $dir    = 'conf';
I, [2015-04-24T11:04:53.341689 #8666]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:04:53.344664 #8666]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:04:53.347775 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:53.351488 #8666]  INFO -- default-precise32:     +else {
I, [2015-04-24T11:04:53.364166 #8666]  INFO -- default-precise32:     +    $dir    = 'sites';
I, [2015-04-24T11:04:53.364215 #8666]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:04:53.364242 #8666]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:04:53.364261 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:53.364279 #8666]  INFO -- default-precise32:     +$name = ucfirst($obj);
I, [2015-04-24T11:04:53.364297 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.365621 #8666]  INFO -- default-precise32: +my $confdir = $ENV{APACHE_CONFDIR} || "/etc/apache2$dir_suffix";
I, [2015-04-24T11:04:53.368137 #8666]  INFO -- default-precise32:     +my $availdir = $ENV{ uc("APACHE_${dir}_AVAILABLE") }
I, [2015-04-24T11:04:53.370226 #8666]  INFO -- default-precise32:     +    || "$confdir/$dir-available";
I, [2015-04-24T11:04:53.373081 #8666]  INFO -- default-precise32:     +my $enabldir = $ENV{ uc("APACHE_${dir}_ENABLED") } || "$confdir/$dir-enabled";
I, [2015-04-24T11:04:53.376047 #8666]  INFO -- default-precise32:     +my $statedir = $ENV{ uc("APACHE_STATE_DIRECTORY") } || "/usr/lib/apache2";
I, [2015-04-24T11:04:53.378881 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.381699 #8666]  INFO -- default-precise32:     +$statedir .= "/$obj";
I, [2015-04-24T11:04:53.384319 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.387660 #8666]  INFO -- default-precise32:     +my $choicedir = $act eq 'enable' ? $availdir : $enabldir;
I, [2015-04-24T11:04:53.390662 #8666]  INFO -- default-precise32:     +my $linkdir = File::Spec->abs2rel( $availdir, $enabldir );
I, [2015-04-24T11:04:53.393412 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.396182 #8666]  INFO -- default-precise32:     +my $request_reload = 0;
I, [2015-04-24T11:04:53.398503 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.401182 #8666]  INFO -- default-precise32:     +my $rc = 0;
I, [2015-04-24T11:04:53.403658 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.408795 #8666]  INFO -- default-precise32:     +if ( !scalar @ARGV ) {
I, [2015-04-24T11:04:53.410907 #8666]  INFO -- default-precise32:     +    my @choices = myglob('*');
I, [2015-04-24T11:04:53.413226 #8666]  INFO -- default-precise32:     +    print "Your choices are: @choices\n";
I, [2015-04-24T11:04:53.415145 #8666]  INFO -- default-precise32:     +    print "Which ${obj}(s) do you want to $act (wildcards ok)?\n";
I, [2015-04-24T11:04:53.417403 #8666]  INFO -- default-precise32:     +    my $input = <>;
I, [2015-04-24T11:04:53.419519 #8666]  INFO -- default-precise32:     +    @ARGV = split /\s+/, $input;
I, [2015-04-24T11:04:53.421230 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.423106 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:53.425042 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.427070 #8666]  INFO -- default-precise32:     +my @objs;
I, [2015-04-24T11:04:53.429039 #8666]  INFO -- default-precise32:     +foreach my $arg (@ARGV) {
I, [2015-04-24T11:04:53.431472 #8666]  INFO -- default-precise32:     +    $arg =~ s/${sffx}$//;
I, [2015-04-24T11:04:53.434954 #8666]  INFO -- default-precise32:     +    my @glob = myglob($arg);
I, [2015-04-24T11:04:53.437145 #8666]  INFO -- default-precise32:     +    if ( !@glob ) {
I, [2015-04-24T11:04:53.438924 #8666]  INFO -- default-precise32:     +        error("No $obj found matching $arg!\n");
I, [2015-04-24T11:04:53.441050 #8666]  INFO -- default-precise32:     +        $rc = 1;
I, [2015-04-24T11:04:53.443091 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.445269 #8666]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:04:53.447218 #8666]  INFO -- default-precise32:     +        push @objs, @glob;
I, [2015-04-24T11:04:53.449714 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.451510 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:53.453410 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.455228 #8666]  INFO -- default-precise32:     +foreach my $acton (@objs) {
I, [2015-04-24T11:04:53.457291 #8666]  INFO -- default-precise32:     +    doit($acton) or $rc = 1;
I, [2015-04-24T11:04:53.458993 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:53.462915 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.469887 #8666]  INFO -- default-precise32:     +info(
I, [2015-04-24T11:04:53.472708 #8666]  INFO -- default-precise32:     +    "To activate the new configuration, you need to run:\n  service apache2 $reload\n"
I, [2015-04-24T11:04:53.475730 #8666]  INFO -- default-precise32:     +) if $request_reload;
I, [2015-04-24T11:04:53.478773 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.481773 #8666]  INFO -- default-precise32:     +exit($rc);
I, [2015-04-24T11:04:53.484557 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.487353 #8666]  INFO -- default-precise32:     +##############################################################################
I, [2015-04-24T11:04:53.491074 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.494111 #8666]  INFO -- default-precise32:     +sub myglob {
I, [2015-04-24T11:04:53.496624 #8666]  INFO -- default-precise32:     +    my $arg = shift;
I, [2015-04-24T11:04:53.499163 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.502081 #8666]  INFO -- default-precise32:     +    my @glob = map {
I, [2015-04-24T11:04:53.504862 #8666]  INFO -- default-precise32:     +        s{^$choicedir/}{};
I, [2015-04-24T11:04:53.507308 #8666]  INFO -- default-precise32:     +        s{$sffx$}{};
I, [2015-04-24T11:04:53.510564 #8666]  INFO -- default-precise32:     +        $_
I, [2015-04-24T11:04:53.513838 #8666]  INFO -- default-precise32:     +    } glob("$choicedir/$arg$sffx");
I, [2015-04-24T11:04:53.516554 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.519408 #8666]  INFO -- default-precise32:     +    return @glob;
I, [2015-04-24T11:04:53.522660 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:53.525211 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.527787 #8666]  INFO -- default-precise32:     +sub doit {
I, [2015-04-24T11:04:53.530581 #8666]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:04:53.533162 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.535711 #8666]  INFO -- default-precise32:     +    my ( $conftgt, $conflink );
I, [2015-04-24T11:04:53.538488 #8666]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:04:53.541516 #8666]  INFO -- default-precise32:     +        if ( $acton eq 'cgi' && threaded() ) {
I, [2015-04-24T11:04:53.544086 #8666]  INFO -- default-precise32:     +            print
I, [2015-04-24T11:04:53.547311 #8666]  INFO -- default-precise32:     +                "Your MPM seems to be threaded. Selecting cgid instead of cgi.\n";
I, [2015-04-24T11:04:53.550589 #8666]  INFO -- default-precise32:     +            $acton = 'cgid';
I, [2015-04-24T11:04:53.553813 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:53.556537 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.559180 #8666]  INFO -- default-precise32:     +        $conftgt = "$availdir/$acton.conf";
I, [2015-04-24T11:04:53.562232 #8666]  INFO -- default-precise32:     +        if ( -e $conftgt ) {
I, [2015-04-24T11:04:53.564963 #8666]  INFO -- default-precise32:     +            $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:04:53.567641 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:53.570107 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.572833 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.575657 #8666]  INFO -- default-precise32:     +    my $tgt  = "$availdir/$acton$sffx";
I, [2015-04-24T11:04:53.578928 #8666]  INFO -- default-precise32:     +    my $link = "$enabldir/$acton$sffx";
I, [2015-04-24T11:04:53.581711 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.584713 #8666]  INFO -- default-precise32:     +    if ( !-e $tgt ) {
I, [2015-04-24T11:04:53.587171 #8666]  INFO -- default-precise32:     +        if ( -l $link && !-e $link ) {
I, [2015-04-24T11:04:53.589495 #8666]  INFO -- default-precise32:     +            if ( $act eq 'disable' ) {
I, [2015-04-24T11:04:53.592203 #8666]  INFO -- default-precise32:     +                info("removing dangling symlink $link\n");
I, [2015-04-24T11:04:53.594738 #8666]  INFO -- default-precise32:     +                unlink($link);
I, [2015-04-24T11:04:53.597499 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.600308 #8666]  INFO -- default-precise32:     +                # force a .conf path. It may exist as dangling link, too
I, [2015-04-24T11:04:53.603122 #8666]  INFO -- default-precise32:     +                $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:04:53.605689 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.608548 #8666]  INFO -- default-precise32:     +                if ( -l $conflink && !-e $conflink ) {
I, [2015-04-24T11:04:53.611790 #8666]  INFO -- default-precise32:     +                    info("removing dangling symlink $conflink\n");
I, [2015-04-24T11:04:53.614920 #8666]  INFO -- default-precise32:     +                    unlink($conflink);
I, [2015-04-24T11:04:53.617498 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:53.620675 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.623084 #8666]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:04:53.625912 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:53.628025 #8666]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:04:53.630334 #8666]  INFO -- default-precise32:     +                error("$link is a dangling symlink!\n");
I, [2015-04-24T11:04:53.632951 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:53.635188 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:53.637754 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.640421 #8666]  INFO -- default-precise32:     +        if ( $purge ) {
I, [2015-04-24T11:04:53.642606 #8666]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:53.645390 #8666]  INFO -- default-precise32:     +            # exit silently, we are purging anyway
I, [2015-04-24T11:04:53.647487 #8666]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:04:53.650182 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:53.652076 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.654329 #8666]  INFO -- default-precise32:     +        error("$name $acton does not exist!\n");
I, [2015-04-24T11:04:53.657046 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:53.659063 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.661312 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.663671 #8666]  INFO -- default-precise32:     +    # handle module dependencies
I, [2015-04-24T11:04:53.666171 #8666]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:04:53.668716 #8666]  INFO -- default-precise32:     +        if ( $act eq 'enable' ) {
I, [2015-04-24T11:04:53.671194 #8666]  INFO -- default-precise32:     +            if ( $acton eq 'mpm_itk' ) {
I, [2015-04-24T11:04:53.673939 #8666]  INFO -- default-precise32:     +                warning(  "MPM_ITK is a third party module that is not part "
I, [2015-04-24T11:04:53.676550 #8666]  INFO -- default-precise32:     +                        . "of the official Apache HTTPD. It has seen less "
I, [2015-04-24T11:04:53.679059 #8666]  INFO -- default-precise32:     +                        . "testing than the official MPM modules." );
I, [2015-04-24T11:04:53.681327 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:53.683479 #8666]  INFO -- default-precise32:     +            my @depends = get_deps("$availdir/$acton.load");
I, [2015-04-24T11:04:53.686192 #8666]  INFO -- default-precise32:     +            do_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:04:53.688497 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.690480 #8666]  INFO -- default-precise32:     +            my @conflicts = get_deps( "$availdir/$acton.load", "Conflicts" );
I, [2015-04-24T11:04:53.692959 #8666]  INFO -- default-precise32:     +            check_conflicts( $acton, @conflicts ) or return 0;
I, [2015-04-24T11:04:53.695153 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:53.697723 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:53.700532 #8666]  INFO -- default-precise32:     +            my @depending;
I, [2015-04-24T11:04:53.703154 #8666]  INFO -- default-precise32:     +            foreach my $d ( glob("$enabldir/*.load") ) {
I, [2015-04-24T11:04:53.705297 #8666]  INFO -- default-precise32:     +                my @deps = get_deps($d);
I, [2015-04-24T11:04:53.707641 #8666]  INFO -- default-precise32:     +                if ( is_in( $acton, @deps ) ) {
I, [2015-04-24T11:04:53.710800 #8666]  INFO -- default-precise32:     +                    $d =~ m,/([^/]+).load$,;
I, [2015-04-24T11:04:53.713130 #8666]  INFO -- default-precise32:     +                    push @depending, $1;
I, [2015-04-24T11:04:53.715243 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:53.718022 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:53.720539 #8666]  INFO -- default-precise32:     +            if ( scalar @depending ) {
I, [2015-04-24T11:04:53.722459 #8666]  INFO -- default-precise32:     +                if ($force) {
I, [2015-04-24T11:04:53.725027 #8666]  INFO -- default-precise32:     +                    do_deps( $acton, @depending ) or return 0;
I, [2015-04-24T11:04:53.727226 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:53.729792 #8666]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:04:53.732405 #8666]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:04:53.734745 #8666]  INFO -- default-precise32:     +                        "The following modules depend on $acton ",
I, [2015-04-24T11:04:53.737099 #8666]  INFO -- default-precise32:     +                        "and need to be disabled first: @depending\n"
I, [2015-04-24T11:04:53.739411 #8666]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:04:53.741989 #8666]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:04:53.744632 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:53.747148 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:53.749673 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:53.751855 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.754159 #8666]  INFO -- default-precise32:     +    elsif ( $act eq 'enable' ) {
I, [2015-04-24T11:04:53.756310 #8666]  INFO -- default-precise32:     +        my @depends = get_deps("$availdir/$acton$sffx");
I, [2015-04-24T11:04:53.758910 #8666]  INFO -- default-precise32:     +        warn_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:04:53.765751 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.769401 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.771129 #8666]  INFO -- default-precise32:     +    if ( $act eq 'enable' ) {
I, [2015-04-24T11:04:53.773351 #8666]  INFO -- default-precise32:     +        my $check = check_link( $tgt, $link );
I, [2015-04-24T11:04:53.775365 #8666]  INFO -- default-precise32:     +        if ( $check eq 'ok' ) {
I, [2015-04-24T11:04:53.777556 #8666]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:04:53.779102 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.781124 #8666]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:04:53.782998 #8666]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:04:53.784764 #8666]  INFO -- default-precise32:     +                if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:04:53.786557 #8666]  INFO -- default-precise32:     +                    info("$name $acton already enabled\n");
I, [2015-04-24T11:04:53.789897 #8666]  INFO -- default-precise32:     +                    return 1;
I, [2015-04-24T11:04:53.790943 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:53.792749 #8666]  INFO -- default-precise32:     +                elsif ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:04:53.794383 #8666]  INFO -- default-precise32:     +                    print "Enabling config file $acton.conf.\n";
I, [2015-04-24T11:04:53.796113 #8666]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:04:53.798124 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:53.799833 #8666]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:04:53.801596 #8666]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:04:53.803414 #8666]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:04:53.805300 #8666]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:04:53.807274 #8666]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:04:53.809368 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:53.811105 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:53.813253 #8666]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:04:53.815039 #8666]  INFO -- default-precise32:     +                info("$name $acton already enabled\n");
I, [2015-04-24T11:04:53.821103 #8666]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:04:53.822505 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:53.824539 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:53.826523 #8666]  INFO -- default-precise32:     +        elsif ( $check eq 'missing' ) {
I, [2015-04-24T11:04:53.829488 #8666]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:04:53.830523 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.832528 #8666]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:04:53.834397 #8666]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:04:53.836307 #8666]  INFO -- default-precise32:     +                if ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:04:53.838264 #8666]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:04:53.840322 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:53.842452 #8666]  INFO -- default-precise32:     +                elsif ( $confcheck ne 'ok' ) {
I, [2015-04-24T11:04:53.844284 #8666]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:04:53.846325 #8666]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:04:53.850332 #8666]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:04:53.850558 #8666]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:04:53.852170 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:53.854474 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:53.856070 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.858418 #8666]  INFO -- default-precise32:     +            print "Enabling $obj $acton.\n";
I, [2015-04-24T11:04:53.860461 #8666]  INFO -- default-precise32:     +            if ( $acton eq 'ssl' ) {
I, [2015-04-24T11:04:53.862413 #8666]  INFO -- default-precise32:     +                info(     "See /usr/share/doc/apache2/README.Debian.gz on "
I, [2015-04-24T11:04:53.864433 #8666]  INFO -- default-precise32:     +                        . "how to configure SSL and create self-signed certificates.\n"
I, [2015-04-24T11:04:53.866406 #8666]  INFO -- default-precise32:     +                );
I, [2015-04-24T11:04:53.868346 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:53.870311 #8666]  INFO -- default-precise32:     +            return add_link( $tgt, $link )
I, [2015-04-24T11:04:53.872379 #8666]  INFO -- default-precise32:     +                && switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:53.874443 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:53.879669 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:53.879952 #8666]  INFO -- default-precise32:     +            error("$name $acton not properly enabled: $check\n");
I, [2015-04-24T11:04:53.881160 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:53.882952 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:53.885111 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.887272 #8666]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:04:53.889345 #8666]  INFO -- default-precise32:     +        if ( -e $link || -l $link ) {
I, [2015-04-24T11:04:53.891219 #8666]  INFO -- default-precise32:     +            remove_link($link);
I, [2015-04-24T11:04:53.893323 #8666]  INFO -- default-precise32:     +            if ( $conflink && -e $conflink ) {
I, [2015-04-24T11:04:53.895102 #8666]  INFO -- default-precise32:     +                remove_link($conflink);
I, [2015-04-24T11:04:53.897248 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:53.899141 #8666]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:53.901120 #8666]  INFO -- default-precise32:     +            print "$name $acton disabled.\n";
I, [2015-04-24T11:04:53.903125 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:53.905118 #8666]  INFO -- default-precise32:     +        elsif ( $conflink && -e $conflink ) {
I, [2015-04-24T11:04:53.909475 #8666]  INFO -- default-precise32:     +            print "Disabling stale config file $acton.conf.\n";
I, [2015-04-24T11:04:53.909757 #8666]  INFO -- default-precise32:     +            remove_link($conflink);
I, [2015-04-24T11:04:53.911542 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:53.913825 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:53.915548 #8666]  INFO -- default-precise32:     +            info("$name $acton already disabled\n");
I, [2015-04-24T11:04:53.918129 #8666]  INFO -- default-precise32:     +            if ( $purge ) {
I, [2015-04-24T11:04:53.920143 #8666]  INFO -- default-precise32:     +                switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:53.922127 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:53.924435 #8666]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:04:53.929116 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:53.930929 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.933020 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.934562 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:53.938670 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:53.939238 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.941436 #8666]  INFO -- default-precise32:     +sub get_deps {
I, [2015-04-24T11:04:53.943351 #8666]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:04:53.945456 #8666]  INFO -- default-precise32:     +    my $type = shift || "Depends";
I, [2015-04-24T11:04:53.947275 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.949202 #8666]  INFO -- default-precise32:     +    my $fd;
I, [2015-04-24T11:04:53.951123 #8666]  INFO -- default-precise32:     +    if ( !open( $fd, '<', $file ) ) {
I, [2015-04-24T11:04:53.953098 #8666]  INFO -- default-precise32:     +        error("Can't open $file: $!");
I, [2015-04-24T11:04:53.955042 #8666]  INFO -- default-precise32:     +        return;
I, [2015-04-24T11:04:53.957121 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.958663 #8666]  INFO -- default-precise32:     +    my $line;
I, [2015-04-24T11:04:53.960868 #8666]  INFO -- default-precise32:     +    while ( defined( $line = <$fd> ) ) {
I, [2015-04-24T11:04:53.962567 #8666]  INFO -- default-precise32:     +        chomp $line;
I, [2015-04-24T11:04:53.964407 #8666]  INFO -- default-precise32:     +        if ( $line =~ /^# $type:\s+(.*?)\s*$/ ) {
I, [2015-04-24T11:04:53.967209 #8666]  INFO -- default-precise32:     +            my $deps = $1;
I, [2015-04-24T11:04:53.968375 #8666]  INFO -- default-precise32:     +            return split( /[\n\s]+/, $deps );
I, [2015-04-24T11:04:53.970457 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:53.972330 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.974286 #8666]  INFO -- default-precise32:     +        # only check until the first non-empty non-comment line
I, [2015-04-24T11:04:53.976128 #8666]  INFO -- default-precise32:     +        last if ( $line !~ /^\s*(?:#.*)?$/ );
I, [2015-04-24T11:04:53.978342 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:53.980466 #8666]  INFO -- default-precise32:     +    return;
I, [2015-04-24T11:04:53.982522 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:53.984437 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:53.986342 #8666]  INFO -- default-precise32:     +sub do_deps {
I, [2015-04-24T11:04:53.988258 #8666]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:04:53.990131 #8666]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:04:53.991973 #8666]  INFO -- default-precise32:     +        info("Considering dependency $d for $acton:\n");
I, [2015-04-24T11:04:53.996886 #8666]  INFO -- default-precise32:     +        if ( !doit($d) ) {
I, [2015-04-24T11:04:53.997181 #8666]  INFO -- default-precise32:     +            error("Could not $act dependency $d for $acton, aborting\n");
I, [2015-04-24T11:04:53.998381 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:54.000390 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:54.002524 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.004880 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:54.006600 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:54.008684 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.010513 #8666]  INFO -- default-precise32:     +sub warn_deps {
I, [2015-04-24T11:04:54.012664 #8666]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:04:54.014782 #8666]  INFO -- default-precise32:     +    my $modsenabldir = $ENV{APACHE_MODS_ENABLED} || "$confdir/mods-enabled";
I, [2015-04-24T11:04:54.016778 #8666]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:04:54.019089 #8666]  INFO -- default-precise32:     +        info("Checking dependency $d for $acton:\n");
I, [2015-04-24T11:04:54.021309 #8666]  INFO -- default-precise32:     +        if ( !-e "$modsenabldir/$d.load" ) {
I, [2015-04-24T11:04:54.023101 #8666]  INFO -- default-precise32:     +            warning(
I, [2015-04-24T11:04:54.026771 #8666]  INFO -- default-precise32:     +                "Module $d is not enabled, but $acton depends on it, aborting\n"
I, [2015-04-24T11:04:54.028148 #8666]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:04:54.029912 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:54.031979 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:54.034277 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.036464 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:54.039459 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:54.041061 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.043116 #8666]  INFO -- default-precise32:     +sub check_conflicts {
I, [2015-04-24T11:04:54.045238 #8666]  INFO -- default-precise32:     +    my $acton    = shift;
I, [2015-04-24T11:04:54.047135 #8666]  INFO -- default-precise32:     +    my $haderror = 0;
I, [2015-04-24T11:04:54.049188 #8666]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:04:54.051449 #8666]  INFO -- default-precise32:     +        info("Considering conflict $d for $acton:\n");
I, [2015-04-24T11:04:54.052952 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.056218 #8666]  INFO -- default-precise32:     +        my $tgt  = "$availdir/$d$sffx";
I, [2015-04-24T11:04:54.057228 #8666]  INFO -- default-precise32:     +        my $link = "$enabldir/$d$sffx";
I, [2015-04-24T11:04:54.058897 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.060998 #8666]  INFO -- default-precise32:     +        my $confcheck = check_link( $tgt, $link );
I, [2015-04-24T11:04:54.063335 #8666]  INFO -- default-precise32:     +        if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:04:54.065392 #8666]  INFO -- default-precise32:     +            error(
I, [2015-04-24T11:04:54.067500 #8666]  INFO -- default-precise32:     +                "Module $d is enabled - cannot proceed due to conflicts. It needs to be disabled first!\n"
I, [2015-04-24T11:04:54.069529 #8666]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:04:54.071720 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.074032 #8666]  INFO -- default-precise32:     +            # Don't return immediately, there could be several conflicts
I, [2015-04-24T11:04:54.076176 #8666]  INFO -- default-precise32:     +            $haderror++;
I, [2015-04-24T11:04:54.078159 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:54.079951 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.081656 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.085320 #8666]  INFO -- default-precise32:     +    if ($haderror) {
I, [2015-04-24T11:04:54.085782 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:54.087567 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.089497 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.091239 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:54.093557 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:54.095039 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.097140 #8666]  INFO -- default-precise32:     +sub add_link {
I, [2015-04-24T11:04:54.099547 #8666]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:04:54.101458 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.103468 #8666]  INFO -- default-precise32:     +    # create relative link
I, [2015-04-24T11:04:54.105460 #8666]  INFO -- default-precise32:     +    if ( !symlink( File::Spec->abs2rel( $tgt, dirname($link) ), $link ) ) {
I, [2015-04-24T11:04:54.107131 #8666]  INFO -- default-precise32:     +        die("Could not create $link: $!\n");
I, [2015-04-24T11:04:54.109144 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.111142 #8666]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:04:54.114622 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:54.115300 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:54.117160 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.119232 #8666]  INFO -- default-precise32:     +sub check_link {
I, [2015-04-24T11:04:54.121491 #8666]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:04:54.123045 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.125034 #8666]  INFO -- default-precise32:     +    if ( !-e $link ) {
I, [2015-04-24T11:04:54.126910 #8666]  INFO -- default-precise32:     +        if ( -l $link ) {
I, [2015-04-24T11:04:54.129102 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.130988 #8666]  INFO -- default-precise32:     +            # points to nowhere
I, [2015-04-24T11:04:54.133318 #8666]  INFO -- default-precise32:     +            info("Removing dangling link $link");
I, [2015-04-24T11:04:54.140241 #8666]  INFO -- default-precise32:     +            unlink($link) or die "Could not remove $link\n";
I, [2015-04-24T11:04:54.144114 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:54.144933 #8666]  INFO -- default-precise32:     +        return 'missing';
I, [2015-04-24T11:04:54.147512 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.149548 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.151270 #8666]  INFO -- default-precise32:     +    if ( -e $link && !-l $link ) {
I, [2015-04-24T11:04:54.153173 #8666]  INFO -- default-precise32:     +        return "$link is a real file, not touching it";
I, [2015-04-24T11:04:54.154625 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.156765 #8666]  INFO -- default-precise32:     +    if ( realpath($link) ne realpath($tgt) ) {
I, [2015-04-24T11:04:54.158576 #8666]  INFO -- default-precise32:     +        return "$link exists but does not point to $tgt, not touching it";
I, [2015-04-24T11:04:54.160739 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.162502 #8666]  INFO -- default-precise32:     +    return 'ok';
I, [2015-04-24T11:04:54.164352 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:54.165575 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.167718 #8666]  INFO -- default-precise32:     +sub remove_link {
I, [2015-04-24T11:04:54.169528 #8666]  INFO -- default-precise32:     +    my ($link) = @_;
I, [2015-04-24T11:04:54.173550 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.173812 #8666]  INFO -- default-precise32:     +    if ( -l $link ) {
I, [2015-04-24T11:04:54.175075 #8666]  INFO -- default-precise32:     +        unlink($link) or die "Could not remove $link: $!\n";
I, [2015-04-24T11:04:54.177178 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.179117 #8666]  INFO -- default-precise32:     +    elsif ( -e $link ) {
I, [2015-04-24T11:04:54.181186 #8666]  INFO -- default-precise32:     +        error("$link is not a symbolic link, not deleting\n");
I, [2015-04-24T11:04:54.182984 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:54.184580 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.186441 #8666]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:04:54.188464 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:54.190519 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:54.192125 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.193567 #8666]  INFO -- default-precise32:     +sub threaded {
I, [2015-04-24T11:04:54.195300 #8666]  INFO -- default-precise32:     +    my $result = "";
I, [2015-04-24T11:04:54.197020 #8666]  INFO -- default-precise32:     +    $result = qx{/usr/sbin/apache2ctl -V | grep 'threaded'}
I, [2015-04-24T11:04:54.198602 #8666]  INFO -- default-precise32:     +        if -x '/usr/sbin/apache2ctl';
I, [2015-04-24T11:04:54.202573 #8666]  INFO -- default-precise32:     +    if ( $? != 0 ) {
I, [2015-04-24T11:04:54.202866 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.204456 #8666]  INFO -- default-precise32:     +        # config doesn't work
I, [2015-04-24T11:04:54.206348 #8666]  INFO -- default-precise32:     +        if ( -e "$enabldir/mpm_prefork.load" || -e "$enabldir/mpm_itk.load" )
I, [2015-04-24T11:04:54.208198 #8666]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:04:54.210157 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:54.211978 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:54.213910 #8666]  INFO -- default-precise32:     +        elsif (-e "$enabldir/mpm_worker.load"
I, [2015-04-24T11:04:54.215857 #8666]  INFO -- default-precise32:     +            || -e "$enabldir/mpm_event.load" )
I, [2015-04-24T11:04:54.218817 #8666]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:04:54.220804 #8666]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:04:54.222502 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:54.224682 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:54.226500 #8666]  INFO -- default-precise32:     +            error("Can't determine enabled MPM");
I, [2015-04-24T11:04:54.228308 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.231244 #8666]  INFO -- default-precise32:     +            # do what user requested
I, [2015-04-24T11:04:54.232439 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:54.234529 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:54.236897 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.238945 #8666]  INFO -- default-precise32:     +    if ( $result =~ / no/ ) {
I, [2015-04-24T11:04:54.241202 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:54.243123 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.245113 #8666]  INFO -- default-precise32:     +    elsif ( $result =~ / yes/ ) {
I, [2015-04-24T11:04:54.246920 #8666]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:04:54.248891 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.250366 #8666]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:04:54.252784 #8666]  INFO -- default-precise32:     +        die("Can't parse output from apache2ctl -V:\n$result\n");
I, [2015-04-24T11:04:54.254405 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.256455 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:54.257975 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.261668 #8666]  INFO -- default-precise32:     +sub info {
I, [2015-04-24T11:04:54.261891 #8666]  INFO -- default-precise32:     +    print @_ if !$quiet;
I, [2015-04-24T11:04:54.263538 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:54.265118 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.267144 #8666]  INFO -- default-precise32:     +sub error {
I, [2015-04-24T11:04:54.269405 #8666]  INFO -- default-precise32:     +    print STDERR 'ERROR: ', @_;
I, [2015-04-24T11:04:54.271469 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:54.273490 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.275460 #8666]  INFO -- default-precise32:     +sub warning {
I, [2015-04-24T11:04:54.277791 #8666]  INFO -- default-precise32:     +    print STDERR 'WARNING: ', @_;
I, [2015-04-24T11:04:54.279519 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:54.281713 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.283728 #8666]  INFO -- default-precise32:     +sub is_in {
I, [2015-04-24T11:04:54.285770 #8666]  INFO -- default-precise32:     +    my $needle = shift;
I, [2015-04-24T11:04:54.287824 #8666]  INFO -- default-precise32:     +    foreach my $e (@_) {
I, [2015-04-24T11:04:54.291356 #8666]  INFO -- default-precise32:     +        return 1 if $needle eq $e;
I, [2015-04-24T11:04:54.291874 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.293916 #8666]  INFO -- default-precise32:     +    return 0;
I, [2015-04-24T11:04:54.295496 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:54.297310 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.299288 #8666]  INFO -- default-precise32:     +sub read_env_file {
I, [2015-04-24T11:04:54.301617 #8666]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:04:54.302923 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.305056 #8666]  INFO -- default-precise32:     +    -r $file or return;
I, [2015-04-24T11:04:54.306609 #8666]  INFO -- default-precise32:     +    my @lines = qx{env - sh -c '. $file && env'};
I, [2015-04-24T11:04:54.309036 #8666]  INFO -- default-precise32:     +    if ($?) {
I, [2015-04-24T11:04:54.311013 #8666]  INFO -- default-precise32:     +        die "Could not read $file\n";
I, [2015-04-24T11:04:54.313455 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.314830 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.316891 #8666]  INFO -- default-precise32:     +    foreach my $l (@lines) {
I, [2015-04-24T11:04:54.320673 #8666]  INFO -- default-precise32:     +        chomp $l;
I, [2015-04-24T11:04:54.321046 #8666]  INFO -- default-precise32:     +        $l =~ /^(.*)?=(.*)$/ or die "Could not parse $file\n";
I, [2015-04-24T11:04:54.323225 #8666]  INFO -- default-precise32:     +        $ENV{$1} = $2;
I, [2015-04-24T11:04:54.325169 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.326813 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:54.329103 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.331031 #8666]  INFO -- default-precise32:     +sub switch_marker {
I, [2015-04-24T11:04:54.333128 #8666]  INFO -- default-precise32:     +    die('usage: switch_marker([module|site|conf], [enable|disable], $name)')
I, [2015-04-24T11:04:54.334996 #8666]  INFO -- default-precise32:     +        if @_ != 3;
I, [2015-04-24T11:04:54.336971 #8666]  INFO -- default-precise32:     +    my $which = shift;
I, [2015-04-24T11:04:54.338560 #8666]  INFO -- default-precise32:     +    my $what  = shift;
I, [2015-04-24T11:04:54.341497 #8666]  INFO -- default-precise32:     +    my $name  = shift;
I, [2015-04-24T11:04:54.342255 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.344040 #8666]  INFO -- default-precise32:     +    my $mode = "admin";
I, [2015-04-24T11:04:54.346457 #8666]  INFO -- default-precise32:     +    $mode = "maint" if $maintmode;
I, [2015-04-24T11:04:54.350359 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.350606 #8666]  INFO -- default-precise32:     +    #print("switch_marker $which $what $name\n");
I, [2015-04-24T11:04:54.352293 #8666]  INFO -- default-precise32:     +    # TODO: get rid of the magic string(s)
I, [2015-04-24T11:04:54.359758 #8666]  INFO -- default-precise32:     +    my $state_marker_dir = "$statedir/$what" . "d" . "_by_$mode";
I, [2015-04-24T11:04:54.361161 #8666]  INFO -- default-precise32:     +    my $state_marker     = "$state_marker_dir/$name";
I, [2015-04-24T11:04:54.363174 #8666]  INFO -- default-precise32:     +    if ( !-d $state_marker_dir ) {
I, [2015-04-24T11:04:54.365154 #8666]  INFO -- default-precise32:     +        File::Path::mkpath("$state_marker_dir")
I, [2015-04-24T11:04:54.367019 #8666]  INFO -- default-precise32:     +            || error(
I, [2015-04-24T11:04:54.369292 #8666]  INFO -- default-precise32:     +            "Failed to create marker directory: '$state_marker_dir'\n");
I, [2015-04-24T11:04:54.371255 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.372844 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.375235 #8666]  INFO -- default-precise32:     +    # XXX: swap find with perl alternative
I, [2015-04-24T11:04:54.379700 #8666]  INFO -- default-precise32:     +    my @markers = qx{find "$statedir" -type f -a -name "$name"};
I, [2015-04-24T11:04:54.379973 #8666]  INFO -- default-precise32:     +    chomp(@markers);
I, [2015-04-24T11:04:54.382092 #8666]  INFO -- default-precise32:     +    foreach (@markers) {
I, [2015-04-24T11:04:54.384166 #8666]  INFO -- default-precise32:     +        unless ( unlink $_ ) {
I, [2015-04-24T11:04:54.387121 #8666]  INFO -- default-precise32:     +            error("Failed to remove old marker '$_'!\n") && return 0;
I, [2015-04-24T11:04:54.389447 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:54.391465 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.393719 #8666]  INFO -- default-precise32:     +    unless ($purge) {
I, [2015-04-24T11:04:54.396150 #8666]  INFO -- default-precise32:     +        qx{touch "$state_marker"};
I, [2015-04-24T11:04:54.398226 #8666]  INFO -- default-precise32:     +        if ( $? != 0 ) {
I, [2015-04-24T11:04:54.400737 #8666]  INFO -- default-precise32:     +            error("Failed to create marker '$state_marker'!\n") && return 0;
I, [2015-04-24T11:04:54.402793 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:54.405138 #8666]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:04:54.408876 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:54.409846 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:54.411873 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.418301 #8666]  INFO -- default-precise32:     +# vim: syntax=perl sw=4 sts=4 sr et
I, [2015-04-24T11:04:54.420904 #8666]  INFO -- default-precise32:     - change mode from '' to '0700'
I, [2015-04-24T11:04:54.422998 #8666]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:04:54.426355 #8666]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:04:54.430244 #8666]  INFO -- default-precise32:   * link[/usr/sbin/a2enmod] action delete (skipped due to only_if)
I, [2015-04-24T11:04:54.467078 #8666]  INFO -- default-precise32:   * template[/usr/sbin/a2enmod] action create
I, [2015-04-24T11:04:54.469492 #8666]  INFO -- default-precise32:     - update content in file /usr/sbin/a2enmod from 549dfe to ce53f4
I, [2015-04-24T11:04:54.473009 #8666]  INFO -- default-precise32:     --- /usr/sbin/a2enmod	2012-02-07 04:16:57.000000000 +0000
I, [2015-04-24T11:04:54.476293 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-nt7d26	2015-04-24 08:04:54.432740208 +0000
I, [2015-04-24T11:04:54.479406 #8666]  INFO -- default-precise32:     @@ -2,23 +2,31 @@
I, [2015-04-24T11:04:54.480854 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:54.482905 #8666]  INFO -- default-precise32:      # a2enmod by Stefan Fritsch <sf@debian.org>
I, [2015-04-24T11:04:54.484978 #8666]  INFO -- default-precise32:      # Licensed under Apache License 2.0
I, [2015-04-24T11:04:54.487045 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:54.489131 #8666]  INFO -- default-precise32:     +# The coding style is "perltidy -pbp"
I, [2015-04-24T11:04:54.491154 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.495815 #8666]  INFO -- default-precise32:      use strict;
I, [2015-04-24T11:04:54.496104 #8666]  INFO -- default-precise32:      use Cwd 'realpath';
I, [2015-04-24T11:04:54.498243 #8666]  INFO -- default-precise32:      use File::Spec;
I, [2015-04-24T11:04:54.500168 #8666]  INFO -- default-precise32:      use File::Basename;
I, [2015-04-24T11:04:54.502332 #8666]  INFO -- default-precise32:     +use File::Path;
I, [2015-04-24T11:04:54.504380 #8666]  INFO -- default-precise32:      use Getopt::Long;
I, [2015-04-24T11:04:54.506459 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.508469 #8666]  INFO -- default-precise32:      my $quiet;
I, [2015-04-24T11:04:54.510531 #8666]  INFO -- default-precise32:      my $force;
I, [2015-04-24T11:04:54.512206 #8666]  INFO -- default-precise32: +my $maintmode;
I, [2015-04-24T11:04:54.513864 #8666]  INFO -- default-precise32:     +my $purge;
I, [2015-04-24T11:04:54.514689 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:54.516767 #8666]  INFO -- default-precise32:      Getopt::Long::Configure('bundling');
I, [2015-04-24T11:04:54.518817 #8666]  INFO -- default-precise32:      GetOptions(
I, [2015-04-24T11:04:54.521286 #8666]  INFO -- default-precise32:     -    'quiet|q' => \$quiet,
I, [2015-04-24T11:04:54.522917 #8666]  INFO -- default-precise32:     -    'force|f' => \$force
I, [2015-04-24T11:04:54.525544 #8666]  INFO -- default-precise32:     +    'quiet|q'     => \$quiet,
I, [2015-04-24T11:04:54.527815 #8666]  INFO -- default-precise32:     +    'force|f'     => \$force,
I, [2015-04-24T11:04:54.527858 #8666]  INFO -- default-precise32:     +    'maintmode|m' => \$maintmode,
I, [2015-04-24T11:04:54.529462 #8666]  INFO -- default-precise32:     +    'purge|p'     => \$purge
I, [2015-04-24T11:04:54.531439 #8666]  INFO -- default-precise32:      ) or exit 2;
I, [2015-04-24T11:04:54.533461 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.535774 #8666]  INFO -- default-precise32:      my $basename = basename($0);
I, [2015-04-24T11:04:54.537814 #8666]  INFO -- default-precise32:     -$basename =~ /^a2(en|dis)(mod|site)((?:-.+)?)$/
I, [2015-04-24T11:04:54.539859 #8666]  INFO -- default-precise32:     +$basename =~ /^a2(en|dis)(mod|site|conf)((?:-.+)?)$/
I, [2015-04-24T11:04:54.542358 #8666]  INFO -- default-precise32:   or die "$basename call name unknown\n";
I, [2015-04-24T11:04:54.544319 #8666]  INFO -- default-precise32:      my $act        = $1;
I, [2015-04-24T11:04:54.546424 #8666]  INFO -- default-precise32:      my $obj        = $2;
I, [2015-04-24T11:04:54.548535 #8666]  INFO -- default-precise32:     @@ -30,7 +38,7 @@
I, [2015-04-24T11:04:54.550628 #8666]  INFO -- default-precise32:   ? "$ENV{APACHE_CONFDIR}/envvars"
I, [2015-04-24T11:04:54.552169 #8666]  INFO -- default-precise32:   : "/etc/apache2$dir_suffix/envvars"
I, [2015-04-24T11:04:54.555227 #8666]  INFO -- default-precise32:   );
I, [2015-04-24T11:04:54.556759 #8666]  INFO -- default-precise32:     -$ENV{LANG}='C';
I, [2015-04-24T11:04:54.558850 #8666]  INFO -- default-precise32:     +$ENV{LANG} = 'C';
I, [2015-04-24T11:04:54.561311 #8666]  INFO -- default-precise32:      read_env_file($env_file);
I, [2015-04-24T11:04:54.563401 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.565433 #8666]  INFO -- default-precise32:      $act .= 'able';
I, [2015-04-24T11:04:54.567432 #8666]  INFO -- default-precise32:     @@ -41,17 +49,27 @@
I, [2015-04-24T11:04:54.569435 #8666]  INFO -- default-precise32:   $sffx   = '.load';
I, [2015-04-24T11:04:54.571448 #8666]  INFO -- default-precise32:   $reload = 'restart';
I, [2015-04-24T11:04:54.573772 #8666]  INFO -- default-precise32:      }
I, [2015-04-24T11:04:54.575794 #8666]  INFO -- default-precise32:     +elsif ( $obj eq 'conf' ) {
I, [2015-04-24T11:04:54.578260 #8666]  INFO -- default-precise32:     +    $obj    = 'conf';
I, [2015-04-24T11:04:54.580744 #8666]  INFO -- default-precise32:     +    $dir    = 'conf';
I, [2015-04-24T11:04:54.582428 #8666]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:04:54.586112 #8666]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:04:54.586161 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:54.586183 #8666]  INFO -- default-precise32:      else {
I, [2015-04-24T11:04:54.587356 #8666]  INFO -- default-precise32:   $dir    = 'sites';
I, [2015-04-24T11:04:54.589830 #8666]  INFO -- default-precise32:     -    $sffx   = '';
I, [2015-04-24T11:04:54.591465 #8666]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:04:54.593944 #8666]  INFO -- default-precise32:   $reload = 'reload';
I, [2015-04-24T11:04:54.595961 #8666]  INFO -- default-precise32:      }
I, [2015-04-24T11:04:54.598075 #8666]  INFO -- default-precise32:      $name = ucfirst($obj);
I, [2015-04-24T11:04:54.599306 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.600125 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:54.601808 #8666]  INFO -- default-precise32:     -my $availdir = $ENV{ uc("APACHE_${dir}_AVAILABLE") } || "$confdir/$dir-available";
I, [2015-04-24T11:04:54.603881 #8666]  INFO -- default-precise32:     -my $enabldir = $ENV{ uc("APACHE_${dir}_ENABLED") }   || "$confdir/$dir-enabled";
I, [2015-04-24T11:04:54.605929 #8666]  INFO -- default-precise32:     +my $confdir = $ENV{APACHE_CONFDIR} || "/etc/apache2$dir_suffix";
I, [2015-04-24T11:04:54.608392 #8666]  INFO -- default-precise32:     +my $availdir = $ENV{ uc("APACHE_${dir}_AVAILABLE") }
I, [2015-04-24T11:04:54.610077 #8666]  INFO -- default-precise32:     +    || "$confdir/$dir-available";
I, [2015-04-24T11:04:54.614478 #8666]  INFO -- default-precise32:     +my $enabldir = $ENV{ uc("APACHE_${dir}_ENABLED") } || "$confdir/$dir-enabled";
I, [2015-04-24T11:04:54.614709 #8666]  INFO -- default-precise32:     +my $statedir = $ENV{ uc("APACHE_STATE_DIRECTORY") } || "/usr/lib/apache2";
I, [2015-04-24T11:04:54.617137 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.618492 #8666]  INFO -- default-precise32:     +$statedir .= "/$obj";
I, [2015-04-24T11:04:54.623247 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.623499 #8666]  INFO -- default-precise32:      my $choicedir = $act eq 'enable' ? $availdir : $enabldir;
I, [2015-04-24T11:04:54.623891 #8666]  INFO -- default-precise32:      my $linkdir = File::Spec->abs2rel( $availdir, $enabldir );
I, [2015-04-24T11:04:54.626450 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.627492 #8666]  INFO -- default-precise32:     @@ -70,6 +88,7 @@
I, [2015-04-24T11:04:54.629443 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.630524 #8666]  INFO -- default-precise32:      my @objs;
I, [2015-04-24T11:04:54.633216 #8666]  INFO -- default-precise32:      foreach my $arg (@ARGV) {
I, [2015-04-24T11:04:54.635038 #8666]  INFO -- default-precise32:     +    $arg =~ s/${sffx}$//;
I, [2015-04-24T11:04:54.637127 #8666]  INFO -- default-precise32:   my @glob = myglob($arg);
I, [2015-04-24T11:04:54.638604 #8666]  INFO -- default-precise32:   if ( !@glob ) {
I, [2015-04-24T11:04:54.640805 #8666]  INFO -- default-precise32:       error("No $obj found matching $arg!\n");
I, [2015-04-24T11:04:54.642538 #8666]  INFO -- default-precise32:     @@ -84,8 +103,9 @@
I, [2015-04-24T11:04:54.645200 #8666]  INFO -- default-precise32:   doit($acton) or $rc = 1;
I, [2015-04-24T11:04:54.647577 #8666]  INFO -- default-precise32:      }
I, [2015-04-24T11:04:54.649528 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.653064 #8666]  INFO -- default-precise32:     -info("To activate the new configuration, you need to run:\n  service apache2 $reload\n")
I, [2015-04-24T11:04:54.655395 #8666]  INFO -- default-precise32:     -    if $request_reload;
I, [2015-04-24T11:04:54.658229 #8666]  INFO -- default-precise32:     +info(
I, [2015-04-24T11:04:54.660924 #8666]  INFO -- default-precise32:     +    "To activate the new configuration, you need to run:\n  service apache2 $reload\n"
I, [2015-04-24T11:04:54.663559 #8666]  INFO -- default-precise32:     +) if $request_reload;
I, [2015-04-24T11:04:54.665168 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.667178 #8666]  INFO -- default-precise32:      exit($rc);
I, [2015-04-24T11:04:54.669213 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.671641 #8666]  INFO -- default-precise32:     @@ -97,29 +117,20 @@
I, [2015-04-24T11:04:54.673487 #8666]  INFO -- default-precise32:   my @glob = map {
I, [2015-04-24T11:04:54.675855 #8666]  INFO -- default-precise32:       s{^$choicedir/}{};
I, [2015-04-24T11:04:54.678145 #8666]  INFO -- default-precise32:       s{$sffx$}{};
I, [2015-04-24T11:04:54.680426 #8666]  INFO -- default-precise32:     -        s{^000-default$}{default};
I, [2015-04-24T11:04:54.682189 #8666]  INFO -- default-precise32:       $_
I, [2015-04-24T11:04:54.683909 #8666]  INFO -- default-precise32:   } glob("$choicedir/$arg$sffx");
I, [2015-04-24T11:04:54.686268 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.688276 #8666]  INFO -- default-precise32:     -    # use same rules as apache's Include directive
I, [2015-04-24T11:04:54.690446 #8666]  INFO -- default-precise32:     -    @glob = grep( /^[[:alnum:]][-._[:alnum:]]*$/, @glob );
I, [2015-04-24T11:04:54.693483 #8666]  INFO -- default-precise32:     -    @glob = grep( !/\.dpkg/, @glob );
I, [2015-04-24T11:04:54.694538 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:04:54.696904 #8666]  INFO -- default-precise32:   return @glob;
I, [2015-04-24T11:04:54.699352 #8666]  INFO -- default-precise32:      }
I, [2015-04-24T11:04:54.701138 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.703192 #8666]  INFO -- default-precise32:      sub doit {
I, [2015-04-24T11:04:54.705604 #8666]  INFO -- default-precise32:   my $acton = shift;
I, [2015-04-24T11:04:54.707599 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.710111 #8666]  INFO -- default-precise32:     -    my $prio = "";
I, [2015-04-24T11:04:54.712298 #8666]  INFO -- default-precise32:     -    if ( $obj eq 'site' && $acton eq 'default' ) {
I, [2015-04-24T11:04:54.714246 #8666]  INFO -- default-precise32:     -        $prio = '000-';
I, [2015-04-24T11:04:54.716455 #8666]  INFO -- default-precise32:     -    }
I, [2015-04-24T11:04:54.718188 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:04:54.721191 #8666]  INFO -- default-precise32:   my ( $conftgt, $conflink );
I, [2015-04-24T11:04:54.723282 #8666]  INFO -- default-precise32:   if ( $obj eq 'module' ) {
I, [2015-04-24T11:04:54.732312 #8666]  INFO -- default-precise32:       if ( $acton eq 'cgi' && threaded() ) {
I, [2015-04-24T11:04:54.732577 #8666]  INFO -- default-precise32:     -            print "Your MPM seems to be threaded. Selecting cgid instead of cgi.\n";
I, [2015-04-24T11:04:54.733040 #8666]  INFO -- default-precise32:     +            print
I, [2015-04-24T11:04:54.735119 #8666]  INFO -- default-precise32:     +                "Your MPM seems to be threaded. Selecting cgid instead of cgi.\n";
I, [2015-04-24T11:04:54.737949 #8666]  INFO -- default-precise32:           $acton = 'cgid';
I, [2015-04-24T11:04:54.741224 #8666]  INFO -- default-precise32:       }
I, [2015-04-24T11:04:54.743139 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.745888 #8666]  INFO -- default-precise32:     @@ -130,20 +141,35 @@
I, [2015-04-24T11:04:54.748841 #8666]  INFO -- default-precise32:   }
I, [2015-04-24T11:04:54.751002 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.753799 #8666]  INFO -- default-precise32:   my $tgt  = "$availdir/$acton$sffx";
I, [2015-04-24T11:04:54.756309 #8666]  INFO -- default-precise32:     -    my $link = "$enabldir/$prio$acton$sffx";
I, [2015-04-24T11:04:54.759335 #8666]  INFO -- default-precise32:     +    my $link = "$enabldir/$acton$sffx";
I, [2015-04-24T11:04:54.762066 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.764956 #8666]  INFO -- default-precise32:   if ( !-e $tgt ) {
I, [2015-04-24T11:04:54.767316 #8666]  INFO -- default-precise32:       if ( -l $link && !-e $link ) {
I, [2015-04-24T11:04:54.772106 #8666]  INFO -- default-precise32:     -		if ( $act eq 'disable' ) {
I, [2015-04-24T11:04:54.777908 #8666]  INFO -- default-precise32:     -			info("removing dangling symlink $link\n");
I, [2015-04-24T11:04:54.783742 #8666]  INFO -- default-precise32:     -			unlink($link);
I, [2015-04-24T11:04:54.790185 #8666]  INFO -- default-precise32:     -			return 1;
I, [2015-04-24T11:04:54.795398 #8666]  INFO -- default-precise32:     -		}
I, [2015-04-24T11:04:54.800406 #8666]  INFO -- default-precise32:     -		else {
I, [2015-04-24T11:04:54.805630 #8666]  INFO -- default-precise32:     -			error("$link is a dangling symlink!\n");
I, [2015-04-24T11:04:54.810287 #8666]  INFO -- default-precise32:     -		}
I, [2015-04-24T11:04:54.814340 #8666]  INFO -- default-precise32:     -	}
I, [2015-04-24T11:04:54.817034 #8666]  INFO -- default-precise32:     +            if ( $act eq 'disable' ) {
I, [2015-04-24T11:04:54.820171 #8666]  INFO -- default-precise32:     +                info("removing dangling symlink $link\n");
I, [2015-04-24T11:04:54.823495 #8666]  INFO -- default-precise32:     +                unlink($link);
I, [2015-04-24T11:04:54.825900 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:54.828407 #8666]  INFO -- default-precise32:     +                # force a .conf path. It may exist as dangling link, too
I, [2015-04-24T11:04:54.831552 #8666]  INFO -- default-precise32:     +                $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:04:54.839184 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.842169 #8666]  INFO -- default-precise32:     +                if ( -l $conflink && !-e $conflink ) {
I, [2015-04-24T11:04:54.845785 #8666]  INFO -- default-precise32:     +                    info("removing dangling symlink $conflink\n");
I, [2015-04-24T11:04:54.848614 #8666]  INFO -- default-precise32:     +                    unlink($conflink);
I, [2015-04-24T11:04:54.851223 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:54.854147 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.857210 #8666]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:04:54.860673 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:54.863858 #8666]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:04:54.866565 #8666]  INFO -- default-precise32:     +                error("$link is a dangling symlink!\n");
I, [2015-04-24T11:04:54.869122 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:54.871337 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:54.873914 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.876791 #8666]  INFO -- default-precise32:     +        if ( $purge ) {
I, [2015-04-24T11:04:54.879095 #8666]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:54.882194 #8666]  INFO -- default-precise32:     +            # exit silently, we are purging anyway
I, [2015-04-24T11:04:54.885187 #8666]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:04:54.888615 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:54.892102 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.895512 #8666]  INFO -- default-precise32:       error("$name $acton does not exist!\n");
I, [2015-04-24T11:04:54.898578 #8666]  INFO -- default-precise32:       return 0;
I, [2015-04-24T11:04:54.901929 #8666]  INFO -- default-precise32:   }
I, [2015-04-24T11:04:54.905059 #8666]  INFO -- default-precise32:     @@ -151,28 +177,44 @@
I, [2015-04-24T11:04:54.908181 #8666]  INFO -- default-precise32:   # handle module dependencies
I, [2015-04-24T11:04:54.912886 #8666]  INFO -- default-precise32:   if ( $obj eq 'module' ) {
I, [2015-04-24T11:04:54.915269 #8666]  INFO -- default-precise32:       if ( $act eq 'enable' ) {
I, [2015-04-24T11:04:54.917864 #8666]  INFO -- default-precise32:     -            my $depends = qx{grep "# Depends:" "$availdir/$acton.load"|cut -f2 -d:};
I, [2015-04-24T11:04:54.919939 #8666]  INFO -- default-precise32:     -            $depends =~ s,^[\s\n]+,,;
I, [2015-04-24T11:04:54.922733 #8666]  INFO -- default-precise32:     -            $depends =~ s,[\s\n]+$,,;
I, [2015-04-24T11:04:54.926065 #8666]  INFO -- default-precise32:     -            do_deps( $acton, split( /[\n\s]+/, $depends ) ) or return 0;
I, [2015-04-24T11:04:54.927983 #8666]  INFO -- default-precise32: +            if ( $acton eq 'mpm_itk' ) {
I, [2015-04-24T11:04:54.930205 #8666]  INFO -- default-precise32: +                warning(  "MPM_ITK is a third party module that is not part "
I, [2015-04-24T11:04:54.931104 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:54.933792 #8666]  INFO -- default-precise32:     +                        . "testing than the official MPM modules." );
I, [2015-04-24T11:04:54.936180 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:54.938737 #8666]  INFO -- default-precise32:     +            my @depends = get_deps("$availdir/$acton.load");
I, [2015-04-24T11:04:54.942178 #8666]  INFO -- default-precise32:     +            do_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:04:54.944645 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:54.947021 #8666]  INFO -- default-precise32:     +            my @conflicts = get_deps( "$availdir/$acton.load", "Conflicts" );
I, [2015-04-24T11:04:54.949343 #8666]  INFO -- default-precise32:     +            check_conflicts( $acton, @conflicts ) or return 0;
I, [2015-04-24T11:04:54.952581 #8666]  INFO -- default-precise32:       }
I, [2015-04-24T11:04:54.955502 #8666]  INFO -- default-precise32:       else {
I, [2015-04-24T11:04:54.958073 #8666]  INFO -- default-precise32:     -            my @depends = qx{egrep "# Depends:.*${acton}( |\$)" $enabldir/*.load};
I, [2015-04-24T11:04:54.960340 #8666]  INFO -- default-precise32:     -            @depends = grep {s{^.*?/([^/]*?)\.load:.*}{$1}s} @depends;
I, [2015-04-24T11:04:54.962857 #8666]  INFO -- default-precise32:     -            if ( scalar @depends ) {
I, [2015-04-24T11:04:54.965671 #8666]  INFO -- default-precise32:     +            my @depending;
I, [2015-04-24T11:04:54.968517 #8666]  INFO -- default-precise32:     +            foreach my $d ( glob("$enabldir/*.load") ) {
I, [2015-04-24T11:04:54.971196 #8666]  INFO -- default-precise32:     +                my @deps = get_deps($d);
I, [2015-04-24T11:04:54.973938 #8666]  INFO -- default-precise32:     +                if ( is_in( $acton, @deps ) ) {
I, [2015-04-24T11:04:54.976432 #8666]  INFO -- default-precise32:     +                    $d =~ m,/([^/]+).load$,;
I, [2015-04-24T11:04:54.978979 #8666]  INFO -- default-precise32:     +                    push @depending, $1;
I, [2015-04-24T11:04:54.981589 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:54.984705 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:54.987434 #8666]  INFO -- default-precise32:     +            if ( scalar @depending ) {
I, [2015-04-24T11:04:54.990138 #8666]  INFO -- default-precise32:               if ($force) {
I, [2015-04-24T11:04:54.993175 #8666]  INFO -- default-precise32:     -                    do_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:04:54.996739 #8666]  INFO -- default-precise32:     +                    do_deps( $acton, @depending ) or return 0;
I, [2015-04-24T11:04:54.999906 #8666]  INFO -- default-precise32:               }
I, [2015-04-24T11:04:55.002605 #8666]  INFO -- default-precise32:               else {
I, [2015-04-24T11:04:55.004968 #8666]  INFO -- default-precise32:                   error(
I, [2015-04-24T11:04:55.007433 #8666]  INFO -- default-precise32:                       "The following modules depend on $acton ",
I, [2015-04-24T11:04:55.010072 #8666]  INFO -- default-precise32:     -                        "and need to be disabled first: @depends\n"
I, [2015-04-24T11:04:55.012806 #8666]  INFO -- default-precise32:     +                        "and need to be disabled first: @depending\n"
I, [2015-04-24T11:04:55.015165 #8666]  INFO -- default-precise32:                   );
I, [2015-04-24T11:04:55.018191 #8666]  INFO -- default-precise32:                   return 0;
I, [2015-04-24T11:04:55.020969 #8666]  INFO -- default-precise32:               }
I, [2015-04-24T11:04:55.023536 #8666]  INFO -- default-precise32:           }
I, [2015-04-24T11:04:55.026454 #8666]  INFO -- default-precise32:       }
I, [2015-04-24T11:04:55.029371 #8666]  INFO -- default-precise32:   }
I, [2015-04-24T11:04:55.032442 #8666]  INFO -- default-precise32:     +    elsif ( $act eq 'enable' ) {
I, [2015-04-24T11:04:55.034877 #8666]  INFO -- default-precise32:     +        my @depends = get_deps("$availdir/$acton$sffx");
I, [2015-04-24T11:04:55.037652 #8666]  INFO -- default-precise32:     +        warn_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:04:55.039907 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:55.042320 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:55.045189 #8666]  INFO -- default-precise32:   if ( $act eq 'enable' ) {
I, [2015-04-24T11:04:55.047929 #8666]  INFO -- default-precise32:       my $check = check_link( $tgt, $link );
I, [2015-04-24T11:04:55.050657 #8666]  INFO -- default-precise32:     @@ -190,7 +232,9 @@
I, [2015-04-24T11:04:55.053387 #8666]  INFO -- default-precise32:                   add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:04:55.056184 #8666]  INFO -- default-precise32:               }
I, [2015-04-24T11:04:55.058895 #8666]  INFO -- default-precise32:               else {
I, [2015-04-24T11:04:55.063379 #8666]  INFO -- default-precise32:     -                    error("Config file $acton.conf not properly enabled: $confcheck\n");
I, [2015-04-24T11:04:55.069622 #8666]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:04:55.072183 #8666]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:04:55.075040 #8666]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:04:55.077237 #8666]  INFO -- default-precise32:                   return 0;
I, [2015-04-24T11:04:55.079206 #8666]  INFO -- default-precise32:               }
I, [2015-04-24T11:04:55.081642 #8666]  INFO -- default-precise32:           }
I, [2015-04-24T11:04:55.084103 #8666]  INFO -- default-precise32:     @@ -208,17 +252,21 @@
I, [2015-04-24T11:04:55.086321 #8666]  INFO -- default-precise32:                   add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:04:55.089017 #8666]  INFO -- default-precise32:               }
I, [2015-04-24T11:04:55.091199 #8666]  INFO -- default-precise32:               elsif ( $confcheck ne 'ok' ) {
I, [2015-04-24T11:04:55.093900 #8666]  INFO -- default-precise32:     -                    error("Config file $acton.conf not properly enabled: $confcheck\n");
I, [2015-04-24T11:04:55.096584 #8666]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:04:55.098849 #8666]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:04:55.101094 #8666]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:04:55.103543 #8666]  INFO -- default-precise32:                   return 0;
I, [2015-04-24T11:04:55.105988 #8666]  INFO -- default-precise32:               }
I, [2015-04-24T11:04:55.108324 #8666]  INFO -- default-precise32:           }
I, [2015-04-24T11:04:55.110315 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:55.112887 #8666]  INFO -- default-precise32:           print "Enabling $obj $acton.\n";
I, [2015-04-24T11:04:55.115215 #8666]  INFO -- default-precise32:           if ( $acton eq 'ssl' ) {
I, [2015-04-24T11:04:55.117795 #8666]  INFO -- default-precise32:     -                info("See /usr/share/doc/apache2.2-common/README.Debian.gz on " .
I, [2015-04-24T11:04:55.120926 #8666]  INFO -- default-precise32:     -                     "how to configure SSL and create self-signed certificates.\n");
I, [2015-04-24T11:04:55.124841 #8666]  INFO -- default-precise32:     -	    }
I, [2015-04-24T11:04:55.127039 #8666]  INFO -- default-precise32:     -            return add_link( $tgt, $link );
I, [2015-04-24T11:04:55.129576 #8666]  INFO -- default-precise32:     +                info(     "See /usr/share/doc/apache2/README.Debian.gz on "
I, [2015-04-24T11:04:55.131581 #8666]  INFO -- default-precise32:     +                        . "how to configure SSL and create self-signed certificates.\n"
I, [2015-04-24T11:04:55.134170 #8666]  INFO -- default-precise32:     +                );
I, [2015-04-24T11:04:55.136652 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:55.138878 #8666]  INFO -- default-precise32:     +            return add_link( $tgt, $link )
I, [2015-04-24T11:04:55.141115 #8666]  INFO -- default-precise32:     +                && switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:55.143189 #8666]  INFO -- default-precise32:       }
I, [2015-04-24T11:04:55.145137 #8666]  INFO -- default-precise32:       else {
I, [2015-04-24T11:04:55.148210 #8666]  INFO -- default-precise32:           error("$name $acton not properly enabled: $check\n");
I, [2015-04-24T11:04:55.150623 #8666]  INFO -- default-precise32:     @@ -231,6 +279,7 @@
I, [2015-04-24T11:04:55.153386 #8666]  INFO -- default-precise32:           if ( $conflink && -e $conflink ) {
I, [2015-04-24T11:04:55.156189 #8666]  INFO -- default-precise32:               remove_link($conflink);
I, [2015-04-24T11:04:55.158487 #8666]  INFO -- default-precise32:           }
I, [2015-04-24T11:04:55.161185 #8666]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:55.163360 #8666]  INFO -- default-precise32:           print "$name $acton disabled.\n";
I, [2015-04-24T11:04:55.165857 #8666]  INFO -- default-precise32:       }
I, [2015-04-24T11:04:55.167991 #8666]  INFO -- default-precise32:       elsif ( $conflink && -e $conflink ) {
I, [2015-04-24T11:04:55.170554 #8666]  INFO -- default-precise32:     @@ -239,6 +288,9 @@
I, [2015-04-24T11:04:55.172979 #8666]  INFO -- default-precise32:       }
I, [2015-04-24T11:04:55.175183 #8666]  INFO -- default-precise32:       else {
I, [2015-04-24T11:04:55.177855 #8666]  INFO -- default-precise32:           info("$name $acton already disabled\n");
I, [2015-04-24T11:04:55.180173 #8666]  INFO -- default-precise32:     +            if ( $purge ) {
I, [2015-04-24T11:04:55.182847 #8666]  INFO -- default-precise32:     +                switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:55.185332 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:55.187457 #8666]  INFO -- default-precise32:           return 1;
I, [2015-04-24T11:04:55.190071 #8666]  INFO -- default-precise32:       }
I, [2015-04-24T11:04:55.192647 #8666]  INFO -- default-precise32:   }
I, [2015-04-24T11:04:55.194803 #8666]  INFO -- default-precise32:     @@ -246,6 +298,29 @@
I, [2015-04-24T11:04:55.197438 #8666]  INFO -- default-precise32:   return 1;
I, [2015-04-24T11:04:55.200203 #8666]  INFO -- default-precise32:      }
I, [2015-04-24T11:04:55.202213 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:55.204280 #8666]  INFO -- default-precise32:     +sub get_deps {
I, [2015-04-24T11:04:55.206826 #8666]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:04:55.209193 #8666]  INFO -- default-precise32:     +    my $type = shift || "Depends";
I, [2015-04-24T11:04:55.211296 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.213474 #8666]  INFO -- default-precise32:     +    my $fd;
I, [2015-04-24T11:04:55.216492 #8666]  INFO -- default-precise32:     +    if ( !open( $fd, '<', $file ) ) {
I, [2015-04-24T11:04:55.218923 #8666]  INFO -- default-precise32:     +        error("Can't open $file: $!");
I, [2015-04-24T11:04:55.221651 #8666]  INFO -- default-precise32:     +        return;
I, [2015-04-24T11:04:55.224167 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:55.226336 #8666]  INFO -- default-precise32:     +    my $line;
I, [2015-04-24T11:04:55.229061 #8666]  INFO -- default-precise32:     +    while ( defined( $line = <$fd> ) ) {
I, [2015-04-24T11:04:55.231170 #8666]  INFO -- default-precise32:     +        chomp $line;
I, [2015-04-24T11:04:55.233702 #8666]  INFO -- default-precise32:     +        if ( $line =~ /^# $type:\s+(.*?)\s*$/ ) {
I, [2015-04-24T11:04:55.235783 #8666]  INFO -- default-precise32:     +            my $deps = $1;
I, [2015-04-24T11:04:55.238532 #8666]  INFO -- default-precise32:     +            return split( /[\n\s]+/, $deps );
I, [2015-04-24T11:04:55.241192 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:55.243151 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.245379 #8666]  INFO -- default-precise32:     +        # only check until the first non-empty non-comment line
I, [2015-04-24T11:04:55.248026 #8666]  INFO -- default-precise32:     +        last if ( $line !~ /^\s*(?:#.*)?$/ );
I, [2015-04-24T11:04:55.250071 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:55.252476 #8666]  INFO -- default-precise32:     +    return;
I, [2015-04-24T11:04:55.254288 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:55.256241 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.258612 #8666]  INFO -- default-precise32:      sub do_deps {
I, [2015-04-24T11:04:55.260752 #8666]  INFO -- default-precise32:   my $acton = shift;
I, [2015-04-24T11:04:55.262384 #8666]  INFO -- default-precise32:   foreach my $d (@_) {
I, [2015-04-24T11:04:55.264687 #8666]  INFO -- default-precise32:     @@ -258,6 +333,48 @@
I, [2015-04-24T11:04:55.267170 #8666]  INFO -- default-precise32:   return 1;
I, [2015-04-24T11:04:55.269793 #8666]  INFO -- default-precise32:      }
I, [2015-04-24T11:04:55.271468 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:55.274091 #8666]  INFO -- default-precise32:     +sub warn_deps {
I, [2015-04-24T11:04:55.276162 #8666]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:04:55.278762 #8666]  INFO -- default-precise32:     +    my $modsenabldir = $ENV{APACHE_MODS_ENABLED} || "$confdir/mods-enabled";
I, [2015-04-24T11:04:55.281320 #8666]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:04:55.283988 #8666]  INFO -- default-precise32:     +        info("Checking dependency $d for $acton:\n");
I, [2015-04-24T11:04:55.286388 #8666]  INFO -- default-precise32:     +        if ( !-e "$modsenabldir/$d.load" ) {
I, [2015-04-24T11:04:55.288947 #8666]  INFO -- default-precise32:     +            warning(
I, [2015-04-24T11:04:55.291290 #8666]  INFO -- default-precise32:     +                "Module $d is not enabled, but $acton depends on it, aborting\n"
I, [2015-04-24T11:04:55.293540 #8666]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:04:55.295885 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:55.298370 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:55.301172 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:55.303772 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:55.306324 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:55.308839 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.311013 #8666]  INFO -- default-precise32:     +sub check_conflicts {
I, [2015-04-24T11:04:55.313734 #8666]  INFO -- default-precise32:     +    my $acton    = shift;
I, [2015-04-24T11:04:55.316507 #8666]  INFO -- default-precise32:     +    my $haderror = 0;
I, [2015-04-24T11:04:55.318957 #8666]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:04:55.321328 #8666]  INFO -- default-precise32:     +        info("Considering conflict $d for $acton:\n");
I, [2015-04-24T11:04:55.323721 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.326095 #8666]  INFO -- default-precise32:     +        my $tgt  = "$availdir/$d$sffx";
I, [2015-04-24T11:04:55.329159 #8666]  INFO -- default-precise32:     +        my $link = "$enabldir/$d$sffx";
I, [2015-04-24T11:04:55.330697 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.333063 #8666]  INFO -- default-precise32:     +        my $confcheck = check_link( $tgt, $link );
I, [2015-04-24T11:04:55.335313 #8666]  INFO -- default-precise32:     +        if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:04:55.337782 #8666]  INFO -- default-precise32:     +            error(
I, [2015-04-24T11:04:55.340432 #8666]  INFO -- default-precise32:     +                "Module $d is enabled - cannot proceed due to conflicts. It needs to be disabled first!\n"
I, [2015-04-24T11:04:55.342472 #8666]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:04:55.345106 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.347864 #8666]  INFO -- default-precise32:     +            # Don't return immediately, there could be several conflicts
I, [2015-04-24T11:04:55.350329 #8666]  INFO -- default-precise32:     +            $haderror++;
I, [2015-04-24T11:04:55.353172 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:55.355353 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:55.357935 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.360427 #8666]  INFO -- default-precise32:     +    if ($haderror) {
I, [2015-04-24T11:04:55.362927 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:55.366194 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:55.367457 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.369436 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:55.372074 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:55.374298 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.377051 #8666]  INFO -- default-precise32:      sub add_link {
I, [2015-04-24T11:04:55.379759 #8666]  INFO -- default-precise32:   my ( $tgt, $link ) = @_;
I, [2015-04-24T11:04:55.382136 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:55.385382 #8666]  INFO -- default-precise32:     @@ -307,13 +424,36 @@
I, [2015-04-24T11:04:55.387800 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:55.390178 #8666]  INFO -- default-precise32:      sub threaded {
I, [2015-04-24T11:04:55.393023 #8666]  INFO -- default-precise32:   my $result = "";
I, [2015-04-24T11:04:55.395187 #8666]  INFO -- default-precise32:     -    $result = qx{/usr/sbin/apache2 -V | grep 'threaded'} if -x '/usr/sbin/apache2';
I, [2015-04-24T11:04:55.397353 #8666]  INFO -- default-precise32:     +    $result = qx{/usr/sbin/apache2ctl -V | grep 'threaded'}
I, [2015-04-24T11:04:55.400074 #8666]  INFO -- default-precise32:     +        if -x '/usr/sbin/apache2ctl';
I, [2015-04-24T11:04:55.402369 #8666]  INFO -- default-precise32:     +    if ( $? != 0 ) {
I, [2015-04-24T11:04:55.404909 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.406907 #8666]  INFO -- default-precise32:     +        # config doesn't work
I, [2015-04-24T11:04:55.408977 #8666]  INFO -- default-precise32:     +        if ( -e "$enabldir/mpm_prefork.load" || -e "$enabldir/mpm_itk.load" )
I, [2015-04-24T11:04:55.410863 #8666]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:04:55.413042 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:55.415202 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:55.417751 #8666]  INFO -- default-precise32:     +        elsif (-e "$enabldir/mpm_worker.load"
I, [2015-04-24T11:04:55.420104 #8666]  INFO -- default-precise32:     +            || -e "$enabldir/mpm_event.load" )
I, [2015-04-24T11:04:55.422664 #8666]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:04:55.424833 #8666]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:04:55.426941 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:55.428976 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:55.431218 #8666]  INFO -- default-precise32:     +            error("Can't determine enabled MPM");
I, [2015-04-24T11:04:55.433194 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.435050 #8666]  INFO -- default-precise32:     +            # do what user requested
I, [2015-04-24T11:04:55.437616 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:55.439540 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:55.441863 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:55.444421 #8666]  INFO -- default-precise32:   if ( $result =~ / no/ ) {
I, [2015-04-24T11:04:55.446544 #8666]  INFO -- default-precise32:       return 0;
I, [2015-04-24T11:04:55.448883 #8666]  INFO -- default-precise32:   }
I, [2015-04-24T11:04:55.450748 #8666]  INFO -- default-precise32:     -    else {
I, [2015-04-24T11:04:55.452888 #8666]  INFO -- default-precise32:     +    elsif ( $result =~ / yes/ ) {
I, [2015-04-24T11:04:55.454872 #8666]  INFO -- default-precise32:       return 1;
I, [2015-04-24T11:04:55.456904 #8666]  INFO -- default-precise32:   }
I, [2015-04-24T11:04:55.458731 #8666]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:04:55.460742 #8666]  INFO -- default-precise32:     +        die("Can't parse output from apache2ctl -V:\n$result\n");
I, [2015-04-24T11:04:55.462385 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:55.464946 #8666]  INFO -- default-precise32:      }
I, [2015-04-24T11:04:55.466402 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:55.468903 #8666]  INFO -- default-precise32:      sub info {
I, [2015-04-24T11:04:55.470815 #8666]  INFO -- default-precise32:     @@ -324,6 +464,18 @@
I, [2015-04-24T11:04:55.473084 #8666]  INFO -- default-precise32:   print STDERR 'ERROR: ', @_;
I, [2015-04-24T11:04:55.475636 #8666]  INFO -- default-precise32:      }
I, [2015-04-24T11:04:55.477965 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:55.480584 #8666]  INFO -- default-precise32:     +sub warning {
I, [2015-04-24T11:04:55.483177 #8666]  INFO -- default-precise32:     +    print STDERR 'WARNING: ', @_;
I, [2015-04-24T11:04:55.486186 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:55.488478 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.490733 #8666]  INFO -- default-precise32:     +sub is_in {
I, [2015-04-24T11:04:55.493098 #8666]  INFO -- default-precise32:     +    my $needle = shift;
I, [2015-04-24T11:04:55.495174 #8666]  INFO -- default-precise32:     +    foreach my $e (@_) {
I, [2015-04-24T11:04:55.497799 #8666]  INFO -- default-precise32:     +        return 1 if $needle eq $e;
I, [2015-04-24T11:04:55.499996 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:55.502430 #8666]  INFO -- default-precise32:     +    return 0;
I, [2015-04-24T11:04:55.505401 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:55.508067 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.510368 #8666]  INFO -- default-precise32:      sub read_env_file {
I, [2015-04-24T11:04:55.513230 #8666]  INFO -- default-precise32:   my $file = shift;
I, [2015-04-24T11:04:55.515191 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:55.517649 #8666]  INFO -- default-precise32:     @@ -339,4 +491,43 @@
I, [2015-04-24T11:04:55.520059 #8666]  INFO -- default-precise32:       $ENV{$1} = $2;
I, [2015-04-24T11:04:55.522184 #8666]  INFO -- default-precise32:   }
I, [2015-04-24T11:04:55.525194 #8666]  INFO -- default-precise32:      }
I, [2015-04-24T11:04:55.527065 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.529584 #8666]  INFO -- default-precise32:     +sub switch_marker {
I, [2015-04-24T11:04:55.531433 #8666]  INFO -- default-precise32:     +    die('usage: switch_marker([module|site|conf], [enable|disable], $name)')
I, [2015-04-24T11:04:55.547361 #8666]  INFO -- default-precise32:     +        if @_ != 3;
I, [2015-04-24T11:04:55.547434 #8666]  INFO -- default-precise32:     +    my $which = shift;
I, [2015-04-24T11:04:55.547456 #8666]  INFO -- default-precise32:     +    my $what  = shift;
I, [2015-04-24T11:04:55.547476 #8666]  INFO -- default-precise32:     +    my $name  = shift;
I, [2015-04-24T11:04:55.547494 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.547513 #8666]  INFO -- default-precise32:     +    my $mode = "admin";
I, [2015-04-24T11:04:55.547532 #8666]  INFO -- default-precise32:     +    $mode = "maint" if $maintmode;
I, [2015-04-24T11:04:55.547551 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.547570 #8666]  INFO -- default-precise32:     +    #print("switch_marker $which $what $name\n");
I, [2015-04-24T11:04:55.547589 #8666]  INFO -- default-precise32:     +    # TODO: get rid of the magic string(s)
I, [2015-04-24T11:04:55.548105 #8666]  INFO -- default-precise32: +    my $state_marker_dir = "$statedir/$what" . "d" . "_by_$mode";
I, [2015-04-24T11:04:55.550055 #8666]  INFO -- default-precise32:     +    my $state_marker     = "$state_marker_dir/$name";
I, [2015-04-24T11:04:55.551920 #8666]  INFO -- default-precise32:     +    if ( !-d $state_marker_dir ) {
I, [2015-04-24T11:04:55.554019 #8666]  INFO -- default-precise32:     +        File::Path::mkpath("$state_marker_dir")
I, [2015-04-24T11:04:55.555719 #8666]  INFO -- default-precise32:     +            || error(
I, [2015-04-24T11:04:55.557923 #8666]  INFO -- default-precise32:     +            "Failed to create marker directory: '$state_marker_dir'\n");
I, [2015-04-24T11:04:55.560318 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:55.561794 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.564094 #8666]  INFO -- default-precise32:     +    # XXX: swap find with perl alternative
I, [2015-04-24T11:04:55.567069 #8666]  INFO -- default-precise32:     +    my @markers = qx{find "$statedir" -type f -a -name "$name"};
I, [2015-04-24T11:04:55.569998 #8666]  INFO -- default-precise32:     +    chomp(@markers);
I, [2015-04-24T11:04:55.572580 #8666]  INFO -- default-precise32:     +    foreach (@markers) {
I, [2015-04-24T11:04:55.574900 #8666]  INFO -- default-precise32:     +        unless ( unlink $_ ) {
I, [2015-04-24T11:04:55.577319 #8666]  INFO -- default-precise32:     +            error("Failed to remove old marker '$_'!\n") && return 0;
I, [2015-04-24T11:04:55.579486 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:55.582063 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:55.584509 #8666]  INFO -- default-precise32:     +    unless ($purge) {
I, [2015-04-24T11:04:55.586523 #8666]  INFO -- default-precise32:     +        qx{touch "$state_marker"};
I, [2015-04-24T11:04:55.589433 #8666]  INFO -- default-precise32:     +        if ( $? != 0 ) {
I, [2015-04-24T11:04:55.591693 #8666]  INFO -- default-precise32:     +            error("Failed to create marker '$state_marker'!\n") && return 0;
I, [2015-04-24T11:04:55.594182 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:55.596862 #8666]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:04:55.599218 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:55.602207 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:55.604178 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.618233 #8666]  INFO -- default-precise32:     +# vim: syntax=perl sw=4 sts=4 sr et
I, [2015-04-24T11:04:55.623266 #8666]  INFO -- default-precise32:     - change mode from '0755' to '0700'
I, [2015-04-24T11:04:55.627201 #8666]  INFO -- default-precise32:   * link[/usr/sbin/a2dismod] action delete
I, [2015-04-24T11:04:55.630224 #8666]  INFO -- default-precise32:     - delete link at /usr/sbin/a2dismod
I, [2015-04-24T11:04:55.638356 #8666]  INFO -- default-precise32:   * template[/usr/sbin/a2dismod] action create
I, [2015-04-24T11:04:55.654375 #8666]  INFO -- default-precise32:     - create new file /usr/sbin/a2dismod
I, [2015-04-24T11:04:55.656213 #8666]  INFO -- default-precise32:     - update content in file /usr/sbin/a2dismod from none to ce53f4
I, [2015-04-24T11:04:55.659368 #8666]  INFO -- default-precise32:     --- /usr/sbin/a2dismod	2015-04-24 08:04:55.632725121 +0000
I, [2015-04-24T11:04:55.663242 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-1ow9x4v	2015-04-24 08:04:55.628725172 +0000
I, [2015-04-24T11:04:55.664799 #8666]  INFO -- default-precise32:     @@ -1 +1,533 @@
I, [2015-04-24T11:04:55.667122 #8666]  INFO -- default-precise32:     +#!/usr/bin/perl -w
I, [2015-04-24T11:04:55.669269 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:55.670415 #8666]  INFO -- default-precise32:     +# a2enmod by Stefan Fritsch <sf@debian.org>
I, [2015-04-24T11:04:55.673206 #8666]  INFO -- default-precise32:     +# Licensed under Apache License 2.0
I, [2015-04-24T11:04:55.675295 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:55.677291 #8666]  INFO -- default-precise32:     +# The coding style is "perltidy -pbp"
I, [2015-04-24T11:04:55.679215 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.681044 #8666]  INFO -- default-precise32:     +use strict;
I, [2015-04-24T11:04:55.683372 #8666]  INFO -- default-precise32:     +use Cwd 'realpath';
I, [2015-04-24T11:04:55.685554 #8666]  INFO -- default-precise32:     +use File::Spec;
I, [2015-04-24T11:04:55.687528 #8666]  INFO -- default-precise32:     +use File::Basename;
I, [2015-04-24T11:04:55.690099 #8666]  INFO -- default-precise32:     +use File::Path;
I, [2015-04-24T11:04:55.692209 #8666]  INFO -- default-precise32:     +use Getopt::Long;
I, [2015-04-24T11:04:55.694307 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.696228 #8666]  INFO -- default-precise32:     +my $quiet;
I, [2015-04-24T11:04:55.698314 #8666]  INFO -- default-precise32:     +my $force;
I, [2015-04-24T11:04:55.700219 #8666]  INFO -- default-precise32:     +my $maintmode;
I, [2015-04-24T11:04:55.702232 #8666]  INFO -- default-precise32:     +my $purge;
I, [2015-04-24T11:04:55.704199 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.706225 #8666]  INFO -- default-precise32:     +Getopt::Long::Configure('bundling');
I, [2015-04-24T11:04:55.708222 #8666]  INFO -- default-precise32:     +GetOptions(
I, [2015-04-24T11:04:55.710236 #8666]  INFO -- default-precise32:     +    'quiet|q'     => \$quiet,
I, [2015-04-24T11:04:55.712207 #8666]  INFO -- default-precise32:     +    'force|f'     => \$force,
I, [2015-04-24T11:04:55.714236 #8666]  INFO -- default-precise32:     +    'maintmode|m' => \$maintmode,
I, [2015-04-24T11:04:55.716209 #8666]  INFO -- default-precise32:     +    'purge|p'     => \$purge
I, [2015-04-24T11:04:55.718202 #8666]  INFO -- default-precise32:     +) or exit 2;
I, [2015-04-24T11:04:55.718231 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.721235 #8666]  INFO -- default-precise32:     +my $basename = basename($0);
I, [2015-04-24T11:04:55.722204 #8666]  INFO -- default-precise32: +$basename =~ /^a2(en|dis)(mod|site|conf)((?:-.+)?)$/
I, [2015-04-24T11:04:55.723267 #8666]  INFO -- default-precise32: +    or die "$basename call name unknown\n";
I, [2015-04-24T11:04:55.725274 #8666]  INFO -- default-precise32:     +my $act        = $1;
I, [2015-04-24T11:04:55.727040 #8666]  INFO -- default-precise32: +my $obj        = $2;
I, [2015-04-24T11:04:55.728093 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:55.728200 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:55.730334 #8666]  INFO -- default-precise32:     +my $env_file = $ENV{APACHE_ENVVARS}
I, [2015-04-24T11:04:55.732175 #8666]  INFO -- default-precise32:     +    || (
I, [2015-04-24T11:04:55.733395 #8666]  INFO -- default-precise32: +    $ENV{APACHE_CONFDIR}
I, [2015-04-24T11:04:55.736772 #8666]  INFO -- default-precise32:     +    ? "$ENV{APACHE_CONFDIR}/envvars"
I, [2015-04-24T11:04:55.743528 #8666]  INFO -- default-precise32:     +    : "/etc/apache2$dir_suffix/envvars"
I, [2015-04-24T11:04:55.744208 #8666]  INFO -- default-precise32:     +    );
I, [2015-04-24T11:04:55.747752 #8666]  INFO -- default-precise32:     +$ENV{LANG} = 'C';
I, [2015-04-24T11:04:55.751233 #8666]  INFO -- default-precise32:     +read_env_file($env_file);
I, [2015-04-24T11:04:55.754514 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.758178 #8666]  INFO -- default-precise32:     +$act .= 'able';
I, [2015-04-24T11:04:55.761382 #8666]  INFO -- default-precise32:     +my ( $name, $dir, $sffx, $reload );
I, [2015-04-24T11:04:55.764836 #8666]  INFO -- default-precise32:     +if ( $obj eq 'mod' ) {
I, [2015-04-24T11:04:55.768716 #8666]  INFO -- default-precise32:     +    $obj    = 'module';
I, [2015-04-24T11:04:55.772784 #8666]  INFO -- default-precise32:     +    $dir    = 'mods';
I, [2015-04-24T11:04:55.776811 #8666]  INFO -- default-precise32:     +    $sffx   = '.load';
I, [2015-04-24T11:04:55.780900 #8666]  INFO -- default-precise32:     +    $reload = 'restart';
I, [2015-04-24T11:04:55.784834 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:55.788788 #8666]  INFO -- default-precise32:     +elsif ( $obj eq 'conf' ) {
I, [2015-04-24T11:04:55.792585 #8666]  INFO -- default-precise32:     +    $obj    = 'conf';
I, [2015-04-24T11:04:55.796583 #8666]  INFO -- default-precise32:     +    $dir    = 'conf';
I, [2015-04-24T11:04:55.801247 #8666]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:04:55.812740 #8666]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:04:55.816570 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:55.826671 #8666]  INFO -- default-precise32:     +else {
I, [2015-04-24T11:04:55.830676 #8666]  INFO -- default-precise32:     +    $dir    = 'sites';
I, [2015-04-24T11:04:55.835576 #8666]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:04:55.847357 #8666]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:04:55.851171 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:55.855125 #8666]  INFO -- default-precise32:     +$name = ucfirst($obj);
I, [2015-04-24T11:04:55.866016 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.870180 #8666]  INFO -- default-precise32:     +my $confdir = $ENV{APACHE_CONFDIR} || "/etc/apache2$dir_suffix";
I, [2015-04-24T11:04:55.879625 #8666]  INFO -- default-precise32:     +my $availdir = $ENV{ uc("APACHE_${dir}_AVAILABLE") }
I, [2015-04-24T11:04:55.883714 #8666]  INFO -- default-precise32:     +    || "$confdir/$dir-available";
I, [2015-04-24T11:04:55.887495 #8666]  INFO -- default-precise32:     +my $enabldir = $ENV{ uc("APACHE_${dir}_ENABLED") } || "$confdir/$dir-enabled";
I, [2015-04-24T11:04:55.891505 #8666]  INFO -- default-precise32:     +my $statedir = $ENV{ uc("APACHE_STATE_DIRECTORY") } || "/usr/lib/apache2";
I, [2015-04-24T11:04:55.903462 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.907184 #8666]  INFO -- default-precise32:     +$statedir .= "/$obj";
I, [2015-04-24T11:04:55.910879 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.915103 #8666]  INFO -- default-precise32:     +my $choicedir = $act eq 'enable' ? $availdir : $enabldir;
I, [2015-04-24T11:04:55.925529 #8666]  INFO -- default-precise32:     +my $linkdir = File::Spec->abs2rel( $availdir, $enabldir );
I, [2015-04-24T11:04:55.929748 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.934117 #8666]  INFO -- default-precise32:     +my $request_reload = 0;
I, [2015-04-24T11:04:55.946100 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.950024 #8666]  INFO -- default-precise32:     +my $rc = 0;
I, [2015-04-24T11:04:55.954398 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.958193 #8666]  INFO -- default-precise32:     +if ( !scalar @ARGV ) {
I, [2015-04-24T11:04:55.969302 #8666]  INFO -- default-precise32:     +    my @choices = myglob('*');
I, [2015-04-24T11:04:55.978091 #8666]  INFO -- default-precise32:     +    print "Your choices are: @choices\n";
I, [2015-04-24T11:04:55.980279 #8666]  INFO -- default-precise32:     +    print "Which ${obj}(s) do you want to $act (wildcards ok)?\n";
I, [2015-04-24T11:04:55.983083 #8666]  INFO -- default-precise32:     +    my $input = <>;
I, [2015-04-24T11:04:55.986172 #8666]  INFO -- default-precise32:     +    @ARGV = split /\s+/, $input;
I, [2015-04-24T11:04:55.988425 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.991236 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:55.993222 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:55.995752 #8666]  INFO -- default-precise32:     +my @objs;
I, [2015-04-24T11:04:55.998242 #8666]  INFO -- default-precise32:     +foreach my $arg (@ARGV) {
I, [2015-04-24T11:04:56.000744 #8666]  INFO -- default-precise32:     +    $arg =~ s/${sffx}$//;
I, [2015-04-24T11:04:56.002979 #8666]  INFO -- default-precise32:     +    my @glob = myglob($arg);
I, [2015-04-24T11:04:56.005242 #8666]  INFO -- default-precise32:     +    if ( !@glob ) {
I, [2015-04-24T11:04:56.007345 #8666]  INFO -- default-precise32:     +        error("No $obj found matching $arg!\n");
I, [2015-04-24T11:04:56.009969 #8666]  INFO -- default-precise32:     +        $rc = 1;
I, [2015-04-24T11:04:56.012644 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.014986 #8666]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:04:56.017322 #8666]  INFO -- default-precise32:     +        push @objs, @glob;
I, [2015-04-24T11:04:56.019703 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.022191 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:56.024368 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.027039 #8666]  INFO -- default-precise32:     +foreach my $acton (@objs) {
I, [2015-04-24T11:04:56.030142 #8666]  INFO -- default-precise32:     +    doit($acton) or $rc = 1;
I, [2015-04-24T11:04:56.033190 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:56.034889 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.037769 #8666]  INFO -- default-precise32:     +info(
I, [2015-04-24T11:04:56.040183 #8666]  INFO -- default-precise32:     +    "To activate the new configuration, you need to run:\n  service apache2 $reload\n"
I, [2015-04-24T11:04:56.042336 #8666]  INFO -- default-precise32:     +) if $request_reload;
I, [2015-04-24T11:04:56.044979 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.047162 #8666]  INFO -- default-precise32:     +exit($rc);
I, [2015-04-24T11:04:56.049244 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.051345 #8666]  INFO -- default-precise32:     +##############################################################################
I, [2015-04-24T11:04:56.053458 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.055908 #8666]  INFO -- default-precise32:     +sub myglob {
I, [2015-04-24T11:04:56.059221 #8666]  INFO -- default-precise32:     +    my $arg = shift;
I, [2015-04-24T11:04:56.060852 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.063146 #8666]  INFO -- default-precise32:     +    my @glob = map {
I, [2015-04-24T11:04:56.065343 #8666]  INFO -- default-precise32:     +        s{^$choicedir/}{};
I, [2015-04-24T11:04:56.067853 #8666]  INFO -- default-precise32:     +        s{$sffx$}{};
I, [2015-04-24T11:04:56.070100 #8666]  INFO -- default-precise32:     +        $_
I, [2015-04-24T11:04:56.072928 #8666]  INFO -- default-precise32:     +    } glob("$choicedir/$arg$sffx");
I, [2015-04-24T11:04:56.074961 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.077226 #8666]  INFO -- default-precise32:     +    return @glob;
I, [2015-04-24T11:04:56.079319 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:56.081191 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.082943 #8666]  INFO -- default-precise32:     +sub doit {
I, [2015-04-24T11:04:56.085309 #8666]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:04:56.086757 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.088990 #8666]  INFO -- default-precise32:     +    my ( $conftgt, $conflink );
I, [2015-04-24T11:04:56.090857 #8666]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:04:56.093160 #8666]  INFO -- default-precise32:     +        if ( $acton eq 'cgi' && threaded() ) {
I, [2015-04-24T11:04:56.095029 #8666]  INFO -- default-precise32:     +            print
I, [2015-04-24T11:04:56.097194 #8666]  INFO -- default-precise32:     +                "Your MPM seems to be threaded. Selecting cgid instead of cgi.\n";
I, [2015-04-24T11:04:56.100412 #8666]  INFO -- default-precise32:     +            $acton = 'cgid';
I, [2015-04-24T11:04:56.102233 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.103812 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.105867 #8666]  INFO -- default-precise32:     +        $conftgt = "$availdir/$acton.conf";
I, [2015-04-24T11:04:56.107874 #8666]  INFO -- default-precise32:     +        if ( -e $conftgt ) {
I, [2015-04-24T11:04:56.109794 #8666]  INFO -- default-precise32:     +            $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:04:56.111754 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.114110 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.115405 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.119285 #8666]  INFO -- default-precise32:     +    my $tgt  = "$availdir/$acton$sffx";
I, [2015-04-24T11:04:56.119319 #8666]  INFO -- default-precise32:     +    my $link = "$enabldir/$acton$sffx";
I, [2015-04-24T11:04:56.119340 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.120212 #8666]  INFO -- default-precise32: +    if ( !-e $tgt ) {
I, [2015-04-24T11:04:56.122190 #8666]  INFO -- default-precise32:     +        if ( -l $link && !-e $link ) {
I, [2015-04-24T11:04:56.124266 #8666]  INFO -- default-precise32:     +            if ( $act eq 'disable' ) {
I, [2015-04-24T11:04:56.126390 #8666]  INFO -- default-precise32:     +                info("removing dangling symlink $link\n");
I, [2015-04-24T11:04:56.132370 #8666]  INFO -- default-precise32:     +                unlink($link);
I, [2015-04-24T11:04:56.132685 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.132926 #8666]  INFO -- default-precise32:     +                # force a .conf path. It may exist as dangling link, too
I, [2015-04-24T11:04:56.135230 #8666]  INFO -- default-precise32:     +                $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:04:56.136828 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.138746 #8666]  INFO -- default-precise32:     +                if ( -l $conflink && !-e $conflink ) {
I, [2015-04-24T11:04:56.140772 #8666]  INFO -- default-precise32:     +                    info("removing dangling symlink $conflink\n");
I, [2015-04-24T11:04:56.142326 #8666]  INFO -- default-precise32:     +                    unlink($conflink);
I, [2015-04-24T11:04:56.145214 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:56.146178 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.148001 #8666]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:04:56.149974 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:56.151808 #8666]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:04:56.154044 #8666]  INFO -- default-precise32:     +                error("$link is a dangling symlink!\n");
I, [2015-04-24T11:04:56.156051 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:56.158207 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.160207 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.162914 #8666]  INFO -- default-precise32:     +        if ( $purge ) {
I, [2015-04-24T11:04:56.165259 #8666]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:56.167363 #8666]  INFO -- default-precise32:     +            # exit silently, we are purging anyway
I, [2015-04-24T11:04:56.169897 #8666]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:04:56.172487 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.174346 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.176844 #8666]  INFO -- default-precise32:     +        error("$name $acton does not exist!\n");
I, [2015-04-24T11:04:56.179164 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:56.182187 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.183917 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.186022 #8666]  INFO -- default-precise32:     +    # handle module dependencies
I, [2015-04-24T11:04:56.188498 #8666]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:04:56.191145 #8666]  INFO -- default-precise32:     +        if ( $act eq 'enable' ) {
I, [2015-04-24T11:04:56.193499 #8666]  INFO -- default-precise32:     +            if ( $acton eq 'mpm_itk' ) {
I, [2015-04-24T11:04:56.196198 #8666]  INFO -- default-precise32:     +                warning(  "MPM_ITK is a third party module that is not part "
I, [2015-04-24T11:04:56.198742 #8666]  INFO -- default-precise32:     +                        . "of the official Apache HTTPD. It has seen less "
I, [2015-04-24T11:04:56.201398 #8666]  INFO -- default-precise32:     +                        . "testing than the official MPM modules." );
I, [2015-04-24T11:04:56.203897 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:56.206294 #8666]  INFO -- default-precise32:     +            my @depends = get_deps("$availdir/$acton.load");
I, [2015-04-24T11:04:56.209188 #8666]  INFO -- default-precise32:     +            do_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:04:56.210224 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.212706 #8666]  INFO -- default-precise32:     +            my @conflicts = get_deps( "$availdir/$acton.load", "Conflicts" );
I, [2015-04-24T11:04:56.215179 #8666]  INFO -- default-precise32:     +            check_conflicts( $acton, @conflicts ) or return 0;
I, [2015-04-24T11:04:56.217113 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.219491 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:56.222396 #8666]  INFO -- default-precise32:     +            my @depending;
I, [2015-04-24T11:04:56.225018 #8666]  INFO -- default-precise32:     +            foreach my $d ( glob("$enabldir/*.load") ) {
I, [2015-04-24T11:04:56.227183 #8666]  INFO -- default-precise32:     +                my @deps = get_deps($d);
I, [2015-04-24T11:04:56.229847 #8666]  INFO -- default-precise32:     +                if ( is_in( $acton, @deps ) ) {
I, [2015-04-24T11:04:56.232205 #8666]  INFO -- default-precise32:     +                    $d =~ m,/([^/]+).load$,;
I, [2015-04-24T11:04:56.234456 #8666]  INFO -- default-precise32:     +                    push @depending, $1;
I, [2015-04-24T11:04:56.237197 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:56.239469 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:56.241959 #8666]  INFO -- default-precise32:     +            if ( scalar @depending ) {
I, [2015-04-24T11:04:56.244233 #8666]  INFO -- default-precise32:     +                if ($force) {
I, [2015-04-24T11:04:56.246620 #8666]  INFO -- default-precise32:     +                    do_deps( $acton, @depending ) or return 0;
I, [2015-04-24T11:04:56.249196 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:56.251733 #8666]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:04:56.254487 #8666]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:04:56.256825 #8666]  INFO -- default-precise32:     +                        "The following modules depend on $acton ",
I, [2015-04-24T11:04:56.259502 #8666]  INFO -- default-precise32:     +                        "and need to be disabled first: @depending\n"
I, [2015-04-24T11:04:56.261811 #8666]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:04:56.264513 #8666]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:04:56.269295 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:56.279638 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:56.280486 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.282896 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.285238 #8666]  INFO -- default-precise32:     +    elsif ( $act eq 'enable' ) {
I, [2015-04-24T11:04:56.287937 #8666]  INFO -- default-precise32:     +        my @depends = get_deps("$availdir/$acton$sffx");
I, [2015-04-24T11:04:56.290511 #8666]  INFO -- default-precise32:     +        warn_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:04:56.293057 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.295101 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.297514 #8666]  INFO -- default-precise32:     +    if ( $act eq 'enable' ) {
I, [2015-04-24T11:04:56.299874 #8666]  INFO -- default-precise32:     +        my $check = check_link( $tgt, $link );
I, [2015-04-24T11:04:56.302596 #8666]  INFO -- default-precise32:     +        if ( $check eq 'ok' ) {
I, [2015-04-24T11:04:56.305182 #8666]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:04:56.309466 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.310035 #8666]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:04:56.312633 #8666]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:04:56.314794 #8666]  INFO -- default-precise32:     +                if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:04:56.317096 #8666]  INFO -- default-precise32:     +                    info("$name $acton already enabled\n");
I, [2015-04-24T11:04:56.319753 #8666]  INFO -- default-precise32:     +                    return 1;
I, [2015-04-24T11:04:56.322474 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:56.324948 #8666]  INFO -- default-precise32:     +                elsif ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:04:56.327227 #8666]  INFO -- default-precise32:     +                    print "Enabling config file $acton.conf.\n";
I, [2015-04-24T11:04:56.329751 #8666]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:04:56.332483 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:56.334790 #8666]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:04:56.337076 #8666]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:04:56.339936 #8666]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:04:56.343015 #8666]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:04:56.345731 #8666]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:04:56.348863 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:56.357608 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:56.361357 #8666]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:04:56.363777 #8666]  INFO -- default-precise32:     +                info("$name $acton already enabled\n");
I, [2015-04-24T11:04:56.366126 #8666]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:04:56.369250 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:56.371688 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.374535 #8666]  INFO -- default-precise32:     +        elsif ( $check eq 'missing' ) {
I, [2015-04-24T11:04:56.377886 #8666]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:04:56.380121 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.382764 #8666]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:04:56.385439 #8666]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:04:56.388831 #8666]  INFO -- default-precise32:     +                if ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:04:56.391316 #8666]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:04:56.394087 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:56.396689 #8666]  INFO -- default-precise32:     +                elsif ( $confcheck ne 'ok' ) {
I, [2015-04-24T11:04:56.399159 #8666]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:04:56.401897 #8666]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:04:56.404583 #8666]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:04:56.407170 #8666]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:04:56.409838 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:56.412688 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:56.415038 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.417881 #8666]  INFO -- default-precise32:     +            print "Enabling $obj $acton.\n";
I, [2015-04-24T11:04:56.421073 #8666]  INFO -- default-precise32:     +            if ( $acton eq 'ssl' ) {
I, [2015-04-24T11:04:56.423933 #8666]  INFO -- default-precise32:     +                info(     "See /usr/share/doc/apache2/README.Debian.gz on "
I, [2015-04-24T11:04:56.426438 #8666]  INFO -- default-precise32:     +                        . "how to configure SSL and create self-signed certificates.\n"
I, [2015-04-24T11:04:56.429760 #8666]  INFO -- default-precise32:     +                );
I, [2015-04-24T11:04:56.432581 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:56.435203 #8666]  INFO -- default-precise32:     +            return add_link( $tgt, $link )
I, [2015-04-24T11:04:56.437955 #8666]  INFO -- default-precise32:     +                && switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:56.440876 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.443508 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:56.446103 #8666]  INFO -- default-precise32:     +            error("$name $acton not properly enabled: $check\n");
I, [2015-04-24T11:04:56.448722 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:56.451528 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.454742 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.458075 #8666]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:04:56.460814 #8666]  INFO -- default-precise32:     +        if ( -e $link || -l $link ) {
I, [2015-04-24T11:04:56.463487 #8666]  INFO -- default-precise32:     +            remove_link($link);
I, [2015-04-24T11:04:56.466500 #8666]  INFO -- default-precise32:     +            if ( $conflink && -e $conflink ) {
I, [2015-04-24T11:04:56.468902 #8666]  INFO -- default-precise32:     +                remove_link($conflink);
I, [2015-04-24T11:04:56.471444 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:56.473832 #8666]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:56.476685 #8666]  INFO -- default-precise32:     +            print "$name $acton disabled.\n";
I, [2015-04-24T11:04:56.479057 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.482108 #8666]  INFO -- default-precise32:     +        elsif ( $conflink && -e $conflink ) {
I, [2015-04-24T11:04:56.485163 #8666]  INFO -- default-precise32:     +            print "Disabling stale config file $acton.conf.\n";
I, [2015-04-24T11:04:56.488465 #8666]  INFO -- default-precise32:     +            remove_link($conflink);
I, [2015-04-24T11:04:56.491396 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.494463 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:56.497047 #8666]  INFO -- default-precise32:     +            info("$name $acton already disabled\n");
I, [2015-04-24T11:04:56.499464 #8666]  INFO -- default-precise32:     +            if ( $purge ) {
I, [2015-04-24T11:04:56.502530 #8666]  INFO -- default-precise32:     +                switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:56.505131 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:56.507814 #8666]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:04:56.510622 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.513181 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.515826 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.518821 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:56.521758 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:56.524608 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.527209 #8666]  INFO -- default-precise32:     +sub get_deps {
I, [2015-04-24T11:04:56.530130 #8666]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:04:56.533131 #8666]  INFO -- default-precise32:     +    my $type = shift || "Depends";
I, [2015-04-24T11:04:56.535188 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.537875 #8666]  INFO -- default-precise32:     +    my $fd;
I, [2015-04-24T11:04:56.539753 #8666]  INFO -- default-precise32: +    if ( !open( $fd, '<', $file ) ) {
I, [2015-04-24T11:04:56.542601 #8666]  INFO -- default-precise32:     +        error("Can't open $file: $!");
I, [2015-04-24T11:04:56.546227 #8666]  INFO -- default-precise32:     +        return;
I, [2015-04-24T11:04:56.547207 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:56.550623 #8666]  INFO -- default-precise32:     +    my $line;
I, [2015-04-24T11:04:56.553501 #8666]  INFO -- default-precise32:     +    while ( defined( $line = <$fd> ) ) {
I, [2015-04-24T11:04:56.556699 #8666]  INFO -- default-precise32:     +        chomp $line;
I, [2015-04-24T11:04:56.559498 #8666]  INFO -- default-precise32:     +        if ( $line =~ /^# $type:\s+(.*?)\s*$/ ) {
I, [2015-04-24T11:04:56.562194 #8666]  INFO -- default-precise32:     +            my $deps = $1;
I, [2015-04-24T11:04:56.565243 #8666]  INFO -- default-precise32:     +            return split( /[\n\s]+/, $deps );
I, [2015-04-24T11:04:56.568127 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.570576 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.573421 #8666]  INFO -- default-precise32:     +        # only check until the first non-empty non-comment line
I, [2015-04-24T11:04:56.576628 #8666]  INFO -- default-precise32:     +        last if ( $line !~ /^\s*(?:#.*)?$/ );
I, [2015-04-24T11:04:56.579130 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.581573 #8666]  INFO -- default-precise32:     +    return;
I, [2015-04-24T11:04:56.585194 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:56.586977 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.590022 #8666]  INFO -- default-precise32:     +sub do_deps {
I, [2015-04-24T11:04:56.590957 #8666]  INFO -- default-precise32: +    my $acton = shift;
I, [2015-04-24T11:04:56.594038 #8666]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:04:56.596300 #8666]  INFO -- default-precise32:     +        info("Considering dependency $d for $acton:\n");
I, [2015-04-24T11:04:56.599384 #8666]  INFO -- default-precise32:     +        if ( !doit($d) ) {
I, [2015-04-24T11:04:56.602193 #8666]  INFO -- default-precise32:     +            error("Could not $act dependency $d for $acton, aborting\n");
I, [2015-04-24T11:04:56.605169 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:56.607537 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.610427 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.613188 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:56.616578 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:56.618961 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.620844 #8666]  INFO -- default-precise32: +sub warn_deps {
I, [2015-04-24T11:04:56.623668 #8666]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:04:56.626428 #8666]  INFO -- default-precise32:     +    my $modsenabldir = $ENV{APACHE_MODS_ENABLED} || "$confdir/mods-enabled";
I, [2015-04-24T11:04:56.629216 #8666]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:04:56.631743 #8666]  INFO -- default-precise32:     +        info("Checking dependency $d for $acton:\n");
I, [2015-04-24T11:04:56.634925 #8666]  INFO -- default-precise32:     +        if ( !-e "$modsenabldir/$d.load" ) {
I, [2015-04-24T11:04:56.637787 #8666]  INFO -- default-precise32:     +            warning(
I, [2015-04-24T11:04:56.640654 #8666]  INFO -- default-precise32:     +                "Module $d is not enabled, but $acton depends on it, aborting\n"
I, [2015-04-24T11:04:56.643122 #8666]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:04:56.645633 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:56.648499 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.650529 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.653230 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:56.655314 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:56.658809 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.661124 #8666]  INFO -- default-precise32:     +sub check_conflicts {
I, [2015-04-24T11:04:56.663855 #8666]  INFO -- default-precise32:     +    my $acton    = shift;
I, [2015-04-24T11:04:56.666076 #8666]  INFO -- default-precise32:     +    my $haderror = 0;
I, [2015-04-24T11:04:56.668465 #8666]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:04:56.671173 #8666]  INFO -- default-precise32:     +        info("Considering conflict $d for $acton:\n");
I, [2015-04-24T11:04:56.672969 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.675182 #8666]  INFO -- default-precise32:     +        my $tgt  = "$availdir/$d$sffx";
I, [2015-04-24T11:04:56.677935 #8666]  INFO -- default-precise32:     +        my $link = "$enabldir/$d$sffx";
I, [2015-04-24T11:04:56.680445 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.682946 #8666]  INFO -- default-precise32:     +        my $confcheck = check_link( $tgt, $link );
I, [2015-04-24T11:04:56.685800 #8666]  INFO -- default-precise32:     +        if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:04:56.688166 #8666]  INFO -- default-precise32:     +            error(
I, [2015-04-24T11:04:56.690317 #8666]  INFO -- default-precise32:     +                "Module $d is enabled - cannot proceed due to conflicts. It needs to be disabled first!\n"
I, [2015-04-24T11:04:56.693190 #8666]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:04:56.695655 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.697876 #8666]  INFO -- default-precise32:     +            # Don't return immediately, there could be several conflicts
I, [2015-04-24T11:04:56.700577 #8666]  INFO -- default-precise32:     +            $haderror++;
I, [2015-04-24T11:04:56.703031 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.705312 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.707310 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.709438 #8666]  INFO -- default-precise32:     +    if ($haderror) {
I, [2015-04-24T11:04:56.712015 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:56.714317 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.716953 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.719538 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:56.723263 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:56.724080 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.726328 #8666]  INFO -- default-precise32:     +sub add_link {
I, [2015-04-24T11:04:56.728189 #8666]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:04:56.730224 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.732075 #8666]  INFO -- default-precise32:     +    # create relative link
I, [2015-04-24T11:04:56.734070 #8666]  INFO -- default-precise32:     +    if ( !symlink( File::Spec->abs2rel( $tgt, dirname($link) ), $link ) ) {
I, [2015-04-24T11:04:56.736069 #8666]  INFO -- default-precise32:     +        die("Could not create $link: $!\n");
I, [2015-04-24T11:04:56.738054 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.740083 #8666]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:04:56.741832 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:56.744815 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:56.746717 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.749268 #8666]  INFO -- default-precise32:     +sub check_link {
I, [2015-04-24T11:04:56.752351 #8666]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:04:56.753862 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.755875 #8666]  INFO -- default-precise32:     +    if ( !-e $link ) {
I, [2015-04-24T11:04:56.757937 #8666]  INFO -- default-precise32:     +        if ( -l $link ) {
I, [2015-04-24T11:04:56.760644 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.763063 #8666]  INFO -- default-precise32:     +            # points to nowhere
I, [2015-04-24T11:04:56.765166 #8666]  INFO -- default-precise32:     +            info("Removing dangling link $link");
I, [2015-04-24T11:04:56.767024 #8666]  INFO -- default-precise32:     +            unlink($link) or die "Could not remove $link\n";
I, [2015-04-24T11:04:56.769536 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.810440 #8666]  INFO -- default-precise32:     +        return 'missing';
I, [2015-04-24T11:04:56.810772 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.810984 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.811203 #8666]  INFO -- default-precise32:     +    if ( -e $link && !-l $link ) {
I, [2015-04-24T11:04:56.811497 #8666]  INFO -- default-precise32:     +        return "$link is a real file, not touching it";
I, [2015-04-24T11:04:56.811747 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.812024 #8666]  INFO -- default-precise32:     +    if ( realpath($link) ne realpath($tgt) ) {
I, [2015-04-24T11:04:56.812250 #8666]  INFO -- default-precise32:     +        return "$link exists but does not point to $tgt, not touching it";
I, [2015-04-24T11:04:56.812506 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.812753 #8666]  INFO -- default-precise32:     +    return 'ok';
I, [2015-04-24T11:04:56.813005 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:56.813212 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.813470 #8666]  INFO -- default-precise32:     +sub remove_link {
I, [2015-04-24T11:04:56.813706 #8666]  INFO -- default-precise32:     +    my ($link) = @_;
I, [2015-04-24T11:04:56.813950 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.814161 #8666]  INFO -- default-precise32:     +    if ( -l $link ) {
I, [2015-04-24T11:04:56.814428 #8666]  INFO -- default-precise32:     +        unlink($link) or die "Could not remove $link: $!\n";
I, [2015-04-24T11:04:56.815760 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.815994 #8666]  INFO -- default-precise32:     +    elsif ( -e $link ) {
I, [2015-04-24T11:04:56.849576 #8666]  INFO -- default-precise32:     +        error("$link is not a symbolic link, not deleting\n");
I, [2015-04-24T11:04:56.849851 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:56.850136 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.850390 #8666]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:04:56.850623 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:56.850847 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:56.851042 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.851359 #8666]  INFO -- default-precise32:     +sub threaded {
I, [2015-04-24T11:04:56.851597 #8666]  INFO -- default-precise32:     +    my $result = "";
I, [2015-04-24T11:04:56.851807 #8666]  INFO -- default-precise32:     +    $result = qx{/usr/sbin/apache2ctl -V | grep 'threaded'}
I, [2015-04-24T11:04:56.852080 #8666]  INFO -- default-precise32:     +        if -x '/usr/sbin/apache2ctl';
I, [2015-04-24T11:04:56.852333 #8666]  INFO -- default-precise32:     +    if ( $? != 0 ) {
I, [2015-04-24T11:04:56.852556 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.852801 #8666]  INFO -- default-precise32:     +        # config doesn't work
I, [2015-04-24T11:04:56.853049 #8666]  INFO -- default-precise32:     +        if ( -e "$enabldir/mpm_prefork.load" || -e "$enabldir/mpm_itk.load" )
I, [2015-04-24T11:04:56.853321 #8666]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:04:56.853509 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:56.853718 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.854004 #8666]  INFO -- default-precise32:     +        elsif (-e "$enabldir/mpm_worker.load"
I, [2015-04-24T11:04:56.890478 #8666]  INFO -- default-precise32:     +            || -e "$enabldir/mpm_event.load" )
I, [2015-04-24T11:04:56.890780 #8666]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:04:56.890990 #8666]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:04:56.891240 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.891498 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:56.891726 #8666]  INFO -- default-precise32:     +            error("Can't determine enabled MPM");
I, [2015-04-24T11:04:56.891933 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.892184 #8666]  INFO -- default-precise32:     +            # do what user requested
I, [2015-04-24T11:04:56.892428 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:56.892611 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:56.892860 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.893064 #8666]  INFO -- default-precise32:     +    if ( $result =~ / no/ ) {
I, [2015-04-24T11:04:56.893308 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:56.893496 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.893747 #8666]  INFO -- default-precise32:     +    elsif ( $result =~ / yes/ ) {
I, [2015-04-24T11:04:56.893937 #8666]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:04:56.894182 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.894419 #8666]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:04:56.894605 #8666]  INFO -- default-precise32:     +        die("Can't parse output from apache2ctl -V:\n$result\n");
I, [2015-04-24T11:04:56.894824 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.929578 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:56.929874 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.930086 #8666]  INFO -- default-precise32:     +sub info {
I, [2015-04-24T11:04:56.930347 #8666]  INFO -- default-precise32:     +    print @_ if !$quiet;
I, [2015-04-24T11:04:56.930626 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:56.930840 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.931033 #8666]  INFO -- default-precise32:     +sub error {
I, [2015-04-24T11:04:56.931357 #8666]  INFO -- default-precise32:     +    print STDERR 'ERROR: ', @_;
I, [2015-04-24T11:04:56.931565 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:56.931791 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.931986 #8666]  INFO -- default-precise32:     +sub warning {
I, [2015-04-24T11:04:56.932295 #8666]  INFO -- default-precise32:     +    print STDERR 'WARNING: ', @_;
I, [2015-04-24T11:04:56.932502 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:56.932699 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.932902 #8666]  INFO -- default-precise32:     +sub is_in {
I, [2015-04-24T11:04:56.933169 #8666]  INFO -- default-precise32:     +    my $needle = shift;
I, [2015-04-24T11:04:56.933433 #8666]  INFO -- default-precise32:     +    foreach my $e (@_) {
I, [2015-04-24T11:04:56.933635 #8666]  INFO -- default-precise32:     +        return 1 if $needle eq $e;
I, [2015-04-24T11:04:56.933855 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.934140 #8666]  INFO -- default-precise32:     +    return 0;
I, [2015-04-24T11:04:56.934406 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:56.934594 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.936192 #8666]  INFO -- default-precise32:     +sub read_env_file {
I, [2015-04-24T11:04:56.938046 #8666]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:04:56.939887 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.942196 #8666]  INFO -- default-precise32:     +    -r $file or return;
I, [2015-04-24T11:04:56.945043 #8666]  INFO -- default-precise32:     +    my @lines = qx{env - sh -c '. $file && env'};
I, [2015-04-24T11:04:56.947220 #8666]  INFO -- default-precise32:     +    if ($?) {
I, [2015-04-24T11:04:56.949898 #8666]  INFO -- default-precise32:     +        die "Could not read $file\n";
I, [2015-04-24T11:04:56.952170 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.954733 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.957462 #8666]  INFO -- default-precise32:     +    foreach my $l (@lines) {
I, [2015-04-24T11:04:56.959943 #8666]  INFO -- default-precise32:     +        chomp $l;
I, [2015-04-24T11:04:56.962351 #8666]  INFO -- default-precise32:     +        $l =~ /^(.*)?=(.*)$/ or die "Could not parse $file\n";
I, [2015-04-24T11:04:56.964864 #8666]  INFO -- default-precise32:     +        $ENV{$1} = $2;
I, [2015-04-24T11:04:56.966963 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:56.969789 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:56.972190 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.974607 #8666]  INFO -- default-precise32:     +sub switch_marker {
I, [2015-04-24T11:04:56.976950 #8666]  INFO -- default-precise32:     +    die('usage: switch_marker([module|site|conf], [enable|disable], $name)')
I, [2015-04-24T11:04:56.979156 #8666]  INFO -- default-precise32:     +        if @_ != 3;
I, [2015-04-24T11:04:56.981330 #8666]  INFO -- default-precise32:     +    my $which = shift;
I, [2015-04-24T11:04:56.983454 #8666]  INFO -- default-precise32:     +    my $what  = shift;
I, [2015-04-24T11:04:56.986181 #8666]  INFO -- default-precise32:     +    my $name  = shift;
I, [2015-04-24T11:04:56.988838 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.991076 #8666]  INFO -- default-precise32:     +    my $mode = "admin";
I, [2015-04-24T11:04:56.994173 #8666]  INFO -- default-precise32:     +    $mode = "maint" if $maintmode;
I, [2015-04-24T11:04:56.995514 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:56.997812 #8666]  INFO -- default-precise32:     +    #print("switch_marker $which $what $name\n");
I, [2015-04-24T11:04:57.000414 #8666]  INFO -- default-precise32:     +    # TODO: get rid of the magic string(s)
I, [2015-04-24T11:04:57.002865 #8666]  INFO -- default-precise32:     +    my $state_marker_dir = "$statedir/$what" . "d" . "_by_$mode";
I, [2015-04-24T11:04:57.005535 #8666]  INFO -- default-precise32:     +    my $state_marker     = "$state_marker_dir/$name";
I, [2015-04-24T11:04:57.007801 #8666]  INFO -- default-precise32:     +    if ( !-d $state_marker_dir ) {
I, [2015-04-24T11:04:57.010333 #8666]  INFO -- default-precise32:     +        File::Path::mkpath("$state_marker_dir")
I, [2015-04-24T11:04:57.012878 #8666]  INFO -- default-precise32:     +            || error(
I, [2015-04-24T11:04:57.015012 #8666]  INFO -- default-precise32:     +            "Failed to create marker directory: '$state_marker_dir'\n");
I, [2015-04-24T11:04:57.018375 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:57.021015 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.023339 #8666]  INFO -- default-precise32:     +    # XXX: swap find with perl alternative
I, [2015-04-24T11:04:57.025830 #8666]  INFO -- default-precise32:     +    my @markers = qx{find "$statedir" -type f -a -name "$name"};
I, [2015-04-24T11:04:57.028679 #8666]  INFO -- default-precise32:     +    chomp(@markers);
I, [2015-04-24T11:04:57.030952 #8666]  INFO -- default-precise32:     +    foreach (@markers) {
I, [2015-04-24T11:04:57.033491 #8666]  INFO -- default-precise32:     +        unless ( unlink $_ ) {
I, [2015-04-24T11:04:57.035845 #8666]  INFO -- default-precise32:     +            error("Failed to remove old marker '$_'!\n") && return 0;
I, [2015-04-24T11:04:57.038935 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:57.041166 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:57.043337 #8666]  INFO -- default-precise32:     +    unless ($purge) {
I, [2015-04-24T11:04:57.045442 #8666]  INFO -- default-precise32:     +        qx{touch "$state_marker"};
I, [2015-04-24T11:04:57.048194 #8666]  INFO -- default-precise32:     +        if ( $? != 0 ) {
I, [2015-04-24T11:04:57.050327 #8666]  INFO -- default-precise32:     +            error("Failed to create marker '$state_marker'!\n") && return 0;
I, [2015-04-24T11:04:57.052837 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:57.055062 #8666]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:04:57.057389 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:57.059509 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:57.061953 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.068887 #8666]  INFO -- default-precise32:     +# vim: syntax=perl sw=4 sts=4 sr et
I, [2015-04-24T11:04:57.071212 #8666]  INFO -- default-precise32:     - change mode from '' to '0700'
I, [2015-04-24T11:04:57.073813 #8666]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:04:57.077201 #8666]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:04:57.081095 #8666]  INFO -- default-precise32:   * link[/usr/sbin/a2enconf] action delete (skipped due to only_if)
I, [2015-04-24T11:04:57.088155 #8666]  INFO -- default-precise32:   * template[/usr/sbin/a2enconf] action create
I, [2015-04-24T11:04:57.101186 #8666]  INFO -- default-precise32:     - create new file /usr/sbin/a2enconf
I, [2015-04-24T11:04:57.103594 #8666]  INFO -- default-precise32:     - update content in file /usr/sbin/a2enconf from none to ce53f4
I, [2015-04-24T11:04:57.107827 #8666]  INFO -- default-precise32:     --- /usr/sbin/a2enconf	2015-04-24 08:04:57.080706917 +0000
I, [2015-04-24T11:04:57.111987 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-1y3zqtk	2015-04-24 08:04:57.080706917 +0000
I, [2015-04-24T11:04:57.114211 #8666]  INFO -- default-precise32:     @@ -1 +1,533 @@
I, [2015-04-24T11:04:57.117171 #8666]  INFO -- default-precise32:     +#!/usr/bin/perl -w
I, [2015-04-24T11:04:57.119176 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:57.121359 #8666]  INFO -- default-precise32:     +# a2enmod by Stefan Fritsch <sf@debian.org>
I, [2015-04-24T11:04:57.123192 #8666]  INFO -- default-precise32:     +# Licensed under Apache License 2.0
I, [2015-04-24T11:04:57.126169 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:57.127778 #8666]  INFO -- default-precise32:     +# The coding style is "perltidy -pbp"
I, [2015-04-24T11:04:57.130389 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.133183 #8666]  INFO -- default-precise32:     +use strict;
I, [2015-04-24T11:04:57.135312 #8666]  INFO -- default-precise32:     +use Cwd 'realpath';
I, [2015-04-24T11:04:57.138198 #8666]  INFO -- default-precise32:     +use File::Spec;
I, [2015-04-24T11:04:57.141167 #8666]  INFO -- default-precise32:     +use File::Basename;
I, [2015-04-24T11:04:57.143192 #8666]  INFO -- default-precise32:     +use File::Path;
I, [2015-04-24T11:04:57.145204 #8666]  INFO -- default-precise32:     +use Getopt::Long;
I, [2015-04-24T11:04:57.147190 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.149328 #8666]  INFO -- default-precise32:     +my $quiet;
I, [2015-04-24T11:04:57.151162 #8666]  INFO -- default-precise32:     +my $force;
I, [2015-04-24T11:04:57.154169 #8666]  INFO -- default-precise32:     +my $maintmode;
I, [2015-04-24T11:04:57.155494 #8666]  INFO -- default-precise32:     +my $purge;
I, [2015-04-24T11:04:57.158166 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.160186 #8666]  INFO -- default-precise32:     +Getopt::Long::Configure('bundling');
I, [2015-04-24T11:04:57.162179 #8666]  INFO -- default-precise32:     +GetOptions(
I, [2015-04-24T11:04:57.165198 #8666]  INFO -- default-precise32:     +    'quiet|q'     => \$quiet,
I, [2015-04-24T11:04:57.167225 #8666]  INFO -- default-precise32:     +    'force|f'     => \$force,
I, [2015-04-24T11:04:57.170215 #8666]  INFO -- default-precise32:     +    'maintmode|m' => \$maintmode,
I, [2015-04-24T11:04:57.172235 #8666]  INFO -- default-precise32:     +    'purge|p'     => \$purge
I, [2015-04-24T11:04:57.175321 #8666]  INFO -- default-precise32:     +) or exit 2;
I, [2015-04-24T11:04:57.176091 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.178222 #8666]  INFO -- default-precise32:     +my $basename = basename($0);
I, [2015-04-24T11:04:57.180224 #8666]  INFO -- default-precise32:     +$basename =~ /^a2(en|dis)(mod|site|conf)((?:-.+)?)$/
I, [2015-04-24T11:04:57.182222 #8666]  INFO -- default-precise32:     +    or die "$basename call name unknown\n";
I, [2015-04-24T11:04:57.183766 #8666]  INFO -- default-precise32:     +my $act        = $1;
I, [2015-04-24T11:04:57.185367 #8666]  INFO -- default-precise32:     +my $obj        = $2;
I, [2015-04-24T11:04:57.187327 #8666]  INFO -- default-precise32:     +my $dir_suffix = $3;
I, [2015-04-24T11:04:57.189339 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.191330 #8666]  INFO -- default-precise32:     +my $env_file = $ENV{APACHE_ENVVARS}
I, [2015-04-24T11:04:57.193319 #8666]  INFO -- default-precise32:     +    || (
I, [2015-04-24T11:04:57.195415 #8666]  INFO -- default-precise32:     +    $ENV{APACHE_CONFDIR}
I, [2015-04-24T11:04:57.198308 #8666]  INFO -- default-precise32:     +    ? "$ENV{APACHE_CONFDIR}/envvars"
I, [2015-04-24T11:04:57.199403 #8666]  INFO -- default-precise32:     +    : "/etc/apache2$dir_suffix/envvars"
I, [2015-04-24T11:04:57.201310 #8666]  INFO -- default-precise32:     +    );
I, [2015-04-24T11:04:57.203328 #8666]  INFO -- default-precise32:     +$ENV{LANG} = 'C';
I, [2015-04-24T11:04:57.206241 #8666]  INFO -- default-precise32:     +read_env_file($env_file);
I, [2015-04-24T11:04:57.206287 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.208093 #8666]  INFO -- default-precise32:     +$act .= 'able';
I, [2015-04-24T11:04:57.209309 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:57.211026 #8666]  INFO -- default-precise32:     +if ( $obj eq 'mod' ) {
I, [2015-04-24T11:04:57.213267 #8666]  INFO -- default-precise32:     +    $obj    = 'module';
I, [2015-04-24T11:04:57.214234 #8666]  INFO -- default-precise32:     +    $dir    = 'mods';
I, [2015-04-24T11:04:57.216262 #8666]  INFO -- default-precise32:     +    $sffx   = '.load';
I, [2015-04-24T11:04:57.217358 #8666]  INFO -- default-precise32: +    $reload = 'restart';
I, [2015-04-24T11:04:57.219333 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:57.221324 #8666]  INFO -- default-precise32:     +elsif ( $obj eq 'conf' ) {
I, [2015-04-24T11:04:57.223725 #8666]  INFO -- default-precise32:     +    $obj    = 'conf';
I, [2015-04-24T11:04:57.226201 #8666]  INFO -- default-precise32:     +    $dir    = 'conf';
I, [2015-04-24T11:04:57.229246 #8666]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:04:57.231178 #8666]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:04:57.233155 #8666]  INFO -- default-precise32: +}
I, [2015-04-24T11:04:57.234763 #8666]  INFO -- default-precise32:     +else {
I, [2015-04-24T11:04:57.237171 #8666]  INFO -- default-precise32:     +    $dir    = 'sites';
I, [2015-04-24T11:04:57.239690 #8666]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:04:57.241202 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:57.243016 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:57.245172 #8666]  INFO -- default-precise32:     +$name = ucfirst($obj);
I, [2015-04-24T11:04:57.247348 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.249585 #8666]  INFO -- default-precise32:     +my $confdir = $ENV{APACHE_CONFDIR} || "/etc/apache2$dir_suffix";
I, [2015-04-24T11:04:57.251194 #8666]  INFO -- default-precise32:     +my $availdir = $ENV{ uc("APACHE_${dir}_AVAILABLE") }
I, [2015-04-24T11:04:57.252173 #8666]  INFO -- default-precise32: +    || "$confdir/$dir-available";
I, [2015-04-24T11:04:57.254308 #8666]  INFO -- default-precise32:     +my $enabldir = $ENV{ uc("APACHE_${dir}_ENABLED") } || "$confdir/$dir-enabled";
I, [2015-04-24T11:04:57.257202 #8666]  INFO -- default-precise32:     +my $statedir = $ENV{ uc("APACHE_STATE_DIRECTORY") } || "/usr/lib/apache2";
I, [2015-04-24T11:04:57.259327 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.262191 #8666]  INFO -- default-precise32:     +$statedir .= "/$obj";
I, [2015-04-24T11:04:57.264177 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.267196 #8666]  INFO -- default-precise32:     +my $choicedir = $act eq 'enable' ? $availdir : $enabldir;
I, [2015-04-24T11:04:57.269184 #8666]  INFO -- default-precise32:     +my $linkdir = File::Spec->abs2rel( $availdir, $enabldir );
I, [2015-04-24T11:04:57.271087 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.274275 #8666]  INFO -- default-precise32:     +my $request_reload = 0;
I, [2015-04-24T11:04:57.275853 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.278192 #8666]  INFO -- default-precise32:     +my $rc = 0;
I, [2015-04-24T11:04:57.280064 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.282865 #8666]  INFO -- default-precise32:     +if ( !scalar @ARGV ) {
I, [2015-04-24T11:04:57.285212 #8666]  INFO -- default-precise32:     +    my @choices = myglob('*');
I, [2015-04-24T11:04:57.287983 #8666]  INFO -- default-precise32:     +    print "Your choices are: @choices\n";
I, [2015-04-24T11:04:57.290131 #8666]  INFO -- default-precise32:     +    print "Which ${obj}(s) do you want to $act (wildcards ok)?\n";
I, [2015-04-24T11:04:57.292686 #8666]  INFO -- default-precise32:     +    my $input = <>;
I, [2015-04-24T11:04:57.295205 #8666]  INFO -- default-precise32:     +    @ARGV = split /\s+/, $input;
I, [2015-04-24T11:04:57.297688 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.300550 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:57.302766 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.305474 #8666]  INFO -- default-precise32:     +my @objs;
I, [2015-04-24T11:04:57.307441 #8666]  INFO -- default-precise32:     +foreach my $arg (@ARGV) {
I, [2015-04-24T11:04:57.309990 #8666]  INFO -- default-precise32:     +    $arg =~ s/${sffx}$//;
I, [2015-04-24T11:04:57.312494 #8666]  INFO -- default-precise32:     +    my @glob = myglob($arg);
I, [2015-04-24T11:04:57.314815 #8666]  INFO -- default-precise32:     +    if ( !@glob ) {
I, [2015-04-24T11:04:57.317493 #8666]  INFO -- default-precise32:     +        error("No $obj found matching $arg!\n");
I, [2015-04-24T11:04:57.320027 #8666]  INFO -- default-precise32:     +        $rc = 1;
I, [2015-04-24T11:04:57.322181 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:57.324772 #8666]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:04:57.327176 #8666]  INFO -- default-precise32:     +        push @objs, @glob;
I, [2015-04-24T11:04:57.330039 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:57.333182 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:57.334880 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.337211 #8666]  INFO -- default-precise32:     +foreach my $acton (@objs) {
I, [2015-04-24T11:04:57.339292 #8666]  INFO -- default-precise32:     +    doit($acton) or $rc = 1;
I, [2015-04-24T11:04:57.341302 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:57.343141 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.345195 #8666]  INFO -- default-precise32:     +info(
I, [2015-04-24T11:04:57.348245 #8666]  INFO -- default-precise32:     +    "To activate the new configuration, you need to run:\n  service apache2 $reload\n"
I, [2015-04-24T11:04:57.351317 #8666]  INFO -- default-precise32:     +) if $request_reload;
I, [2015-04-24T11:04:57.352210 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.354284 #8666]  INFO -- default-precise32:     +exit($rc);
I, [2015-04-24T11:04:57.364314 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.364402 #8666]  INFO -- default-precise32:     +##############################################################################
I, [2015-04-24T11:04:57.364424 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.364442 #8666]  INFO -- default-precise32:     +sub myglob {
I, [2015-04-24T11:04:57.366273 #8666]  INFO -- default-precise32: +    my $arg = shift;
I, [2015-04-24T11:04:57.367215 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.370005 #8666]  INFO -- default-precise32:     +    my @glob = map {
I, [2015-04-24T11:04:57.372543 #8666]  INFO -- default-precise32:     +        s{^$choicedir/}{};
I, [2015-04-24T11:04:57.375396 #8666]  INFO -- default-precise32:     +        s{$sffx$}{};
I, [2015-04-24T11:04:57.378304 #8666]  INFO -- default-precise32:     +        $_
I, [2015-04-24T11:04:57.381169 #8666]  INFO -- default-precise32:     +    } glob("$choicedir/$arg$sffx");
I, [2015-04-24T11:04:57.383583 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.386708 #8666]  INFO -- default-precise32:     +    return @glob;
I, [2015-04-24T11:04:57.388948 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:57.391173 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.393513 #8666]  INFO -- default-precise32:     +sub doit {
I, [2015-04-24T11:04:57.397210 #8666]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:04:57.398608 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.401421 #8666]  INFO -- default-precise32:     +    my ( $conftgt, $conflink );
I, [2015-04-24T11:04:57.404031 #8666]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:04:57.406861 #8666]  INFO -- default-precise32:     +        if ( $acton eq 'cgi' && threaded() ) {
I, [2015-04-24T11:04:57.409891 #8666]  INFO -- default-precise32:     +            print
I, [2015-04-24T11:04:57.412728 #8666]  INFO -- default-precise32:     +                "Your MPM seems to be threaded. Selecting cgid instead of cgi.\n";
I, [2015-04-24T11:04:57.415436 #8666]  INFO -- default-precise32:     +            $acton = 'cgid';
I, [2015-04-24T11:04:57.418227 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:57.421081 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.423817 #8666]  INFO -- default-precise32:     +        $conftgt = "$availdir/$acton.conf";
I, [2015-04-24T11:04:57.426793 #8666]  INFO -- default-precise32:     +        if ( -e $conftgt ) {
I, [2015-04-24T11:04:57.429931 #8666]  INFO -- default-precise32:     +            $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:04:57.433096 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:57.435908 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:57.438954 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.441844 #8666]  INFO -- default-precise32:     +    my $tgt  = "$availdir/$acton$sffx";
I, [2015-04-24T11:04:57.444708 #8666]  INFO -- default-precise32:     +    my $link = "$enabldir/$acton$sffx";
I, [2015-04-24T11:04:57.447579 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.450623 #8666]  INFO -- default-precise32:     +    if ( !-e $tgt ) {
I, [2015-04-24T11:04:57.453459 #8666]  INFO -- default-precise32:     +        if ( -l $link && !-e $link ) {
I, [2015-04-24T11:04:57.456519 #8666]  INFO -- default-precise32:     +            if ( $act eq 'disable' ) {
I, [2015-04-24T11:04:57.459425 #8666]  INFO -- default-precise32:     +                info("removing dangling symlink $link\n");
I, [2015-04-24T11:04:57.462613 #8666]  INFO -- default-precise32:     +                unlink($link);
I, [2015-04-24T11:04:57.465671 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.468567 #8666]  INFO -- default-precise32:     +                # force a .conf path. It may exist as dangling link, too
I, [2015-04-24T11:04:57.471359 #8666]  INFO -- default-precise32:     +                $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:04:57.474394 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.476955 #8666]  INFO -- default-precise32:     +                if ( -l $conflink && !-e $conflink ) {
I, [2015-04-24T11:04:57.479919 #8666]  INFO -- default-precise32:     +                    info("removing dangling symlink $conflink\n");
I, [2015-04-24T11:04:57.482508 #8666]  INFO -- default-precise32:     +                    unlink($conflink);
I, [2015-04-24T11:04:57.485690 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:57.488115 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.490798 #8666]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:04:57.493688 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:57.497581 #8666]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:04:57.500732 #8666]  INFO -- default-precise32:     +                error("$link is a dangling symlink!\n");
I, [2015-04-24T11:04:57.503567 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:57.506100 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:57.508475 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.510839 #8666]  INFO -- default-precise32:     +        if ( $purge ) {
I, [2015-04-24T11:04:57.513660 #8666]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:57.516054 #8666]  INFO -- default-precise32:     +            # exit silently, we are purging anyway
I, [2015-04-24T11:04:57.518866 #8666]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:04:57.521170 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:57.523541 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.527188 #8666]  INFO -- default-precise32:     +        error("$name $acton does not exist!\n");
I, [2015-04-24T11:04:57.530634 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:57.533899 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:57.536518 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.539440 #8666]  INFO -- default-precise32:     +    # handle module dependencies
I, [2015-04-24T11:04:57.542239 #8666]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:04:57.545446 #8666]  INFO -- default-precise32:     +        if ( $act eq 'enable' ) {
I, [2015-04-24T11:04:57.548529 #8666]  INFO -- default-precise32:     +            if ( $acton eq 'mpm_itk' ) {
I, [2015-04-24T11:04:57.551048 #8666]  INFO -- default-precise32:     +                warning(  "MPM_ITK is a third party module that is not part "
I, [2015-04-24T11:04:57.554182 #8666]  INFO -- default-precise32:     +                        . "of the official Apache HTTPD. It has seen less "
I, [2015-04-24T11:04:57.557441 #8666]  INFO -- default-precise32:     +                        . "testing than the official MPM modules." );
I, [2015-04-24T11:04:57.560619 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:57.563709 #8666]  INFO -- default-precise32:     +            my @depends = get_deps("$availdir/$acton.load");
I, [2015-04-24T11:04:57.566607 #8666]  INFO -- default-precise32:     +            do_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:04:57.568558 #8666]  INFO -- default-precise32: +
I, [2015-04-24T11:04:57.571386 #8666]  INFO -- default-precise32:     +            my @conflicts = get_deps( "$availdir/$acton.load", "Conflicts" );
I, [2015-04-24T11:04:57.574429 #8666]  INFO -- default-precise32:     +            check_conflicts( $acton, @conflicts ) or return 0;
I, [2015-04-24T11:04:57.577179 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:57.579753 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:57.582793 #8666]  INFO -- default-precise32:     +            my @depending;
I, [2015-04-24T11:04:57.585993 #8666]  INFO -- default-precise32:     +            foreach my $d ( glob("$enabldir/*.load") ) {
I, [2015-04-24T11:04:57.588917 #8666]  INFO -- default-precise32:     +                my @deps = get_deps($d);
I, [2015-04-24T11:04:57.592087 #8666]  INFO -- default-precise32:     +                if ( is_in( $acton, @deps ) ) {
I, [2015-04-24T11:04:57.595543 #8666]  INFO -- default-precise32:     +                    $d =~ m,/([^/]+).load$,;
I, [2015-04-24T11:04:57.598482 #8666]  INFO -- default-precise32:     +                    push @depending, $1;
I, [2015-04-24T11:04:57.601611 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:57.604423 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:57.607209 #8666]  INFO -- default-precise32:     +            if ( scalar @depending ) {
I, [2015-04-24T11:04:57.609997 #8666]  INFO -- default-precise32:     +                if ($force) {
I, [2015-04-24T11:04:57.613056 #8666]  INFO -- default-precise32:     +                    do_deps( $acton, @depending ) or return 0;
I, [2015-04-24T11:04:57.615987 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:57.618760 #8666]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:04:57.621548 #8666]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:04:57.624751 #8666]  INFO -- default-precise32:     +                        "The following modules depend on $acton ",
I, [2015-04-24T11:04:57.627886 #8666]  INFO -- default-precise32:     +                        "and need to be disabled first: @depending\n"
I, [2015-04-24T11:04:57.630694 #8666]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:04:57.633500 #8666]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:04:57.636960 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:57.639717 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:57.642170 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:57.644261 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:57.646994 #8666]  INFO -- default-precise32:     +    elsif ( $act eq 'enable' ) {
I, [2015-04-24T11:04:57.649542 #8666]  INFO -- default-precise32:     +        my @depends = get_deps("$availdir/$acton$sffx");
I, [2015-04-24T11:04:57.651476 #8666]  INFO -- default-precise32:     +        warn_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:04:57.654191 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:57.656455 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.658566 #8666]  INFO -- default-precise32:     +    if ( $act eq 'enable' ) {
I, [2015-04-24T11:04:57.661696 #8666]  INFO -- default-precise32:     +        my $check = check_link( $tgt, $link );
I, [2015-04-24T11:04:57.664409 #8666]  INFO -- default-precise32:     +        if ( $check eq 'ok' ) {
I, [2015-04-24T11:04:57.668107 #8666]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:04:57.670073 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.672178 #8666]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:04:57.674200 #8666]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:04:57.677027 #8666]  INFO -- default-precise32:     +                if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:04:57.679189 #8666]  INFO -- default-precise32:     +                    info("$name $acton already enabled\n");
I, [2015-04-24T11:04:57.681430 #8666]  INFO -- default-precise32:     +                    return 1;
I, [2015-04-24T11:04:57.683475 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:57.685940 #8666]  INFO -- default-precise32:     +                elsif ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:04:57.688173 #8666]  INFO -- default-precise32:     +                    print "Enabling config file $acton.conf.\n";
I, [2015-04-24T11:04:57.690553 #8666]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:04:57.693217 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:57.695720 #8666]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:04:57.698074 #8666]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:04:57.700108 #8666]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:04:57.702293 #8666]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:04:57.704784 #8666]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:04:57.707164 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:57.709326 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:57.711891 #8666]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:04:57.713779 #8666]  INFO -- default-precise32:     +                info("$name $acton already enabled\n");
I, [2015-04-24T11:04:57.715368 #8666]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:04:57.717360 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:57.719297 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:57.721325 #8666]  INFO -- default-precise32:     +        elsif ( $check eq 'missing' ) {
I, [2015-04-24T11:04:57.724264 #8666]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:04:57.726030 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.728210 #8666]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:04:57.730012 #8666]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:04:57.732196 #8666]  INFO -- default-precise32:     +                if ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:04:57.734773 #8666]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:04:57.737299 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:57.739755 #8666]  INFO -- default-precise32:     +                elsif ( $confcheck ne 'ok' ) {
I, [2015-04-24T11:04:57.742159 #8666]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:04:57.744699 #8666]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:04:57.746980 #8666]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:04:57.749153 #8666]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:04:57.751542 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:57.753397 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:57.755950 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.758556 #8666]  INFO -- default-precise32:     +            print "Enabling $obj $acton.\n";
I, [2015-04-24T11:04:57.760913 #8666]  INFO -- default-precise32:     +            if ( $acton eq 'ssl' ) {
I, [2015-04-24T11:04:57.762901 #8666]  INFO -- default-precise32:     +                info(     "See /usr/share/doc/apache2/README.Debian.gz on "
I, [2015-04-24T11:04:57.765784 #8666]  INFO -- default-precise32:     +                        . "how to configure SSL and create self-signed certificates.\n"
I, [2015-04-24T11:04:57.768473 #8666]  INFO -- default-precise32:     +                );
I, [2015-04-24T11:04:57.770523 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:57.773168 #8666]  INFO -- default-precise32:     +            return add_link( $tgt, $link )
I, [2015-04-24T11:04:57.775630 #8666]  INFO -- default-precise32:     +                && switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:57.777994 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:57.780118 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:57.782713 #8666]  INFO -- default-precise32:     +            error("$name $acton not properly enabled: $check\n");
I, [2015-04-24T11:04:57.785164 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:57.787362 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:57.790072 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:57.792674 #8666]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:04:57.795205 #8666]  INFO -- default-precise32:     +        if ( -e $link || -l $link ) {
I, [2015-04-24T11:04:57.797566 #8666]  INFO -- default-precise32:     +            remove_link($link);
I, [2015-04-24T11:04:57.800053 #8666]  INFO -- default-precise32:     +            if ( $conflink && -e $conflink ) {
I, [2015-04-24T11:04:57.802538 #8666]  INFO -- default-precise32:     +                remove_link($conflink);
I, [2015-04-24T11:04:57.805078 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:57.806887 #8666]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:57.808910 #8666]  INFO -- default-precise32:     +            print "$name $acton disabled.\n";
I, [2015-04-24T11:04:57.810843 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:57.812887 #8666]  INFO -- default-precise32:     +        elsif ( $conflink && -e $conflink ) {
I, [2015-04-24T11:04:57.814776 #8666]  INFO -- default-precise32:     +            print "Disabling stale config file $acton.conf.\n";
I, [2015-04-24T11:04:57.817000 #8666]  INFO -- default-precise32:     +            remove_link($conflink);
I, [2015-04-24T11:04:57.819181 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:57.821295 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:57.823479 #8666]  INFO -- default-precise32:     +            info("$name $acton already disabled\n");
I, [2015-04-24T11:04:57.825305 #8666]  INFO -- default-precise32:     +            if ( $purge ) {
I, [2015-04-24T11:04:57.827272 #8666]  INFO -- default-precise32:     +                switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:57.829508 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:57.831221 #8666]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:04:57.833594 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:57.835265 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:57.837359 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.839430 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:57.841274 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:57.842982 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.845055 #8666]  INFO -- default-precise32:     +sub get_deps {
I, [2015-04-24T11:04:57.846863 #8666]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:04:57.849178 #8666]  INFO -- default-precise32:     +    my $type = shift || "Depends";
I, [2015-04-24T11:04:57.850982 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.853697 #8666]  INFO -- default-precise32:     +    my $fd;
I, [2015-04-24T11:04:57.856531 #8666]  INFO -- default-precise32:     +    if ( !open( $fd, '<', $file ) ) {
I, [2015-04-24T11:04:57.858951 #8666]  INFO -- default-precise32:     +        error("Can't open $file: $!");
I, [2015-04-24T11:04:57.861368 #8666]  INFO -- default-precise32:     +        return;
I, [2015-04-24T11:04:57.863822 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:57.865794 #8666]  INFO -- default-precise32:     +    my $line;
I, [2015-04-24T11:04:57.867332 #8666]  INFO -- default-precise32:     +    while ( defined( $line = <$fd> ) ) {
I, [2015-04-24T11:04:57.869820 #8666]  INFO -- default-precise32:     +        chomp $line;
I, [2015-04-24T11:04:57.871385 #8666]  INFO -- default-precise32:     +        if ( $line =~ /^# $type:\s+(.*?)\s*$/ ) {
I, [2015-04-24T11:04:57.873682 #8666]  INFO -- default-precise32:     +            my $deps = $1;
I, [2015-04-24T11:04:57.875697 #8666]  INFO -- default-precise32:     +            return split( /[\n\s]+/, $deps );
I, [2015-04-24T11:04:57.878177 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:57.880195 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.882991 #8666]  INFO -- default-precise32:     +        # only check until the first non-empty non-comment line
I, [2015-04-24T11:04:57.885420 #8666]  INFO -- default-precise32:     +        last if ( $line !~ /^\s*(?:#.*)?$/ );
I, [2015-04-24T11:04:57.888052 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:57.890985 #8666]  INFO -- default-precise32:     +    return;
I, [2015-04-24T11:04:57.893311 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:57.895512 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.897970 #8666]  INFO -- default-precise32:     +sub do_deps {
I, [2015-04-24T11:04:57.900467 #8666]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:04:57.902605 #8666]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:04:57.904997 #8666]  INFO -- default-precise32:     +        info("Considering dependency $d for $acton:\n");
I, [2015-04-24T11:04:57.907169 #8666]  INFO -- default-precise32:     +        if ( !doit($d) ) {
I, [2015-04-24T11:04:57.909715 #8666]  INFO -- default-precise32:     +            error("Could not $act dependency $d for $acton, aborting\n");
I, [2015-04-24T11:04:57.912214 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:57.914710 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:57.917392 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:57.919576 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:57.922381 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:57.924848 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.927163 #8666]  INFO -- default-precise32:     +sub warn_deps {
I, [2015-04-24T11:04:57.929201 #8666]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:04:57.931827 #8666]  INFO -- default-precise32:     +    my $modsenabldir = $ENV{APACHE_MODS_ENABLED} || "$confdir/mods-enabled";
I, [2015-04-24T11:04:57.933893 #8666]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:04:57.936042 #8666]  INFO -- default-precise32:     +        info("Checking dependency $d for $acton:\n");
I, [2015-04-24T11:04:57.937971 #8666]  INFO -- default-precise32:     +        if ( !-e "$modsenabldir/$d.load" ) {
I, [2015-04-24T11:04:57.940071 #8666]  INFO -- default-precise32:     +            warning(
I, [2015-04-24T11:04:57.942281 #8666]  INFO -- default-precise32:     +                "Module $d is not enabled, but $acton depends on it, aborting\n"
I, [2015-04-24T11:04:57.944844 #8666]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:04:57.947086 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:57.949750 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:57.952649 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:57.955063 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:57.957308 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:57.959462 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.962915 #8666]  INFO -- default-precise32:     +sub check_conflicts {
I, [2015-04-24T11:04:57.965217 #8666]  INFO -- default-precise32:     +    my $acton    = shift;
I, [2015-04-24T11:04:57.967349 #8666]  INFO -- default-precise32:     +    my $haderror = 0;
I, [2015-04-24T11:04:57.970192 #8666]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:04:57.973168 #8666]  INFO -- default-precise32:     +        info("Considering conflict $d for $acton:\n");
I, [2015-04-24T11:04:57.975326 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.978094 #8666]  INFO -- default-precise32:     +        my $tgt  = "$availdir/$d$sffx";
I, [2015-04-24T11:04:57.980653 #8666]  INFO -- default-precise32:     +        my $link = "$enabldir/$d$sffx";
I, [2015-04-24T11:04:57.983083 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.986100 #8666]  INFO -- default-precise32:     +        my $confcheck = check_link( $tgt, $link );
I, [2015-04-24T11:04:57.988760 #8666]  INFO -- default-precise32:     +        if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:04:57.990702 #8666]  INFO -- default-precise32:     +            error(
I, [2015-04-24T11:04:57.993065 #8666]  INFO -- default-precise32:     +                "Module $d is enabled - cannot proceed due to conflicts. It needs to be disabled first!\n"
I, [2015-04-24T11:04:57.994924 #8666]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:04:57.996892 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:57.999016 #8666]  INFO -- default-precise32:     +            # Don't return immediately, there could be several conflicts
I, [2015-04-24T11:04:58.001860 #8666]  INFO -- default-precise32:     +            $haderror++;
I, [2015-04-24T11:04:58.004637 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.006919 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.009054 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.011699 #8666]  INFO -- default-precise32:     +    if ($haderror) {
I, [2015-04-24T11:04:58.013955 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:58.017028 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.019195 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.025101 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:58.028041 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.030226 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.032917 #8666]  INFO -- default-precise32:     +sub add_link {
I, [2015-04-24T11:04:58.035173 #8666]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:04:58.038012 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.039926 #8666]  INFO -- default-precise32:     +    # create relative link
I, [2015-04-24T11:04:58.042028 #8666]  INFO -- default-precise32:     +    if ( !symlink( File::Spec->abs2rel( $tgt, dirname($link) ), $link ) ) {
I, [2015-04-24T11:04:58.043994 #8666]  INFO -- default-precise32:     +        die("Could not create $link: $!\n");
I, [2015-04-24T11:04:58.046069 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.047949 #8666]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:04:58.050066 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:58.052128 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.054872 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.056199 #8666]  INFO -- default-precise32:     +sub check_link {
I, [2015-04-24T11:04:58.058427 #8666]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:04:58.060934 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.063200 #8666]  INFO -- default-precise32:     +    if ( !-e $link ) {
I, [2015-04-24T11:04:58.066208 #8666]  INFO -- default-precise32:     +        if ( -l $link ) {
I, [2015-04-24T11:04:58.068197 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.070831 #8666]  INFO -- default-precise32:     +            # points to nowhere
I, [2015-04-24T11:04:58.073364 #8666]  INFO -- default-precise32:     +            info("Removing dangling link $link");
I, [2015-04-24T11:04:58.075975 #8666]  INFO -- default-precise32:     +            unlink($link) or die "Could not remove $link\n";
I, [2015-04-24T11:04:58.078169 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.080951 #8666]  INFO -- default-precise32:     +        return 'missing';
I, [2015-04-24T11:04:58.083644 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.086180 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.089556 #8666]  INFO -- default-precise32:     +    if ( -e $link && !-l $link ) {
I, [2015-04-24T11:04:58.092147 #8666]  INFO -- default-precise32:     +        return "$link is a real file, not touching it";
I, [2015-04-24T11:04:58.094721 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.097668 #8666]  INFO -- default-precise32:     +    if ( realpath($link) ne realpath($tgt) ) {
I, [2015-04-24T11:04:58.100477 #8666]  INFO -- default-precise32:     +        return "$link exists but does not point to $tgt, not touching it";
I, [2015-04-24T11:04:58.102986 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.105588 #8666]  INFO -- default-precise32:     +    return 'ok';
I, [2015-04-24T11:04:58.107823 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.110639 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.113051 #8666]  INFO -- default-precise32:     +sub remove_link {
I, [2015-04-24T11:04:58.115896 #8666]  INFO -- default-precise32:     +    my ($link) = @_;
I, [2015-04-24T11:04:58.118534 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.121586 #8666]  INFO -- default-precise32:     +    if ( -l $link ) {
I, [2015-04-24T11:04:58.123974 #8666]  INFO -- default-precise32:     +        unlink($link) or die "Could not remove $link: $!\n";
I, [2015-04-24T11:04:58.126158 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.129044 #8666]  INFO -- default-precise32:     +    elsif ( -e $link ) {
I, [2015-04-24T11:04:58.131567 #8666]  INFO -- default-precise32:     +        error("$link is not a symbolic link, not deleting\n");
I, [2015-04-24T11:04:58.134072 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:58.136721 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.138986 #8666]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:04:58.141117 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:58.143285 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.145446 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.147436 #8666]  INFO -- default-precise32:     +sub threaded {
I, [2015-04-24T11:04:58.150376 #8666]  INFO -- default-precise32:     +    my $result = "";
I, [2015-04-24T11:04:58.153173 #8666]  INFO -- default-precise32:     +    $result = qx{/usr/sbin/apache2ctl -V | grep 'threaded'}
I, [2015-04-24T11:04:58.155476 #8666]  INFO -- default-precise32:     +        if -x '/usr/sbin/apache2ctl';
I, [2015-04-24T11:04:58.158181 #8666]  INFO -- default-precise32:     +    if ( $? != 0 ) {
I, [2015-04-24T11:04:58.160573 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.162464 #8666]  INFO -- default-precise32:     +        # config doesn't work
I, [2015-04-24T11:04:58.165082 #8666]  INFO -- default-precise32:     +        if ( -e "$enabldir/mpm_prefork.load" || -e "$enabldir/mpm_itk.load" )
I, [2015-04-24T11:04:58.167200 #8666]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:04:58.169707 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:58.172135 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.174250 #8666]  INFO -- default-precise32:     +        elsif (-e "$enabldir/mpm_worker.load"
I, [2015-04-24T11:04:58.176816 #8666]  INFO -- default-precise32:     +            || -e "$enabldir/mpm_event.load" )
I, [2015-04-24T11:04:58.179168 #8666]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:04:58.182216 #8666]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:04:58.185045 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.187766 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:58.190311 #8666]  INFO -- default-precise32:     +            error("Can't determine enabled MPM");
I, [2015-04-24T11:04:58.192912 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.195160 #8666]  INFO -- default-precise32:     +            # do what user requested
I, [2015-04-24T11:04:58.197512 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:58.200065 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.201975 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.204034 #8666]  INFO -- default-precise32:     +    if ( $result =~ / no/ ) {
I, [2015-04-24T11:04:58.205761 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:58.208147 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.210335 #8666]  INFO -- default-precise32:     +    elsif ( $result =~ / yes/ ) {
I, [2015-04-24T11:04:58.213117 #8666]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:04:58.215518 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.217938 #8666]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:04:58.220820 #8666]  INFO -- default-precise32:     +        die("Can't parse output from apache2ctl -V:\n$result\n");
I, [2015-04-24T11:04:58.223103 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.226221 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.228193 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.230334 #8666]  INFO -- default-precise32:     +sub info {
I, [2015-04-24T11:04:58.232993 #8666]  INFO -- default-precise32:     +    print @_ if !$quiet;
I, [2015-04-24T11:04:58.235343 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.238033 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.240666 #8666]  INFO -- default-precise32:     +sub error {
I, [2015-04-24T11:04:58.242869 #8666]  INFO -- default-precise32:     +    print STDERR 'ERROR: ', @_;
I, [2015-04-24T11:04:58.245308 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.247331 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.250100 #8666]  INFO -- default-precise32:     +sub warning {
I, [2015-04-24T11:04:58.252941 #8666]  INFO -- default-precise32:     +    print STDERR 'WARNING: ', @_;
I, [2015-04-24T11:04:58.255199 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.257753 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.260076 #8666]  INFO -- default-precise32:     +sub is_in {
I, [2015-04-24T11:04:58.262165 #8666]  INFO -- default-precise32:     +    my $needle = shift;
I, [2015-04-24T11:04:58.264723 #8666]  INFO -- default-precise32:     +    foreach my $e (@_) {
I, [2015-04-24T11:04:58.266954 #8666]  INFO -- default-precise32:     +        return 1 if $needle eq $e;
I, [2015-04-24T11:04:58.269378 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.271502 #8666]  INFO -- default-precise32:     +    return 0;
I, [2015-04-24T11:04:58.274199 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.276226 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.278313 #8666]  INFO -- default-precise32:     +sub read_env_file {
I, [2015-04-24T11:04:58.281309 #8666]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:04:58.282717 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.284927 #8666]  INFO -- default-precise32:     +    -r $file or return;
I, [2015-04-24T11:04:58.286930 #8666]  INFO -- default-precise32:     +    my @lines = qx{env - sh -c '. $file && env'};
I, [2015-04-24T11:04:58.289035 #8666]  INFO -- default-precise32:     +    if ($?) {
I, [2015-04-24T11:04:58.290870 #8666]  INFO -- default-precise32:     +        die "Could not read $file\n";
I, [2015-04-24T11:04:58.293308 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.294860 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.297221 #8666]  INFO -- default-precise32:     +    foreach my $l (@lines) {
I, [2015-04-24T11:04:58.299951 #8666]  INFO -- default-precise32:     +        chomp $l;
I, [2015-04-24T11:04:58.302140 #8666]  INFO -- default-precise32:     +        $l =~ /^(.*)?=(.*)$/ or die "Could not parse $file\n";
I, [2015-04-24T11:04:58.304316 #8666]  INFO -- default-precise32:     +        $ENV{$1} = $2;
I, [2015-04-24T11:04:58.306823 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.309179 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.311467 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.314162 #8666]  INFO -- default-precise32:     +sub switch_marker {
I, [2015-04-24T11:04:58.316886 #8666]  INFO -- default-precise32:     +    die('usage: switch_marker([module|site|conf], [enable|disable], $name)')
I, [2015-04-24T11:04:58.319176 #8666]  INFO -- default-precise32:     +        if @_ != 3;
I, [2015-04-24T11:04:58.321764 #8666]  INFO -- default-precise32:     +    my $which = shift;
I, [2015-04-24T11:04:58.323746 #8666]  INFO -- default-precise32:     +    my $what  = shift;
I, [2015-04-24T11:04:58.327266 #8666]  INFO -- default-precise32:     +    my $name  = shift;
I, [2015-04-24T11:04:58.329206 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.331222 #8666]  INFO -- default-precise32:     +    my $mode = "admin";
I, [2015-04-24T11:04:58.334307 #8666]  INFO -- default-precise32:     +    $mode = "maint" if $maintmode;
I, [2015-04-24T11:04:58.335061 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.337175 #8666]  INFO -- default-precise32:     +    #print("switch_marker $which $what $name\n");
I, [2015-04-24T11:04:58.339003 #8666]  INFO -- default-precise32:     +    # TODO: get rid of the magic string(s)
I, [2015-04-24T11:04:58.340904 #8666]  INFO -- default-precise32:     +    my $state_marker_dir = "$statedir/$what" . "d" . "_by_$mode";
I, [2015-04-24T11:04:58.342911 #8666]  INFO -- default-precise32:     +    my $state_marker     = "$state_marker_dir/$name";
I, [2015-04-24T11:04:58.345014 #8666]  INFO -- default-precise32:     +    if ( !-d $state_marker_dir ) {
I, [2015-04-24T11:04:58.346916 #8666]  INFO -- default-precise32:     +        File::Path::mkpath("$state_marker_dir")
I, [2015-04-24T11:04:58.354936 #8666]  INFO -- default-precise32:     +            || error(
I, [2015-04-24T11:04:58.355011 #8666]  INFO -- default-precise32:     +            "Failed to create marker directory: '$state_marker_dir'\n");
I, [2015-04-24T11:04:58.357172 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:58.357221 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.359840 #8666]  INFO -- default-precise32:     +    # XXX: swap find with perl alternative
I, [2015-04-24T11:04:58.361212 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:58.362800 #8666]  INFO -- default-precise32: +    chomp(@markers);
I, [2015-04-24T11:04:58.367144 #8666]  INFO -- default-precise32:     +    foreach (@markers) {
I, [2015-04-24T11:04:58.367178 #8666]  INFO -- default-precise32:     +        unless ( unlink $_ ) {
I, [2015-04-24T11:04:58.367200 #8666]  INFO -- default-precise32:     +            error("Failed to remove old marker '$_'!\n") && return 0;
I, [2015-04-24T11:04:58.368173 #8666]  INFO -- default-precise32: +        }
I, [2015-04-24T11:04:58.370647 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.373046 #8666]  INFO -- default-precise32:     +    unless ($purge) {
I, [2015-04-24T11:04:58.375155 #8666]  INFO -- default-precise32:     +        qx{touch "$state_marker"};
I, [2015-04-24T11:04:58.378047 #8666]  INFO -- default-precise32:     +        if ( $? != 0 ) {
I, [2015-04-24T11:04:58.380526 #8666]  INFO -- default-precise32:     +            error("Failed to create marker '$state_marker'!\n") && return 0;
I, [2015-04-24T11:04:58.382939 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.385348 #8666]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:04:58.388118 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.390335 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.392765 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.398457 #8666]  INFO -- default-precise32:     +# vim: syntax=perl sw=4 sts=4 sr et
I, [2015-04-24T11:04:58.400876 #8666]  INFO -- default-precise32:     - change mode from '' to '0700'
I, [2015-04-24T11:04:58.403059 #8666]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:04:58.406694 #8666]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:04:58.410293 #8666]  INFO -- default-precise32:   * link[/usr/sbin/a2disconf] action delete (skipped due to only_if)
I, [2015-04-24T11:04:58.419761 #8666]  INFO -- default-precise32:   * template[/usr/sbin/a2disconf] action create
I, [2015-04-24T11:04:58.432883 #8666]  INFO -- default-precise32:     - create new file /usr/sbin/a2disconf
I, [2015-04-24T11:04:58.435712 #8666]  INFO -- default-precise32:     - update content in file /usr/sbin/a2disconf from none to ce53f4
I, [2015-04-24T11:04:58.440196 #8666]  INFO -- default-precise32:     --- /usr/sbin/a2disconf	2015-04-24 08:04:58.412690173 +0000
I, [2015-04-24T11:04:58.444720 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-19hswnl	2015-04-24 08:04:58.412690173 +0000
I, [2015-04-24T11:04:58.447115 #8666]  INFO -- default-precise32:     @@ -1 +1,533 @@
I, [2015-04-24T11:04:58.450091 #8666]  INFO -- default-precise32:     +#!/usr/bin/perl -w
I, [2015-04-24T11:04:58.453175 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:58.456064 #8666]  INFO -- default-precise32:     +# a2enmod by Stefan Fritsch <sf@debian.org>
I, [2015-04-24T11:04:58.458893 #8666]  INFO -- default-precise32:     +# Licensed under Apache License 2.0
I, [2015-04-24T11:04:58.461771 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:58.463184 #8666]  INFO -- default-precise32:     +# The coding style is "perltidy -pbp"
I, [2015-04-24T11:04:58.465081 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.466935 #8666]  INFO -- default-precise32: +use strict;
I, [2015-04-24T11:04:58.468856 #8666]  INFO -- default-precise32:     +use Cwd 'realpath';
I, [2015-04-24T11:04:58.471510 #8666]  INFO -- default-precise32:     +use File::Spec;
I, [2015-04-24T11:04:58.478200 #8666]  INFO -- default-precise32:     +use File::Basename;
I, [2015-04-24T11:04:58.481159 #8666]  INFO -- default-precise32:     +use File::Path;
I, [2015-04-24T11:04:58.483089 #8666]  INFO -- default-precise32:     +use Getopt::Long;
I, [2015-04-24T11:04:58.485885 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.488724 #8666]  INFO -- default-precise32:     +my $quiet;
I, [2015-04-24T11:04:58.491556 #8666]  INFO -- default-precise32:     +my $force;
I, [2015-04-24T11:04:58.494196 #8666]  INFO -- default-precise32:     +my $maintmode;
I, [2015-04-24T11:04:58.496771 #8666]  INFO -- default-precise32:     +my $purge;
I, [2015-04-24T11:04:58.501030 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.502929 #8666]  INFO -- default-precise32:     +Getopt::Long::Configure('bundling');
I, [2015-04-24T11:04:58.502961 #8666]  INFO -- default-precise32:     +GetOptions(
I, [2015-04-24T11:04:58.506203 #8666]  INFO -- default-precise32:     +    'quiet|q'     => \$quiet,
I, [2015-04-24T11:04:58.506240 #8666]  INFO -- default-precise32:     +    'force|f'     => \$force,
I, [2015-04-24T11:04:58.507181 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:58.509185 #8666]  INFO -- default-precise32: +    'purge|p'     => \$purge
I, [2015-04-24T11:04:58.511181 #8666]  INFO -- default-precise32:     +) or exit 2;
I, [2015-04-24T11:04:58.512417 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:58.515617 #8666]  INFO -- default-precise32:     +my $basename = basename($0);
I, [2015-04-24T11:04:58.517123 #8666]  INFO -- default-precise32: +$basename =~ /^a2(en|dis)(mod|site|conf)((?:-.+)?)$/
I, [2015-04-24T11:04:58.518084 #8666]  INFO -- default-precise32: +    or die "$basename call name unknown\n";
I, [2015-04-24T11:04:58.519949 #8666]  INFO -- default-precise32:     +my $act        = $1;
I, [2015-04-24T11:04:58.553817 #8666]  INFO -- default-precise32:     +my $obj        = $2;
I, [2015-04-24T11:04:58.553901 #8666]  INFO -- default-precise32:     +my $dir_suffix = $3;
I, [2015-04-24T11:04:58.553924 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.553944 #8666]  INFO -- default-precise32:     +my $env_file = $ENV{APACHE_ENVVARS}
I, [2015-04-24T11:04:58.553964 #8666]  INFO -- default-precise32:     +    || (
I, [2015-04-24T11:04:58.553983 #8666]  INFO -- default-precise32:     +    $ENV{APACHE_CONFDIR}
I, [2015-04-24T11:04:58.554033 #8666]  INFO -- default-precise32:     +    ? "$ENV{APACHE_CONFDIR}/envvars"
I, [2015-04-24T11:04:58.554054 #8666]  INFO -- default-precise32:     +    : "/etc/apache2$dir_suffix/envvars"
I, [2015-04-24T11:04:58.554073 #8666]  INFO -- default-precise32:     +    );
I, [2015-04-24T11:04:58.554091 #8666]  INFO -- default-precise32:     +$ENV{LANG} = 'C';
I, [2015-04-24T11:04:58.554110 #8666]  INFO -- default-precise32:     +read_env_file($env_file);
I, [2015-04-24T11:04:58.554128 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.554146 #8666]  INFO -- default-precise32:     +$act .= 'able';
I, [2015-04-24T11:04:58.554164 #8666]  INFO -- default-precise32:     +my ( $name, $dir, $sffx, $reload );
I, [2015-04-24T11:04:58.554182 #8666]  INFO -- default-precise32:     +if ( $obj eq 'mod' ) {
I, [2015-04-24T11:04:58.554201 #8666]  INFO -- default-precise32:     +    $obj    = 'module';
I, [2015-04-24T11:04:58.554219 #8666]  INFO -- default-precise32:     +    $dir    = 'mods';
I, [2015-04-24T11:04:58.554237 #8666]  INFO -- default-precise32:     +    $sffx   = '.load';
I, [2015-04-24T11:04:58.554255 #8666]  INFO -- default-precise32:     +    $reload = 'restart';
I, [2015-04-24T11:04:58.554273 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.554292 #8666]  INFO -- default-precise32:     +elsif ( $obj eq 'conf' ) {
I, [2015-04-24T11:04:58.554310 #8666]  INFO -- default-precise32:     +    $obj    = 'conf';
I, [2015-04-24T11:04:58.554336 #8666]  INFO -- default-precise32:     +    $dir    = 'conf';
I, [2015-04-24T11:04:58.554356 #8666]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:04:58.554374 #8666]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:04:58.554392 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.554410 #8666]  INFO -- default-precise32:     +else {
I, [2015-04-24T11:04:58.554428 #8666]  INFO -- default-precise32:     +    $dir    = 'sites';
I, [2015-04-24T11:04:58.554446 #8666]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:04:58.554465 #8666]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:04:58.554482 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.554500 #8666]  INFO -- default-precise32:     +$name = ucfirst($obj);
I, [2015-04-24T11:04:58.554518 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.554536 #8666]  INFO -- default-precise32:     +my $confdir = $ENV{APACHE_CONFDIR} || "/etc/apache2$dir_suffix";
I, [2015-04-24T11:04:58.554580 #8666]  INFO -- default-precise32:     +my $availdir = $ENV{ uc("APACHE_${dir}_AVAILABLE") }
I, [2015-04-24T11:04:58.554601 #8666]  INFO -- default-precise32:     +    || "$confdir/$dir-available";
I, [2015-04-24T11:04:58.554619 #8666]  INFO -- default-precise32:     +my $enabldir = $ENV{ uc("APACHE_${dir}_ENABLED") } || "$confdir/$dir-enabled";
I, [2015-04-24T11:04:58.554646 #8666]  INFO -- default-precise32:     +my $statedir = $ENV{ uc("APACHE_STATE_DIRECTORY") } || "/usr/lib/apache2";
I, [2015-04-24T11:04:58.554668 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.554688 #8666]  INFO -- default-precise32:     +$statedir .= "/$obj";
I, [2015-04-24T11:04:58.554706 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.554724 #8666]  INFO -- default-precise32:     +my $choicedir = $act eq 'enable' ? $availdir : $enabldir;
I, [2015-04-24T11:04:58.554743 #8666]  INFO -- default-precise32:     +my $linkdir = File::Spec->abs2rel( $availdir, $enabldir );
I, [2015-04-24T11:04:58.554761 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.554779 #8666]  INFO -- default-precise32:     +my $request_reload = 0;
I, [2015-04-24T11:04:58.554805 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.554825 #8666]  INFO -- default-precise32:     +my $rc = 0;
I, [2015-04-24T11:04:58.554843 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.554862 #8666]  INFO -- default-precise32:     +if ( !scalar @ARGV ) {
I, [2015-04-24T11:04:58.554880 #8666]  INFO -- default-precise32:     +    my @choices = myglob('*');
I, [2015-04-24T11:04:58.554899 #8666]  INFO -- default-precise32:     +    print "Your choices are: @choices\n";
I, [2015-04-24T11:04:58.554917 #8666]  INFO -- default-precise32:     +    print "Which ${obj}(s) do you want to $act (wildcards ok)?\n";
I, [2015-04-24T11:04:58.554936 #8666]  INFO -- default-precise32:     +    my $input = <>;
I, [2015-04-24T11:04:58.554955 #8666]  INFO -- default-precise32:     +    @ARGV = split /\s+/, $input;
I, [2015-04-24T11:04:58.554973 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.554991 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.555020 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.555040 #8666]  INFO -- default-precise32:     +my @objs;
I, [2015-04-24T11:04:58.555058 #8666]  INFO -- default-precise32:     +foreach my $arg (@ARGV) {
I, [2015-04-24T11:04:58.555077 #8666]  INFO -- default-precise32:     +    $arg =~ s/${sffx}$//;
I, [2015-04-24T11:04:58.555113 #8666]  INFO -- default-precise32:     +    my @glob = myglob($arg);
I, [2015-04-24T11:04:58.555133 #8666]  INFO -- default-precise32:     +    if ( !@glob ) {
I, [2015-04-24T11:04:58.555152 #8666]  INFO -- default-precise32:     +        error("No $obj found matching $arg!\n");
I, [2015-04-24T11:04:58.555171 #8666]  INFO -- default-precise32:     +        $rc = 1;
I, [2015-04-24T11:04:58.555189 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.555207 #8666]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:04:58.555226 #8666]  INFO -- default-precise32:     +        push @objs, @glob;
I, [2015-04-24T11:04:58.555244 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.555262 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.555289 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.555308 #8666]  INFO -- default-precise32:     +foreach my $acton (@objs) {
I, [2015-04-24T11:04:58.555327 #8666]  INFO -- default-precise32:     +    doit($acton) or $rc = 1;
I, [2015-04-24T11:04:58.555345 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.555363 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.555381 #8666]  INFO -- default-precise32:     +info(
I, [2015-04-24T11:04:58.555399 #8666]  INFO -- default-precise32:     +    "To activate the new configuration, you need to run:\n  service apache2 $reload\n"
I, [2015-04-24T11:04:58.555418 #8666]  INFO -- default-precise32:     +) if $request_reload;
I, [2015-04-24T11:04:58.555436 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.555454 #8666]  INFO -- default-precise32:     +exit($rc);
I, [2015-04-24T11:04:58.555472 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.555503 #8666]  INFO -- default-precise32:     +##############################################################################
I, [2015-04-24T11:04:58.555527 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.555545 #8666]  INFO -- default-precise32:     +sub myglob {
I, [2015-04-24T11:04:58.555564 #8666]  INFO -- default-precise32:     +    my $arg = shift;
I, [2015-04-24T11:04:58.555588 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.555607 #8666]  INFO -- default-precise32:     +    my @glob = map {
I, [2015-04-24T11:04:58.555626 #8666]  INFO -- default-precise32:     +        s{^$choicedir/}{};
I, [2015-04-24T11:04:58.555644 #8666]  INFO -- default-precise32:     +        s{$sffx$}{};
I, [2015-04-24T11:04:58.555663 #8666]  INFO -- default-precise32:     +        $_
I, [2015-04-24T11:04:58.555682 #8666]  INFO -- default-precise32:     +    } glob("$choicedir/$arg$sffx");
I, [2015-04-24T11:04:58.555700 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.555718 #8666]  INFO -- default-precise32:     +    return @glob;
I, [2015-04-24T11:04:58.555736 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.555763 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.555782 #8666]  INFO -- default-precise32:     +sub doit {
I, [2015-04-24T11:04:58.555818 #8666]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:04:58.555837 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.555855 #8666]  INFO -- default-precise32:     +    my ( $conftgt, $conflink );
I, [2015-04-24T11:04:58.555874 #8666]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:04:58.555893 #8666]  INFO -- default-precise32:     +        if ( $acton eq 'cgi' && threaded() ) {
I, [2015-04-24T11:04:58.555912 #8666]  INFO -- default-precise32:     +            print
I, [2015-04-24T11:04:58.555931 #8666]  INFO -- default-precise32:     +                "Your MPM seems to be threaded. Selecting cgid instead of cgi.\n";
I, [2015-04-24T11:04:58.555950 #8666]  INFO -- default-precise32:     +            $acton = 'cgid';
I, [2015-04-24T11:04:58.555968 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.555986 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.556015 #8666]  INFO -- default-precise32:     +        $conftgt = "$availdir/$acton.conf";
I, [2015-04-24T11:04:58.556036 #8666]  INFO -- default-precise32:     +        if ( -e $conftgt ) {
I, [2015-04-24T11:04:58.556055 #8666]  INFO -- default-precise32:     +            $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:04:58.556074 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.556092 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.556110 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.556128 #8666]  INFO -- default-precise32:     +    my $tgt  = "$availdir/$acton$sffx";
I, [2015-04-24T11:04:58.556147 #8666]  INFO -- default-precise32:     +    my $link = "$enabldir/$acton$sffx";
I, [2015-04-24T11:04:58.556164 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.556182 #8666]  INFO -- default-precise32:     +    if ( !-e $tgt ) {
I, [2015-04-24T11:04:58.556201 #8666]  INFO -- default-precise32:     +        if ( -l $link && !-e $link ) {
I, [2015-04-24T11:04:58.556228 #8666]  INFO -- default-precise32:     +            if ( $act eq 'disable' ) {
I, [2015-04-24T11:04:58.556249 #8666]  INFO -- default-precise32:     +                info("removing dangling symlink $link\n");
I, [2015-04-24T11:04:58.556268 #8666]  INFO -- default-precise32:     +                unlink($link);
I, [2015-04-24T11:04:58.556286 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.556305 #8666]  INFO -- default-precise32:     +                # force a .conf path. It may exist as dangling link, too
I, [2015-04-24T11:04:58.556325 #8666]  INFO -- default-precise32:     +                $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:04:58.556363 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.556387 #8666]  INFO -- default-precise32:     +                if ( -l $conflink && !-e $conflink ) {
I, [2015-04-24T11:04:58.556407 #8666]  INFO -- default-precise32:     +                    info("removing dangling symlink $conflink\n");
I, [2015-04-24T11:04:58.556426 #8666]  INFO -- default-precise32:     +                    unlink($conflink);
I, [2015-04-24T11:04:58.556445 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:58.556463 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.556481 #8666]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:04:58.556500 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:58.556519 #8666]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:04:58.556538 #8666]  INFO -- default-precise32:     +                error("$link is a dangling symlink!\n");
I, [2015-04-24T11:04:58.556556 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:58.556581 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.556600 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.556619 #8666]  INFO -- default-precise32:     +        if ( $purge ) {
I, [2015-04-24T11:04:58.556638 #8666]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:58.556657 #8666]  INFO -- default-precise32:     +            # exit silently, we are purging anyway
I, [2015-04-24T11:04:58.558397 #8666]  INFO -- default-precise32:       return 1;
I, [2015-04-24T11:04:58.558426 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.558445 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.558464 #8666]  INFO -- default-precise32:     +        error("$name $acton does not exist!\n");
I, [2015-04-24T11:04:58.558483 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:58.558501 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.558519 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.558537 #8666]  INFO -- default-precise32:     +    # handle module dependencies
I, [2015-04-24T11:04:58.558555 #8666]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:04:58.558593 #8666]  INFO -- default-precise32:     +        if ( $act eq 'enable' ) {
I, [2015-04-24T11:04:58.558617 #8666]  INFO -- default-precise32:     +            if ( $acton eq 'mpm_itk' ) {
I, [2015-04-24T11:04:58.558636 #8666]  INFO -- default-precise32:     +                warning(  "MPM_ITK is a third party module that is not part "
I, [2015-04-24T11:04:58.558656 #8666]  INFO -- default-precise32:     +                        . "of the official Apache HTTPD. It has seen less "
I, [2015-04-24T11:04:58.558675 #8666]  INFO -- default-precise32:     +                        . "testing than the official MPM modules." );
I, [2015-04-24T11:04:58.558693 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:58.558712 #8666]  INFO -- default-precise32:     +            my @depends = get_deps("$availdir/$acton.load");
I, [2015-04-24T11:04:58.558731 #8666]  INFO -- default-precise32:     +            do_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:04:58.558749 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.558767 #8666]  INFO -- default-precise32:     +            my @conflicts = get_deps( "$availdir/$acton.load", "Conflicts" );
I, [2015-04-24T11:04:58.558786 #8666]  INFO -- default-precise32:     +            check_conflicts( $acton, @conflicts ) or return 0;
I, [2015-04-24T11:04:58.558804 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.558822 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:58.558841 #8666]  INFO -- default-precise32:     +            my @depending;
I, [2015-04-24T11:04:58.558859 #8666]  INFO -- default-precise32:     +            foreach my $d ( glob("$enabldir/*.load") ) {
I, [2015-04-24T11:04:58.558878 #8666]  INFO -- default-precise32:     +                my @deps = get_deps($d);
I, [2015-04-24T11:04:58.558902 #8666]  INFO -- default-precise32:     +                if ( is_in( $acton, @deps ) ) {
I, [2015-04-24T11:04:58.558934 #8666]  INFO -- default-precise32:     +                    $d =~ m,/([^/]+).load$,;
I, [2015-04-24T11:04:58.558953 #8666]  INFO -- default-precise32:     +                    push @depending, $1;
I, [2015-04-24T11:04:58.558983 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:58.559037 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:58.559065 #8666]  INFO -- default-precise32:     +            if ( scalar @depending ) {
I, [2015-04-24T11:04:58.559085 #8666]  INFO -- default-precise32:     +                if ($force) {
I, [2015-04-24T11:04:58.559104 #8666]  INFO -- default-precise32:     +                    do_deps( $acton, @depending ) or return 0;
I, [2015-04-24T11:04:58.559122 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:58.559140 #8666]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:04:58.559159 #8666]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:04:58.559177 #8666]  INFO -- default-precise32:     +                        "The following modules depend on $acton ",
I, [2015-04-24T11:04:58.559208 #8666]  INFO -- default-precise32:     +                        "and need to be disabled first: @depending\n"
I, [2015-04-24T11:04:58.559239 #8666]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:04:58.559258 #8666]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:04:58.559276 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:58.559294 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:58.559312 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.559330 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.559348 #8666]  INFO -- default-precise32:     +    elsif ( $act eq 'enable' ) {
I, [2015-04-24T11:04:58.559366 #8666]  INFO -- default-precise32:     +        my @depends = get_deps("$availdir/$acton$sffx");
I, [2015-04-24T11:04:58.559385 #8666]  INFO -- default-precise32:     +        warn_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:04:58.559403 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.559421 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.560129 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:58.560329 #8666]  INFO -- default-precise32:     +        my $check = check_link( $tgt, $link );
I, [2015-04-24T11:04:58.560556 #8666]  INFO -- default-precise32:     +        if ( $check eq 'ok' ) {
I, [2015-04-24T11:04:58.593403 #8666]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:04:58.593708 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.593925 #8666]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:04:58.594146 #8666]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:04:58.594357 #8666]  INFO -- default-precise32:     +                if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:04:58.595646 #8666]  INFO -- default-precise32:     +                    info("$name $acton already enabled\n");
I, [2015-04-24T11:04:58.595854 #8666]  INFO -- default-precise32:     +                    return 1;
I, [2015-04-24T11:04:58.596088 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:58.596300 #8666]  INFO -- default-precise32:     +                elsif ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:04:58.596546 #8666]  INFO -- default-precise32:     +                    print "Enabling config file $acton.conf.\n";
I, [2015-04-24T11:04:58.596801 #8666]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:04:58.597017 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:58.597237 #8666]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:04:58.597438 #8666]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:04:58.597654 #8666]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:04:58.597842 #8666]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:04:58.598101 #8666]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:04:58.598205 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:58.598248 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:58.598268 #8666]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:04:58.598288 #8666]  INFO -- default-precise32:     +                info("$name $acton already enabled\n");
I, [2015-04-24T11:04:58.598308 #8666]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:04:58.598326 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:58.598355 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.598375 #8666]  INFO -- default-precise32:     +        elsif ( $check eq 'missing' ) {
I, [2015-04-24T11:04:58.598558 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:58.598713 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.598912 #8666]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:04:58.599158 #8666]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:04:58.599184 #8666]  INFO -- default-precise32:     +                if ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:04:58.599360 #8666]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:04:58.599476 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:58.599663 #8666]  INFO -- default-precise32:     +                elsif ( $confcheck ne 'ok' ) {
I, [2015-04-24T11:04:58.599831 #8666]  INFO -- default-precise32: +                    error(
I, [2015-04-24T11:04:58.599929 #8666]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:04:58.600128 #8666]  INFO -- default-precise32: +                    );
I, [2015-04-24T11:04:58.600329 #8666]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:04:58.633736 #8666]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:04:58.634022 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:58.634215 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.634243 #8666]  INFO -- default-precise32:     +            print "Enabling $obj $acton.\n";
I, [2015-04-24T11:04:58.634311 #8666]  INFO -- default-precise32:     +            if ( $acton eq 'ssl' ) {
I, [2015-04-24T11:04:58.634340 #8666]  INFO -- default-precise32:     +                info(     "See /usr/share/doc/apache2/README.Debian.gz on "
I, [2015-04-24T11:04:58.634360 #8666]  INFO -- default-precise32:     +                        . "how to configure SSL and create self-signed certificates.\n"
I, [2015-04-24T11:04:58.634380 #8666]  INFO -- default-precise32:     +                );
I, [2015-04-24T11:04:58.634399 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:58.634430 #8666]  INFO -- default-precise32:     +            return add_link( $tgt, $link )
I, [2015-04-24T11:04:58.634450 #8666]  INFO -- default-precise32:     +                && switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:58.634481 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.634499 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:58.634518 #8666]  INFO -- default-precise32:     +            error("$name $acton not properly enabled: $check\n");
I, [2015-04-24T11:04:58.634543 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:58.634563 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.634581 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.634599 #8666]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:04:58.634617 #8666]  INFO -- default-precise32:     +        if ( -e $link || -l $link ) {
I, [2015-04-24T11:04:58.634636 #8666]  INFO -- default-precise32:     +            remove_link($link);
I, [2015-04-24T11:04:58.634674 #8666]  INFO -- default-precise32:     +            if ( $conflink && -e $conflink ) {
I, [2015-04-24T11:04:58.634693 #8666]  INFO -- default-precise32:     +                remove_link($conflink);
I, [2015-04-24T11:04:58.634712 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:58.634730 #8666]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:58.634749 #8666]  INFO -- default-precise32:     +            print "$name $acton disabled.\n";
I, [2015-04-24T11:04:58.634768 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.634786 #8666]  INFO -- default-precise32:     +        elsif ( $conflink && -e $conflink ) {
I, [2015-04-24T11:04:58.634805 #8666]  INFO -- default-precise32:     +            print "Disabling stale config file $acton.conf.\n";
I, [2015-04-24T11:04:58.634823 #8666]  INFO -- default-precise32:     +            remove_link($conflink);
I, [2015-04-24T11:04:58.634842 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.634860 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:58.634879 #8666]  INFO -- default-precise32:     +            info("$name $acton already disabled\n");
I, [2015-04-24T11:04:58.634898 #8666]  INFO -- default-precise32:     +            if ( $purge ) {
I, [2015-04-24T11:04:58.634916 #8666]  INFO -- default-precise32:     +                switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:04:58.634935 #8666]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:04:58.634953 #8666]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:04:58.634972 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.634990 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.635008 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.635025 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:58.635044 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.635062 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.635079 #8666]  INFO -- default-precise32:     +sub get_deps {
I, [2015-04-24T11:04:58.635098 #8666]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:04:58.635116 #8666]  INFO -- default-precise32:     +    my $type = shift || "Depends";
I, [2015-04-24T11:04:58.635133 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.635163 #8666]  INFO -- default-precise32:     +    my $fd;
I, [2015-04-24T11:04:58.635182 #8666]  INFO -- default-precise32:     +    if ( !open( $fd, '<', $file ) ) {
I, [2015-04-24T11:04:58.635212 #8666]  INFO -- default-precise32:     +        error("Can't open $file: $!");
I, [2015-04-24T11:04:58.635230 #8666]  INFO -- default-precise32:     +        return;
I, [2015-04-24T11:04:58.635249 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.635279 #8666]  INFO -- default-precise32:     +    my $line;
I, [2015-04-24T11:04:58.635298 #8666]  INFO -- default-precise32:     +    while ( defined( $line = <$fd> ) ) {
I, [2015-04-24T11:04:58.635353 #8666]  INFO -- default-precise32:     +        chomp $line;
I, [2015-04-24T11:04:58.635384 #8666]  INFO -- default-precise32:     +        if ( $line =~ /^# $type:\s+(.*?)\s*$/ ) {
I, [2015-04-24T11:04:58.635403 #8666]  INFO -- default-precise32:     +            my $deps = $1;
I, [2015-04-24T11:04:58.635444 #8666]  INFO -- default-precise32:     +            return split( /[\n\s]+/, $deps );
I, [2015-04-24T11:04:58.635480 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.635511 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.635530 #8666]  INFO -- default-precise32:     +        # only check until the first non-empty non-comment line
I, [2015-04-24T11:04:58.635549 #8666]  INFO -- default-precise32:     +        last if ( $line !~ /^\s*(?:#.*)?$/ );
I, [2015-04-24T11:04:58.635568 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.635586 #8666]  INFO -- default-precise32:     +    return;
I, [2015-04-24T11:04:58.635605 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.635623 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.635641 #8666]  INFO -- default-precise32:     +sub do_deps {
I, [2015-04-24T11:04:58.635660 #8666]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:04:58.635679 #8666]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:04:58.635698 #8666]  INFO -- default-precise32:     +        info("Considering dependency $d for $acton:\n");
I, [2015-04-24T11:04:58.635717 #8666]  INFO -- default-precise32:     +        if ( !doit($d) ) {
I, [2015-04-24T11:04:58.635736 #8666]  INFO -- default-precise32:     +            error("Could not $act dependency $d for $acton, aborting\n");
I, [2015-04-24T11:04:58.635756 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:58.635775 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.635793 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.635812 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:58.635830 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.635848 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.635866 #8666]  INFO -- default-precise32:     +sub warn_deps {
I, [2015-04-24T11:04:58.635885 #8666]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:04:58.635903 #8666]  INFO -- default-precise32:     +    my $modsenabldir = $ENV{APACHE_MODS_ENABLED} || "$confdir/mods-enabled";
I, [2015-04-24T11:04:58.635922 #8666]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:04:58.635941 #8666]  INFO -- default-precise32:     +        info("Checking dependency $d for $acton:\n");
I, [2015-04-24T11:04:58.635961 #8666]  INFO -- default-precise32:     +        if ( !-e "$modsenabldir/$d.load" ) {
I, [2015-04-24T11:04:58.635980 #8666]  INFO -- default-precise32:     +            warning(
I, [2015-04-24T11:04:58.636018 #8666]  INFO -- default-precise32:     +                "Module $d is not enabled, but $acton depends on it, aborting\n"
I, [2015-04-24T11:04:58.636039 #8666]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:04:58.636058 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:58.636076 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.636095 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.636113 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:58.636131 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.636149 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.636167 #8666]  INFO -- default-precise32:     +sub check_conflicts {
I, [2015-04-24T11:04:58.636186 #8666]  INFO -- default-precise32:     +    my $acton    = shift;
I, [2015-04-24T11:04:58.636204 #8666]  INFO -- default-precise32:     +    my $haderror = 0;
I, [2015-04-24T11:04:58.636223 #8666]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:04:58.636242 #8666]  INFO -- default-precise32:     +        info("Considering conflict $d for $acton:\n");
I, [2015-04-24T11:04:58.636332 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.636357 #8666]  INFO -- default-precise32:     +        my $tgt  = "$availdir/$d$sffx";
I, [2015-04-24T11:04:58.636376 #8666]  INFO -- default-precise32:     +        my $link = "$enabldir/$d$sffx";
I, [2015-04-24T11:04:58.636398 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.636418 #8666]  INFO -- default-precise32:     +        my $confcheck = check_link( $tgt, $link );
I, [2015-04-24T11:04:58.636438 #8666]  INFO -- default-precise32:     +        if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:04:58.636457 #8666]  INFO -- default-precise32:     +            error(
I, [2015-04-24T11:04:58.636476 #8666]  INFO -- default-precise32:     +                "Module $d is enabled - cannot proceed due to conflicts. It needs to be disabled first!\n"
I, [2015-04-24T11:04:58.636495 #8666]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:04:58.636514 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.636533 #8666]  INFO -- default-precise32:     +            # Don't return immediately, there could be several conflicts
I, [2015-04-24T11:04:58.636552 #8666]  INFO -- default-precise32:     +            $haderror++;
I, [2015-04-24T11:04:58.636571 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.636589 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.636608 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.636626 #8666]  INFO -- default-precise32:     +    if ($haderror) {
I, [2015-04-24T11:04:58.636644 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:58.636663 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.636681 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.636716 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:58.636735 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.636753 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.636772 #8666]  INFO -- default-precise32:     +sub add_link {
I, [2015-04-24T11:04:58.636790 #8666]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:04:58.636808 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.636827 #8666]  INFO -- default-precise32:     +    # create relative link
I, [2015-04-24T11:04:58.636846 #8666]  INFO -- default-precise32:     +    if ( !symlink( File::Spec->abs2rel( $tgt, dirname($link) ), $link ) ) {
I, [2015-04-24T11:04:58.636875 #8666]  INFO -- default-precise32:     +        die("Could not create $link: $!\n");
I, [2015-04-24T11:04:58.636895 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.636914 #8666]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:04:58.636932 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:58.636950 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.636968 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.636986 #8666]  INFO -- default-precise32:     +sub check_link {
I, [2015-04-24T11:04:58.637005 #8666]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:04:58.637023 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.638622 #8666]  INFO -- default-precise32:     +    if ( !-e $link ) {
I, [2015-04-24T11:04:58.638685 #8666]  INFO -- default-precise32:     +        if ( -l $link ) {
I, [2015-04-24T11:04:58.638706 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.638726 #8666]  INFO -- default-precise32:     +            # points to nowhere
I, [2015-04-24T11:04:58.638745 #8666]  INFO -- default-precise32:     +            info("Removing dangling link $link");
I, [2015-04-24T11:04:58.638779 #8666]  INFO -- default-precise32:     +            unlink($link) or die "Could not remove $link\n";
I, [2015-04-24T11:04:58.638800 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.638819 #8666]  INFO -- default-precise32:     +        return 'missing';
I, [2015-04-24T11:04:58.638837 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.638855 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.638873 #8666]  INFO -- default-precise32:     +    if ( -e $link && !-l $link ) {
I, [2015-04-24T11:04:58.638896 #8666]  INFO -- default-precise32:     +        return "$link is a real file, not touching it";
I, [2015-04-24T11:04:58.638916 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.638935 #8666]  INFO -- default-precise32:     +    if ( realpath($link) ne realpath($tgt) ) {
I, [2015-04-24T11:04:58.638954 #8666]  INFO -- default-precise32:     +        return "$link exists but does not point to $tgt, not touching it";
I, [2015-04-24T11:04:58.638973 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.638991 #8666]  INFO -- default-precise32:     +    return 'ok';
I, [2015-04-24T11:04:58.639010 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.639028 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.639047 #8666]  INFO -- default-precise32:     +sub remove_link {
I, [2015-04-24T11:04:58.639096 #8666]  INFO -- default-precise32:     +    my ($link) = @_;
I, [2015-04-24T11:04:58.639119 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.639138 #8666]  INFO -- default-precise32:     +    if ( -l $link ) {
I, [2015-04-24T11:04:58.639157 #8666]  INFO -- default-precise32:     +        unlink($link) or die "Could not remove $link: $!\n";
I, [2015-04-24T11:04:58.639176 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.639232 #8666]  INFO -- default-precise32:     +    elsif ( -e $link ) {
I, [2015-04-24T11:04:58.639266 #8666]  INFO -- default-precise32:     +        error("$link is not a symbolic link, not deleting\n");
I, [2015-04-24T11:04:58.639289 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:58.639389 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.639425 #8666]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:04:58.639443 #8666]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:04:58.639462 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.639480 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.639498 #8666]  INFO -- default-precise32:     +sub threaded {
I, [2015-04-24T11:04:58.639516 #8666]  INFO -- default-precise32:     +    my $result = "";
I, [2015-04-24T11:04:58.639534 #8666]  INFO -- default-precise32:     +    $result = qx{/usr/sbin/apache2ctl -V | grep 'threaded'}
I, [2015-04-24T11:04:58.639553 #8666]  INFO -- default-precise32:     +        if -x '/usr/sbin/apache2ctl';
I, [2015-04-24T11:04:58.639577 #8666]  INFO -- default-precise32:     +    if ( $? != 0 ) {
I, [2015-04-24T11:04:58.639596 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.639615 #8666]  INFO -- default-precise32:     +        # config doesn't work
I, [2015-04-24T11:04:58.639634 #8666]  INFO -- default-precise32:     +        if ( -e "$enabldir/mpm_prefork.load" || -e "$enabldir/mpm_itk.load" )
I, [2015-04-24T11:04:58.639653 #8666]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:04:58.639671 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:58.639690 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.639708 #8666]  INFO -- default-precise32:     +        elsif (-e "$enabldir/mpm_worker.load"
I, [2015-04-24T11:04:58.639727 #8666]  INFO -- default-precise32:     +            || -e "$enabldir/mpm_event.load" )
I, [2015-04-24T11:04:58.639745 #8666]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:04:58.639774 #8666]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:04:58.639793 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.639812 #8666]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:04:58.639830 #8666]  INFO -- default-precise32:     +            error("Can't determine enabled MPM");
I, [2015-04-24T11:04:58.639849 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.639868 #8666]  INFO -- default-precise32:     +            # do what user requested
I, [2015-04-24T11:04:58.639890 #8666]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:04:58.639909 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.639927 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.639946 #8666]  INFO -- default-precise32:     +    if ( $result =~ / no/ ) {
I, [2015-04-24T11:04:58.639964 #8666]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:04:58.639982 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.640016 #8666]  INFO -- default-precise32:     +    elsif ( $result =~ / yes/ ) {
I, [2015-04-24T11:04:58.640036 #8666]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:04:58.640117 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.640137 #8666]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:04:58.640155 #8666]  INFO -- default-precise32:     +        die("Can't parse output from apache2ctl -V:\n$result\n");
I, [2015-04-24T11:04:58.640174 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.640191 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.640209 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.640239 #8666]  INFO -- default-precise32:     +sub info {
I, [2015-04-24T11:04:58.640268 #8666]  INFO -- default-precise32:     +    print @_ if !$quiet;
I, [2015-04-24T11:04:58.640288 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.640307 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.640331 #8666]  INFO -- default-precise32:     +sub error {
I, [2015-04-24T11:04:58.640351 #8666]  INFO -- default-precise32:     +    print STDERR 'ERROR: ', @_;
I, [2015-04-24T11:04:58.640370 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.640388 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.640406 #8666]  INFO -- default-precise32:     +sub warning {
I, [2015-04-24T11:04:58.640425 #8666]  INFO -- default-precise32:     +    print STDERR 'WARNING: ', @_;
I, [2015-04-24T11:04:58.640443 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.640460 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.640479 #8666]  INFO -- default-precise32:     +sub is_in {
I, [2015-04-24T11:04:58.640497 #8666]  INFO -- default-precise32:     +    my $needle = shift;
I, [2015-04-24T11:04:58.640516 #8666]  INFO -- default-precise32:     +    foreach my $e (@_) {
I, [2015-04-24T11:04:58.641540 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:58.641794 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.642002 #8666]  INFO -- default-precise32:     +    return 0;
I, [2015-04-24T11:04:58.642188 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.642445 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.642662 #8666]  INFO -- default-precise32:     +sub read_env_file {
I, [2015-04-24T11:04:58.642863 #8666]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:04:58.643059 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.643307 #8666]  INFO -- default-precise32:     +    -r $file or return;
I, [2015-04-24T11:04:58.643520 #8666]  INFO -- default-precise32:     +    my @lines = qx{env - sh -c '. $file && env'};
I, [2015-04-24T11:04:58.643785 #8666]  INFO -- default-precise32:     +    if ($?) {
I, [2015-04-24T11:04:58.644014 #8666]  INFO -- default-precise32:     +        die "Could not read $file\n";
I, [2015-04-24T11:04:58.644240 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.673357 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.673705 #8666]  INFO -- default-precise32:     +    foreach my $l (@lines) {
I, [2015-04-24T11:04:58.673913 #8666]  INFO -- default-precise32:     +        chomp $l;
I, [2015-04-24T11:04:58.674158 #8666]  INFO -- default-precise32:     +        $l =~ /^(.*)?=(.*)$/ or die "Could not parse $file\n";
I, [2015-04-24T11:04:58.674452 #8666]  INFO -- default-precise32:     +        $ENV{$1} = $2;
I, [2015-04-24T11:04:58.674669 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.674874 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.675061 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.675367 #8666]  INFO -- default-precise32:     +sub switch_marker {
I, [2015-04-24T11:04:58.675575 #8666]  INFO -- default-precise32:     +    die('usage: switch_marker([module|site|conf], [enable|disable], $name)')
I, [2015-04-24T11:04:58.675847 #8666]  INFO -- default-precise32:     +        if @_ != 3;
I, [2015-04-24T11:04:58.676064 #8666]  INFO -- default-precise32:     +    my $which = shift;
I, [2015-04-24T11:04:58.676248 #8666]  INFO -- default-precise32:     +    my $what  = shift;
I, [2015-04-24T11:04:58.676577 #8666]  INFO -- default-precise32:     +    my $name  = shift;
I, [2015-04-24T11:04:58.676766 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.676968 #8666]  INFO -- default-precise32:     +    my $mode = "admin";
I, [2015-04-24T11:04:58.677315 #8666]  INFO -- default-precise32:     +    $mode = "maint" if $maintmode;
I, [2015-04-24T11:04:58.677523 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.677729 #8666]  INFO -- default-precise32:     +    #print("switch_marker $which $what $name\n");
I, [2015-04-24T11:04:58.677936 #8666]  INFO -- default-precise32:     +    # TODO: get rid of the magic string(s)
I, [2015-04-24T11:04:58.680027 #8666]  INFO -- default-precise32:     +    my $state_marker_dir = "$statedir/$what" . "d" . "_by_$mode";
I, [2015-04-24T11:04:58.682183 #8666]  INFO -- default-precise32:     +    my $state_marker     = "$state_marker_dir/$name";
I, [2015-04-24T11:04:58.687966 #8666]  INFO -- default-precise32:     +    if ( !-d $state_marker_dir ) {
I, [2015-04-24T11:04:58.688216 #8666]  INFO -- default-precise32:     +        File::Path::mkpath("$state_marker_dir")
I, [2015-04-24T11:04:58.690198 #8666]  INFO -- default-precise32:     +            || error(
I, [2015-04-24T11:04:58.690229 #8666]  INFO -- default-precise32:     +            "Failed to create marker directory: '$state_marker_dir'\n");
I, [2015-04-24T11:04:58.691731 #8666]  INFO -- default-precise32: +    }
I, [2015-04-24T11:04:58.693735 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.695298 #8666]  INFO -- default-precise32: +    # XXX: swap find with perl alternative
I, [2015-04-24T11:04:58.697147 #8666]  INFO -- default-precise32:     +    my @markers = qx{find "$statedir" -type f -a -name "$name"};
I, [2015-04-24T11:04:58.699535 #8666]  INFO -- default-precise32:     +    chomp(@markers);
I, [2015-04-24T11:04:58.701750 #8666]  INFO -- default-precise32:     +    foreach (@markers) {
I, [2015-04-24T11:04:58.704616 #8666]  INFO -- default-precise32:     +        unless ( unlink $_ ) {
I, [2015-04-24T11:04:58.705221 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:58.706975 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.709533 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.711878 #8666]  INFO -- default-precise32:     +    unless ($purge) {
I, [2015-04-24T11:04:58.714180 #8666]  INFO -- default-precise32:     +        qx{touch "$state_marker"};
I, [2015-04-24T11:04:58.717674 #8666]  INFO -- default-precise32:     +        if ( $? != 0 ) {
I, [2015-04-24T11:04:58.718188 #8666]  INFO -- default-precise32: +            error("Failed to create marker '$state_marker'!\n") && return 0;
I, [2015-04-24T11:04:58.720722 #8666]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:04:58.722895 #8666]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:04:58.728905 #8666]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:04:58.731242 #8666]  INFO -- default-precise32:     +}
I, [2015-04-24T11:04:58.733754 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.739132 #8666]  INFO -- default-precise32:     +# vim: syntax=perl sw=4 sts=4 sr et
I, [2015-04-24T11:04:58.741338 #8666]  INFO -- default-precise32:     - change mode from '' to '0700'
I, [2015-04-24T11:04:58.743337 #8666]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:04:58.747478 #8666]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:04:58.751601 #8666]  INFO -- default-precise32:   * directory[/etc/apache2/ssl] action create
I, [2015-04-24T11:04:58.756920 #8666]  INFO -- default-precise32:     - create new directory /etc/apache2/ssl
I, [2015-04-24T11:04:58.758942 #8666]  INFO -- default-precise32:     - change mode from '' to '0755'
I, [2015-04-24T11:04:58.761225 #8666]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:04:58.764220 #8666]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:04:58.777477 #8666]  INFO -- default-precise32:   * directory[/var/cache/apache2] action create
I, [2015-04-24T11:04:58.777807 #8666]  INFO -- default-precise32:     - change owner from 'www-data' to 'root'
I, [2015-04-24T11:04:58.781038 #8666]  INFO -- default-precise32:     - change group from 'www-data' to 'root'
I, [2015-04-24T11:04:58.789805 #8666]  INFO -- default-precise32:   * directory[/var/lock/apache2] action create (up to date)
I, [2015-04-24T11:04:58.792908 #8666]  INFO -- default-precise32:   * template[/etc/sysconfig/apache2] action create (skipped due to only_if)
I, [2015-04-24T11:04:58.807449 #8666]  INFO -- default-precise32:   * template[/etc/apache2/envvars] action create
I, [2015-04-24T11:04:58.810306 #8666]  INFO -- default-precise32:     - update content in file /etc/apache2/envvars from 57ed3f to ed0ad7
I, [2015-04-24T11:04:58.815116 #8666]  INFO -- default-precise32:     --- /etc/apache2/envvars	2012-02-07 04:16:59.000000000 +0000
I, [2015-04-24T11:04:58.821237 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-18t6xyf	2015-04-24 08:04:58.792685395 +0000
I, [2015-04-24T11:04:58.822788 #8666]  INFO -- default-precise32:     @@ -3,30 +3,22 @@
I, [2015-04-24T11:04:58.825247 #8666]  INFO -- default-precise32:      # this won't be correct after changing uid
I, [2015-04-24T11:04:58.827267 #8666]  INFO -- default-precise32:      unset HOME
I, [2015-04-24T11:04:58.828317 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:58.830297 #8666]  INFO -- default-precise32:     -# for supporting multiple apache2 instances
I, [2015-04-24T11:04:58.832467 #8666]  INFO -- default-precise32:     -if [ "${APACHE_CONFDIR##/etc/apache2-}" != "${APACHE_CONFDIR}" ] ; then
I, [2015-04-24T11:04:58.836792 #8666]  INFO -- default-precise32:     -	SUFFIX="-${APACHE_CONFDIR##/etc/apache2-}"
I, [2015-04-24T11:04:58.838273 #8666]  INFO -- default-precise32:     -else
I, [2015-04-24T11:04:58.841229 #8666]  INFO -- default-precise32:     -	SUFFIX=
I, [2015-04-24T11:04:58.843263 #8666]  INFO -- default-precise32:     -fi
I, [2015-04-24T11:04:58.845008 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:04:58.847269 #8666]  INFO -- default-precise32:      # Since there is no sane way to get the parsed apache2 config in scripts, some
I, [2015-04-24T11:04:58.849313 #8666]  INFO -- default-precise32:      # settings are defined via environment variables and then used in apache2ctl,
I, [2015-04-24T11:04:58.851244 #8666]  INFO -- default-precise32:      # /etc/init.d/apache2, /etc/logrotate.d/apache2, etc.
I, [2015-04-24T11:04:58.853147 #8666]  INFO -- default-precise32:      export APACHE_RUN_USER=www-data
I, [2015-04-24T11:04:58.855234 #8666]  INFO -- default-precise32:      export APACHE_RUN_GROUP=www-data
I, [2015-04-24T11:04:58.857278 #8666]  INFO -- default-precise32:     -export APACHE_PID_FILE=/var/run/apache2$SUFFIX.pid
I, [2015-04-24T11:04:58.857390 #8666]  INFO -- default-precise32:     -export APACHE_RUN_DIR=/var/run/apache2$SUFFIX
I, [2015-04-24T11:04:58.859295 #8666]  INFO -- default-precise32:     -export APACHE_LOCK_DIR=/var/lock/apache2$SUFFIX
I, [2015-04-24T11:04:58.860084 #8666]  INFO -- default-precise32: +# temporary state file location. This might be changed to /run in Wheezy+1
I, [2015-04-24T11:04:58.861014 #8666]  INFO -- default-precise32: +export APACHE_PID_FILE=/var/run/apache2.pid
I, [2015-04-24T11:04:58.865755 #8666]  INFO -- default-precise32:     +export APACHE_RUN_DIR=/var/run/apache2
I, [2015-04-24T11:04:58.868302 #8666]  INFO -- default-precise32:     +export APACHE_LOCK_DIR=/var/lock/apache2
I, [2015-04-24T11:04:58.868336 #8666]  INFO -- default-precise32:      # Only /var/log/apache2 is handled by /etc/logrotate.d/apache2.
I, [2015-04-24T11:04:58.868357 #8666]  INFO -- default-precise32:     -export APACHE_LOG_DIR=/var/log/apache2$SUFFIX
I, [2015-04-24T11:04:58.868375 #8666]  INFO -- default-precise32:     +export APACHE_LOG_DIR=/var/log/apache2
I, [2015-04-24T11:04:58.868393 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:58.868411 #8666]  INFO -- default-precise32:      ## The locale used by some modules like mod_dav
I, [2015-04-24T11:04:58.868429 #8666]  INFO -- default-precise32:      export LANG=C
I, [2015-04-24T11:04:58.868447 #8666]  INFO -- default-precise32:     -## Uncomment the following line to use the system default locale instead:
I, [2015-04-24T11:04:58.868465 #8666]  INFO -- default-precise32:     -#. /etc/default/locale
I, [2015-04-24T11:04:58.868483 #8666]  INFO -- default-precise32:     +export LC_ALL=C
I, [2015-04-24T11:04:58.868500 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:58.868518 #8666]  INFO -- default-precise32:     -export LANG
I, [2015-04-24T11:04:58.868535 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:58.868553 #8666]  INFO -- default-precise32:      ## The command to get the status for 'apache2ctl status'.
I, [2015-04-24T11:04:58.868577 #8666]  INFO -- default-precise32:      ## Some packages providing 'www-browser' need '--dump' instead of '-dump'.
I, [2015-04-24T11:04:58.868597 #8666]  INFO -- default-precise32:     @@ -35,4 +27,13 @@
I, [2015-04-24T11:04:58.868615 #8666]  INFO -- default-precise32:      ## If you need a higher file descriptor limit, uncomment and adjust the
I, [2015-04-24T11:04:58.868633 #8666]  INFO -- default-precise32:      ## following line (default is 8192):
I, [2015-04-24T11:04:58.868651 #8666]  INFO -- default-precise32:      #APACHE_ULIMIT_MAX_FILES='ulimit -n 65536'
I, [2015-04-24T11:04:58.868688 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.868708 #8666]  INFO -- default-precise32:     +## If you would like to pass arguments to the web server, add them below
I, [2015-04-24T11:04:58.868726 #8666]  INFO -- default-precise32:     +## to the APACHE_ARGUMENTS environment.
I, [2015-04-24T11:04:58.868744 #8666]  INFO -- default-precise32:     +#export APACHE_ARGUMENTS=''
I, [2015-04-24T11:04:58.868761 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:58.868779 #8666]  INFO -- default-precise32:     +## Enable the debug mode for maintainer scripts.
I, [2015-04-24T11:04:58.868798 #8666]  INFO -- default-precise32:     +## This will produce a verbose output on package installations of web server modules and web application
I, [2015-04-24T11:04:58.868816 #8666]  INFO -- default-precise32:     +## installations which interact with Apache
I, [2015-04-24T11:04:58.870264 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:58.890446 #8666]  INFO -- default-precise32:   * template[apache2.conf] action create
I, [2015-04-24T11:04:58.896596 #8666]  INFO -- default-precise32:     - update content in file /etc/apache2/apache2.conf from ad8601 to 9e43cc
I, [2015-04-24T11:04:58.902364 #8666]  INFO -- default-precise32:     --- /etc/apache2/apache2.conf	2012-02-07 04:16:59.000000000 +0000
I, [2015-04-24T11:04:58.906406 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-1w9hput	2015-04-24 08:04:58.872684389 +0000
I, [2015-04-24T11:04:58.909237 #8666]  INFO -- default-precise32:     @@ -1,65 +1,20 @@
I, [2015-04-24T11:04:58.910946 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:58.912419 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:58.913483 #8666]  INFO -- default-precise32: +# Generated by Chef
I, [2015-04-24T11:04:58.915924 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:58.918403 #8666]  INFO -- default-precise32:     -# This is the main Apache server configuration file.  It contains the
I, [2015-04-24T11:04:58.920511 #8666]  INFO -- default-precise32:     -# configuration directives that give the server its instructions.
I, [2015-04-24T11:04:58.926385 #8666]  INFO -- default-precise32:     -# See http://httpd.apache.org/docs/2.2/ for detailed information about
I, [2015-04-24T11:04:58.928964 #8666]  INFO -- default-precise32:     -# the directives.
I, [2015-04-24T11:04:58.931248 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:04:58.934094 #8666]  INFO -- default-precise32:     -# Do NOT simply read the instructions in here without understanding
I, [2015-04-24T11:04:58.935781 #8666]  INFO -- default-precise32:     -# what they do.  They're here only as hints or reminders.  If you are unsure
I, [2015-04-24T11:04:58.938390 #8666]  INFO -- default-precise32:     -# consult the online docs. You have been warned.  
I, [2015-04-24T11:04:58.941040 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:04:58.943452 #8666]  INFO -- default-precise32: -# The configuration directives are grouped into three basic sections:
I, [2015-04-24T11:04:58.944440 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:58.946117 #8666]  INFO -- default-precise32:     -#     whole (the 'global environment').
I, [2015-04-24T11:04:58.948717 #8666]  INFO -- default-precise32:     -#  2. Directives that define the parameters of the 'main' or 'default' server,
I, [2015-04-24T11:04:58.959139 #8666]  INFO -- default-precise32:     -#     which responds to requests that aren't handled by a virtual host.
I, [2015-04-24T11:04:58.959189 #8666]  INFO -- default-precise32:     -#     These directives also provide default values for the settings
I, [2015-04-24T11:04:58.959210 #8666]  INFO -- default-precise32:     -#     of all virtual hosts.
I, [2015-04-24T11:04:58.959229 #8666]  INFO -- default-precise32:     -#  3. Settings for virtual hosts, which allow Web requests to be sent to
I, [2015-04-24T11:04:58.959249 #8666]  INFO -- default-precise32:     -#     different IP addresses or hostnames and have them handled by the
I, [2015-04-24T11:04:58.959283 #8666]  INFO -- default-precise32:     -#     same Apache server process.
I, [2015-04-24T11:04:58.959301 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:04:58.959319 #8666]  INFO -- default-precise32:     -# Configuration and logfile names: If the filenames you specify for many
I, [2015-04-24T11:04:58.960434 #8666]  INFO -- default-precise32: -# of the server's control files begin with "/" (or "drive:/" for Win32), the
I, [2015-04-24T11:04:58.962461 #8666]  INFO -- default-precise32:     -# server will use that explicit path.  If the filenames do *not* begin
I, [2015-04-24T11:04:58.962667 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:04:58.965003 #8666]  INFO -- default-precise32:     -# with ServerRoot set to "/etc/apache2" will be interpreted by the
I, [2015-04-24T11:04:58.967411 #8666]  INFO -- default-precise32:     -# server as "/etc/apache2/foo.log".
I, [2015-04-24T11:04:58.969297 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:04:58.971425 #8666]  INFO -- default-precise32:     +# Based on the Ubuntu apache2.conf
I, [2015-04-24T11:04:58.974448 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:58.977048 #8666]  INFO -- default-precise32:     -### Section 1: Global Environment
I, [2015-04-24T11:04:58.979412 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:04:58.985433 #8666]  INFO -- default-precise32:     -# The directives in this section affect the overall operation of Apache,
I, [2015-04-24T11:04:58.987352 #8666]  INFO -- default-precise32:     -# such as the number of concurrent requests it can handle or where it
I, [2015-04-24T11:04:58.989888 #8666]  INFO -- default-precise32:     -# can find its configuration files.
I, [2015-04-24T11:04:58.992409 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:04:58.995035 #8666]  INFO -- default-precise32:     +ServerRoot "/etc/apache2"
I, [2015-04-24T11:04:58.997420 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:59.000207 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:59.000240 #8666]  INFO -- default-precise32:     -# ServerRoot: The top of the directory tree under which the server's
I, [2015-04-24T11:04:59.009981 #8666]  INFO -- default-precise32:     -# configuration, error, and log files are kept.
I, [2015-04-24T11:04:59.013377 #8666]  INFO -- default-precise32: -#
I, [2015-04-24T11:04:59.013441 #8666]  INFO -- default-precise32:     -# NOTE!  If you intend to place this on an NFS (or otherwise network)
I, [2015-04-24T11:04:59.013471 #8666]  INFO -- default-precise32:     -# mounted filesystem then please read the LockFile documentation (available
I, [2015-04-24T11:04:59.013492 #8666]  INFO -- default-precise32:     -# at <URL:http://httpd.apache.org/docs/2.2/mod/mpm_common.html#lockfile>);
I, [2015-04-24T11:04:59.013511 #8666]  INFO -- default-precise32:     -# you will save yourself a lot of trouble.
I, [2015-04-24T11:04:59.013529 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:04:59.013814 #8666]  INFO -- default-precise32: -# Do NOT add a slash at the end of the directory path.
I, [2015-04-24T11:04:59.016899 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:04:59.019329 #8666]  INFO -- default-precise32:     -#ServerRoot "/etc/apache2"
I, [2015-04-24T11:04:59.021930 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:04:59.024133 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:04:59.026713 #8666]  INFO -- default-precise32:      # The accept serialization lock file MUST BE STORED ON A LOCAL DISK.
I, [2015-04-24T11:04:59.029163 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:59.031891 #8666]  INFO -- default-precise32:     -LockFile ${APACHE_LOCK_DIR}/accept.lock
I, [2015-04-24T11:04:59.034092 #8666]  INFO -- default-precise32:     +LockFile /var/lock/apache2/accept.lock
I, [2015-04-24T11:04:59.037037 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:59.039175 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:59.042186 #8666]  INFO -- default-precise32:      # PidFile: The file in which the server should record its process
I, [2015-04-24T11:04:59.045210 #8666]  INFO -- default-precise32:      # identification number when it starts.
I, [2015-04-24T11:04:59.047302 #8666]  INFO -- default-precise32:     -# This needs to be set in /etc/apache2/envvars
I, [2015-04-24T11:04:59.049967 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:59.052208 #8666]  INFO -- default-precise32:     -PidFile ${APACHE_PID_FILE}
I, [2015-04-24T11:04:59.054181 #8666]  INFO -- default-precise32:     +PidFile /var/run/apache2.pid
I, [2015-04-24T11:04:59.056470 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:59.058296 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:59.060911 #8666]  INFO -- default-precise32:      # Timeout: The number of seconds before receives and sends time out.
I, [2015-04-24T11:04:59.063191 #8666]  INFO -- default-precise32:     @@ -85,65 +40,12 @@
I, [2015-04-24T11:04:59.065911 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:59.067958 #8666]  INFO -- default-precise32:      KeepAliveTimeout 5
I, [2015-04-24T11:04:59.070803 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:59.073439 #8666]  INFO -- default-precise32:     -##
I, [2015-04-24T11:04:59.076181 #8666]  INFO -- default-precise32:     -## Server-Pool Size Regulation (MPM specific)
I, [2015-04-24T11:04:59.078964 #8666]  INFO -- default-precise32:     -## 
I, [2015-04-24T11:04:59.081568 #8666]  INFO -- default-precise32:     +#<IfModule unixd_module>
I, [2015-04-24T11:04:59.084132 #8666]  INFO -- default-precise32:     +User www-data
I, [2015-04-24T11:04:59.086179 #8666]  INFO -- default-precise32:     +Group www-data
I, [2015-04-24T11:04:59.088768 #8666]  INFO -- default-precise32:     +#</IfModule>
I, [2015-04-24T11:04:59.091125 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:59.093623 #8666]  INFO -- default-precise32:     -# prefork MPM
I, [2015-04-24T11:04:59.095934 #8666]  INFO -- default-precise32:     -# StartServers: number of server processes to start
I, [2015-04-24T11:04:59.098240 #8666]  INFO -- default-precise32:     -# MinSpareServers: minimum number of server processes which are kept spare
I, [2015-04-24T11:04:59.100900 #8666]  INFO -- default-precise32:     -# MaxSpareServers: maximum number of server processes which are kept spare
I, [2015-04-24T11:04:59.103453 #8666]  INFO -- default-precise32:     -# MaxClients: maximum number of server processes allowed to start
I, [2015-04-24T11:04:59.106153 #8666]  INFO -- default-precise32:     -# MaxRequestsPerChild: maximum number of requests a server process serves
I, [2015-04-24T11:04:59.109033 #8666]  INFO -- default-precise32:     -<IfModule mpm_prefork_module>
I, [2015-04-24T11:04:59.111678 #8666]  INFO -- default-precise32:     -    StartServers          5
I, [2015-04-24T11:04:59.114189 #8666]  INFO -- default-precise32:     -    MinSpareServers       5
I, [2015-04-24T11:04:59.116919 #8666]  INFO -- default-precise32:     -    MaxSpareServers      10
I, [2015-04-24T11:04:59.119159 #8666]  INFO -- default-precise32:     -    MaxClients          150
I, [2015-04-24T11:04:59.122516 #8666]  INFO -- default-precise32:     -    MaxRequestsPerChild   0
I, [2015-04-24T11:04:59.125191 #8666]  INFO -- default-precise32:     -</IfModule>
I, [2015-04-24T11:04:59.127162 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:59.129983 #8666]  INFO -- default-precise32:     -# worker MPM
I, [2015-04-24T11:04:59.132685 #8666]  INFO -- default-precise32:     -# StartServers: initial number of server processes to start
I, [2015-04-24T11:04:59.134967 #8666]  INFO -- default-precise32:     -# MinSpareThreads: minimum number of worker threads which are kept spare
I, [2015-04-24T11:04:59.137788 #8666]  INFO -- default-precise32:     -# MaxSpareThreads: maximum number of worker threads which are kept spare
I, [2015-04-24T11:04:59.140550 #8666]  INFO -- default-precise32:     -# ThreadLimit: ThreadsPerChild can be changed to this maximum value during a
I, [2015-04-24T11:04:59.143175 #8666]  INFO -- default-precise32:     -#              graceful restart. ThreadLimit can only be changed by stopping
I, [2015-04-24T11:04:59.145928 #8666]  INFO -- default-precise32:     -#              and starting Apache.
I, [2015-04-24T11:04:59.148523 #8666]  INFO -- default-precise32:     -# ThreadsPerChild: constant number of worker threads in each server process
I, [2015-04-24T11:04:59.150922 #8666]  INFO -- default-precise32:     -# MaxClients: maximum number of simultaneous client connections
I, [2015-04-24T11:04:59.153158 #8666]  INFO -- default-precise32:     -# MaxRequestsPerChild: maximum number of requests a server process serves
I, [2015-04-24T11:04:59.155631 #8666]  INFO -- default-precise32:     -<IfModule mpm_worker_module>
I, [2015-04-24T11:04:59.158070 #8666]  INFO -- default-precise32:     -    StartServers          2
I, [2015-04-24T11:04:59.160696 #8666]  INFO -- default-precise32:     -    MinSpareThreads      25
I, [2015-04-24T11:04:59.163430 #8666]  INFO -- default-precise32:     -    MaxSpareThreads      75 
I, [2015-04-24T11:04:59.165978 #8666]  INFO -- default-precise32:     -    ThreadLimit          64
I, [2015-04-24T11:04:59.168515 #8666]  INFO -- default-precise32:     -    ThreadsPerChild      25
I, [2015-04-24T11:04:59.170867 #8666]  INFO -- default-precise32:     -    MaxClients          150
I, [2015-04-24T11:04:59.173623 #8666]  INFO -- default-precise32:     -    MaxRequestsPerChild   0
I, [2015-04-24T11:04:59.176171 #8666]  INFO -- default-precise32:     -</IfModule>
I, [2015-04-24T11:04:59.178802 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:04:59.181544 #8666]  INFO -- default-precise32:     -# event MPM
I, [2015-04-24T11:04:59.184076 #8666]  INFO -- default-precise32:     -# StartServers: initial number of server processes to start
I, [2015-04-24T11:04:59.186164 #8666]  INFO -- default-precise32:     -# MinSpareThreads: minimum number of worker threads which are kept spare
I, [2015-04-24T11:04:59.188995 #8666]  INFO -- default-precise32:     -# MaxSpareThreads: maximum number of worker threads which are kept spare
I, [2015-04-24T11:04:59.191341 #8666]  INFO -- default-precise32:     -# ThreadsPerChild: constant number of worker threads in each server process
I, [2015-04-24T11:04:59.194081 #8666]  INFO -- default-precise32:     -# MaxClients: maximum number of simultaneous client connections
I, [2015-04-24T11:04:59.196774 #8666]  INFO -- default-precise32:     -# MaxRequestsPerChild: maximum number of requests a server process serves
I, [2015-04-24T11:04:59.199026 #8666]  INFO -- default-precise32:     -<IfModule mpm_event_module>
I, [2015-04-24T11:04:59.201528 #8666]  INFO -- default-precise32:     -    StartServers          2
I, [2015-04-24T11:04:59.203970 #8666]  INFO -- default-precise32:     -    MinSpareThreads      25
I, [2015-04-24T11:04:59.206736 #8666]  INFO -- default-precise32:     -    MaxSpareThreads      75 
I, [2015-04-24T11:04:59.209899 #8666]  INFO -- default-precise32:     -    ThreadLimit          64
I, [2015-04-24T11:04:59.212518 #8666]  INFO -- default-precise32:     -    ThreadsPerChild      25
I, [2015-04-24T11:04:59.214949 #8666]  INFO -- default-precise32:     -    MaxClients          150
I, [2015-04-24T11:04:59.217301 #8666]  INFO -- default-precise32:     -    MaxRequestsPerChild   0
I, [2015-04-24T11:04:59.219778 #8666]  INFO -- default-precise32:     -</IfModule>
I, [2015-04-24T11:04:59.222441 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:04:59.225188 #8666]  INFO -- default-precise32:     -# These need to be set in /etc/apache2/envvars
I, [2015-04-24T11:04:59.228066 #8666]  INFO -- default-precise32:     -User ${APACHE_RUN_USER}
I, [2015-04-24T11:04:59.230281 #8666]  INFO -- default-precise32:     -Group ${APACHE_RUN_GROUP}
I, [2015-04-24T11:04:59.232761 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:04:59.235232 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:59.238120 #8666]  INFO -- default-precise32:      # AccessFileName: The name of the file to look for in each directory
I, [2015-04-24T11:04:59.241123 #8666]  INFO -- default-precise32:      # for additional configuration directives.  See also the AllowOverride
I, [2015-04-24T11:04:59.243653 #8666]  INFO -- default-precise32:     @@ -153,13 +55,12 @@
I, [2015-04-24T11:04:59.246055 #8666]  INFO -- default-precise32:      AccessFileName .htaccess
I, [2015-04-24T11:04:59.248959 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:59.251375 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:59.253705 #8666]  INFO -- default-precise32:     -# The following lines prevent .htaccess and .htpasswd files from being 
I, [2015-04-24T11:04:59.256204 #8666]  INFO -- default-precise32:     -# viewed by Web clients. 
I, [2015-04-24T11:04:59.258649 #8666]  INFO -- default-precise32:     +# The following lines prevent .htaccess and .htpasswd files from being
I, [2015-04-24T11:04:59.261199 #8666]  INFO -- default-precise32:     +# viewed by Web clients.
I, [2015-04-24T11:04:59.263308 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:59.265827 #8666]  INFO -- default-precise32:      <Files ~ "^\.ht">
I, [2015-04-24T11:04:59.267973 #8666]  INFO -- default-precise32:   Order allow,deny
I, [2015-04-24T11:04:59.270275 #8666]  INFO -- default-precise32:   Deny from all
I, [2015-04-24T11:04:59.273121 #8666]  INFO -- default-precise32:     -    Satisfy all
I, [2015-04-24T11:04:59.275311 #8666]  INFO -- default-precise32:      </Files>
I, [2015-04-24T11:04:59.277394 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:59.280104 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:59.282327 #8666]  INFO -- default-precise32:     @@ -171,16 +72,8 @@
I, [2015-04-24T11:04:59.284944 #8666]  INFO -- default-precise32:      # keep browsers from trying to display binary files as though they are
I, [2015-04-24T11:04:59.287073 #8666]  INFO -- default-precise32:      # text.
I, [2015-04-24T11:04:59.289554 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:59.291486 #8666]  INFO -- default-precise32:     -# It is also possible to omit any default MIME type and let the
I, [2015-04-24T11:04:59.293884 #8666]  INFO -- default-precise32:     -# client's browser guess an appropriate action instead. Typically the
I, [2015-04-24T11:04:59.296343 #8666]  INFO -- default-precise32:     -# browser will decide based on the file's extension then. In cases
I, [2015-04-24T11:04:59.298766 #8666]  INFO -- default-precise32:     -# where no good assumption can be made, letting the default MIME type
I, [2015-04-24T11:04:59.301016 #8666]  INFO -- default-precise32:     -# unset is suggested  instead of forcing the browser to accept
I, [2015-04-24T11:04:59.303140 #8666]  INFO -- default-precise32:     -# incorrect  metadata.
I, [2015-04-24T11:04:59.305317 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:04:59.307381 #8666]  INFO -- default-precise32:     -DefaultType None
I, [2015-04-24T11:04:59.310353 #8666]  INFO -- default-precise32:     +DefaultType text/plain
I, [2015-04-24T11:04:59.313189 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:59.314976 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:04:59.317219 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:59.319069 #8666]  INFO -- default-precise32:      # HostnameLookups: Log the names of clients or just their IP addresses
I, [2015-04-24T11:04:59.321292 #8666]  INFO -- default-precise32:      # e.g., www.apache.org (on) or 204.62.129.132 (off).
I, [2015-04-24T11:04:59.323888 #8666]  INFO -- default-precise32:     @@ -197,7 +90,7 @@
I, [2015-04-24T11:04:59.326903 #8666]  INFO -- default-precise32:      # logged here.  If you *do* define an error logfile for a <VirtualHost>
I, [2015-04-24T11:04:59.329283 #8666]  INFO -- default-precise32:      # container, that host's errors will be logged there and not here.
I, [2015-04-24T11:04:59.332067 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:59.334147 #8666]  INFO -- default-precise32:     -ErrorLog ${APACHE_LOG_DIR}/error.log
I, [2015-04-24T11:04:59.336292 #8666]  INFO -- default-precise32:     +ErrorLog /var/log/apache2/error.log
I, [2015-04-24T11:04:59.339094 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:59.341996 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:59.344612 #8666]  INFO -- default-precise32:      # LogLevel: Control the number of messages logged to the error_log.
I, [2015-04-24T11:04:59.346847 #8666]  INFO -- default-precise32:     @@ -206,33 +99,93 @@
I, [2015-04-24T11:04:59.349404 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:59.352188 #8666]  INFO -- default-precise32:      LogLevel warn
I, [2015-04-24T11:04:59.354284 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:59.356904 #8666]  INFO -- default-precise32:     +# COOK-1021: Dummy LoadModule directive to aid module installations
I, [2015-04-24T11:04:59.359186 #8666]  INFO -- default-precise32:     +#LoadModule dummy_module modules/mod_dummy.so
I, [2015-04-24T11:04:59.361675 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:59.363745 #8666]  INFO -- default-precise32:      # Include module configuration:
I, [2015-04-24T11:04:59.366054 #8666]  INFO -- default-precise32:     -Include mods-enabled/*.load
I, [2015-04-24T11:04:59.368847 #8666]  INFO -- default-precise32:     -Include mods-enabled/*.conf
I, [2015-04-24T11:04:59.371378 #8666]  INFO -- default-precise32:     +Include /etc/apache2/mods-enabled/*.load
I, [2015-04-24T11:04:59.374191 #8666]  INFO -- default-precise32:     +Include /etc/apache2/mods-enabled/*.conf
I, [2015-04-24T11:04:59.376528 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:59.379797 #8666]  INFO -- default-precise32:     -# Include all the user configurations:
I, [2015-04-24T11:04:59.382363 #8666]  INFO -- default-precise32:     -Include httpd.conf
I, [2015-04-24T11:04:59.385078 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:59.387705 #8666]  INFO -- default-precise32:      # Include ports listing
I, [2015-04-24T11:04:59.390606 #8666]  INFO -- default-precise32:     -Include ports.conf
I, [2015-04-24T11:04:59.393481 #8666]  INFO -- default-precise32:     +Include /etc/apache2/ports.conf
I, [2015-04-24T11:04:59.395885 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:59.398942 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:59.401715 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:59.405041 #8666]  INFO -- default-precise32:      # The following directives define some format nicknames for use with
I, [2015-04-24T11:04:59.407845 #8666]  INFO -- default-precise32:      # a CustomLog directive (see below).
I, [2015-04-24T11:04:59.410594 #8666]  INFO -- default-precise32:     -# If you are behind a reverse proxy, you might want to change %h into %{X-Forwarded-For}i
I, [2015-04-24T11:04:59.413373 #8666]  INFO -- default-precise32:      #
I, [2015-04-24T11:04:59.416159 #8666]  INFO -- default-precise32:      LogFormat "%v:%p %h %l %u %t \"%r\" %>s %O \"%{Referer}i\" \"%{User-Agent}i\"" vhost_combined
I, [2015-04-24T11:04:59.418900 #8666]  INFO -- default-precise32:     -LogFormat "%h %l %u %t \"%r\" %>s %O \"%{Referer}i\" \"%{User-Agent}i\"" combined
I, [2015-04-24T11:04:59.421687 #8666]  INFO -- default-precise32:     -LogFormat "%h %l %u %t \"%r\" %>s %O" common
I, [2015-04-24T11:04:59.424509 #8666]  INFO -- default-precise32:     +LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
I, [2015-04-24T11:04:59.427577 #8666]  INFO -- default-precise32:     +LogFormat "%h %l %u %t \"%r\" %>s %b" common
I, [2015-04-24T11:04:59.430494 #8666]  INFO -- default-precise32:      LogFormat "%{Referer}i -> %U" referer
I, [2015-04-24T11:04:59.433502 #8666]  INFO -- default-precise32:      LogFormat "%{User-agent}i" agent
I, [2015-04-24T11:04:59.436498 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.439635 #8666]  INFO -- default-precise32:     +# Customizable error responses come in three flavors:
I, [2015-04-24T11:04:59.442841 #8666]  INFO -- default-precise32:     +# 1) plain text 2) local redirects 3) external redirects
I, [2015-04-24T11:04:59.445648 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.448610 #8666]  INFO -- default-precise32:     +# Some examples:
I, [2015-04-24T11:04:59.451169 #8666]  INFO -- default-precise32:     +#ErrorDocument 500 "The server made a boo boo."
I, [2015-04-24T11:04:59.453982 #8666]  INFO -- default-precise32:     +#ErrorDocument 404 /missing.html
I, [2015-04-24T11:04:59.457156 #8666]  INFO -- default-precise32:     +#ErrorDocument 404 "/cgi-bin/missing_handler.pl"
I, [2015-04-24T11:04:59.460189 #8666]  INFO -- default-precise32:     +#ErrorDocument 402 http://www.example.com/subscription_info.html
I, [2015-04-24T11:04:59.463119 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.465527 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:59.468679 #8666]  INFO -- default-precise32:     -# Include of directories ignores editors' and dpkg's backup files,
I, [2015-04-24T11:04:59.471731 #8666]  INFO -- default-precise32:     -# see README.Debian for details.
I, [2015-04-24T11:04:59.474918 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.477818 #8666]  INFO -- default-precise32:     +# Putting this all together, we can internationalize error responses.
I, [2015-04-24T11:04:59.480642 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.483417 #8666]  INFO -- default-precise32:     +# We use Alias to redirect any /error/HTTP_<error>.html.var response to
I, [2015-04-24T11:04:59.486632 #8666]  INFO -- default-precise32:     +# our collection of by-error message multi-language collections.  We use
I, [2015-04-24T11:04:59.489776 #8666]  INFO -- default-precise32:     +# includes to substitute the appropriate text.
I, [2015-04-24T11:04:59.492545 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.494960 #8666]  INFO -- default-precise32:     +# You can modify the messages' appearance without changing any of the
I, [2015-04-24T11:04:59.498021 #8666]  INFO -- default-precise32:     +# default HTTP_<error>.html.var files by adding the line:
I, [2015-04-24T11:04:59.500833 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.503721 #8666]  INFO -- default-precise32:     +#   Alias /error/include/ "/your/include/path/"
I, [2015-04-24T11:04:59.506846 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.509687 #8666]  INFO -- default-precise32:     +# which allows you to create your own set of files by starting with the
I, [2015-04-24T11:04:59.512876 #8666]  INFO -- default-precise32:     +# /usr/share/apache2/error/include/ files and copying them to /your/include/path/,
I, [2015-04-24T11:04:59.515668 #8666]  INFO -- default-precise32:     +# even on a per-VirtualHost basis.  The default include files will display
I, [2015-04-24T11:04:59.518814 #8666]  INFO -- default-precise32:     +# your Apache version number and your ServerAdmin email address regardless
I, [2015-04-24T11:04:59.521609 #8666]  INFO -- default-precise32:     +# of the setting of ServerSignature.
I, [2015-04-24T11:04:59.524671 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.527170 #8666]  INFO -- default-precise32:     +# The internationalized error documents require mod_alias, mod_include
I, [2015-04-24T11:04:59.529964 #8666]  INFO -- default-precise32:     +# and mod_negotiation.  To activate them, uncomment the following 30 lines.
I, [2015-04-24T11:04:59.532744 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:59.535537 #8666]  INFO -- default-precise32:     +#    Alias /error/ "/usr/share/apache2/error/"
I, [2015-04-24T11:04:59.538330 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.541520 #8666]  INFO -- default-precise32:     +#    <Directory "/usr/share/apache2/error">
I, [2015-04-24T11:04:59.544654 #8666]  INFO -- default-precise32:     +#        AllowOverride None
I, [2015-04-24T11:04:59.547755 #8666]  INFO -- default-precise32:     +#        Options IncludesNoExec
I, [2015-04-24T11:04:59.550660 #8666]  INFO -- default-precise32:     +#        AddOutputFilter Includes html
I, [2015-04-24T11:04:59.553479 #8666]  INFO -- default-precise32:     +#        AddHandler type-map var
I, [2015-04-24T11:04:59.556612 #8666]  INFO -- default-precise32:     +#        Order allow,deny
I, [2015-04-24T11:04:59.559169 #8666]  INFO -- default-precise32:     +#        Allow from all
I, [2015-04-24T11:04:59.562178 #8666]  INFO -- default-precise32:     +#        LanguagePriority en cs de es fr it nl sv pt-br ro
I, [2015-04-24T11:04:59.564804 #8666]  INFO -- default-precise32:     +#        ForceLanguagePriority Prefer Fallback
I, [2015-04-24T11:04:59.567787 #8666]  INFO -- default-precise32:     +#    </Directory>
I, [2015-04-24T11:04:59.570581 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.573735 #8666]  INFO -- default-precise32:     +#    ErrorDocument 400 /error/HTTP_BAD_REQUEST.html.var
I, [2015-04-24T11:04:59.576810 #8666]  INFO -- default-precise32:     +#    ErrorDocument 401 /error/HTTP_UNAUTHORIZED.html.var
I, [2015-04-24T11:04:59.579668 #8666]  INFO -- default-precise32:     +#    ErrorDocument 403 /error/HTTP_FORBIDDEN.html.var
I, [2015-04-24T11:04:59.582513 #8666]  INFO -- default-precise32:     +#    ErrorDocument 404 /error/HTTP_NOT_FOUND.html.var
I, [2015-04-24T11:04:59.585568 #8666]  INFO -- default-precise32:     +#    ErrorDocument 405 /error/HTTP_METHOD_NOT_ALLOWED.html.var
I, [2015-04-24T11:04:59.588478 #8666]  INFO -- default-precise32:     +#    ErrorDocument 408 /error/HTTP_REQUEST_TIME_OUT.html.var
I, [2015-04-24T11:04:59.591177 #8666]  INFO -- default-precise32:     +#    ErrorDocument 410 /error/HTTP_GONE.html.var
I, [2015-04-24T11:04:59.593960 #8666]  INFO -- default-precise32:     +#    ErrorDocument 411 /error/HTTP_LENGTH_REQUIRED.html.var
I, [2015-04-24T11:04:59.596750 #8666]  INFO -- default-precise32:     +#    ErrorDocument 412 /error/HTTP_PRECONDITION_FAILED.html.var
I, [2015-04-24T11:04:59.599519 #8666]  INFO -- default-precise32:     +#    ErrorDocument 413 /error/HTTP_REQUEST_ENTITY_TOO_LARGE.html.var
I, [2015-04-24T11:04:59.602673 #8666]  INFO -- default-precise32:     +#    ErrorDocument 414 /error/HTTP_REQUEST_URI_TOO_LARGE.html.var
I, [2015-04-24T11:04:59.605969 #8666]  INFO -- default-precise32:     +#    ErrorDocument 415 /error/HTTP_UNSUPPORTED_MEDIA_TYPE.html.var
I, [2015-04-24T11:04:59.609030 #8666]  INFO -- default-precise32:     +#    ErrorDocument 500 /error/HTTP_INTERNAL_SERVER_ERROR.html.var
I, [2015-04-24T11:04:59.611551 #8666]  INFO -- default-precise32:     +#    ErrorDocument 501 /error/HTTP_NOT_IMPLEMENTED.html.var
I, [2015-04-24T11:04:59.614628 #8666]  INFO -- default-precise32:     +#    ErrorDocument 502 /error/HTTP_BAD_GATEWAY.html.var
I, [2015-04-24T11:04:59.617496 #8666]  INFO -- default-precise32:     +#    ErrorDocument 503 /error/HTTP_SERVICE_UNAVAILABLE.html.var
I, [2015-04-24T11:04:59.620199 #8666]  INFO -- default-precise32:     +#    ErrorDocument 506 /error/HTTP_VARIANT_ALSO_VARIES.html.var
I, [2015-04-24T11:04:59.622061 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:59.624384 #8666]  INFO -- default-precise32:      # Include generic snippets of statements
I, [2015-04-24T11:04:59.626682 #8666]  INFO -- default-precise32:     -Include conf.d/
I, [2015-04-24T11:04:59.629299 #8666]  INFO -- default-precise32:     +Include /etc/apache2/conf-enabled/*.conf
I, [2015-04-24T11:04:59.630988 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:04:59.633314 #8666]  INFO -- default-precise32:      # Include the virtual host configurations:
I, [2015-04-24T11:04:59.635959 #8666]  INFO -- default-precise32:     -Include sites-enabled/
I, [2015-04-24T11:04:59.643040 #8666]  INFO -- default-precise32:     +Include /etc/apache2/sites-enabled/*.conf
I, [2015-04-24T11:04:59.647191 #8666]  INFO -- default-precise32:   * file[/etc/apache2/conf-available/security] action delete (up to date)
I, [2015-04-24T11:04:59.653153 #8666]  INFO -- default-precise32:   * template[/etc/apache2/conf-available/security.conf] action create
I, [2015-04-24T11:04:59.659222 #8666]  INFO -- default-precise32:     - create new file /etc/apache2/conf-available/security.conf
I, [2015-04-24T11:04:59.662421 #8666]  INFO -- default-precise32:     - update content in file /etc/apache2/conf-available/security.conf from none to 595bd1
I, [2015-04-24T11:04:59.666177 #8666]  INFO -- default-precise32:     --- /etc/apache2/conf-available/security.conf	2015-04-24 08:04:59.648674633 +0000
I, [2015-04-24T11:04:59.670223 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-xwy6zp	2015-04-24 08:04:59.648674633 +0000
I, [2015-04-24T11:04:59.672988 #8666]  INFO -- default-precise32:     @@ -1 +1,46 @@
I, [2015-04-24T11:04:59.675186 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.677798 #8666]  INFO -- default-precise32:     +# Disable access to the entire file system except for the directories that
I, [2015-04-24T11:04:59.680060 #8666]  INFO -- default-precise32:     +# are explicitly allowed later.
I, [2015-04-24T11:04:59.682656 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.685138 #8666]  INFO -- default-precise32:     +# This currently breaks the configurations that come with some web application
I, [2015-04-24T11:04:59.687504 #8666]  INFO -- default-precise32:     +# Debian packages. It will be made the default for the release after lenny.
I, [2015-04-24T11:04:59.689763 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.691870 #8666]  INFO -- default-precise32:     +#<Directory />
I, [2015-04-24T11:04:59.695764 #8666]  INFO -- default-precise32:     +#	AllowOverride None
I, [2015-04-24T11:04:59.699917 #8666]  INFO -- default-precise32:     +#	Order Deny,Allow
I, [2015-04-24T11:04:59.704117 #8666]  INFO -- default-precise32:     +#	Deny from all
I, [2015-04-24T11:04:59.706960 #8666]  INFO -- default-precise32:     +#</Directory>
I, [2015-04-24T11:04:59.708978 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:59.711136 #8666]  INFO -- default-precise32:     +# Changing the following options will not really affect the security of the
I, [2015-04-24T11:04:59.713324 #8666]  INFO -- default-precise32:     +# server, but might make attacks slightly more difficult in some cases.
I, [2015-04-24T11:04:59.715666 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:59.717986 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.720194 #8666]  INFO -- default-precise32:     +# ServerTokens
I, [2015-04-24T11:04:59.722692 #8666]  INFO -- default-precise32:     +# This directive configures what you return as the Server HTTP response
I, [2015-04-24T11:04:59.725192 #8666]  INFO -- default-precise32:     +# Header. The default is 'Full' which sends information about the OS-Type
I, [2015-04-24T11:04:59.727499 #8666]  INFO -- default-precise32:     +# and compiled in modules.
I, [2015-04-24T11:04:59.730097 #8666]  INFO -- default-precise32:     +# Set to one of:  Full | OS | Minimal | Minor | Major | Prod
I, [2015-04-24T11:04:59.732481 #8666]  INFO -- default-precise32:     +# where Full conveys the most information, and Prod the least.
I, [2015-04-24T11:04:59.734671 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.737233 #8666]  INFO -- default-precise32:     +ServerTokens Prod
I, [2015-04-24T11:04:59.738309 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:59.740178 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.742745 #8666]  INFO -- default-precise32:     +# Optionally add a line containing the server version and virtual host
I, [2015-04-24T11:04:59.744330 #8666]  INFO -- default-precise32:     +# name to server-generated pages (internal error documents, FTP directory
I, [2015-04-24T11:04:59.746689 #8666]  INFO -- default-precise32:     +# listings, mod_status and mod_info output etc., but not CGI generated
I, [2015-04-24T11:04:59.748940 #8666]  INFO -- default-precise32:     +# documents or custom error documents).
I, [2015-04-24T11:04:59.750852 #8666]  INFO -- default-precise32:     +# Set to "EMail" to also include a mailto: link to the ServerAdmin.
I, [2015-04-24T11:04:59.752969 #8666]  INFO -- default-precise32:     +# Set to one of:  On | Off | EMail
I, [2015-04-24T11:04:59.755353 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.758195 #8666]  INFO -- default-precise32:     +ServerSignature On
I, [2015-04-24T11:04:59.760178 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:04:59.762067 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.763818 #8666]  INFO -- default-precise32:     +# Allow TRACE method
I, [2015-04-24T11:04:59.766102 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.768646 #8666]  INFO -- default-precise32:     +# Set to "extended" to also reflect the request body (only for testing and
I, [2015-04-24T11:04:59.770816 #8666]  INFO -- default-precise32:     +# diagnostic purposes).
I, [2015-04-24T11:04:59.773041 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.774830 #8666]  INFO -- default-precise32:     +# Set to one of:  On | Off | extended
I, [2015-04-24T11:04:59.776910 #8666]  INFO -- default-precise32:     +#
I, [2015-04-24T11:04:59.782239 #8666]  INFO -- default-precise32:     +TraceEnable Off
I, [2015-04-24T11:04:59.784692 #8666]  INFO -- default-precise32:     - change mode from '' to '0644'
I, [2015-04-24T11:04:59.787027 #8666]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:04:59.790524 #8666]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:05:00.253928 #8666]  INFO -- default-precise32:   * execute[a2enconf security.conf] action run
I, [2015-04-24T11:05:00.258586 #8666]  INFO -- default-precise32:     - execute /usr/sbin/a2enconf security.conf
I, [2015-04-24T11:05:00.284130 #8666]  INFO -- default-precise32:   * file[/etc/apache2/conf-available/charset] action delete (up to date)
I, [2015-04-24T11:05:00.311689 #8666]  INFO -- default-precise32:   * template[/etc/apache2/conf-available/charset.conf] action create
I, [2015-04-24T11:05:00.338802 #8666]  INFO -- default-precise32:     - create new file /etc/apache2/conf-available/charset.conf
I, [2015-04-24T11:05:00.342891 #8666]  INFO -- default-precise32:     - update content in file /etc/apache2/conf-available/charset.conf from none to 543c6c
I, [2015-04-24T11:05:00.348537 #8666]  INFO -- default-precise32:     --- /etc/apache2/conf-available/charset.conf	2015-04-24 08:05:00.304666387 +0000
I, [2015-04-24T11:05:00.354536 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-1fgvrs4	2015-04-24 08:05:00.300666437 +0000
I, [2015-04-24T11:05:00.358229 #8666]  INFO -- default-precise32:     @@ -1 +1,7 @@
I, [2015-04-24T11:05:00.361819 #8666]  INFO -- default-precise32:     +# Read the documentation before enabling AddDefaultCharset.
I, [2015-04-24T11:05:00.365379 #8666]  INFO -- default-precise32:     +# In general, it is only a good idea if you know that all your files
I, [2015-04-24T11:05:00.368975 #8666]  INFO -- default-precise32:     +# have this encoding. It will override any encoding given in the files
I, [2015-04-24T11:05:00.372693 #8666]  INFO -- default-precise32:     +# in meta http-equiv or xml encoding tags.
I, [2015-04-24T11:05:00.378168 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:05:00.395399 #8666]  INFO -- default-precise32:     +#AddDefaultCharset UTF-8
I, [2015-04-24T11:05:00.398631 #8666]  INFO -- default-precise32:     - change mode from '' to '0644'
I, [2015-04-24T11:05:00.402359 #8666]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:05:00.408140 #8666]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:05:01.083537 #8666]  INFO -- default-precise32:   * execute[a2enconf charset.conf] action run
I, [2015-04-24T11:05:01.088757 #8666]  INFO -- default-precise32:     - execute /usr/sbin/a2enconf charset.conf
I, [2015-04-24T11:05:01.113109 #8666]  INFO -- default-precise32:   * file[/etc/apache2/ports] action delete (up to date)
I, [2015-04-24T11:05:01.179347 #8666]  INFO -- default-precise32:   * template[/etc/apache2/ports.conf] action create
I, [2015-04-24T11:05:01.182800 #8666]  INFO -- default-precise32:     - update content in file /etc/apache2/ports.conf from 69cde6 to 251243
I, [2015-04-24T11:05:01.187859 #8666]  INFO -- default-precise32:     --- /etc/apache2/ports.conf	2012-02-07 04:16:59.000000000 +0000
I, [2015-04-24T11:05:01.193099 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-1q4mt27	2015-04-24 08:05:01.144655825 +0000
I, [2015-04-24T11:05:01.196076 #8666]  INFO -- default-precise32:     @@ -1,24 +1,6 @@
I, [2015-04-24T11:05:01.199045 #8666]  INFO -- default-precise32:     -# If you just change the port or add more ports here, you will likely also
I, [2015-04-24T11:05:01.202035 #8666]  INFO -- default-precise32:     -# have to change the VirtualHost statement in
I, [2015-04-24T11:05:01.204985 #8666]  INFO -- default-precise32:     -# /etc/apache2/sites-enabled/000-default
I, [2015-04-24T11:05:01.208192 #8666]  INFO -- default-precise32:     -# This is also true if you have upgraded from before 2.2.9-3 (i.e. from
I, [2015-04-24T11:05:01.213988 #8666]  INFO -- default-precise32:     -# Debian etch). See /usr/share/doc/apache2.2-common/NEWS.Debian.gz and
I, [2015-04-24T11:05:01.217393 #8666]  INFO -- default-precise32:     -# README.Debian.gz
I, [2015-04-24T11:05:01.220778 #8666]  INFO -- default-precise32:     +# This file was generated by Chef for default-precise32.
I, [2015-04-24T11:05:01.223908 #8666]  INFO -- default-precise32:     +# Do NOT modify this file by hand!
I, [2015-04-24T11:05:01.226958 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:01.230633 #8666]  INFO -- default-precise32:     +Listen *:80
I, [2015-04-24T11:05:01.233847 #8666]  INFO -- default-precise32:      NameVirtualHost *:80
I, [2015-04-24T11:05:01.237499 #8666]  INFO -- default-precise32:     -Listen 80
I, [2015-04-24T11:05:01.240906 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:05:01.244116 #8666]  INFO -- default-precise32:     -<IfModule mod_ssl.c>
I, [2015-04-24T11:05:01.246870 #8666]  INFO -- default-precise32:     -    # If you add NameVirtualHost *:443 here, you will also have to change
I, [2015-04-24T11:05:01.251658 #8666]  INFO -- default-precise32:     -    # the VirtualHost statement in /etc/apache2/sites-available/default-ssl
I, [2015-04-24T11:05:01.254858 #8666]  INFO -- default-precise32:     -    # to <VirtualHost *:443>
I, [2015-04-24T11:05:01.257855 #8666]  INFO -- default-precise32:     -    # Server Name Indication for SSL named virtual hosts is currently not
I, [2015-04-24T11:05:01.261064 #8666]  INFO -- default-precise32:     -    # supported by MSIE on Windows XP.
I, [2015-04-24T11:05:01.264020 #8666]  INFO -- default-precise32:     -    Listen 443
I, [2015-04-24T11:05:01.267010 #8666]  INFO -- default-precise32:     -</IfModule>
I, [2015-04-24T11:05:01.270165 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:05:01.273159 #8666]  INFO -- default-precise32:     -<IfModule mod_gnutls.c>
I, [2015-04-24T11:05:01.276383 #8666]  INFO -- default-precise32:     -    Listen 443
I, [2015-04-24T11:05:01.279032 #8666]  INFO -- default-precise32:     -</IfModule>
I, [2015-04-24T11:05:01.287718 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:05:01.290612 #8666]  INFO -- default-precise32: Recipe: apache2::mod_status
I, [2015-04-24T11:05:01.329324 #8666]  INFO -- default-precise32:   * template[/etc/apache2/mods-available/status.conf] action create
I, [2015-04-24T11:05:01.331691 #8666]  INFO -- default-precise32:     - update content in file /etc/apache2/mods-available/status.conf from 5f6b3c to 7736cd
I, [2015-04-24T11:05:01.335752 #8666]  INFO -- default-precise32:     --- /etc/apache2/mods-available/status.conf	2012-02-07 04:16:59.000000000 +0000
I, [2015-04-24T11:05:01.340668 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-3n2q1f	2015-04-24 08:05:01.300653866 +0000
I, [2015-04-24T11:05:01.343175 #8666]  INFO -- default-precise32:     @@ -1,31 +1,23 @@
I, [2015-04-24T11:05:01.346168 #8666]  INFO -- default-precise32:      <IfModule mod_status.c>
I, [2015-04-24T11:05:01.349027 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:01.351699 #8666]  INFO -- default-precise32:     -# Allow server status reports generated by mod_status,
I, [2015-04-24T11:05:01.354175 #8666]  INFO -- default-precise32:     -# with the URL of http://servername/server-status
I, [2015-04-24T11:05:01.357242 #8666]  INFO -- default-precise32:     -# Uncomment and change the "192.0.2.0/24" to allow access from other hosts.
I, [2015-04-24T11:05:01.360082 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:01.362143 #8666]  INFO -- default-precise32:     -<Location /server-status>
I, [2015-04-24T11:05:01.364983 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:01.367067 #8666]  INFO -- default-precise32:     +  # Allow server status reports generated by mod_status,
I, [2015-04-24T11:05:01.369126 #8666]  INFO -- default-precise32:     +  # with the URL of http://servername/server-status
I, [2015-04-24T11:05:01.371213 #8666]  INFO -- default-precise32:     +  # Uncomment and change the ".example.com" to allow
I, [2015-04-24T11:05:01.374012 #8666]  INFO -- default-precise32:     +  # access from other hosts.
I, [2015-04-24T11:05:01.376100 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:01.378856 #8666]  INFO -- default-precise32:     +  <Location /server-status>
I, [2015-04-24T11:05:01.381004 #8666]  INFO -- default-precise32:   SetHandler server-status
I, [2015-04-24T11:05:01.383103 #8666]  INFO -- default-precise32:   Order deny,allow
I, [2015-04-24T11:05:01.385463 #8666]  INFO -- default-precise32:   Deny from all
I, [2015-04-24T11:05:01.387329 #8666]  INFO -- default-precise32:   Allow from 127.0.0.1 ::1
I, [2015-04-24T11:05:01.389963 #8666]  INFO -- default-precise32:     -#    Allow from 192.0.2.0/24
I, [2015-04-24T11:05:01.391738 #8666]  INFO -- default-precise32:     -</Location>
I, [2015-04-24T11:05:01.394815 #8666]  INFO -- default-precise32:     +  </Location>
I, [2015-04-24T11:05:01.396896 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:01.396934 #8666]  INFO -- default-precise32:     -# Keep track of extended status information for each request
I, [2015-04-24T11:05:01.399539 #8666]  INFO -- default-precise32:     -ExtendedStatus On
I, [2015-04-24T11:05:01.402099 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:05:01.404669 #8666]  INFO -- default-precise32:     -# Determine if mod_status displays the first 63 characters of a request or
I, [2015-04-24T11:05:01.407489 #8666]  INFO -- default-precise32:     -# the last 63, assuming the request itself is greater than 63 chars.
I, [2015-04-24T11:05:01.410110 #8666]  INFO -- default-precise32:     -# Default: Off
I, [2015-04-24T11:05:01.412671 #8666]  INFO -- default-precise32:     -#SeeRequestTail On
I, [2015-04-24T11:05:01.415336 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:05:01.417825 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:05:01.420641 #8666]  INFO -- default-precise32:     -<IfModule mod_proxy.c>
I, [2015-04-24T11:05:01.423183 #8666]  INFO -- default-precise32:     -    # Show Proxy LoadBalancer status in mod_status
I, [2015-04-24T11:05:01.426075 #8666]  INFO -- default-precise32:     -    ProxyStatus On
I, [2015-04-24T11:05:01.428676 #8666]  INFO -- default-precise32:     -</IfModule>
I, [2015-04-24T11:05:01.431167 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:05:01.434854 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:01.438098 #8666]  INFO -- default-precise32:     +  # ExtendedStatus controls whether Apache will generate "full" status
I, [2015-04-24T11:05:01.440919 #8666]  INFO -- default-precise32:     +  # information (ExtendedStatus On) or just basic information (ExtendedStatus
I, [2015-04-24T11:05:01.443696 #8666]  INFO -- default-precise32:     +  # Off) when the "server-status" handler is called. The default is Off.
I, [2015-04-24T11:05:01.446566 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:01.449371 #8666]  INFO -- default-precise32:     +  ExtendedStatus Off
I, [2015-04-24T11:05:01.451971 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:01.457662 #8666]  INFO -- default-precise32:      </IfModule>
I, [2015-04-24T11:05:01.473895 #8666]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/status.load] action create (up to date)
I, [2015-04-24T11:05:01.480751 #8666]  INFO -- default-precise32:   * execute[a2enmod status] action run (skipped due to not_if)
I, [2015-04-24T11:05:01.482755 #8666]  INFO -- default-precise32: Recipe: apache2::mod_alias
I, [2015-04-24T11:05:01.517394 #8666]  INFO -- default-precise32:   * template[/etc/apache2/mods-available/alias.conf] action create
I, [2015-04-24T11:05:01.520537 #8666]  INFO -- default-precise32:     - update content in file /etc/apache2/mods-available/alias.conf from 541075 to 43605a
I, [2015-04-24T11:05:01.525194 #8666]  INFO -- default-precise32:     --- /etc/apache2/mods-available/alias.conf	2012-02-07 04:16:59.000000000 +0000
I, [2015-04-24T11:05:01.529470 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-fgoquw	2015-04-24 08:05:01.488651501 +0000
I, [2015-04-24T11:05:01.532787 #8666]  INFO -- default-precise32:     @@ -1,25 +1,24 @@
I, [2015-04-24T11:05:01.535585 #8666]  INFO -- default-precise32:      <IfModule alias_module>
I, [2015-04-24T11:05:01.539166 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:01.541701 #8666]  INFO -- default-precise32:     -# Aliases: Add here as many aliases as you need (with no limit). The format is 
I, [2015-04-24T11:05:01.544520 #8666]  INFO -- default-precise32:     -# Alias fakename realname
I, [2015-04-24T11:05:01.547197 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:01.552560 #8666]  INFO -- default-precise32:     -# Note that if you include a trailing / on fakename then the server will
I, [2015-04-24T11:05:01.554877 #8666]  INFO -- default-precise32:     -# require it to be present in the URL.  So "/icons" isn't aliased in this
I, [2015-04-24T11:05:01.557702 #8666]  INFO -- default-precise32:     -# example, only "/icons/".  If the fakename is slash-terminated, then the 
I, [2015-04-24T11:05:01.560534 #8666]  INFO -- default-precise32:     -# realname must also be slash terminated, and if the fakename omits the 
I, [2015-04-24T11:05:01.562885 #8666]  INFO -- default-precise32:     -# trailing slash, the realname must also omit it.
I, [2015-04-24T11:05:01.566211 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:01.569559 #8666]  INFO -- default-precise32:     -# We include the /icons/ alias for FancyIndexed directory listings.  If
I, [2015-04-24T11:05:01.572791 #8666]  INFO -- default-precise32:     -# you do not use FancyIndexing, you may comment this out.
I, [2015-04-24T11:05:01.575608 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:01.576563 #8666]  INFO -- default-precise32: -Alias /icons/ "/usr/share/apache2/icons/"
I, [2015-04-24T11:05:01.579403 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:01.582175 #8666]  INFO -- default-precise32:     +  # Aliases: Add here as many aliases as you need (with no limit). The format is
I, [2015-04-24T11:05:01.584610 #8666]  INFO -- default-precise32:     +  # Alias fakename realname
I, [2015-04-24T11:05:01.586950 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:01.589210 #8666]  INFO -- default-precise32:     +  # Note that if you include a trailing / on fakename then the server will
I, [2015-04-24T11:05:01.591637 #8666]  INFO -- default-precise32:     +  # require it to be present in the URL.  So "/icons" isn't aliased in this
I, [2015-04-24T11:05:01.593996 #8666]  INFO -- default-precise32:     +  # example, only "/icons/".  If the fakename is slash-terminated, then the
I, [2015-04-24T11:05:01.597253 #8666]  INFO -- default-precise32:     +  # realname must also be slash terminated, and if the fakename omits the
I, [2015-04-24T11:05:01.597313 #8666]  INFO -- default-precise32:     +  # trailing slash, the realname must also omit it.
I, [2015-04-24T11:05:01.598206 #8666]  INFO -- default-precise32: +  #
I, [2015-04-24T11:05:01.601554 #8666]  INFO -- default-precise32:     +  # We include the /icons/ alias for FancyIndexed directory listings.  If
I, [2015-04-24T11:05:01.603877 #8666]  INFO -- default-precise32:     +  # you do not use FancyIndexing, you may comment this out.
I, [2015-04-24T11:05:01.605770 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:01.608605 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:05:01.611193 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:01.613760 #8666]  INFO -- default-precise32:     -<Directory "/usr/share/apache2/icons">
I, [2015-04-24T11:05:01.616583 #8666]  INFO -- default-precise32:     -    Options FollowSymlinks
I, [2015-04-24T11:05:01.618948 #8666]  INFO -- default-precise32:     +  <Directory "/usr/share/apache2/icons">
I, [2015-04-24T11:05:01.621771 #8666]  INFO -- default-precise32:     +    Options Indexes MultiViews
I, [2015-04-24T11:05:01.624650 #8666]  INFO -- default-precise32:   AllowOverride None
I, [2015-04-24T11:05:01.627437 #8666]  INFO -- default-precise32:   Order allow,deny
I, [2015-04-24T11:05:01.630789 #8666]  INFO -- default-precise32:   Allow from all
I, [2015-04-24T11:05:01.633562 #8666]  INFO -- default-precise32:     -</Directory>
I, [2015-04-24T11:05:01.636193 #8666]  INFO -- default-precise32: -
I, [2015-04-24T11:05:01.638195 #8666]  INFO -- default-precise32:     +  </Directory>
I, [2015-04-24T11:05:01.641215 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:05:01.651352 #8666]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/alias.load] action create (up to date)
I, [2015-04-24T11:05:01.655381 #8666]  INFO -- default-precise32:   * execute[a2enmod alias] action run (skipped due to not_if)
I, [2015-04-24T11:05:01.657370 #8666]  INFO -- default-precise32: Recipe: apache2::mod_auth_basic
I, [2015-04-24T11:05:01.671200 #8666]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/auth_basic.load] action create (up to date)
I, [2015-04-24T11:05:01.675177 #8666]  INFO -- default-precise32:   * execute[a2enmod auth_basic] action run (skipped due to not_if)
I, [2015-04-24T11:05:01.677169 #8666]  INFO -- default-precise32: Recipe: apache2::mod_authn_file
I, [2015-04-24T11:05:01.690453 #8666]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/authn_file.load] action create (up to date)
I, [2015-04-24T11:05:01.698618 #8666]  INFO -- default-precise32:   * execute[a2enmod authn_file] action run (skipped due to not_if)
I, [2015-04-24T11:05:01.699538 #8666]  INFO -- default-precise32: Recipe: apache2::mod_authz_core
I, [2015-04-24T11:05:01.711724 #8666]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/authz_default.load] action create (up to date)
I, [2015-04-24T11:05:01.741235 #8666]  INFO -- default-precise32:   * execute[a2enmod authz_default] action run (skipped due to not_if)
I, [2015-04-24T11:05:01.743191 #8666]  INFO -- default-precise32: Recipe: apache2::mod_authz_groupfile
I, [2015-04-24T11:05:01.751347 #8666]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/authz_groupfile.load] action create (up to date)
I, [2015-04-24T11:05:01.755176 #8666]  INFO -- default-precise32:   * execute[a2enmod authz_groupfile] action run (skipped due to not_if)
I, [2015-04-24T11:05:01.757186 #8666]  INFO -- default-precise32: Recipe: apache2::mod_authz_host
I, [2015-04-24T11:05:01.766232 #8666]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/authz_host.load] action create (up to date)
I, [2015-04-24T11:05:01.770185 #8666]  INFO -- default-precise32:   * execute[a2enmod authz_host] action run (skipped due to not_if)
I, [2015-04-24T11:05:01.773214 #8666]  INFO -- default-precise32: Recipe: apache2::mod_authz_user
I, [2015-04-24T11:05:01.781388 #8666]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/authz_user.load] action create (up to date)
I, [2015-04-24T11:05:01.785370 #8666]  INFO -- default-precise32:   * execute[a2enmod authz_user] action run (skipped due to not_if)
I, [2015-04-24T11:05:01.787202 #8666]  INFO -- default-precise32: Recipe: apache2::mod_autoindex
I, [2015-04-24T11:05:01.811065 #8666]  INFO -- default-precise32:   * template[/etc/apache2/mods-available/autoindex.conf] action create
I, [2015-04-24T11:05:01.813091 #8666]  INFO -- default-precise32:     - update content in file /etc/apache2/mods-available/autoindex.conf from e9cb73 to 8e7e44
I, [2015-04-24T11:05:01.816997 #8666]  INFO -- default-precise32:     --- /etc/apache2/mods-available/autoindex.conf	2012-02-07 04:16:59.000000000 +0000
I, [2015-04-24T11:05:01.820354 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-12dxkay	2015-04-24 08:05:01.788647730 +0000
I, [2015-04-24T11:05:01.823160 #8666]  INFO -- default-precise32:     @@ -1,102 +1,101 @@
I, [2015-04-24T11:05:01.825360 #8666]  INFO -- default-precise32:      <IfModule mod_autoindex.c>
I, [2015-04-24T11:05:01.827348 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:01.830190 #8666]  INFO -- default-precise32:     -# Directives controlling the display of server-generated directory listings.
I, [2015-04-24T11:05:01.833225 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:01.836394 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:01.836433 #8666]  INFO -- default-precise32:     +  # Directives controlling the display of server-generated directory listings.
I, [2015-04-24T11:05:01.836456 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:01.836475 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:01.836493 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:01.836512 #8666]  INFO -- default-precise32:     -# IndexOptions: Controls the appearance of server-generated directory
I, [2015-04-24T11:05:01.836531 #8666]  INFO -- default-precise32:     -# listings.
I, [2015-04-24T11:05:01.836550 #8666]  INFO -- default-precise32:     -# Remove/replace the "Charset=UTF-8" if you don't use UTF-8 for your filenames.
I, [2015-04-24T11:05:01.836568 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:01.836596 #8666]  INFO -- default-precise32:     -IndexOptions FancyIndexing VersionSort HTMLTable NameWidth=* DescriptionWidth=* Charset=UTF-8
I, [2015-04-24T11:05:01.836633 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:01.836654 #8666]  INFO -- default-precise32:     +  # IndexOptions: Controls the appearance of server-generated directory
I, [2015-04-24T11:05:01.836674 #8666]  INFO -- default-precise32:     +  # listings.
I, [2015-04-24T11:05:01.836693 #8666]  INFO -- default-precise32:     +  # Remove/replace the "Charset=UTF-8" if you don't use UTF-8 for your filenames.
I, [2015-04-24T11:05:01.836711 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:01.836730 #8666]  INFO -- default-precise32:     +  IndexOptions FancyIndexing VersionSort HTMLTable NameWidth=* DescriptionWidth=* Charset=UTF-8
I, [2015-04-24T11:05:01.836748 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:01.836766 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:01.836785 #8666]  INFO -- default-precise32:     -# AddIcon* directives tell the server which icon to show for different
I, [2015-04-24T11:05:01.836804 #8666]  INFO -- default-precise32:     -# files or filename extensions.  These are only displayed for
I, [2015-04-24T11:05:01.836823 #8666]  INFO -- default-precise32:     -# FancyIndexed directories.
I, [2015-04-24T11:05:01.836841 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:01.836860 #8666]  INFO -- default-precise32:     -AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip x-bzip2
I, [2015-04-24T11:05:01.836878 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:01.836897 #8666]  INFO -- default-precise32:     +  # AddIcon* directives tell the server which icon to show for different
I, [2015-04-24T11:05:01.836916 #8666]  INFO -- default-precise32:     +  # files or filename extensions.  These are only displayed for
I, [2015-04-24T11:05:01.836935 #8666]  INFO -- default-precise32:     +  # FancyIndexed directories.
I, [2015-04-24T11:05:01.836953 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:01.836972 #8666]  INFO -- default-precise32:     +  AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip x-bzip2
I, [2015-04-24T11:05:01.836990 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:01.837023 #8666]  INFO -- default-precise32:     -AddIconByType (TXT,/icons/text.gif) text/*
I, [2015-04-24T11:05:01.837044 #8666]  INFO -- default-precise32:     -AddIconByType (IMG,/icons/image2.gif) image/*
I, [2015-04-24T11:05:01.837063 #8666]  INFO -- default-precise32:     -AddIconByType (SND,/icons/sound2.gif) audio/*
I, [2015-04-24T11:05:01.837081 #8666]  INFO -- default-precise32:     -AddIconByType (VID,/icons/movie.gif) video/*
I, [2015-04-24T11:05:01.837100 #8666]  INFO -- default-precise32:     +  AddIconByType (TXT,/icons/text.gif) text/*
I, [2015-04-24T11:05:01.837119 #8666]  INFO -- default-precise32:     +  AddIconByType (IMG,/icons/image2.gif) image/*
I, [2015-04-24T11:05:01.837137 #8666]  INFO -- default-precise32:     +  AddIconByType (SND,/icons/sound2.gif) audio/*
I, [2015-04-24T11:05:01.837156 #8666]  INFO -- default-precise32:     +  AddIconByType (VID,/icons/movie.gif) video/*
I, [2015-04-24T11:05:01.837174 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:01.837192 #8666]  INFO -- default-precise32:     -AddIcon /icons/binary.gif .bin .exe
I, [2015-04-24T11:05:01.837211 #8666]  INFO -- default-precise32:     -AddIcon /icons/binhex.gif .hqx
I, [2015-04-24T11:05:01.837229 #8666]  INFO -- default-precise32:     -AddIcon /icons/tar.gif .tar
I, [2015-04-24T11:05:01.837248 #8666]  INFO -- default-precise32:     -AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
I, [2015-04-24T11:05:01.837286 #8666]  INFO -- default-precise32:     -AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
I, [2015-04-24T11:05:01.837305 #8666]  INFO -- default-precise32:     -AddIcon /icons/a.gif .ps .ai .eps
I, [2015-04-24T11:05:01.837339 #8666]  INFO -- default-precise32:     -AddIcon /icons/layout.gif .html .shtml .htm .pdf
I, [2015-04-24T11:05:01.837363 #8666]  INFO -- default-precise32:     -AddIcon /icons/text.gif .txt
I, [2015-04-24T11:05:01.837383 #8666]  INFO -- default-precise32:     -AddIcon /icons/c.gif .c
I, [2015-04-24T11:05:01.837402 #8666]  INFO -- default-precise32:     -AddIcon /icons/p.gif .pl .py
I, [2015-04-24T11:05:01.837420 #8666]  INFO -- default-precise32:     -AddIcon /icons/f.gif .for
I, [2015-04-24T11:05:01.837439 #8666]  INFO -- default-precise32:     -AddIcon /icons/dvi.gif .dvi
I, [2015-04-24T11:05:01.837457 #8666]  INFO -- default-precise32:     -AddIcon /icons/uuencoded.gif .uu
I, [2015-04-24T11:05:01.837476 #8666]  INFO -- default-precise32:     -AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
I, [2015-04-24T11:05:01.837495 #8666]  INFO -- default-precise32:     -AddIcon /icons/tex.gif .tex
I, [2015-04-24T11:05:01.837514 #8666]  INFO -- default-precise32:     -# It's a suffix rule, so simply matching "core" matches "score" as well !
I, [2015-04-24T11:05:01.837532 #8666]  INFO -- default-precise32:     -AddIcon /icons/bomb.gif /core
I, [2015-04-24T11:05:01.880615 #8666]  INFO -- default-precise32: -AddIcon (SND,/icons/sound2.gif) .ogg
I, [2015-04-24T11:05:01.880888 #8666]  INFO -- default-precise32:     -AddIcon (VID,/icons/movie.gif) .ogm
I, [2015-04-24T11:05:01.881100 #8666]  INFO -- default-precise32:     +  AddIcon /icons/binary.gif .bin .exe
I, [2015-04-24T11:05:01.881341 #8666]  INFO -- default-precise32:     +  AddIcon /icons/binhex.gif .hqx
I, [2015-04-24T11:05:01.881659 #8666]  INFO -- default-precise32:     +  AddIcon /icons/tar.gif .tar
I, [2015-04-24T11:05:01.881873 #8666]  INFO -- default-precise32:     +  AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
I, [2015-04-24T11:05:01.882110 #8666]  INFO -- default-precise32:     +  AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
I, [2015-04-24T11:05:01.882324 #8666]  INFO -- default-precise32:     +  AddIcon /icons/a.gif .ps .ai .eps
I, [2015-04-24T11:05:01.882533 #8666]  INFO -- default-precise32:     +  AddIcon /icons/layout.gif .html .shtml .htm .pdf
I, [2015-04-24T11:05:01.882726 #8666]  INFO -- default-precise32:     +  AddIcon /icons/text.gif .txt
I, [2015-04-24T11:05:01.882945 #8666]  INFO -- default-precise32:     +  AddIcon /icons/c.gif .c
I, [2015-04-24T11:05:01.883224 #8666]  INFO -- default-precise32:     +  AddIcon /icons/p.gif .pl .py
I, [2015-04-24T11:05:01.883471 #8666]  INFO -- default-precise32:     +  AddIcon /icons/f.gif .for
I, [2015-04-24T11:05:01.883676 #8666]  INFO -- default-precise32:     +  AddIcon /icons/dvi.gif .dvi
I, [2015-04-24T11:05:01.883881 #8666]  INFO -- default-precise32:     +  AddIcon /icons/uuencoded.gif .uu
I, [2015-04-24T11:05:01.884150 #8666]  INFO -- default-precise32:     +  AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
I, [2015-04-24T11:05:01.884420 #8666]  INFO -- default-precise32:     +  AddIcon /icons/tex.gif .tex
I, [2015-04-24T11:05:01.884640 #8666]  INFO -- default-precise32:     +  # It's a suffix rule, so simply matching "core" matches "score" as well !
I, [2015-04-24T11:05:01.884853 #8666]  INFO -- default-precise32:     +  AddIcon /icons/bomb.gif /core
I, [2015-04-24T11:05:01.885043 #8666]  INFO -- default-precise32:     +  AddIcon (SND,/icons/sound2.gif) .ogg
I, [2015-04-24T11:05:01.885339 #8666]  INFO -- default-precise32:     +  AddIcon (VID,/icons/movie.gif) .ogm
I, [2015-04-24T11:05:01.888163 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:01.892952 #8666]  INFO -- default-precise32:     -AddIcon /icons/back.gif ..
I, [2015-04-24T11:05:01.895677 #8666]  INFO -- default-precise32:     -AddIcon /icons/hand.right.gif README
I, [2015-04-24T11:05:01.899060 #8666]  INFO -- default-precise32:     -AddIcon /icons/folder.gif ^^DIRECTORY^^
I, [2015-04-24T11:05:01.901524 #8666]  INFO -- default-precise32:     -AddIcon /icons/blank.gif ^^BLANKICON^^
I, [2015-04-24T11:05:01.904382 #8666]  INFO -- default-precise32:     +  AddIcon /icons/back.gif ..
I, [2015-04-24T11:05:01.907326 #8666]  INFO -- default-precise32:     +  AddIcon /icons/hand.right.gif README
I, [2015-04-24T11:05:01.910104 #8666]  INFO -- default-precise32:     +  AddIcon /icons/folder.gif ^^DIRECTORY^^
I, [2015-04-24T11:05:01.912455 #8666]  INFO -- default-precise32:     +  AddIcon /icons/blank.gif ^^BLANKICON^^
I, [2015-04-24T11:05:01.914281 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:01.916995 #8666]  INFO -- default-precise32:     -# Default icons for OpenDocument format
I, [2015-04-24T11:05:01.919149 #8666]  INFO -- default-precise32:     -AddIcon /icons/odf6odt-20x22.png .odt
I, [2015-04-24T11:05:01.921485 #8666]  INFO -- default-precise32:     -AddIcon /icons/odf6ods-20x22.png .ods
I, [2015-04-24T11:05:01.923546 #8666]  INFO -- default-precise32:     -AddIcon /icons/odf6odp-20x22.png .odp
I, [2015-04-24T11:05:01.925684 #8666]  INFO -- default-precise32:     -AddIcon /icons/odf6odg-20x22.png .odg
I, [2015-04-24T11:05:01.927771 #8666]  INFO -- default-precise32:     -AddIcon /icons/odf6odc-20x22.png .odc
I, [2015-04-24T11:05:01.930341 #8666]  INFO -- default-precise32:     -AddIcon /icons/odf6odf-20x22.png .odf
I, [2015-04-24T11:05:01.933351 #8666]  INFO -- default-precise32:     -AddIcon /icons/odf6odb-20x22.png .odb
I, [2015-04-24T11:05:01.935428 #8666]  INFO -- default-precise32:     -AddIcon /icons/odf6odi-20x22.png .odi
I, [2015-04-24T11:05:01.937603 #8666]  INFO -- default-precise32:     -AddIcon /icons/odf6odm-20x22.png .odm
I, [2015-04-24T11:05:01.939616 #8666]  INFO -- default-precise32:     +  # Default icons for OpenDocument format
I, [2015-04-24T11:05:01.941978 #8666]  INFO -- default-precise32:     +  AddIcon /icons/odf6odt-20x22.png .odt
I, [2015-04-24T11:05:01.944035 #8666]  INFO -- default-precise32:     +  AddIcon /icons/odf6ods-20x22.png .ods
I, [2015-04-24T11:05:01.946705 #8666]  INFO -- default-precise32:     +  AddIcon /icons/odf6odp-20x22.png .odp
I, [2015-04-24T11:05:01.949141 #8666]  INFO -- default-precise32:     +  AddIcon /icons/odf6odg-20x22.png .odg
I, [2015-04-24T11:05:01.951318 #8666]  INFO -- default-precise32:     +  AddIcon /icons/odf6odc-20x22.png .odc
I, [2015-04-24T11:05:01.953648 #8666]  INFO -- default-precise32:     +  AddIcon /icons/odf6odf-20x22.png .odf
I, [2015-04-24T11:05:01.955514 #8666]  INFO -- default-precise32:     +  AddIcon /icons/odf6odb-20x22.png .odb
I, [2015-04-24T11:05:01.957730 #8666]  INFO -- default-precise32:     +  AddIcon /icons/odf6odi-20x22.png .odi
I, [2015-04-24T11:05:01.959691 #8666]  INFO -- default-precise32:     +  AddIcon /icons/odf6odm-20x22.png .odm
I, [2015-04-24T11:05:01.962151 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:01.964406 #8666]  INFO -- default-precise32:     -AddIcon /icons/odf6ott-20x22.png .ott
I, [2015-04-24T11:05:01.967428 #8666]  INFO -- default-precise32:     -AddIcon /icons/odf6ots-20x22.png .ots
I, [2015-04-24T11:05:01.969956 #8666]  INFO -- default-precise32:     -AddIcon /icons/odf6otp-20x22.png .otp
I, [2015-04-24T11:05:01.971977 #8666]  INFO -- default-precise32:     -AddIcon /icons/odf6otg-20x22.png .otg
I, [2015-04-24T11:05:01.974413 #8666]  INFO -- default-precise32:     -AddIcon /icons/odf6otc-20x22.png .otc
I, [2015-04-24T11:05:01.976547 #8666]  INFO -- default-precise32:     -AddIcon /icons/odf6otf-20x22.png .otf
I, [2015-04-24T11:05:01.979013 #8666]  INFO -- default-precise32:     -AddIcon /icons/odf6oti-20x22.png .oti
I, [2015-04-24T11:05:01.981429 #8666]  INFO -- default-precise32:     -AddIcon /icons/odf6oth-20x22.png .oth
I, [2015-04-24T11:05:01.983546 #8666]  INFO -- default-precise32:     +  AddIcon /icons/odf6ott-20x22.png .ott
I, [2015-04-24T11:05:01.986217 #8666]  INFO -- default-precise32:     +  AddIcon /icons/odf6ots-20x22.png .ots
I, [2015-04-24T11:05:01.989044 #8666]  INFO -- default-precise32:     +  AddIcon /icons/odf6otp-20x22.png .otp
I, [2015-04-24T11:05:01.991290 #8666]  INFO -- default-precise32:     +  AddIcon /icons/odf6otg-20x22.png .otg
I, [2015-04-24T11:05:01.993622 #8666]  INFO -- default-precise32:     +  AddIcon /icons/odf6otc-20x22.png .otc
I, [2015-04-24T11:05:01.995853 #8666]  INFO -- default-precise32:     +  AddIcon /icons/odf6otf-20x22.png .otf
I, [2015-04-24T11:05:01.998765 #8666]  INFO -- default-precise32:     +  AddIcon /icons/odf6oti-20x22.png .oti
I, [2015-04-24T11:05:02.001424 #8666]  INFO -- default-precise32:     +  AddIcon /icons/odf6oth-20x22.png .oth
I, [2015-04-24T11:05:02.004296 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:02.006477 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.008977 #8666]  INFO -- default-precise32:     -# DefaultIcon is which icon to show for files which do not have an icon
I, [2015-04-24T11:05:02.011337 #8666]  INFO -- default-precise32:     -# explicitly set.
I, [2015-04-24T11:05:02.013548 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.016167 #8666]  INFO -- default-precise32:     -DefaultIcon /icons/unknown.gif
I, [2015-04-24T11:05:02.018357 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.020874 #8666]  INFO -- default-precise32:     +  # DefaultIcon is which icon to show for files which do not have an icon
I, [2015-04-24T11:05:02.023268 #8666]  INFO -- default-precise32:     +  # explicitly set.
I, [2015-04-24T11:05:02.025501 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.027989 #8666]  INFO -- default-precise32:     +  DefaultIcon /icons/unknown.gif
I, [2015-04-24T11:05:02.031263 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:02.034042 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.037048 #8666]  INFO -- default-precise32:     -# AddDescription allows you to place a short description after a file in
I, [2015-04-24T11:05:02.039598 #8666]  INFO -- default-precise32:     -# server-generated indexes.  These are only displayed for FancyIndexed
I, [2015-04-24T11:05:02.042298 #8666]  INFO -- default-precise32:     -# directories.
I, [2015-04-24T11:05:02.044462 #8666]  INFO -- default-precise32:     -# Format: AddDescription "description" filename
I, [2015-04-24T11:05:02.046989 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.049277 #8666]  INFO -- default-precise32:     -#AddDescription "GZIP compressed document" .gz
I, [2015-04-24T11:05:02.051390 #8666]  INFO -- default-precise32:     -#AddDescription "tar archive" .tar
I, [2015-04-24T11:05:02.053576 #8666]  INFO -- default-precise32:     -#AddDescription "GZIP compressed tar archive" .tgz
I, [2015-04-24T11:05:02.056033 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.058217 #8666]  INFO -- default-precise32:     +  # AddDescription allows you to place a short description after a file in
I, [2015-04-24T11:05:02.060814 #8666]  INFO -- default-precise32:     +  # server-generated indexes.  These are only displayed for FancyIndexed
I, [2015-04-24T11:05:02.063107 #8666]  INFO -- default-precise32:     +  # directories.
I, [2015-04-24T11:05:02.065369 #8666]  INFO -- default-precise32:     +  # Format: AddDescription "description" filename
I, [2015-04-24T11:05:02.068103 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.070563 #8666]  INFO -- default-precise32:     +  #AddDescription "GZIP compressed document" .gz
I, [2015-04-24T11:05:02.073113 #8666]  INFO -- default-precise32:     +  #AddDescription "tar archive" .tar
I, [2015-04-24T11:05:02.075424 #8666]  INFO -- default-precise32:     +  #AddDescription "GZIP compressed tar archive" .tgz
I, [2015-04-24T11:05:02.077516 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:02.080084 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.082234 #8666]  INFO -- default-precise32:     -# ReadmeName is the name of the README file the server will look for by
I, [2015-04-24T11:05:02.084621 #8666]  INFO -- default-precise32:     -# default, and append to directory listings.
I, [2015-04-24T11:05:02.086995 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.089296 #8666]  INFO -- default-precise32:     -# HeaderName is the name of a file which should be prepended to
I, [2015-04-24T11:05:02.091410 #8666]  INFO -- default-precise32:     -# directory indexes. 
I, [2015-04-24T11:05:02.094134 #8666]  INFO -- default-precise32:     -ReadmeName README.html
I, [2015-04-24T11:05:02.096582 #8666]  INFO -- default-precise32:     -HeaderName HEADER.html
I, [2015-04-24T11:05:02.098796 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.101426 #8666]  INFO -- default-precise32:     +  # ReadmeName is the name of the README file the server will look for by
I, [2015-04-24T11:05:02.104074 #8666]  INFO -- default-precise32:     +  # default, and append to directory listings.
I, [2015-04-24T11:05:02.106200 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.108419 #8666]  INFO -- default-precise32:     +  # HeaderName is the name of a file which should be prepended to
I, [2015-04-24T11:05:02.110866 #8666]  INFO -- default-precise32:     +  # directory indexes.
I, [2015-04-24T11:05:02.113198 #8666]  INFO -- default-precise32:     +  ReadmeName README.html
I, [2015-04-24T11:05:02.115459 #8666]  INFO -- default-precise32:     +  HeaderName HEADER.html
I, [2015-04-24T11:05:02.120286 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:02.122355 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.125141 #8666]  INFO -- default-precise32:     -# IndexIgnore is a set of filenames which directory indexing should ignore
I, [2015-04-24T11:05:02.128330 #8666]  INFO -- default-precise32:     -# and not include in the listing.  Shell-style wildcarding is permitted.
I, [2015-04-24T11:05:02.131018 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.134474 #8666]  INFO -- default-precise32:     -IndexIgnore .??* *~ *# RCS CVS *,v *,t 
I, [2015-04-24T11:05:02.135906 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:05:02.138194 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.140287 #8666]  INFO -- default-precise32:     +  # IndexIgnore is a set of filenames which directory indexing should ignore
I, [2015-04-24T11:05:02.142859 #8666]  INFO -- default-precise32:     +  # and not include in the listing.  Shell-style wildcarding is permitted.
I, [2015-04-24T11:05:02.145100 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.146585 #8666]  INFO -- default-precise32:     +  IndexIgnore .??* *~ *# RCS CVS *,v *,t
I, [2015-04-24T11:05:02.150417 #8666]  INFO -- default-precise32:      </IfModule>
I, [2015-04-24T11:05:02.159667 #8666]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/autoindex.load] action create (up to date)
I, [2015-04-24T11:05:02.164429 #8666]  INFO -- default-precise32:   * execute[a2enmod autoindex] action run (skipped due to not_if)
I, [2015-04-24T11:05:02.166300 #8666]  INFO -- default-precise32: Recipe: apache2::mod_dir
I, [2015-04-24T11:05:02.180468 #8666]  INFO -- default-precise32:   * template[/etc/apache2/mods-available/dir.conf] action create
I, [2015-04-24T11:05:02.183178 #8666]  INFO -- default-precise32:     - update content in file /etc/apache2/mods-available/dir.conf from f8a5bd to 5d2651
I, [2015-04-24T11:05:02.187145 #8666]  INFO -- default-precise32:     --- /etc/apache2/mods-available/dir.conf	2012-02-07 04:17:00.000000000 +0000
I, [2015-04-24T11:05:02.191395 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-h1csjp	2015-04-24 08:05:02.168642954 +0000
I, [2015-04-24T11:05:02.193897 #8666]  INFO -- default-precise32:     @@ -1,6 +1,4 @@
I, [2015-04-24T11:05:02.196939 #8666]  INFO -- default-precise32:      <IfModule mod_dir.c>
I, [2015-04-24T11:05:02.198713 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:05:02.201424 #8666]  INFO -- default-precise32:     -          DirectoryIndex index.html index.cgi index.pl index.php index.xhtml index.htm
I, [2015-04-24T11:05:02.203417 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:05:02.206030 #8666]  INFO -- default-precise32:     +  DirectoryIndex index.html index.cgi index.pl index.php index.xhtml index.htm
I, [2015-04-24T11:05:02.210038 #8666]  INFO -- default-precise32:      </IfModule>
I, [2015-04-24T11:05:02.218541 #8666]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/dir.load] action create (up to date)
I, [2015-04-24T11:05:02.222896 #8666]  INFO -- default-precise32:   * execute[a2enmod dir] action run (skipped due to not_if)
I, [2015-04-24T11:05:02.225047 #8666]  INFO -- default-precise32: Recipe: apache2::mod_env
I, [2015-04-24T11:05:02.235167 #8666]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/env.load] action create (up to date)
I, [2015-04-24T11:05:02.239282 #8666]  INFO -- default-precise32:   * execute[a2enmod env] action run (skipped due to not_if)
I, [2015-04-24T11:05:02.241338 #8666]  INFO -- default-precise32: Recipe: apache2::mod_mime
I, [2015-04-24T11:05:02.279390 #8666]  INFO -- default-precise32:   * template[/etc/apache2/mods-available/mime.conf] action create
I, [2015-04-24T11:05:02.282319 #8666]  INFO -- default-precise32:     - update content in file /etc/apache2/mods-available/mime.conf from 43438f to 76e7d0
I, [2015-04-24T11:05:02.285698 #8666]  INFO -- default-precise32:     --- /etc/apache2/mods-available/mime.conf	2012-02-07 04:16:59.000000000 +0000
I, [2015-04-24T11:05:02.290313 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-1j00r51	2015-04-24 08:05:02.244641998 +0000
I, [2015-04-24T11:05:02.292446 #8666]  INFO -- default-precise32:     @@ -1,247 +1,193 @@
I, [2015-04-24T11:05:02.294414 #8666]  INFO -- default-precise32:      <IfModule mod_mime.c>
I, [2015-04-24T11:05:02.297425 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.300095 #8666]  INFO -- default-precise32:     +  # TypesConfig points to the file containing the list of mappings from
I, [2015-04-24T11:05:02.301576 #8666]  INFO -- default-precise32:     +  # filename extension to MIME-type.
I, [2015-04-24T11:05:02.303538 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.305361 #8666]  INFO -- default-precise32: +  TypesConfig /etc/mime.types
I, [2015-04-24T11:05:02.307582 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:02.310418 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.312069 #8666]  INFO -- default-precise32:     -# TypesConfig points to the file containing the list of mappings from
I, [2015-04-24T11:05:02.314405 #8666]  INFO -- default-precise32:     -# filename extension to MIME-type.
I, [2015-04-24T11:05:02.316547 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.320418 #8666]  INFO -- default-precise32:     -TypesConfig /etc/mime.types
I, [2015-04-24T11:05:02.320450 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.320472 #8666]  INFO -- default-precise32:     +  # AddType allows you to add to or override the MIME configuration
I, [2015-04-24T11:05:02.321465 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:05:02.323345 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.325152 #8666]  INFO -- default-precise32:     +  #AddType application/x-gzip .tgz
I, [2015-04-24T11:05:02.327417 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.329559 #8666]  INFO -- default-precise32:     +  # AddEncoding allows you to have certain browsers uncompress
I, [2015-04-24T11:05:02.333444 #8666]  INFO -- default-precise32:     +  # information on the fly. Note: Not all browsers support this.
I, [2015-04-24T11:05:02.333476 #8666]  INFO -- default-precise32:     +  # Despite the name similarity, the following Add* directives have
I, [2015-04-24T11:05:02.333726 #8666]  INFO -- default-precise32: +  # nothing to do with the FancyIndexing customization directives above.
I, [2015-04-24T11:05:02.336385 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.336422 #8666]  INFO -- default-precise32:     +  #AddEncoding x-compress .Z
I, [2015-04-24T11:05:02.338304 #8666]  INFO -- default-precise32:     +  #AddEncoding x-gzip .gz .tgz
I, [2015-04-24T11:05:02.339425 #8666]  INFO -- default-precise32:     +  #AddEncoding x-bzip2 .bz2
I, [2015-04-24T11:05:02.385594 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.385671 #8666]  INFO -- default-precise32:     +  # If the AddEncoding directives above are commented-out, then you
I, [2015-04-24T11:05:02.385709 #8666]  INFO -- default-precise32:     +  # probably should define those extensions to indicate media types:
I, [2015-04-24T11:05:02.385732 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.385752 #8666]  INFO -- default-precise32:     +  AddType application/x-compress .Z
I, [2015-04-24T11:05:02.385771 #8666]  INFO -- default-precise32:     +  AddType application/x-gzip .gz .tgz
I, [2015-04-24T11:05:02.385789 #8666]  INFO -- default-precise32:     +  AddType application/x-bzip2 .bz2
I, [2015-04-24T11:05:02.385808 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:02.385826 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.385844 #8666]  INFO -- default-precise32:     -# AddType allows you to add to or override the MIME configuration
I, [2015-04-24T11:05:02.385884 #8666]  INFO -- default-precise32:     -# file mime.types for specific file types.
I, [2015-04-24T11:05:02.385902 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.385920 #8666]  INFO -- default-precise32:     -#AddType application/x-gzip .tgz
I, [2015-04-24T11:05:02.385938 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.385956 #8666]  INFO -- default-precise32:     -# AddEncoding allows you to have certain browsers uncompress
I, [2015-04-24T11:05:02.385975 #8666]  INFO -- default-precise32:     -# information on the fly. Note: Not all browsers support this.
I, [2015-04-24T11:05:02.385993 #8666]  INFO -- default-precise32:     -# Despite the name similarity, the following Add* directives have
I, [2015-04-24T11:05:02.386012 #8666]  INFO -- default-precise32:     -# nothing to do with the FancyIndexing customization directives above.
I, [2015-04-24T11:05:02.386031 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.386060 #8666]  INFO -- default-precise32:     -#AddEncoding x-compress .Z
I, [2015-04-24T11:05:02.386079 #8666]  INFO -- default-precise32:     -#AddEncoding x-gzip .gz .tgz
I, [2015-04-24T11:05:02.386097 #8666]  INFO -- default-precise32:     -#AddEncoding x-bzip2 .bz2
I, [2015-04-24T11:05:02.386115 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.386133 #8666]  INFO -- default-precise32:     -# If the AddEncoding directives above are commented-out, then you
I, [2015-04-24T11:05:02.386151 #8666]  INFO -- default-precise32:     -# probably should define those extensions to indicate media types:
I, [2015-04-24T11:05:02.386169 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.386187 #8666]  INFO -- default-precise32:     -AddType application/x-compress .Z
I, [2015-04-24T11:05:02.386205 #8666]  INFO -- default-precise32:     -AddType application/x-gzip .gz .tgz
I, [2015-04-24T11:05:02.386223 #8666]  INFO -- default-precise32:     -AddType application/x-bzip2 .bz2
I, [2015-04-24T11:05:02.386241 #8666]  INFO -- default-precise32:     +  AddType image/svg+xml svg svgz
I, [2015-04-24T11:05:02.386277 #8666]  INFO -- default-precise32:     +  AddEncoding gzip svgz
I, [2015-04-24T11:05:02.386297 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:02.386314 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.386332 #8666]  INFO -- default-precise32:     -# DefaultLanguage and AddLanguage allows you to specify the language of 
I, [2015-04-24T11:05:02.386351 #8666]  INFO -- default-precise32:     -# a document. You can then use content negotiation to give a browser a 
I, [2015-04-24T11:05:02.386369 #8666]  INFO -- default-precise32:     -# file in a language the user can understand.
I, [2015-04-24T11:05:02.386387 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.386417 #8666]  INFO -- default-precise32:     -# Specify a default language. This means that all data
I, [2015-04-24T11:05:02.386436 #8666]  INFO -- default-precise32:     -# going out without a specific language tag (see below) will 
I, [2015-04-24T11:05:02.386471 #8666]  INFO -- default-precise32:     -# be marked with this one. You probably do NOT want to set
I, [2015-04-24T11:05:02.386491 #8666]  INFO -- default-precise32:     -# this unless you are sure it is correct for all cases.
I, [2015-04-24T11:05:02.386512 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.386532 #8666]  INFO -- default-precise32:     -# * It is generally better to not mark a page as 
I, [2015-04-24T11:05:02.386551 #8666]  INFO -- default-precise32:     -# * being a certain language than marking it with the wrong
I, [2015-04-24T11:05:02.386569 #8666]  INFO -- default-precise32:     -# * language!
I, [2015-04-24T11:05:02.386587 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.386605 #8666]  INFO -- default-precise32:     -# DefaultLanguage nl
I, [2015-04-24T11:05:02.386624 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.386642 #8666]  INFO -- default-precise32:     -# Note 1: The suffix does not have to be the same as the language
I, [2015-04-24T11:05:02.386661 #8666]  INFO -- default-precise32:     -# keyword --- those with documents in Polish (whose net-standard
I, [2015-04-24T11:05:02.386680 #8666]  INFO -- default-precise32:     -# language code is pl) may wish to use "AddLanguage pl .po" to
I, [2015-04-24T11:05:02.386716 #8666]  INFO -- default-precise32:     -# avoid the ambiguity with the common suffix for perl scripts.
I, [2015-04-24T11:05:02.386736 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.386754 #8666]  INFO -- default-precise32:     -# Note 2: The example entries below illustrate that in some cases 
I, [2015-04-24T11:05:02.386772 #8666]  INFO -- default-precise32:     -# the two character 'Language' abbreviation is not identical to 
I, [2015-04-24T11:05:02.386790 #8666]  INFO -- default-precise32:     -# the two character 'Country' code for its country,
I, [2015-04-24T11:05:02.386809 #8666]  INFO -- default-precise32:     -# E.g. 'Danmark/dk' versus 'Danish/da'.
I, [2015-04-24T11:05:02.386826 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.386844 #8666]  INFO -- default-precise32:     -# Note 3: In the case of 'ltz' we violate the RFC by using a three char
I, [2015-04-24T11:05:02.386862 #8666]  INFO -- default-precise32:     -# specifier. There is 'work in progress' to fix this and get
I, [2015-04-24T11:05:02.386881 #8666]  INFO -- default-precise32:     -# the reference data for rfc1766 cleaned up.
I, [2015-04-24T11:05:02.386899 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.386917 #8666]  INFO -- default-precise32:     -# Catalan (ca) - Croatian (hr) - Czech (cs) - Danish (da) - Dutch (nl)
I, [2015-04-24T11:05:02.386935 #8666]  INFO -- default-precise32:     -# English (en) - Esperanto (eo) - Estonian (et) - French (fr) - German (de)
I, [2015-04-24T11:05:02.386953 #8666]  INFO -- default-precise32:     -# Greek-Modern (el) - Hebrew (he) - Italian (it) - Japanese (ja)
I, [2015-04-24T11:05:02.386972 #8666]  INFO -- default-precise32:     -# Korean (ko) - Luxembourgeois* (ltz) - Norwegian Nynorsk (nn)
I, [2015-04-24T11:05:02.386990 #8666]  INFO -- default-precise32:     -# Norwegian (no) - Polish (pl) - Portugese (pt)
I, [2015-04-24T11:05:02.387023 #8666]  INFO -- default-precise32:     -# Brazilian Portuguese (pt-BR) - Russian (ru) - Swedish (sv)
I, [2015-04-24T11:05:02.387042 #8666]  INFO -- default-precise32:     -# Simplified Chinese (zh-CN) - Spanish (es) - Traditional Chinese (zh-TW)
I, [2015-04-24T11:05:02.387060 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.387078 #8666]  INFO -- default-precise32:     -AddLanguage am .amh
I, [2015-04-24T11:05:02.387096 #8666]  INFO -- default-precise32:     -AddLanguage ar .ara
I, [2015-04-24T11:05:02.387113 #8666]  INFO -- default-precise32:     -AddLanguage be .be
I, [2015-04-24T11:05:02.387131 #8666]  INFO -- default-precise32:     -AddLanguage bg .bg
I, [2015-04-24T11:05:02.387148 #8666]  INFO -- default-precise32:     -AddLanguage bn .bn
I, [2015-04-24T11:05:02.387166 #8666]  INFO -- default-precise32:     -AddLanguage br .br
I, [2015-04-24T11:05:02.387184 #8666]  INFO -- default-precise32:     -AddLanguage bs .bs
I, [2015-04-24T11:05:02.387202 #8666]  INFO -- default-precise32:     -AddLanguage ca .ca
I, [2015-04-24T11:05:02.387224 #8666]  INFO -- default-precise32:     -AddLanguage cs .cz .cs
I, [2015-04-24T11:05:02.387242 #8666]  INFO -- default-precise32:     -AddLanguage cy .cy
I, [2015-04-24T11:05:02.387272 #8666]  INFO -- default-precise32:     -AddLanguage da .dk
I, [2015-04-24T11:05:02.387291 #8666]  INFO -- default-precise32:     -AddLanguage de .de
I, [2015-04-24T11:05:02.387309 #8666]  INFO -- default-precise32:     -AddLanguage dz .dz
I, [2015-04-24T11:05:02.387327 #8666]  INFO -- default-precise32:     -AddLanguage el .el
I, [2015-04-24T11:05:02.387344 #8666]  INFO -- default-precise32:     -AddLanguage en .en
I, [2015-04-24T11:05:02.387362 #8666]  INFO -- default-precise32:     -AddLanguage eo .eo
I, [2015-04-24T11:05:02.387380 #8666]  INFO -- default-precise32:     -# es is ecmascript in /etc/mime.types
I, [2015-04-24T11:05:02.387398 #8666]  INFO -- default-precise32:     -RemoveType  es
I, [2015-04-24T11:05:02.387428 #8666]  INFO -- default-precise32:     -AddLanguage es .es
I, [2015-04-24T11:05:02.387446 #8666]  INFO -- default-precise32:     -AddLanguage et .et
I, [2015-04-24T11:05:02.387464 #8666]  INFO -- default-precise32:     -AddLanguage eu .eu
I, [2015-04-24T11:05:02.387482 #8666]  INFO -- default-precise32:     -AddLanguage fa .fa
I, [2015-04-24T11:05:02.387511 #8666]  INFO -- default-precise32:     -AddLanguage fi .fi
I, [2015-04-24T11:05:02.387530 #8666]  INFO -- default-precise32:     -AddLanguage fr .fr
I, [2015-04-24T11:05:02.387567 #8666]  INFO -- default-precise32:     -AddLanguage ga .ga
I, [2015-04-24T11:05:02.387587 #8666]  INFO -- default-precise32:     -AddLanguage gl .glg
I, [2015-04-24T11:05:02.387606 #8666]  INFO -- default-precise32:     -AddLanguage gu .gu
I, [2015-04-24T11:05:02.387624 #8666]  INFO -- default-precise32:     -AddLanguage he .he
I, [2015-04-24T11:05:02.387642 #8666]  INFO -- default-precise32:     -AddLanguage hi .hi
I, [2015-04-24T11:05:02.387660 #8666]  INFO -- default-precise32:     -AddLanguage hr .hr
I, [2015-04-24T11:05:02.387679 #8666]  INFO -- default-precise32:     -AddLanguage hu .hu
I, [2015-04-24T11:05:02.387702 #8666]  INFO -- default-precise32:     -AddLanguage hy .hy
I, [2015-04-24T11:05:02.387733 #8666]  INFO -- default-precise32:     -AddLanguage id .id
I, [2015-04-24T11:05:02.387751 #8666]  INFO -- default-precise32:     -AddLanguage is .is
I, [2015-04-24T11:05:02.387769 #8666]  INFO -- default-precise32:     -AddLanguage it .it
I, [2015-04-24T11:05:02.387786 #8666]  INFO -- default-precise32:     -AddLanguage ja .ja
I, [2015-04-24T11:05:02.389078 #8666]  INFO -- default-precise32: -AddLanguage ka .ka
I, [2015-04-24T11:05:02.389105 #8666]  INFO -- default-precise32:     -AddLanguage kk .kk
I, [2015-04-24T11:05:02.389124 #8666]  INFO -- default-precise32:     -AddLanguage km .km
I, [2015-04-24T11:05:02.389160 #8666]  INFO -- default-precise32:     -AddLanguage kn .kn
I, [2015-04-24T11:05:02.389179 #8666]  INFO -- default-precise32:     -AddLanguage ko .ko
I, [2015-04-24T11:05:02.389209 #8666]  INFO -- default-precise32:     -AddLanguage ku .ku
I, [2015-04-24T11:05:02.389227 #8666]  INFO -- default-precise32:     -AddLanguage lo .lo
I, [2015-04-24T11:05:02.389283 #8666]  INFO -- default-precise32:     -AddLanguage lt .lt
I, [2015-04-24T11:05:02.389303 #8666]  INFO -- default-precise32:     -AddLanguage ltz .ltz
I, [2015-04-24T11:05:02.389321 #8666]  INFO -- default-precise32:     -AddLanguage lv .lv
I, [2015-04-24T11:05:02.389339 #8666]  INFO -- default-precise32:     -AddLanguage mg .mg
I, [2015-04-24T11:05:02.389357 #8666]  INFO -- default-precise32:     -AddLanguage mk .mk
I, [2015-04-24T11:05:02.389375 #8666]  INFO -- default-precise32:     -AddLanguage ml .ml
I, [2015-04-24T11:05:02.389393 #8666]  INFO -- default-precise32:     -AddLanguage mr .mr
I, [2015-04-24T11:05:02.389410 #8666]  INFO -- default-precise32:     -AddLanguage ms .msa
I, [2015-04-24T11:05:02.389428 #8666]  INFO -- default-precise32:     -AddLanguage nb .nob
I, [2015-04-24T11:05:02.389446 #8666]  INFO -- default-precise32:     -AddLanguage ne .ne
I, [2015-04-24T11:05:02.389480 #8666]  INFO -- default-precise32:     -AddLanguage nl .nl
I, [2015-04-24T11:05:02.389512 #8666]  INFO -- default-precise32:     -AddLanguage nn .nn
I, [2015-04-24T11:05:02.389530 #8666]  INFO -- default-precise32:     -AddLanguage no .no
I, [2015-04-24T11:05:02.389547 #8666]  INFO -- default-precise32:     -AddLanguage pa .pa
I, [2015-04-24T11:05:02.389927 #8666]  INFO -- default-precise32: -AddLanguage pl .po
I, [2015-04-24T11:05:02.390133 #8666]  INFO -- default-precise32:     -AddLanguage pt-BR .pt-br
I, [2015-04-24T11:05:02.390366 #8666]  INFO -- default-precise32:     -AddLanguage pt .pt
I, [2015-04-24T11:05:02.390569 #8666]  INFO -- default-precise32:     -AddLanguage ro .ro
I, [2015-04-24T11:05:02.390684 #8666]  INFO -- default-precise32:     -AddLanguage ru .ru
I, [2015-04-24T11:05:02.390716 #8666]  INFO -- default-precise32:     -AddLanguage sa .sa
I, [2015-04-24T11:05:02.390911 #8666]  INFO -- default-precise32:     -AddLanguage se .se
I, [2015-04-24T11:05:02.391116 #8666]  INFO -- default-precise32:     -AddLanguage si .si
I, [2015-04-24T11:05:02.391341 #8666]  INFO -- default-precise32:     -AddLanguage sk .sk
I, [2015-04-24T11:05:02.391438 #8666]  INFO -- default-precise32:     -AddLanguage sl .sl
I, [2015-04-24T11:05:02.391625 #8666]  INFO -- default-precise32:     -AddLanguage sq .sq
I, [2015-04-24T11:05:02.391837 #8666]  INFO -- default-precise32:     -AddLanguage sr .sr
I, [2015-04-24T11:05:02.391944 #8666]  INFO -- default-precise32:     -AddLanguage sv .sv
I, [2015-04-24T11:05:02.392150 #8666]  INFO -- default-precise32:     -AddLanguage ta .ta
I, [2015-04-24T11:05:02.392243 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:05:02.392466 #8666]  INFO -- default-precise32:     -AddLanguage th .th
I, [2015-04-24T11:05:02.392606 #8666]  INFO -- default-precise32:     -AddLanguage tl .tl
I, [2015-04-24T11:05:02.392771 #8666]  INFO -- default-precise32:     -RemoveType  tr
I, [2015-04-24T11:05:02.392959 #8666]  INFO -- default-precise32:     -# tr is troff in /etc/mime.types
I, [2015-04-24T11:05:02.425359 #8666]  INFO -- default-precise32:     -AddLanguage tr .tr
I, [2015-04-24T11:05:02.425691 #8666]  INFO -- default-precise32:     -AddLanguage uk .uk
I, [2015-04-24T11:05:02.425919 #8666]  INFO -- default-precise32:     -AddLanguage ur .ur
I, [2015-04-24T11:05:02.426146 #8666]  INFO -- default-precise32:     -AddLanguage vi .vi
I, [2015-04-24T11:05:02.426378 #8666]  INFO -- default-precise32:     -AddLanguage wo .wo
I, [2015-04-24T11:05:02.426578 #8666]  INFO -- default-precise32:     -AddLanguage xh .xh
I, [2015-04-24T11:05:02.426814 #8666]  INFO -- default-precise32:     -AddLanguage zh-CN .zh-cn
I, [2015-04-24T11:05:02.427036 #8666]  INFO -- default-precise32:     -AddLanguage zh-TW .zh-tw
I, [2015-04-24T11:05:02.427233 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.427470 #8666]  INFO -- default-precise32:     +  # DefaultLanguage and AddLanguage allows you to specify the language of
I, [2015-04-24T11:05:02.427669 #8666]  INFO -- default-precise32:     +  # a document. You can then use content negotiation to give a browser a
I, [2015-04-24T11:05:02.427919 #8666]  INFO -- default-precise32:     +  # file in a language the user can understand.
I, [2015-04-24T11:05:02.428149 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.428428 #8666]  INFO -- default-precise32:     +  # Specify a default language. This means that all data
I, [2015-04-24T11:05:02.428639 #8666]  INFO -- default-precise32:     +  # going out without a specific language tag (see below) will
I, [2015-04-24T11:05:02.428869 #8666]  INFO -- default-precise32:     +  # be marked with this one. You probably do NOT want to set
I, [2015-04-24T11:05:02.429075 #8666]  INFO -- default-precise32:     +  # this unless you are sure it is correct for all cases.
I, [2015-04-24T11:05:02.429318 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.429521 #8666]  INFO -- default-precise32:     +  # * It is generally better to not mark a page as
I, [2015-04-24T11:05:02.429753 #8666]  INFO -- default-precise32:     +  # * being a certain language than marking it with the wrong
I, [2015-04-24T11:05:02.431734 #8666]  INFO -- default-precise32:     +  # * language!
I, [2015-04-24T11:05:02.433241 #8666]  INFO -- default-precise32: +  #
I, [2015-04-24T11:05:02.434201 #8666]  INFO -- default-precise32:     +  # DefaultLanguage nl
I, [2015-04-24T11:05:02.436084 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.437992 #8666]  INFO -- default-precise32: +  # Note 1: The suffix does not have to be the same as the language
I, [2015-04-24T11:05:02.438166 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:05:02.440241 #8666]  INFO -- default-precise32:     +  # language code is pl) may wish to use "AddLanguage pl .po" to
I, [2015-04-24T11:05:02.443758 #8666]  INFO -- default-precise32: +  # avoid the ambiguity with the common suffix for perl scripts.
I, [2015-04-24T11:05:02.443805 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.443826 #8666]  INFO -- default-precise32:     +  # Note 2: The example entries below illustrate that in some cases
I, [2015-04-24T11:05:02.443845 #8666]  INFO -- default-precise32:     +  # the two character 'Language' abbreviation is not identical to
I, [2015-04-24T11:05:02.445362 #8666]  INFO -- default-precise32:     +  # the two character 'Country' code for its country,
I, [2015-04-24T11:05:02.447392 #8666]  INFO -- default-precise32:     +  # E.g. 'Danmark/dk' versus 'Danish/da'.
I, [2015-04-24T11:05:02.448868 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.450833 #8666]  INFO -- default-precise32:     +  # Note 3: In the case of 'ltz' we violate the RFC by using a three char
I, [2015-04-24T11:05:02.454878 #8666]  INFO -- default-precise32:     +  # specifier. There is 'work in progress' to fix this and get
I, [2015-04-24T11:05:02.455140 #8666]  INFO -- default-precise32:     +  # the reference data for rfc1766 cleaned up.
I, [2015-04-24T11:05:02.456888 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.458721 #8666]  INFO -- default-precise32:     +  # Catalan (ca) - Croatian (hr) - Czech (cs) - Danish (da) - Dutch (nl)
I, [2015-04-24T11:05:02.460711 #8666]  INFO -- default-precise32:     +  # English (en) - Esperanto (eo) - Estonian (et) - French (fr) - German (de)
I, [2015-04-24T11:05:02.462494 #8666]  INFO -- default-precise32:     +  # Greek-Modern (el) - Hebrew (he) - Italian (it) - Japanese (ja)
I, [2015-04-24T11:05:02.464816 #8666]  INFO -- default-precise32:     +  # Korean (ko) - Luxembourgeois* (ltz) - Norwegian Nynorsk (nn)
I, [2015-04-24T11:05:02.466392 #8666]  INFO -- default-precise32:     +  # Norwegian (no) - Polish (pl) - Portugese (pt)
I, [2015-04-24T11:05:02.468771 #8666]  INFO -- default-precise32:     +  # Brazilian Portuguese (pt-BR) - Russian (ru) - Swedish (sv)
I, [2015-04-24T11:05:02.470364 #8666]  INFO -- default-precise32:     +  # Simplified Chinese (zh-CN) - Spanish (es) - Traditional Chinese (zh-TW)
I, [2015-04-24T11:05:02.472719 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.474381 #8666]  INFO -- default-precise32:     +  AddLanguage ca .ca
I, [2015-04-24T11:05:02.476339 #8666]  INFO -- default-precise32:     +  AddLanguage cs .cz .cs
I, [2015-04-24T11:05:02.478247 #8666]  INFO -- default-precise32:     +  AddLanguage da .dk
I, [2015-04-24T11:05:02.480119 #8666]  INFO -- default-precise32:     +  AddLanguage de .de
I, [2015-04-24T11:05:02.484206 #8666]  INFO -- default-precise32:     +  AddLanguage el .el
I, [2015-04-24T11:05:02.484500 #8666]  INFO -- default-precise32:     +  AddLanguage en .en
I, [2015-04-24T11:05:02.485983 #8666]  INFO -- default-precise32:     +  AddLanguage eo .eo
I, [2015-04-24T11:05:02.488213 #8666]  INFO -- default-precise32:     +  # See README.Debian for Spanish
I, [2015-04-24T11:05:02.490102 #8666]  INFO -- default-precise32:     +  AddLanguage es .es
I, [2015-04-24T11:05:02.492216 #8666]  INFO -- default-precise32:     +  AddLanguage et .et
I, [2015-04-24T11:05:02.494110 #8666]  INFO -- default-precise32:     +  AddLanguage fr .fr
I, [2015-04-24T11:05:02.495725 #8666]  INFO -- default-precise32:     +  AddLanguage he .he
I, [2015-04-24T11:05:02.497735 #8666]  INFO -- default-precise32:     +  AddLanguage hr .hr
I, [2015-04-24T11:05:02.499335 #8666]  INFO -- default-precise32:     +  AddLanguage it .it
I, [2015-04-24T11:05:02.501360 #8666]  INFO -- default-precise32:     +  AddLanguage ja .ja
I, [2015-04-24T11:05:02.503136 #8666]  INFO -- default-precise32:     +  AddLanguage ko .ko
I, [2015-04-24T11:05:02.504962 #8666]  INFO -- default-precise32:     +  AddLanguage ltz .ltz
I, [2015-04-24T11:05:02.506747 #8666]  INFO -- default-precise32:     +  AddLanguage nl .nl
I, [2015-04-24T11:05:02.508708 #8666]  INFO -- default-precise32:     +  AddLanguage nn .nn
I, [2015-04-24T11:05:02.510326 #8666]  INFO -- default-precise32:     +  AddLanguage no .no
I, [2015-04-24T11:05:02.513723 #8666]  INFO -- default-precise32:     +  AddLanguage pl .po
I, [2015-04-24T11:05:02.514666 #8666]  INFO -- default-precise32:     +  AddLanguage pt .pt
I, [2015-04-24T11:05:02.516733 #8666]  INFO -- default-precise32:     +  AddLanguage pt-BR .pt-br
I, [2015-04-24T11:05:02.518690 #8666]  INFO -- default-precise32:     +  AddLanguage ru .ru
I, [2015-04-24T11:05:02.520863 #8666]  INFO -- default-precise32:     +  AddLanguage sv .sv
I, [2015-04-24T11:05:02.522977 #8666]  INFO -- default-precise32:     +  # See README.Debian for Turkish
I, [2015-04-24T11:05:02.525171 #8666]  INFO -- default-precise32:     +  AddLanguage tr .tr
I, [2015-04-24T11:05:02.527034 #8666]  INFO -- default-precise32:     +  AddLanguage zh-CN .zh-cn
I, [2015-04-24T11:05:02.529327 #8666]  INFO -- default-precise32:     +  AddLanguage zh-TW .zh-tw
I, [2015-04-24T11:05:02.531078 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:02.533333 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.535124 #8666]  INFO -- default-precise32:     -# Commonly used filename extensions to character sets. You probably
I, [2015-04-24T11:05:02.537067 #8666]  INFO -- default-precise32:     -# want to avoid clashes with the language extensions, unless you
I, [2015-04-24T11:05:02.538888 #8666]  INFO -- default-precise32:     -# are good at carefully testing your setup after each change.
I, [2015-04-24T11:05:02.543559 #8666]  INFO -- default-precise32:     -# See http://www.iana.org/assignments/character-sets for the
I, [2015-04-24T11:05:02.543832 #8666]  INFO -- default-precise32:     -# official list of charset names and their respective RFCs.
I, [2015-04-24T11:05:02.544991 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.547133 #8666]  INFO -- default-precise32:     -AddCharset us-ascii    .ascii .us-ascii
I, [2015-04-24T11:05:02.549135 #8666]  INFO -- default-precise32:     -AddCharset ISO-8859-1  .iso8859-1  .latin1
I, [2015-04-24T11:05:02.551082 #8666]  INFO -- default-precise32:     -AddCharset ISO-8859-2  .iso8859-2  .latin2 .cen
I, [2015-04-24T11:05:02.553031 #8666]  INFO -- default-precise32:     -AddCharset ISO-8859-3  .iso8859-3  .latin3
I, [2015-04-24T11:05:02.554796 #8666]  INFO -- default-precise32:     -AddCharset ISO-8859-4  .iso8859-4  .latin4
I, [2015-04-24T11:05:02.557009 #8666]  INFO -- default-precise32:     -AddCharset ISO-8859-5  .iso8859-5  .cyr .iso-ru
I, [2015-04-24T11:05:02.558920 #8666]  INFO -- default-precise32:     -AddCharset ISO-8859-6  .iso8859-6  .arb .arabic
I, [2015-04-24T11:05:02.561194 #8666]  INFO -- default-precise32:     -AddCharset ISO-8859-7  .iso8859-7  .grk .greek
I, [2015-04-24T11:05:02.563430 #8666]  INFO -- default-precise32:     -AddCharset ISO-8859-8  .iso8859-8  .heb .hebrew
I, [2015-04-24T11:05:02.565620 #8666]  INFO -- default-precise32:     -AddCharset ISO-8859-9  .iso8859-9  .latin5 .trk
I, [2015-04-24T11:05:02.567638 #8666]  INFO -- default-precise32:     -AddCharset ISO-8859-10  .iso8859-10  .latin6
I, [2015-04-24T11:05:02.569690 #8666]  INFO -- default-precise32:     -AddCharset ISO-8859-13  .iso8859-13
I, [2015-04-24T11:05:02.573958 #8666]  INFO -- default-precise32:     -AddCharset ISO-8859-14  .iso8859-14  .latin8
I, [2015-04-24T11:05:02.574264 #8666]  INFO -- default-precise32:     -AddCharset ISO-8859-15  .iso8859-15  .latin9
I, [2015-04-24T11:05:02.576480 #8666]  INFO -- default-precise32:     -AddCharset ISO-8859-16  .iso8859-16  .latin10
I, [2015-04-24T11:05:02.577916 #8666]  INFO -- default-precise32:     -AddCharset ISO-2022-JP .iso2022-jp .jis
I, [2015-04-24T11:05:02.579907 #8666]  INFO -- default-precise32:     -AddCharset ISO-2022-KR .iso2022-kr .kis
I, [2015-04-24T11:05:02.581960 #8666]  INFO -- default-precise32:     -AddCharset ISO-2022-CN .iso2022-cn .cis
I, [2015-04-24T11:05:02.583824 #8666]  INFO -- default-precise32:     -AddCharset Big5        .Big5       .big5 .b5
I, [2015-04-24T11:05:02.585623 #8666]  INFO -- default-precise32:     -AddCharset cn-Big5     .cn-big5
I, [2015-04-24T11:05:02.587352 #8666]  INFO -- default-precise32:     -# For russian, more than one charset is used (depends on client, mostly):
I, [2015-04-24T11:05:02.589599 #8666]  INFO -- default-precise32:     -AddCharset WINDOWS-1251 .cp-1251   .win-1251
I, [2015-04-24T11:05:02.591301 #8666]  INFO -- default-precise32:     -AddCharset CP866       .cp866
I, [2015-04-24T11:05:02.593288 #8666]  INFO -- default-precise32:     -AddCharset KOI8      .koi8
I, [2015-04-24T11:05:02.595103 #8666]  INFO -- default-precise32:     -AddCharset KOI8-E      .koi8-e
I, [2015-04-24T11:05:02.597045 #8666]  INFO -- default-precise32:     -AddCharset KOI8-r      .koi8-r .koi8-ru
I, [2015-04-24T11:05:02.598815 #8666]  INFO -- default-precise32:     -AddCharset KOI8-U      .koi8-u
I, [2015-04-24T11:05:02.603455 #8666]  INFO -- default-precise32:     -AddCharset KOI8-ru     .koi8-uk .ua
I, [2015-04-24T11:05:02.605633 #8666]  INFO -- default-precise32:     -AddCharset ISO-10646-UCS-2 .ucs2
I, [2015-04-24T11:05:02.614127 #8666]  INFO -- default-precise32:     -AddCharset ISO-10646-UCS-4 .ucs4
I, [2015-04-24T11:05:02.617947 #8666]  INFO -- default-precise32:     -AddCharset UTF-7       .utf7
I, [2015-04-24T11:05:02.620315 #8666]  INFO -- default-precise32:     -AddCharset UTF-8       .utf8
I, [2015-04-24T11:05:02.622352 #8666]  INFO -- default-precise32:     -AddCharset UTF-16      .utf16
I, [2015-04-24T11:05:02.624624 #8666]  INFO -- default-precise32:     -AddCharset UTF-16BE    .utf16be
I, [2015-04-24T11:05:02.626575 #8666]  INFO -- default-precise32:     -AddCharset UTF-16LE    .utf16le
I, [2015-04-24T11:05:02.628721 #8666]  INFO -- default-precise32:     -AddCharset UTF-32      .utf32
I, [2015-04-24T11:05:02.632623 #8666]  INFO -- default-precise32:     -AddCharset UTF-32BE    .utf32be
I, [2015-04-24T11:05:02.633172 #8666]  INFO -- default-precise32:     -AddCharset UTF-32LE    .utf32le
I, [2015-04-24T11:05:02.635737 #8666]  INFO -- default-precise32:     -AddCharset euc-cn      .euc-cn
I, [2015-04-24T11:05:02.638039 #8666]  INFO -- default-precise32:     -AddCharset euc-gb      .euc-gb
I, [2015-04-24T11:05:02.640499 #8666]  INFO -- default-precise32:     -AddCharset euc-jp      .euc-jp
I, [2015-04-24T11:05:02.642756 #8666]  INFO -- default-precise32:     -AddCharset euc-kr      .euc-kr
I, [2015-04-24T11:05:02.644806 #8666]  INFO -- default-precise32:     -#Not sure how euc-tw got in - IANA doesn't list it???
I, [2015-04-24T11:05:02.646987 #8666]  INFO -- default-precise32:     -AddCharset EUC-TW      .euc-tw
I, [2015-04-24T11:05:02.649192 #8666]  INFO -- default-precise32:     -AddCharset gb2312      .gb2312 .gb
I, [2015-04-24T11:05:02.650810 #8666]  INFO -- default-precise32:     -AddCharset iso-10646-ucs-2 .ucs-2 .iso-10646-ucs-2
I, [2015-04-24T11:05:02.653143 #8666]  INFO -- default-precise32:     -AddCharset iso-10646-ucs-4 .ucs-4 .iso-10646-ucs-4
I, [2015-04-24T11:05:02.654838 #8666]  INFO -- default-precise32:     -AddCharset shift_jis   .shift_jis .sjis
I, [2015-04-24T11:05:02.656759 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.658896 #8666]  INFO -- default-precise32:     +  # Commonly used filename extensions to character sets. You probably
I, [2015-04-24T11:05:02.662519 #8666]  INFO -- default-precise32:     +  # want to avoid clashes with the language extensions, unless you
I, [2015-04-24T11:05:02.663029 #8666]  INFO -- default-precise32:     +  # are good at carefully testing your setup after each change.
I, [2015-04-24T11:05:02.664918 #8666]  INFO -- default-precise32:     +  # See http://www.iana.org/assignments/character-sets for the
I, [2015-04-24T11:05:02.666849 #8666]  INFO -- default-precise32:     +  # official list of charset names and their respective RFCs.
I, [2015-04-24T11:05:02.670038 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.672196 #8666]  INFO -- default-precise32:     +  AddCharset us-ascii    .ascii .us-ascii
I, [2015-04-24T11:05:02.674241 #8666]  INFO -- default-precise32:     +  AddCharset ISO-8859-1  .iso8859-1  .latin1
I, [2015-04-24T11:05:02.676234 #8666]  INFO -- default-precise32:     +  AddCharset ISO-8859-2  .iso8859-2  .latin2 .cen
I, [2015-04-24T11:05:02.678495 #8666]  INFO -- default-precise32:     +  AddCharset ISO-8859-3  .iso8859-3  .latin3
I, [2015-04-24T11:05:02.680591 #8666]  INFO -- default-precise32:     +  AddCharset ISO-8859-4  .iso8859-4  .latin4
I, [2015-04-24T11:05:02.682780 #8666]  INFO -- default-precise32:     +  AddCharset ISO-8859-5  .iso8859-5  .cyr .iso-ru
I, [2015-04-24T11:05:02.684786 #8666]  INFO -- default-precise32:     +  AddCharset ISO-8859-6  .iso8859-6  .arb .arabic
I, [2015-04-24T11:05:02.686604 #8666]  INFO -- default-precise32:     +  AddCharset ISO-8859-7  .iso8859-7  .grk .greek
I, [2015-04-24T11:05:02.688678 #8666]  INFO -- default-precise32:     +  AddCharset ISO-8859-8  .iso8859-8  .heb .hebrew
I, [2015-04-24T11:05:02.692989 #8666]  INFO -- default-precise32:     +  AddCharset ISO-8859-9  .iso8859-9  .latin5 .trk
I, [2015-04-24T11:05:02.693243 #8666]  INFO -- default-precise32:     +  AddCharset ISO-8859-10  .iso8859-10  .latin6
I, [2015-04-24T11:05:02.694791 #8666]  INFO -- default-precise32:     +  AddCharset ISO-8859-13  .iso8859-13
I, [2015-04-24T11:05:02.696876 #8666]  INFO -- default-precise32:     +  AddCharset ISO-8859-14  .iso8859-14  .latin8
I, [2015-04-24T11:05:02.699166 #8666]  INFO -- default-precise32:     +  AddCharset ISO-8859-15  .iso8859-15  .latin9
I, [2015-04-24T11:05:02.701026 #8666]  INFO -- default-precise32:     +  AddCharset ISO-8859-16  .iso8859-16  .latin10
I, [2015-04-24T11:05:02.703429 #8666]  INFO -- default-precise32:     +  AddCharset ISO-2022-JP .iso2022-jp .jis
I, [2015-04-24T11:05:02.705748 #8666]  INFO -- default-precise32:     +  AddCharset ISO-2022-KR .iso2022-kr .kis
I, [2015-04-24T11:05:02.708234 #8666]  INFO -- default-precise32:     +  AddCharset ISO-2022-CN .iso2022-cn .cis
I, [2015-04-24T11:05:02.710220 #8666]  INFO -- default-precise32:     +  AddCharset Big5        .Big5       .big5 .b5
I, [2015-04-24T11:05:02.712500 #8666]  INFO -- default-precise32:     +  AddCharset cn-Big5     .cn-big5
I, [2015-04-24T11:05:02.714289 #8666]  INFO -- default-precise32:     +  # For russian, more than one charset is used (depends on client, mostly):
I, [2015-04-24T11:05:02.716655 #8666]  INFO -- default-precise32:     +  AddCharset WINDOWS-1251 .cp-1251   .win-1251
I, [2015-04-24T11:05:02.718566 #8666]  INFO -- default-precise32:     +  AddCharset CP866       .cp866
I, [2015-04-24T11:05:02.722834 #8666]  INFO -- default-precise32:     +  AddCharset KOI8      .koi8
I, [2015-04-24T11:05:02.723099 #8666]  INFO -- default-precise32:     +  AddCharset KOI8-E      .koi8-e
I, [2015-04-24T11:05:02.724922 #8666]  INFO -- default-precise32:     +  AddCharset KOI8-r      .koi8-r .koi8-ru
I, [2015-04-24T11:05:02.726747 #8666]  INFO -- default-precise32:     +  AddCharset KOI8-U      .koi8-u
I, [2015-04-24T11:05:02.729002 #8666]  INFO -- default-precise32:     +  AddCharset KOI8-ru     .koi8-uk .ua
I, [2015-04-24T11:05:02.731112 #8666]  INFO -- default-precise32:     +  AddCharset ISO-10646-UCS-2 .ucs2
I, [2015-04-24T11:05:02.733176 #8666]  INFO -- default-precise32:     +  AddCharset ISO-10646-UCS-4 .ucs4
I, [2015-04-24T11:05:02.734990 #8666]  INFO -- default-precise32:     +  AddCharset UTF-7       .utf7
I, [2015-04-24T11:05:02.737003 #8666]  INFO -- default-precise32:     +  AddCharset UTF-8       .utf8
I, [2015-04-24T11:05:02.739321 #8666]  INFO -- default-precise32:     +  AddCharset UTF-16      .utf16
I, [2015-04-24T11:05:02.741481 #8666]  INFO -- default-precise32:     +  AddCharset UTF-16BE    .utf16be
I, [2015-04-24T11:05:02.743810 #8666]  INFO -- default-precise32:     +  AddCharset UTF-16LE    .utf16le
I, [2015-04-24T11:05:02.745843 #8666]  INFO -- default-precise32:     +  AddCharset UTF-32      .utf32
I, [2015-04-24T11:05:02.747951 #8666]  INFO -- default-precise32:     +  AddCharset UTF-32BE    .utf32be
I, [2015-04-24T11:05:02.752475 #8666]  INFO -- default-precise32:     +  AddCharset UTF-32LE    .utf32le
I, [2015-04-24T11:05:02.752715 #8666]  INFO -- default-precise32:     +  AddCharset euc-cn      .euc-cn
I, [2015-04-24T11:05:02.754218 #8666]  INFO -- default-precise32:     +  AddCharset euc-gb      .euc-gb
I, [2015-04-24T11:05:02.756068 #8666]  INFO -- default-precise32:     +  AddCharset euc-jp      .euc-jp
I, [2015-04-24T11:05:02.758001 #8666]  INFO -- default-precise32:     +  AddCharset euc-kr      .euc-kr
I, [2015-04-24T11:05:02.759837 #8666]  INFO -- default-precise32:     +  #Not sure how euc-tw got in - IANA doesn't list it???
I, [2015-04-24T11:05:02.761747 #8666]  INFO -- default-precise32:     +  AddCharset EUC-TW      .euc-tw
I, [2015-04-24T11:05:02.763396 #8666]  INFO -- default-precise32:     +  AddCharset gb2312      .gb2312 .gb
I, [2015-04-24T11:05:02.765627 #8666]  INFO -- default-precise32:     +  AddCharset iso-10646-ucs-2 .ucs-2 .iso-10646-ucs-2
I, [2015-04-24T11:05:02.767319 #8666]  INFO -- default-precise32:     +  AddCharset iso-10646-ucs-4 .ucs-4 .iso-10646-ucs-4
I, [2015-04-24T11:05:02.769760 #8666]  INFO -- default-precise32:     +  AddCharset shift_jis   .shift_jis .sjis
I, [2015-04-24T11:05:02.772054 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:02.773954 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.776060 #8666]  INFO -- default-precise32:     -# AddHandler allows you to map certain file extensions to "handlers":
I, [2015-04-24T11:05:02.777730 #8666]  INFO -- default-precise32:     -# actions unrelated to filetype. These can be either built into the server
I, [2015-04-24T11:05:02.781612 #8666]  INFO -- default-precise32:     -# or added with the Action directive (see below)
I, [2015-04-24T11:05:02.782145 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.784089 #8666]  INFO -- default-precise32:     -# To use CGI scripts outside of ScriptAliased directories:
I, [2015-04-24T11:05:02.785795 #8666]  INFO -- default-precise32:     -# (You will also need to add "ExecCGI" to the "Options" directive.)
I, [2015-04-24T11:05:02.787376 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.790073 #8666]  INFO -- default-precise32:     -#AddHandler cgi-script .cgi
I, [2015-04-24T11:05:02.792065 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.793812 #8666]  INFO -- default-precise32:     +  # AddHandler allows you to map certain file extensions to "handlers":
I, [2015-04-24T11:05:02.795367 #8666]  INFO -- default-precise32:     +  # actions unrelated to filetype. These can be either built into the server
I, [2015-04-24T11:05:02.797771 #8666]  INFO -- default-precise32:     +  # or added with the Action directive (see below)
I, [2015-04-24T11:05:02.799772 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.801750 #8666]  INFO -- default-precise32:     +  # To use CGI scripts outside of ScriptAliased directories:
I, [2015-04-24T11:05:02.803804 #8666]  INFO -- default-precise32:     +  # (You will also need to add "ExecCGI" to the "Options" directive.)
I, [2015-04-24T11:05:02.805788 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.810684 #8666]  INFO -- default-precise32:     +  #AddHandler cgi-script .cgi
I, [2015-04-24T11:05:02.810947 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:02.812245 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.814206 #8666]  INFO -- default-precise32:     -# For files that include their own HTTP headers:
I, [2015-04-24T11:05:02.816015 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.818046 #8666]  INFO -- default-precise32:     -#AddHandler send-as-is asis
I, [2015-04-24T11:05:02.820047 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.821946 #8666]  INFO -- default-precise32:     +  # For files that include their own HTTP headers:
I, [2015-04-24T11:05:02.823976 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.825978 #8666]  INFO -- default-precise32:     +  #AddHandler send-as-is asis
I, [2015-04-24T11:05:02.828203 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:02.830097 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.832223 #8666]  INFO -- default-precise32:     -# For server-parsed imagemap files:
I, [2015-04-24T11:05:02.834143 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.837010 #8666]  INFO -- default-precise32:     -#AddHandler imap-file map
I, [2015-04-24T11:05:02.840601 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.841367 #8666]  INFO -- default-precise32:     +  # For server-parsed imagemap files:
I, [2015-04-24T11:05:02.843721 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.846236 #8666]  INFO -- default-precise32:     +  #AddHandler imap-file map
I, [2015-04-24T11:05:02.847882 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:02.849975 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.851773 #8666]  INFO -- default-precise32:     -# For type maps (negotiated resources):
I, [2015-04-24T11:05:02.854093 #8666]  INFO -- default-precise32:     -# (This is enabled by default to allow the Apache "It Worked" page
I, [2015-04-24T11:05:02.855897 #8666]  INFO -- default-precise32:     -#  to be distributed in multiple languages.)
I, [2015-04-24T11:05:02.857909 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.859769 #8666]  INFO -- default-precise32:     -AddHandler type-map var
I, [2015-04-24T11:05:02.861748 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.863533 #8666]  INFO -- default-precise32:     +  # For type maps (negotiated resources):
I, [2015-04-24T11:05:02.865595 #8666]  INFO -- default-precise32:     +  # (This is enabled by default to allow the Apache "It Worked" page
I, [2015-04-24T11:05:02.867232 #8666]  INFO -- default-precise32:     +  #  to be distributed in multiple languages.)
I, [2015-04-24T11:05:02.870138 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.872244 #8666]  INFO -- default-precise32:     +  AddHandler type-map var
I, [2015-04-24T11:05:02.873946 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:02.876173 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.878122 #8666]  INFO -- default-precise32:     -# Filters allow you to process content before it is sent to the client.
I, [2015-04-24T11:05:02.880146 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.882150 #8666]  INFO -- default-precise32:     -# To parse .shtml files for server-side includes (SSI):
I, [2015-04-24T11:05:02.884482 #8666]  INFO -- default-precise32:     -# (You will also need to add "Includes" to the "Options" directive.)
I, [2015-04-24T11:05:02.886525 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.888850 #8666]  INFO -- default-precise32:     -AddType text/html .shtml
I, [2015-04-24T11:05:02.891191 #8666]  INFO -- default-precise32:     -AddOutputFilter INCLUDES .shtml
I, [2015-04-24T11:05:02.892696 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:05:02.894555 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.896617 #8666]  INFO -- default-precise32:     +  # Filters allow you to process content before it is sent to the client.
I, [2015-04-24T11:05:02.900397 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.900889 #8666]  INFO -- default-precise32:     +  # To parse .shtml files for server-side includes (SSI):
I, [2015-04-24T11:05:02.903043 #8666]  INFO -- default-precise32:     +  # (You will also need to add "Includes" to the "Options" directive.)
I, [2015-04-24T11:05:02.905094 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.907240 #8666]  INFO -- default-precise32:     +  AddType text/html .shtml
I, [2015-04-24T11:05:02.909676 #8666]  INFO -- default-precise32:     +  AddOutputFilter INCLUDES .shtml
I, [2015-04-24T11:05:02.913193 #8666]  INFO -- default-precise32:      </IfModule>
I, [2015-04-24T11:05:02.921999 #8666]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/mime.load] action create (up to date)
I, [2015-04-24T11:05:02.925213 #8666]  INFO -- default-precise32:   * execute[a2enmod mime] action run (skipped due to not_if)
I, [2015-04-24T11:05:02.929446 #8666]  INFO -- default-precise32: Recipe: apache2::mod_negotiation
I, [2015-04-24T11:05:02.941451 #8666]  INFO -- default-precise32:   * template[/etc/apache2/mods-available/negotiation.conf] action create
I, [2015-04-24T11:05:02.943285 #8666]  INFO -- default-precise32:     - update content in file /etc/apache2/mods-available/negotiation.conf from ca1d73 to 3ad8fd
I, [2015-04-24T11:05:02.947240 #8666]  INFO -- default-precise32:     --- /etc/apache2/mods-available/negotiation.conf	2012-02-07 04:17:00.000000000 +0000
I, [2015-04-24T11:05:02.950249 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-ifgwps	2015-04-24 08:05:02.928633399 +0000
I, [2015-04-24T11:05:02.951787 #8666]  INFO -- default-precise32:     @@ -1,19 +1,18 @@
I, [2015-04-24T11:05:02.954270 #8666]  INFO -- default-precise32:      <IfModule mod_negotiation.c>
I, [2015-04-24T11:05:02.955461 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.959769 #8666]  INFO -- default-precise32:     -# LanguagePriority allows you to give precedence to some languages
I, [2015-04-24T11:05:02.960036 #8666]  INFO -- default-precise32:     -# in case of a tie during content negotiation.
I, [2015-04-24T11:05:02.961313 #8666]  INFO -- default-precise32: -#
I, [2015-04-24T11:05:02.963770 #8666]  INFO -- default-precise32:     -# Just list the languages in decreasing order of preference. We have
I, [2015-04-24T11:05:02.964941 #8666]  INFO -- default-precise32: -# more or less alphabetized them here. You probably want to change this.
I, [2015-04-24T11:05:02.965733 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.967319 #8666]  INFO -- default-precise32: -LanguagePriority en ca cs da de el eo es et fr he hr it ja ko ltz nl nn no pl pt pt-BR ru sv tr zh-CN zh-TW
I, [2015-04-24T11:05:02.969245 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.971230 #8666]  INFO -- default-precise32:     +  # LanguagePriority allows you to give precedence to some languages
I, [2015-04-24T11:05:02.973311 #8666]  INFO -- default-precise32:     +  # in case of a tie during content negotiation.
I, [2015-04-24T11:05:02.974913 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.976763 #8666]  INFO -- default-precise32: +  # Just list the languages in decreasing order of preference. We have
I, [2015-04-24T11:05:02.979127 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:05:02.979156 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.979177 #8666]  INFO -- default-precise32:     +  LanguagePriority en ca cs da de el eo es et fr he hr it ja ko ltz nl nn no pl pt pt-BR ru sv tr zh-CN zh-TW
I, [2015-04-24T11:05:02.981198 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:02.981335 #8666]  INFO -- default-precise32: -#
I, [2015-04-24T11:05:02.982660 #8666]  INFO -- default-precise32: -# ForceLanguagePriority allows you to serve a result page rather than
I, [2015-04-24T11:05:02.984233 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:05:02.984271 #8666]  INFO -- default-precise32:     -# [in case no accepted languages matched the available variants]
I, [2015-04-24T11:05:02.986207 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:02.989935 #8666]  INFO -- default-precise32:     -ForceLanguagePriority Prefer Fallback
I, [2015-04-24T11:05:02.990072 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:05:02.990910 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.993274 #8666]  INFO -- default-precise32:     +  # ForceLanguagePriority allows you to serve a result page rather than
I, [2015-04-24T11:05:02.994334 #8666]  INFO -- default-precise32:     +  # MULTIPLE CHOICES (Prefer) [in case of a tie] or NOT ACCEPTABLE (Fallback)
I, [2015-04-24T11:05:02.996872 #8666]  INFO -- default-precise32:     +  # [in case no accepted languages matched the available variants]
I, [2015-04-24T11:05:02.998105 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:02.999947 #8666]  INFO -- default-precise32:     +  ForceLanguagePriority Prefer Fallback
I, [2015-04-24T11:05:03.007665 #8666]  INFO -- default-precise32:      </IfModule>
I, [2015-04-24T11:05:03.012230 #8666]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/negotiation.load] action create (up to date)
I, [2015-04-24T11:05:03.015212 #8666]  INFO -- default-precise32:   * execute[a2enmod negotiation] action run (skipped due to not_if)
I, [2015-04-24T11:05:03.019639 #8666]  INFO -- default-precise32: Recipe: apache2::mod_setenvif
I, [2015-04-24T11:05:03.033891 #8666]  INFO -- default-precise32:   * template[/etc/apache2/mods-available/setenvif.conf] action create
I, [2015-04-24T11:05:03.035611 #8666]  INFO -- default-precise32:     - update content in file /etc/apache2/mods-available/setenvif.conf from 1798c3 to fb5a27
I, [2015-04-24T11:05:03.043286 #8666]  INFO -- default-precise32:     --- /etc/apache2/mods-available/setenvif.conf	2012-02-07 04:17:00.000000000 +0000
I, [2015-04-24T11:05:03.048767 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-1a4yc21	2015-04-24 08:05:03.016632292 +0000
I, [2015-04-24T11:05:03.049927 #8666]  INFO -- default-precise32:     @@ -1,31 +1,29 @@
I, [2015-04-24T11:05:03.051032 #8666]  INFO -- default-precise32:      <IfModule mod_setenvif.c>
I, [2015-04-24T11:05:03.053170 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:03.054889 #8666]  INFO -- default-precise32:     +  # The following directives modify normal HTTP response behavior to
I, [2015-04-24T11:05:03.057212 #8666]  INFO -- default-precise32:     +  # handle known problems with browser implementations.
I, [2015-04-24T11:05:03.059232 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:03.061220 #8666]  INFO -- default-precise32:     +  BrowserMatch "Mozilla/2" nokeepalive
I, [2015-04-24T11:05:03.063217 #8666]  INFO -- default-precise32:     +  BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0
I, [2015-04-24T11:05:03.065216 #8666]  INFO -- default-precise32:     +  BrowserMatch "RealPlayer 4\.0" force-response-1.0
I, [2015-04-24T11:05:03.067145 #8666]  INFO -- default-precise32:     +  BrowserMatch "Java/1\.0" force-response-1.0
I, [2015-04-24T11:05:03.070284 #8666]  INFO -- default-precise32:     +  BrowserMatch "JDK/1\.0" force-response-1.0
I, [2015-04-24T11:05:03.071389 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:03.074222 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:03.077230 #8666]  INFO -- default-precise32:     -# The following directives modify normal HTTP response behavior to
I, [2015-04-24T11:05:03.079185 #8666]  INFO -- default-precise32:     -# handle known problems with browser implementations.
I, [2015-04-24T11:05:03.081681 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:03.084095 #8666]  INFO -- default-precise32:     -BrowserMatch "Mozilla/2" nokeepalive
I, [2015-04-24T11:05:03.086371 #8666]  INFO -- default-precise32:     -BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0
I, [2015-04-24T11:05:03.089193 #8666]  INFO -- default-precise32:     -BrowserMatch "RealPlayer 4\.0" force-response-1.0
I, [2015-04-24T11:05:03.091570 #8666]  INFO -- default-precise32:     -BrowserMatch "Java/1\.0" force-response-1.0
I, [2015-04-24T11:05:03.094116 #8666]  INFO -- default-precise32:     -BrowserMatch "JDK/1\.0" force-response-1.0
I, [2015-04-24T11:05:03.097088 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:05:03.099196 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:03.101767 #8666]  INFO -- default-precise32:     -# The following directive disables redirects on non-GET requests for
I, [2015-04-24T11:05:03.104585 #8666]  INFO -- default-precise32:     -# a directory that does not include the trailing slash.  This fixes a 
I, [2015-04-24T11:05:03.107803 #8666]  INFO -- default-precise32:     -# problem with Microsoft WebFolders which does not appropriately handle 
I, [2015-04-24T11:05:03.111066 #8666]  INFO -- default-precise32:     -# redirects for folders with DAV methods.
I, [2015-04-24T11:05:03.113177 #8666]  INFO -- default-precise32:     -# Same deal with Apple's DAV filesystem and Gnome VFS support for DAV.
I, [2015-04-24T11:05:03.115202 #8666]  INFO -- default-precise32:     -#
I, [2015-04-24T11:05:03.118212 #8666]  INFO -- default-precise32:     -BrowserMatch "Microsoft Data Access Internet Publishing Provider" redirect-carefully
I, [2015-04-24T11:05:03.120688 #8666]  INFO -- default-precise32:     -BrowserMatch "MS FrontPage" redirect-carefully
I, [2015-04-24T11:05:03.123021 #8666]  INFO -- default-precise32:     -BrowserMatch "^WebDrive" redirect-carefully
I, [2015-04-24T11:05:03.126073 #8666]  INFO -- default-precise32:     -BrowserMatch "^WebDAVFS/1.[012]" redirect-carefully
I, [2015-04-24T11:05:03.128200 #8666]  INFO -- default-precise32:     -BrowserMatch "^gnome-vfs/1.0" redirect-carefully
I, [2015-04-24T11:05:03.131195 #8666]  INFO -- default-precise32:     -BrowserMatch "^gvfs/1" redirect-carefully
I, [2015-04-24T11:05:03.133389 #8666]  INFO -- default-precise32:     -BrowserMatch "^XML Spy" redirect-carefully
I, [2015-04-24T11:05:03.136614 #8666]  INFO -- default-precise32:     -BrowserMatch "^Dreamweaver-WebDAV-SCM1" redirect-carefully
I, [2015-04-24T11:05:03.139850 #8666]  INFO -- default-precise32:     -BrowserMatch " Konqueror/4" redirect-carefully
I, [2015-04-24T11:05:03.142848 #8666]  INFO -- default-precise32:     -
I, [2015-04-24T11:05:03.145209 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:03.147495 #8666]  INFO -- default-precise32:     +  # The following directive disables redirects on non-GET requests for
I, [2015-04-24T11:05:03.150690 #8666]  INFO -- default-precise32:     +  # a directory that does not include the trailing slash.  This fixes a
I, [2015-04-24T11:05:03.152991 #8666]  INFO -- default-precise32:     +  # problem with Microsoft WebFolders which does not appropriately handle
I, [2015-04-24T11:05:03.155555 #8666]  INFO -- default-precise32:     +  # redirects for folders with DAV methods.
I, [2015-04-24T11:05:03.158035 #8666]  INFO -- default-precise32:     +  # Same deal with Apple's DAV filesystem and Gnome VFS support for DAV.
I, [2015-04-24T11:05:03.160384 #8666]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:05:03.163042 #8666]  INFO -- default-precise32:     +  BrowserMatch "Microsoft Data Access Internet Publishing Provider" redirect-carefully
I, [2015-04-24T11:05:03.165726 #8666]  INFO -- default-precise32:     +  BrowserMatch "MS FrontPage" redirect-carefully
I, [2015-04-24T11:05:03.169018 #8666]  INFO -- default-precise32:     +  BrowserMatch "^WebDrive" redirect-carefully
I, [2015-04-24T11:05:03.172238 #8666]  INFO -- default-precise32:     +  BrowserMatch "^WebDAVFS/1.[012]" redirect-carefully
I, [2015-04-24T11:05:03.174903 #8666]  INFO -- default-precise32:     +  BrowserMatch "^gnome-vfs/1.0" redirect-carefully
I, [2015-04-24T11:05:03.177806 #8666]  INFO -- default-precise32:     +  BrowserMatch "^gvfs/1" redirect-carefully
I, [2015-04-24T11:05:03.180499 #8666]  INFO -- default-precise32:     +  BrowserMatch "^XML Spy" redirect-carefully
I, [2015-04-24T11:05:03.182800 #8666]  INFO -- default-precise32:     +  BrowserMatch "^Dreamweaver-WebDAV-SCM1" redirect-carefully
I, [2015-04-24T11:05:03.185213 #8666]  INFO -- default-precise32:     +  BrowserMatch " Konqueror/4" redirect-carefully
I, [2015-04-24T11:05:03.189998 #8666]  INFO -- default-precise32:      </IfModule>
I, [2015-04-24T11:05:03.199236 #8666]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/setenvif.load] action create (up to date)
I, [2015-04-24T11:05:03.204421 #8666]  INFO -- default-precise32:   * execute[a2enmod setenvif] action run (skipped due to not_if)
I, [2015-04-24T11:05:03.206389 #8666]  INFO -- default-precise32: Recipe: apache2::mod_rewrite
I, [2015-04-24T11:05:03.215692 #8666]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/rewrite.load] action create (up to date)
I, [2015-04-24T11:05:04.044026 #8666]  INFO -- default-precise32:   * execute[a2enmod rewrite] action run
I, [2015-04-24T11:05:04.055281 #8666]  INFO -- default-precise32:     - execute /usr/sbin/a2enmod rewrite
I, [2015-04-24T11:05:04.069022 #8666]  INFO -- default-precise32: Recipe: apache2::mod_deflate
I, [2015-04-24T11:05:04.158924 #8666]  INFO -- default-precise32:   * template[/etc/apache2/mods-available/deflate.conf] action create
I, [2015-04-24T11:05:04.162136 #8666]  INFO -- default-precise32:     - update content in file /etc/apache2/mods-available/deflate.conf from 4f3582 to c8749f
I, [2015-04-24T11:05:04.171061 #8666]  INFO -- default-precise32:     --- /etc/apache2/mods-available/deflate.conf	2012-02-07 04:16:59.000000000 +0000
I, [2015-04-24T11:05:04.176613 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-1kmv8sr	2015-04-24 08:05:04.131289981 +0000
I, [2015-04-24T11:05:04.179593 #8666]  INFO -- default-precise32:     @@ -1,10 +1,19 @@
I, [2015-04-24T11:05:04.183570 #8666]  INFO -- default-precise32:      <IfModule mod_deflate.c>
I, [2015-04-24T11:05:04.187215 #8666]  INFO -- default-precise32:     -          # these are known to be safe with MSIE 6
I, [2015-04-24T11:05:04.190169 #8666]  INFO -- default-precise32:     -          AddOutputFilterByType DEFLATE text/html text/plain text/xml
I, [2015-04-24T11:05:04.193455 #8666]  INFO -- default-precise32:     +  <IfModule mod_filter.c>
I, [2015-04-24T11:05:04.196732 #8666]  INFO -- default-precise32:     +     # these are known to be safe with MSIE 6
I, [2015-04-24T11:05:04.199721 #8666]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE text/html text/plain text/xml
I, [2015-04-24T11:05:04.202674 #8666]  INFO -- default-precise32:      
I, [2015-04-24T11:05:04.205642 #8666]  INFO -- default-precise32:     -          # everything else may cause problems with MSIE 6
I, [2015-04-24T11:05:04.208943 #8666]  INFO -- default-precise32:     -          AddOutputFilterByType DEFLATE text/css
I, [2015-04-24T11:05:04.211697 #8666]  INFO -- default-precise32:     -          AddOutputFilterByType DEFLATE application/x-javascript application/javascript application/ecmascript
I, [2015-04-24T11:05:04.215190 #8666]  INFO -- default-precise32:     -          AddOutputFilterByType DEFLATE application/rss+xml
I, [2015-04-24T11:05:04.218167 #8666]  INFO -- default-precise32:     +     # everything else may cause problems with MSIE 6
I, [2015-04-24T11:05:04.221152 #8666]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE text/css
I, [2015-04-24T11:05:04.224122 #8666]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE application/x-javascript application/javascript application/ecmascript
I, [2015-04-24T11:05:04.227080 #8666]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE application/rss+xml
I, [2015-04-24T11:05:04.229732 #8666]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE application/xml
I, [2015-04-24T11:05:04.233357 #8666]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE application/xhtml+xml
I, [2015-04-24T11:05:04.236309 #8666]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE image/svg+xml
I, [2015-04-24T11:05:04.239598 #8666]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE application/atom_xml
I, [2015-04-24T11:05:04.242602 #8666]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE application/x-httpd-php
I, [2015-04-24T11:05:04.245936 #8666]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE application/x-httpd-fastphp
I, [2015-04-24T11:05:04.248895 #8666]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE application/x-httpd-eruby
I, [2015-04-24T11:05:04.251887 #8666]  INFO -- default-precise32:     +  </IfModule>
I, [2015-04-24T11:05:04.258206 #8666]  INFO -- default-precise32:      </IfModule>
I, [2015-04-24T11:05:04.273125 #8666]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/deflate.load] action create (up to date)
I, [2015-04-24T11:05:04.277395 #8666]  INFO -- default-precise32:   * execute[a2enmod deflate] action run (skipped due to not_if)
I, [2015-04-24T11:05:04.279875 #8666]  INFO -- default-precise32: Recipe: apache2::mod_headers
I, [2015-04-24T11:05:04.289361 #8666]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/headers.load] action create (up to date)
I, [2015-04-24T11:05:05.112677 #8666]  INFO -- default-precise32:   * execute[a2enmod headers] action run
I, [2015-04-24T11:05:05.118583 #8666]  INFO -- default-precise32:     - execute /usr/sbin/a2enmod headers
I, [2015-04-24T11:05:05.124693 #8666]  INFO -- default-precise32: Recipe: apache2::default
I, [2015-04-24T11:05:05.177842 #8666]  INFO -- default-precise32:   * template[/etc/apache2/sites-available/default.conf] action create
I, [2015-04-24T11:05:05.206926 #8666]  INFO -- default-precise32:     - create new file /etc/apache2/sites-available/default.conf
I, [2015-04-24T11:05:05.211103 #8666]  INFO -- default-precise32:     - update content in file /etc/apache2/sites-available/default.conf from none to 73a103
I, [2015-04-24T11:05:05.217214 #8666]  INFO -- default-precise32:     --- /etc/apache2/sites-available/default.conf	2015-04-24 08:05:05.167289989 +0000
I, [2015-04-24T11:05:05.222819 #8666]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1344-6rne2r	2015-04-24 08:05:05.167289989 +0000
I, [2015-04-24T11:05:05.226178 #8666]  INFO -- default-precise32:     @@ -1 +1,44 @@
I, [2015-04-24T11:05:05.229100 #8666]  INFO -- default-precise32:     +<VirtualHost *:80>
I, [2015-04-24T11:05:05.230929 #8666]  INFO -- default-precise32:     +  ServerAdmin ops@example.com
I, [2015-04-24T11:05:05.232802 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:05:05.237189 #8666]  INFO -- default-precise32:     +  DocumentRoot /var/www/
I, [2015-04-24T11:05:05.239208 #8666]  INFO -- default-precise32:     +  <Directory />
I, [2015-04-24T11:05:05.242066 #8666]  INFO -- default-precise32:     +    Options FollowSymLinks
I, [2015-04-24T11:05:05.243894 #8666]  INFO -- default-precise32:     +    AllowOverride None
I, [2015-04-24T11:05:05.247197 #8666]  INFO -- default-precise32:     +  </Directory>
I, [2015-04-24T11:05:05.249474 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:05:05.251716 #8666]  INFO -- default-precise32:     +  <Directory /var/www/>
I, [2015-04-24T11:05:05.255043 #8666]  INFO -- default-precise32:     +    Options Indexes FollowSymLinks MultiViews
I, [2015-04-24T11:05:05.256875 #8666]  INFO -- default-precise32:     +    AllowOverride None
I, [2015-04-24T11:05:05.259662 #8666]  INFO -- default-precise32:     +    Order allow,deny
I, [2015-04-24T11:05:05.262211 #8666]  INFO -- default-precise32:     +    Allow from all
I, [2015-04-24T11:05:05.264189 #8666]  INFO -- default-precise32:     +  </Directory>
I, [2015-04-24T11:05:05.267081 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:05:05.269849 #8666]  INFO -- default-precise32:     +  ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
I, [2015-04-24T11:05:05.272623 #8666]  INFO -- default-precise32:     +  <Directory "/usr/lib/cgi-bin">
I, [2015-04-24T11:05:05.273550 #8666]  INFO -- default-precise32: +    AllowOverride None
I, [2015-04-24T11:05:05.276068 #8666]  INFO -- default-precise32:     +    Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
I, [2015-04-24T11:05:05.278363 #8666]  INFO -- default-precise32:     +    Order allow,deny
I, [2015-04-24T11:05:05.281177 #8666]  INFO -- default-precise32:     +    Allow from all
I, [2015-04-24T11:05:05.284698 #8666]  INFO -- default-precise32:     +  </Directory>
I, [2015-04-24T11:05:05.287199 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:05:05.290183 #8666]  INFO -- default-precise32:     +  ErrorLog /var/log/apache2/error.log
I, [2015-04-24T11:05:05.292170 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:05:05.297246 #8666]  INFO -- default-precise32:     +  # Possible values include: debug, info, notice, warn, error, crit,
I, [2015-04-24T11:05:05.297300 #8666]  INFO -- default-precise32:     +  # alert, emerg.
I, [2015-04-24T11:05:05.297327 #8666]  INFO -- default-precise32:     +  LogLevel warn
I, [2015-04-24T11:05:05.297357 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:05:05.297377 #8666]  INFO -- default-precise32:     +  CustomLog /var/log/apache2/access.log combined
I, [2015-04-24T11:05:05.297396 #8666]  INFO -- default-precise32:     +  ServerSignature On
I, [2015-04-24T11:05:05.297414 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:05:05.297432 #8666]  INFO -- default-precise32:     +  Alias /doc/ "/usr/share/doc/"
I, [2015-04-24T11:05:05.297451 #8666]  INFO -- default-precise32:     +  <Directory "/usr/share/doc/">
I, [2015-04-24T11:05:05.297469 #8666]  INFO -- default-precise32:     +    Options Indexes MultiViews FollowSymLinks
I, [2015-04-24T11:05:05.297487 #8666]  INFO -- default-precise32:     +    AllowOverride None
I, [2015-04-24T11:05:05.297506 #8666]  INFO -- default-precise32:     +    Order deny,allow
I, [2015-04-24T11:05:05.297523 #8666]  INFO -- default-precise32:     +    Deny from all
I, [2015-04-24T11:05:05.297542 #8666]  INFO -- default-precise32:     +    Allow from 127.0.0.0/255.0.0.0 ::1/128
I, [2015-04-24T11:05:05.297560 #8666]  INFO -- default-precise32:     +  </Directory>
I, [2015-04-24T11:05:05.297591 #8666]  INFO -- default-precise32:     +
I, [2015-04-24T11:05:05.304280 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:05:05.307193 #8666]  INFO -- default-precise32:     - change mode from '' to '0644'
I, [2015-04-24T11:05:05.310196 #8666]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:05:05.314197 #8666]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:05:05.319367 #8666]  INFO -- default-precise32:   * execute[a2dissite default.conf] action run (skipped due to only_if)
I, [2015-04-24T11:05:05.323193 #8666]  INFO -- default-precise32:   * execute[a2dissite 000-default.conf] action run (skipped due to only_if)
I, [2015-04-24T11:05:07.561957 #8666]  INFO -- default-precise32:   * service[apache2] action enable (up to date)
I, [2015-04-24T11:05:09.203094 #8666]  INFO -- default-precise32:   * service[apache2] action start (up to date)
I, [2015-04-24T11:05:13.167098 #8666]  INFO -- default-precise32:   * service[apache2] action reload
I, [2015-04-24T11:05:13.187563 #8666]  INFO -- default-precise32:     - reload service service[apache2]
I, [2015-04-24T11:05:13.228334 #8666]  INFO -- default-precise32: 
I, [2015-04-24T11:05:13.234926 #8666]  INFO -- default-precise32: Running handlers:
I, [2015-04-24T11:05:13.248283 #8666]  INFO -- default-precise32: Running handlers complete
I, [2015-04-24T11:05:13.260039 #8666]  INFO -- default-precise32: Chef Client finished, 37/67 resources updated in 105.441645011 seconds
I, [2015-04-24T11:05:14.812611 #8666]  INFO -- default-precise32: Finished converging <default-precise32> (3m30.05s).
I, [2015-04-24T11:21:34.841959 #8913]  INFO -- default-precise32: -----> Setting up <default-precise32>...
I, [2015-04-24T11:21:41.901503 #8913]  INFO -- default-precise32: Fetching: thor-0.19.0.gemFetching: thor-0.19.0.gem ( 18%)Fetching: thor-0.19.0.gem ( 36%)Fetching: thor-0.19.0.gem ( 54%)Fetching: thor-0.19.0.gem ( 72%)Fetching: thor-0.19.0.gem ( 89%)Fetching: thor-0.19.0.gem (100%)Fetching: thor-0.19.0.gem (100%)
I, [2015-04-24T11:21:42.110777 #8913]  INFO -- default-precise32: Successfully installed thor-0.19.0
I, [2015-04-24T11:21:42.837384 #8913]  INFO -- default-precise32: Fetching: busser-0.7.1.gemFetching: busser-0.7.1.gem ( 66%)Fetching: busser-0.7.1.gem (100%)Fetching: busser-0.7.1.gem (100%)
I, [2015-04-24T11:21:42.948145 #8913]  INFO -- default-precise32: Successfully installed busser-0.7.1
I, [2015-04-24T11:21:42.950200 #8913]  INFO -- default-precise32: 2 gems installed
I, [2015-04-24T11:21:43.788639 #8913]  INFO -- default-precise32: -----> Setting up Busser
I, [2015-04-24T11:21:43.791078 #8913]  INFO -- default-precise32: Creating BUSSER_ROOT in /tmp/busser
I, [2015-04-24T11:21:43.793202 #8913]  INFO -- default-precise32: Creating busser binstub
I, [2015-04-24T11:21:57.121481 #8913]  INFO -- default-precise32: Plugin bats installed (version 0.3.0)
I, [2015-04-24T11:21:57.138514 #8913]  INFO -- default-precise32: -----> Running postinstall for bats plugin
I, [2015-04-24T11:21:57.511773 #8913]  INFO -- default-precise32: Installed Bats to /tmp/busser/vendor/bats/bin/bats
I, [2015-04-24T11:21:57.950616 #8913]  INFO -- default-precise32: Finished setting up <default-precise32> (0m23.11s).
I, [2015-04-24T11:21:57.950818 #8913]  INFO -- default-precise32: -----> Verifying <default-precise32>...
I, [2015-04-24T11:21:59.402974 #8913]  INFO -- default-precise32: Suite path directory /tmp/busser/suites does not exist, skipping.
I, [2015-04-24T11:22:00.322991 #8913]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats (mode=0644)
I, [2015-04-24T11:22:02.935240 #8913]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats~ (mode=0644)
I, [2015-04-24T11:22:05.568355 #8913]  INFO -- default-precise32: -----> Running bats test suite
I, [2015-04-24T11:22:07.267500 #8913]  INFO -- default-precise32: [1G   apache binary is found in PATH[K[77G1/1[2G[1G ✓ apache binary is found in PATH[K
I, [2015-04-24T11:22:07.268104 #8913]  INFO -- default-precise32: [0m
I, [2015-04-24T11:22:07.270026 #8913]  INFO -- default-precise32: 1 test, 0 failures
I, [2015-04-24T11:22:07.500289 #8913]  INFO -- default-precise32: Finished verifying <default-precise32> (0m9.55s).
I, [2015-04-24T11:25:06.783310 #8994]  INFO -- default-precise32: -----> Verifying <default-precise32>...
I, [2015-04-24T11:25:08.610894 #8994]  INFO -- default-precise32: Removing /tmp/busser/suites/bats
I, [2015-04-24T11:25:09.559079 #8994]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats (mode=0644)
I, [2015-04-24T11:25:12.304204 #8994]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats~ (mode=0644)
I, [2015-04-24T11:25:14.998284 #8994]  INFO -- default-precise32: -----> Running bats test suite
I, [2015-04-24T11:25:16.942232 #8994]  INFO -- default-precise32: [1G   apache binary is found in PATH[K[77G1/3[2G[1G ✓ apache binary is found in PATH[K
I, [2015-04-24T11:25:17.654916 #8994]  INFO -- default-precise32: [0m[1G   apache config is valid[K[77G2/3[2G[1G ✓ apache config is valid[K
I, [2015-04-24T11:25:18.846706 #8994]  INFO -- default-precise32: [0m[1G   nginx is running[K[77G3/3[2G[1G[31;1m ✗ nginx is running[K
I, [2015-04-24T11:25:18.847900 #8994]  INFO -- default-precise32: [0m[31;22m   (in test file /tmp/busser/suites/bats/apache_test.bats, line 15)
I, [2015-04-24T11:25:18.851670 #8994]  INFO -- default-precise32: [0m[31;22m     `[ "$output" == " * nginx is running" ]' failed
I, [2015-04-24T11:25:18.853730 #8994]  INFO -- default-precise32: [0m
I, [2015-04-24T11:25:18.855217 #8994]  INFO -- default-precise32: 3 tests, 1 failure
I, [2015-04-24T11:25:18.872649 #8994]  INFO -- default-precise32: !!!!!! Command [/tmp/busser/vendor/bats/bin/bats /tmp/busser/suites/bats] exit code was 1
E, [2015-04-24T11:25:19.089068 #8994] ERROR -- default-precise32: Verify failed on instance <default-precise32>.
E, [2015-04-24T11:25:19.089198 #8994] ERROR -- default-precise32: ------Exception-------
E, [2015-04-24T11:25:19.089222 #8994] ERROR -- default-precise32: Class: Kitchen::ActionFailed
E, [2015-04-24T11:25:19.089239 #8994] ERROR -- default-precise32: Message: SSH exited (1) for command: [sh -c '
BUSSER_ROOT="/tmp/busser" GEM_HOME="/tmp/busser/gems" GEM_PATH="/tmp/busser/gems" GEM_CACHE="/tmp/busser/gems/cache" 
export BUSSER_ROOT GEM_HOME GEM_PATH GEM_CACHE

sudo -E /tmp/busser/bin/busser test
']
E, [2015-04-24T11:25:19.089277 #8994] ERROR -- default-precise32: ---Nested Exception---
E, [2015-04-24T11:25:19.089316 #8994] ERROR -- default-precise32: Class: Kitchen::SSHFailed
E, [2015-04-24T11:25:19.089332 #8994] ERROR -- default-precise32: Message: SSH exited (1) for command: [sh -c '
BUSSER_ROOT="/tmp/busser" GEM_HOME="/tmp/busser/gems" GEM_PATH="/tmp/busser/gems" GEM_CACHE="/tmp/busser/gems/cache" 
export BUSSER_ROOT GEM_HOME GEM_PATH GEM_CACHE

sudo -E /tmp/busser/bin/busser test
']
E, [2015-04-24T11:25:19.089348 #8994] ERROR -- default-precise32: ------Backtrace-------
E, [2015-04-24T11:25:19.089370 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:152:in `rescue in run_remote'
E, [2015-04-24T11:25:19.089387 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:148:in `run_remote'
E, [2015-04-24T11:25:19.089403 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:67:in `block in verify'
E, [2015-04-24T11:25:19.089419 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/ssh.rb:70:in `initialize'
E, [2015-04-24T11:25:19.089435 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:65:in `new'
E, [2015-04-24T11:25:19.089451 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:65:in `verify'
E, [2015-04-24T11:25:19.089466 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:352:in `public_send'
E, [2015-04-24T11:25:19.089482 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:352:in `block in perform_action'
E, [2015-04-24T11:25:19.089498 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:416:in `call'
E, [2015-04-24T11:25:19.089514 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:416:in `synchronize_or_call'
E, [2015-04-24T11:25:19.089535 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:381:in `block in action'
E, [2015-04-24T11:25:19.089552 #8994] ERROR -- default-precise32: /usr/local/rvm/rubies/ruby-2.2.1/lib/ruby/2.2.0/benchmark.rb:288:in `measure'
E, [2015-04-24T11:25:19.089580 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:380:in `action'
E, [2015-04-24T11:25:19.089601 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:352:in `perform_action'
E, [2015-04-24T11:25:19.089618 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:330:in `verify_action'
E, [2015-04-24T11:25:19.089634 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:292:in `block in transition_to'
E, [2015-04-24T11:25:19.089650 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:291:in `each'
E, [2015-04-24T11:25:19.089665 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:291:in `transition_to'
E, [2015-04-24T11:25:19.089690 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:152:in `verify'
E, [2015-04-24T11:25:19.089712 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/command.rb:176:in `public_send'
E, [2015-04-24T11:25:19.089760 #8994] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/command.rb:176:in `block (2 levels) in run_action'
E, [2015-04-24T11:25:19.089789 #8994] ERROR -- default-precise32: ----------------------
I, [2015-04-24T11:26:21.306736 #9027]  INFO -- default-precise32: -----> Verifying <default-precise32>...
I, [2015-04-24T11:26:22.743045 #9027]  INFO -- default-precise32: Removing /tmp/busser/suites/bats
I, [2015-04-24T11:26:23.709484 #9027]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats (mode=0644)
I, [2015-04-24T11:26:26.310375 #9027]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats~ (mode=0644)
I, [2015-04-24T11:26:29.177687 #9027]  INFO -- default-precise32: -----> Running bats test suite
I, [2015-04-24T11:26:31.193461 #9027]  INFO -- default-precise32: [1G   apache binary is found in PATH[K[77G1/3[2G[1G ✓ apache binary is found in PATH[K
I, [2015-04-24T11:26:31.895777 #9027]  INFO -- default-precise32: [0m[1G   apache config is valid[K[77G2/3[2G[1G ✓ apache config is valid[K
I, [2015-04-24T11:26:34.009314 #9027]  INFO -- default-precise32: [0m[1G   apache is running[K[77G3/3[2G[1G[31;1m ✗ apache is running[K
I, [2015-04-24T11:26:34.011087 #9027]  INFO -- default-precise32: [0m[31;22m   (in test file /tmp/busser/suites/bats/apache_test.bats, line 15)
I, [2015-04-24T11:26:34.012771 #9027]  INFO -- default-precise32: [0m[31;22m     `[ "$output" == " * apache is running" ]' failed
I, [2015-04-24T11:26:34.014880 #9027]  INFO -- default-precise32: [0m
I, [2015-04-24T11:26:34.017211 #9027]  INFO -- default-precise32: 3 tests, 1 failure
I, [2015-04-24T11:26:34.038798 #9027]  INFO -- default-precise32: !!!!!! Command [/tmp/busser/vendor/bats/bin/bats /tmp/busser/suites/bats] exit code was 1
E, [2015-04-24T11:26:34.274028 #9027] ERROR -- default-precise32: Verify failed on instance <default-precise32>.
E, [2015-04-24T11:26:34.274158 #9027] ERROR -- default-precise32: ------Exception-------
E, [2015-04-24T11:26:34.274183 #9027] ERROR -- default-precise32: Class: Kitchen::ActionFailed
E, [2015-04-24T11:26:34.274201 #9027] ERROR -- default-precise32: Message: SSH exited (1) for command: [sh -c '
BUSSER_ROOT="/tmp/busser" GEM_HOME="/tmp/busser/gems" GEM_PATH="/tmp/busser/gems" GEM_CACHE="/tmp/busser/gems/cache" 
export BUSSER_ROOT GEM_HOME GEM_PATH GEM_CACHE

sudo -E /tmp/busser/bin/busser test
']
E, [2015-04-24T11:26:34.274218 #9027] ERROR -- default-precise32: ---Nested Exception---
E, [2015-04-24T11:26:34.274245 #9027] ERROR -- default-precise32: Class: Kitchen::SSHFailed
E, [2015-04-24T11:26:34.274282 #9027] ERROR -- default-precise32: Message: SSH exited (1) for command: [sh -c '
BUSSER_ROOT="/tmp/busser" GEM_HOME="/tmp/busser/gems" GEM_PATH="/tmp/busser/gems" GEM_CACHE="/tmp/busser/gems/cache" 
export BUSSER_ROOT GEM_HOME GEM_PATH GEM_CACHE

sudo -E /tmp/busser/bin/busser test
']
E, [2015-04-24T11:26:34.274301 #9027] ERROR -- default-precise32: ------Backtrace-------
E, [2015-04-24T11:26:34.274317 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:152:in `rescue in run_remote'
E, [2015-04-24T11:26:34.274340 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:148:in `run_remote'
E, [2015-04-24T11:26:34.274357 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:67:in `block in verify'
E, [2015-04-24T11:26:34.274373 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/ssh.rb:70:in `initialize'
E, [2015-04-24T11:26:34.274389 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:65:in `new'
E, [2015-04-24T11:26:34.274405 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:65:in `verify'
E, [2015-04-24T11:26:34.274430 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:352:in `public_send'
E, [2015-04-24T11:26:34.274455 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:352:in `block in perform_action'
E, [2015-04-24T11:26:34.274473 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:416:in `call'
E, [2015-04-24T11:26:34.274489 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:416:in `synchronize_or_call'
E, [2015-04-24T11:26:34.274505 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:381:in `block in action'
E, [2015-04-24T11:26:34.274521 #9027] ERROR -- default-precise32: /usr/local/rvm/rubies/ruby-2.2.1/lib/ruby/2.2.0/benchmark.rb:288:in `measure'
E, [2015-04-24T11:26:34.274537 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:380:in `action'
E, [2015-04-24T11:26:34.274552 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:352:in `perform_action'
E, [2015-04-24T11:26:34.274568 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:330:in `verify_action'
E, [2015-04-24T11:26:34.274584 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:292:in `block in transition_to'
E, [2015-04-24T11:26:34.274599 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:291:in `each'
E, [2015-04-24T11:26:34.274622 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:291:in `transition_to'
E, [2015-04-24T11:26:34.274640 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:152:in `verify'
E, [2015-04-24T11:26:34.274656 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/command.rb:176:in `public_send'
E, [2015-04-24T11:26:34.274672 #9027] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/command.rb:176:in `block (2 levels) in run_action'
E, [2015-04-24T11:26:34.274687 #9027] ERROR -- default-precise32: ----------------------
I, [2015-04-24T11:27:13.531169 #9060]  INFO -- default-precise32: -----> Verifying <default-precise32>...
I, [2015-04-24T11:27:15.439837 #9060]  INFO -- default-precise32: Removing /tmp/busser/suites/bats
I, [2015-04-24T11:27:16.360113 #9060]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats (mode=0644)
I, [2015-04-24T11:27:19.188078 #9060]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats~ (mode=0644)
I, [2015-04-24T11:27:22.007609 #9060]  INFO -- default-precise32: -----> Running bats test suite
I, [2015-04-24T11:27:24.068489 #9060]  INFO -- default-precise32: [1G   apache binary is found in PATH[K[77G1/3[2G[1G ✓ apache binary is found in PATH[K
I, [2015-04-24T11:27:24.836793 #9060]  INFO -- default-precise32: [0m[1G   apache config is valid[K[77G2/3[2G[1G ✓ apache config is valid[K
I, [2015-04-24T11:27:25.943874 #9060]  INFO -- default-precise32: [0m[1G   apache is running[K[77G3/3[2G[1G[31;1m ✗ apache is running[K
I, [2015-04-24T11:27:25.945348 #9060]  INFO -- default-precise32: [0m[31;22m   (in test file /tmp/busser/suites/bats/apache_test.bats, line 15)
I, [2015-04-24T11:27:25.946507 #9060]  INFO -- default-precise32: 
I, [2015-04-24T11:27:25.948102 #9060]  INFO -- default-precise32: [0m
I, [2015-04-24T11:27:25.948134 #9060]  INFO -- default-precise32: 3 tests, 1 failure
I, [2015-04-24T11:27:25.963184 #9060]  INFO -- default-precise32: !!!!!! Command [/tmp/busser/vendor/bats/bin/bats /tmp/busser/suites/bats] exit code was 1
E, [2015-04-24T11:27:26.158303 #9060] ERROR -- default-precise32: Verify failed on instance <default-precise32>.
E, [2015-04-24T11:27:26.158473 #9060] ERROR -- default-precise32: ------Exception-------
E, [2015-04-24T11:27:26.158499 #9060] ERROR -- default-precise32: Class: Kitchen::ActionFailed
E, [2015-04-24T11:27:26.158516 #9060] ERROR -- default-precise32: Message: SSH exited (1) for command: [sh -c '
BUSSER_ROOT="/tmp/busser" GEM_HOME="/tmp/busser/gems" GEM_PATH="/tmp/busser/gems" GEM_CACHE="/tmp/busser/gems/cache" 
export BUSSER_ROOT GEM_HOME GEM_PATH GEM_CACHE

sudo -E /tmp/busser/bin/busser test
']
E, [2015-04-24T11:27:26.158540 #9060] ERROR -- default-precise32: ---Nested Exception---
E, [2015-04-24T11:27:26.158558 #9060] ERROR -- default-precise32: Class: Kitchen::SSHFailed
E, [2015-04-24T11:27:26.158573 #9060] ERROR -- default-precise32: Message: SSH exited (1) for command: [sh -c '
BUSSER_ROOT="/tmp/busser" GEM_HOME="/tmp/busser/gems" GEM_PATH="/tmp/busser/gems" GEM_CACHE="/tmp/busser/gems/cache" 
export BUSSER_ROOT GEM_HOME GEM_PATH GEM_CACHE

sudo -E /tmp/busser/bin/busser test
']
E, [2015-04-24T11:27:26.158589 #9060] ERROR -- default-precise32: ------Backtrace-------
E, [2015-04-24T11:27:26.158605 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:152:in `rescue in run_remote'
E, [2015-04-24T11:27:26.158620 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:148:in `run_remote'
E, [2015-04-24T11:27:26.158636 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:67:in `block in verify'
E, [2015-04-24T11:27:26.158652 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/ssh.rb:70:in `initialize'
E, [2015-04-24T11:27:26.158667 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:65:in `new'
E, [2015-04-24T11:27:26.158690 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:65:in `verify'
E, [2015-04-24T11:27:26.158708 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:352:in `public_send'
E, [2015-04-24T11:27:26.158723 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:352:in `block in perform_action'
E, [2015-04-24T11:27:26.158749 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:416:in `call'
E, [2015-04-24T11:27:26.158767 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:416:in `synchronize_or_call'
E, [2015-04-24T11:27:26.158783 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:381:in `block in action'
E, [2015-04-24T11:27:26.158799 #9060] ERROR -- default-precise32: /usr/local/rvm/rubies/ruby-2.2.1/lib/ruby/2.2.0/benchmark.rb:288:in `measure'
E, [2015-04-24T11:27:26.158815 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:380:in `action'
E, [2015-04-24T11:27:26.158830 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:352:in `perform_action'
E, [2015-04-24T11:27:26.158853 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:330:in `verify_action'
E, [2015-04-24T11:27:26.158871 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:292:in `block in transition_to'
E, [2015-04-24T11:27:26.158887 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:291:in `each'
E, [2015-04-24T11:27:26.158926 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:291:in `transition_to'
E, [2015-04-24T11:27:26.158943 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:152:in `verify'
E, [2015-04-24T11:27:26.158959 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/command.rb:176:in `public_send'
E, [2015-04-24T11:27:26.158974 #9060] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/command.rb:176:in `block (2 levels) in run_action'
E, [2015-04-24T11:27:26.158990 #9060] ERROR -- default-precise32: ----------------------
I, [2015-04-24T11:28:22.183625 #9095]  INFO -- default-precise32: -----> Verifying <default-precise32>...
I, [2015-04-24T11:28:23.890532 #9095]  INFO -- default-precise32: Removing /tmp/busser/suites/bats
I, [2015-04-24T11:28:24.714833 #9095]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats (mode=0644)
I, [2015-04-24T11:28:27.477894 #9095]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats~ (mode=0644)
I, [2015-04-24T11:28:30.229106 #9095]  INFO -- default-precise32: -----> Running bats test suite
I, [2015-04-24T11:28:32.528169 #9095]  INFO -- default-precise32: [1G   apache binary is found in PATH[K[77G1/3[2G[1G ✓ apache binary is found in PATH[K
I, [2015-04-24T11:28:33.333557 #9095]  INFO -- default-precise32: [0m[1G   apache config is valid[K[77G2/3[2G[1G ✓ apache config is valid[K
I, [2015-04-24T11:28:34.459129 #9095]  INFO -- default-precise32: [0m[1G   apache is running[K[77G3/3[2G[1G[31;1m ✗ apache is running[K
I, [2015-04-24T11:28:34.460589 #9095]  INFO -- default-precise32: [0m[31;22m   (in test file /tmp/busser/suites/bats/apache_test.bats, line 15)
I, [2015-04-24T11:28:34.462052 #9095]  INFO -- default-precise32: [0m[31;22m     `[ "$output" == " * Apache2 is running" ]' failed
I, [2015-04-24T11:28:34.464186 #9095]  INFO -- default-precise32: [0m
I, [2015-04-24T11:28:34.466098 #9095]  INFO -- default-precise32: 3 tests, 1 failure
I, [2015-04-24T11:28:34.482124 #9095]  INFO -- default-precise32: !!!!!! Command [/tmp/busser/vendor/bats/bin/bats /tmp/busser/suites/bats] exit code was 1
E, [2015-04-24T11:28:34.694534 #9095] ERROR -- default-precise32: Verify failed on instance <default-precise32>.
E, [2015-04-24T11:28:34.694669 #9095] ERROR -- default-precise32: ------Exception-------
E, [2015-04-24T11:28:34.694694 #9095] ERROR -- default-precise32: Class: Kitchen::ActionFailed
E, [2015-04-24T11:28:34.694713 #9095] ERROR -- default-precise32: Message: SSH exited (1) for command: [sh -c '
BUSSER_ROOT="/tmp/busser" GEM_HOME="/tmp/busser/gems" GEM_PATH="/tmp/busser/gems" GEM_CACHE="/tmp/busser/gems/cache" 
export BUSSER_ROOT GEM_HOME GEM_PATH GEM_CACHE

sudo -E /tmp/busser/bin/busser test
']
E, [2015-04-24T11:28:34.694730 #9095] ERROR -- default-precise32: ---Nested Exception---
E, [2015-04-24T11:28:34.694746 #9095] ERROR -- default-precise32: Class: Kitchen::SSHFailed
E, [2015-04-24T11:28:34.694762 #9095] ERROR -- default-precise32: Message: SSH exited (1) for command: [sh -c '
BUSSER_ROOT="/tmp/busser" GEM_HOME="/tmp/busser/gems" GEM_PATH="/tmp/busser/gems" GEM_CACHE="/tmp/busser/gems/cache" 
export BUSSER_ROOT GEM_HOME GEM_PATH GEM_CACHE

sudo -E /tmp/busser/bin/busser test
']
E, [2015-04-24T11:28:34.694786 #9095] ERROR -- default-precise32: ------Backtrace-------
E, [2015-04-24T11:28:34.694804 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:152:in `rescue in run_remote'
E, [2015-04-24T11:28:34.694821 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:148:in `run_remote'
E, [2015-04-24T11:28:34.694837 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:67:in `block in verify'
E, [2015-04-24T11:28:34.694864 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/ssh.rb:70:in `initialize'
E, [2015-04-24T11:28:34.694881 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:65:in `new'
E, [2015-04-24T11:28:34.694898 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:65:in `verify'
E, [2015-04-24T11:28:34.694914 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:352:in `public_send'
E, [2015-04-24T11:28:34.694930 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:352:in `block in perform_action'
E, [2015-04-24T11:28:34.694948 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:416:in `call'
E, [2015-04-24T11:28:34.694983 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:416:in `synchronize_or_call'
E, [2015-04-24T11:28:34.695009 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:381:in `block in action'
E, [2015-04-24T11:28:34.695030 #9095] ERROR -- default-precise32: /usr/local/rvm/rubies/ruby-2.2.1/lib/ruby/2.2.0/benchmark.rb:288:in `measure'
E, [2015-04-24T11:28:34.695046 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:380:in `action'
E, [2015-04-24T11:28:34.695062 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:352:in `perform_action'
E, [2015-04-24T11:28:34.695100 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:330:in `verify_action'
E, [2015-04-24T11:28:34.695117 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:292:in `block in transition_to'
E, [2015-04-24T11:28:34.695133 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:291:in `each'
E, [2015-04-24T11:28:34.695149 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:291:in `transition_to'
E, [2015-04-24T11:28:34.695172 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:152:in `verify'
E, [2015-04-24T11:28:34.695191 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/command.rb:176:in `public_send'
E, [2015-04-24T11:28:34.695207 #9095] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/command.rb:176:in `block (2 levels) in run_action'
E, [2015-04-24T11:28:34.695223 #9095] ERROR -- default-precise32: ----------------------
I, [2015-04-24T11:28:46.450179 #9125]  INFO -- default-precise32: -----> Verifying <default-precise32>...
I, [2015-04-24T11:28:47.967459 #9125]  INFO -- default-precise32: Removing /tmp/busser/suites/bats
I, [2015-04-24T11:28:48.895578 #9125]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats (mode=0644)
I, [2015-04-24T11:28:51.379448 #9125]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats~ (mode=0644)
I, [2015-04-24T11:28:54.254820 #9125]  INFO -- default-precise32: -----> Running bats test suite
I, [2015-04-24T11:28:55.947197 #9125]  INFO -- default-precise32: [1G   apache binary is found in PATH[K[77G1/1[2G[1G ✓ apache binary is found in PATH[K
I, [2015-04-24T11:28:55.948863 #9125]  INFO -- default-precise32: [0m
I, [2015-04-24T11:28:55.950778 #9125]  INFO -- default-precise32: 1 test, 0 failures
I, [2015-04-24T11:28:56.156905 #9125]  INFO -- default-precise32: Finished verifying <default-precise32> (0m9.70s).
I, [2015-04-24T11:29:19.212495 #9151]  INFO -- default-precise32: -----> Verifying <default-precise32>...
I, [2015-04-24T11:29:20.881296 #9151]  INFO -- default-precise32: Removing /tmp/busser/suites/bats
I, [2015-04-24T11:29:21.810137 #9151]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats (mode=0644)
I, [2015-04-24T11:29:24.641065 #9151]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats~ (mode=0644)
I, [2015-04-24T11:29:27.297268 #9151]  INFO -- default-precise32: -----> Running bats test suite
I, [2015-04-24T11:29:29.211441 #9151]  INFO -- default-precise32: [1G   apache binary is found in PATH[K[77G1/2[2G[1G ✓ apache binary is found in PATH[K
I, [2015-04-24T11:29:29.707109 #9151]  INFO -- default-precise32: [0m[1G   apache config is valid[K[77G2/2[2G[1G ✓ apache config is valid[K
I, [2015-04-24T11:29:29.709177 #9151]  INFO -- default-precise32: [0m
I, [2015-04-24T11:29:29.711182 #9151]  INFO -- default-precise32: 2 tests, 0 failures
I, [2015-04-24T11:29:29.950619 #9151]  INFO -- default-precise32: Finished verifying <default-precise32> (0m10.74s).
I, [2015-04-24T11:30:08.482669 #9185]  INFO -- default-precise32: -----> Verifying <default-precise32>...
I, [2015-04-24T11:30:10.208185 #9185]  INFO -- default-precise32: Removing /tmp/busser/suites/bats
I, [2015-04-24T11:30:11.161910 #9185]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats (mode=0644)
I, [2015-04-24T11:30:13.835030 #9185]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats~ (mode=0644)
I, [2015-04-24T11:30:16.404838 #9185]  INFO -- default-precise32: -----> Running bats test suite
I, [2015-04-24T11:30:18.485693 #9185]  INFO -- default-precise32: [1G   apache binary is found in PATH[K[77G1/3[2G[1G ✓ apache binary is found in PATH[K
I, [2015-04-24T11:30:19.268260 #9185]  INFO -- default-precise32: [0m[1G   apache config is valid[K[77G2/3[2G[1G ✓ apache config is valid[K
I, [2015-04-24T11:30:19.924225 #9185]  INFO -- default-precise32: [0m[1G   apache is running[K[77G3/3[2G[1G ✓ apache is running[K
I, [2015-04-24T11:30:19.926192 #9185]  INFO -- default-precise32: [0m
I, [2015-04-24T11:30:19.928108 #9185]  INFO -- default-precise32: 3 tests, 0 failures
I, [2015-04-24T11:30:20.136180 #9185]  INFO -- default-precise32: Finished verifying <default-precise32> (0m11.65s).
I, [2015-04-24T11:30:49.629845 #9216]  INFO -- default-precise32: -----> Verifying <default-precise32>...
I, [2015-04-24T11:30:51.362802 #9216]  INFO -- default-precise32: Removing /tmp/busser/suites/bats
I, [2015-04-24T11:30:52.274474 #9216]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats (mode=0644)
I, [2015-04-24T11:30:54.891183 #9216]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats~ (mode=0644)
I, [2015-04-24T11:30:57.755045 #9216]  INFO -- default-precise32: -----> Running bats test suite
I, [2015-04-24T11:31:00.110475 #9216]  INFO -- default-precise32: [1G   apache binary is found in PATH[K[77G1/3[2G[1G ✓ apache binary is found in PATH[K
I, [2015-04-24T11:31:01.086318 #9216]  INFO -- default-precise32: [0m[1G   apache config is valid[K[77G2/3[2G[1G ✓ apache config is valid[K
I, [2015-04-24T11:31:02.128389 #9216]  INFO -- default-precise32: [0m[1G   apache is running[K[77G3/3[2G[1G[31;1m ✗ apache is running[K
I, [2015-04-24T11:31:02.134390 #9216]  INFO -- default-precise32: [0m[31;22m   (in test file /tmp/busser/suites/bats/apache_test.bats, line 15)
I, [2015-04-24T11:31:02.137139 #9216]  INFO -- default-precise32: [0m[31;22m     `[[ ($output == "apache2 is running"*) ]]' failed
I, [2015-04-24T11:31:02.140121 #9216]  INFO -- default-precise32: [0m
I, [2015-04-24T11:31:02.143322 #9216]  INFO -- default-precise32: 3 tests, 1 failure
I, [2015-04-24T11:31:02.171628 #9216]  INFO -- default-precise32: !!!!!! Command [/tmp/busser/vendor/bats/bin/bats /tmp/busser/suites/bats] exit code was 1
E, [2015-04-24T11:31:02.501437 #9216] ERROR -- default-precise32: Verify failed on instance <default-precise32>.
E, [2015-04-24T11:31:02.501612 #9216] ERROR -- default-precise32: ------Exception-------
E, [2015-04-24T11:31:02.501639 #9216] ERROR -- default-precise32: Class: Kitchen::ActionFailed
E, [2015-04-24T11:31:02.501669 #9216] ERROR -- default-precise32: Message: SSH exited (1) for command: [sh -c '
BUSSER_ROOT="/tmp/busser" GEM_HOME="/tmp/busser/gems" GEM_PATH="/tmp/busser/gems" GEM_CACHE="/tmp/busser/gems/cache" 
export BUSSER_ROOT GEM_HOME GEM_PATH GEM_CACHE

sudo -E /tmp/busser/bin/busser test
']
E, [2015-04-24T11:31:02.501685 #9216] ERROR -- default-precise32: ---Nested Exception---
E, [2015-04-24T11:31:02.501708 #9216] ERROR -- default-precise32: Class: Kitchen::SSHFailed
E, [2015-04-24T11:31:02.501725 #9216] ERROR -- default-precise32: Message: SSH exited (1) for command: [sh -c '
BUSSER_ROOT="/tmp/busser" GEM_HOME="/tmp/busser/gems" GEM_PATH="/tmp/busser/gems" GEM_CACHE="/tmp/busser/gems/cache" 
export BUSSER_ROOT GEM_HOME GEM_PATH GEM_CACHE

sudo -E /tmp/busser/bin/busser test
']
E, [2015-04-24T11:31:02.501741 #9216] ERROR -- default-precise32: ------Backtrace-------
E, [2015-04-24T11:31:02.501770 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:152:in `rescue in run_remote'
E, [2015-04-24T11:31:02.501786 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:148:in `run_remote'
E, [2015-04-24T11:31:02.501802 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:67:in `block in verify'
E, [2015-04-24T11:31:02.501818 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/ssh.rb:70:in `initialize'
E, [2015-04-24T11:31:02.501834 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:65:in `new'
E, [2015-04-24T11:31:02.501849 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/driver/ssh_base.rb:65:in `verify'
E, [2015-04-24T11:31:02.501865 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:352:in `public_send'
E, [2015-04-24T11:31:02.501887 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:352:in `block in perform_action'
E, [2015-04-24T11:31:02.501905 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:416:in `call'
E, [2015-04-24T11:31:02.501921 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:416:in `synchronize_or_call'
E, [2015-04-24T11:31:02.501937 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:381:in `block in action'
E, [2015-04-24T11:31:02.501953 #9216] ERROR -- default-precise32: /usr/local/rvm/rubies/ruby-2.2.1/lib/ruby/2.2.0/benchmark.rb:288:in `measure'
E, [2015-04-24T11:31:02.501969 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:380:in `action'
E, [2015-04-24T11:31:02.501984 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:352:in `perform_action'
E, [2015-04-24T11:31:02.502031 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:330:in `verify_action'
E, [2015-04-24T11:31:02.502049 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:292:in `block in transition_to'
E, [2015-04-24T11:31:02.502069 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:291:in `each'
E, [2015-04-24T11:31:02.502089 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:291:in `transition_to'
E, [2015-04-24T11:31:02.502114 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/instance.rb:152:in `verify'
E, [2015-04-24T11:31:02.502131 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/command.rb:176:in `public_send'
E, [2015-04-24T11:31:02.502147 #9216] ERROR -- default-precise32: /usr/local/rvm/gems/ruby-2.2.1/gems/test-kitchen-1.3.1/lib/kitchen/command.rb:176:in `block (2 levels) in run_action'
E, [2015-04-24T11:31:02.502162 #9216] ERROR -- default-precise32: ----------------------
I, [2015-04-24T11:31:19.500756 #9241]  INFO -- default-precise32: -----> Verifying <default-precise32>...
I, [2015-04-24T11:31:21.035581 #9241]  INFO -- default-precise32: Removing /tmp/busser/suites/bats
I, [2015-04-24T11:31:22.051231 #9241]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats (mode=0644)
I, [2015-04-24T11:31:24.936215 #9241]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats~ (mode=0644)
I, [2015-04-24T11:31:27.500244 #9241]  INFO -- default-precise32: -----> Running bats test suite
I, [2015-04-24T11:31:29.601216 #9241]  INFO -- default-precise32: [1G   apache binary is found in PATH[K[77G1/3[2G[1G ✓ apache binary is found in PATH[K
I, [2015-04-24T11:31:30.335205 #9241]  INFO -- default-precise32: [0m[1G   apache config is valid[K[77G2/3[2G[1G ✓ apache config is valid[K
I, [2015-04-24T11:31:31.004496 #9241]  INFO -- default-precise32: [0m[1G   apache is running[K[77G3/3[2G[1G ✓ apache is running[K
I, [2015-04-24T11:31:31.006914 #9241]  INFO -- default-precise32: [0m
I, [2015-04-24T11:31:31.008128 #9241]  INFO -- default-precise32: 3 tests, 0 failures
I, [2015-04-24T11:31:31.215793 #9241]  INFO -- default-precise32: Finished verifying <default-precise32> (0m11.71s).
I, [2015-04-24T11:33:10.814921 #9300]  INFO -- default-precise32: -----> Cleaning up any prior instances of <default-precise32>
I, [2015-04-24T11:33:10.815998 #9300]  INFO -- default-precise32: -----> Destroying <default-precise32>...
I, [2015-04-24T11:33:14.804307 #9300]  INFO -- default-precise32: Vagrant instance <default-precise32> destroyed.
I, [2015-04-24T11:33:14.806155 #9300]  INFO -- default-precise32: Finished destroying <default-precise32> (0m3.99s).
I, [2015-04-24T11:33:14.806996 #9300]  INFO -- default-precise32: -----> Testing <default-precise32>
I, [2015-04-24T11:33:14.807236 #9300]  INFO -- default-precise32: -----> Creating <default-precise32>...
I, [2015-04-24T11:34:16.464557 #9300]  INFO -- default-precise32: ==> default: Forcing shutdown of VM...==> default: Destroying VM and associated drives...Bringing machine 'default' up with 'virtualbox' provider...==> default: Importing base box 'precise32'...[KProgress: 10%[KProgress: 30%[KProgress: 40%[KProgress: 50%[KProgress: 70%[KProgress: 80%[KProgress: 90%[K==> default: Matching MAC address for NAT networking...==> default: Setting the name of the VM: kitchen-task10-default-precise32_default_1429864408847_97902==> default: Clearing any previously set network interfaces...==> default: Preparing network interfaces based on configuration...    default: Adapter 1: nat==> default: Forwarding ports...    default: 22 => 2222 (adapter 1)==> default: Booting VM...==> default: Waiting for machine to boot. This may take a few minutes...    default: SSH address: 127.0.0.1:2222    default: SSH username: vagrant    default: SSH auth method: private key    default: Warning: Connection timeout. Retrying...    default: Warning: Connection timeout. Retrying...    default: 
I, [2015-04-24T11:34:16.464665 #9300]  INFO -- default-precise32:     default: Vagrant insecure key detected. Vagrant will automatically replace
I, [2015-04-24T11:34:23.085756 #9300]  INFO -- default-precise32:     default: 
I, [2015-04-24T11:34:32.401919 #9300]  INFO -- default-precise32:     default: Removing insecure key from the guest if its present...    default: Key inserted! Disconnecting and reconnecting using new SSH key...==> default: Machine booted and ready!==> default: Checking for guest additions in VM...
I, [2015-04-24T11:34:32.465599 #9300]  INFO -- default-precise32:     default: The guest additions on this VM do not match the installed version of
I, [2015-04-24T11:34:32.465681 #9300]  INFO -- default-precise32:     default: VirtualBox! In most cases this is fine, but in rare cases it can
I, [2015-04-24T11:34:32.465712 #9300]  INFO -- default-precise32:     default: prevent things such as shared folders from working properly. If you see
I, [2015-04-24T11:34:32.465732 #9300]  INFO -- default-precise32:     default: shared folder errors, please make sure the guest additions within the
I, [2015-04-24T11:34:32.465759 #9300]  INFO -- default-precise32:     default: virtual machine match the version of VirtualBox you have installed on
I, [2015-04-24T11:34:32.465787 #9300]  INFO -- default-precise32:     default: your host and reload your VM.
I, [2015-04-24T11:34:32.465807 #9300]  INFO -- default-precise32:     default: 
I, [2015-04-24T11:34:32.465826 #9300]  INFO -- default-precise32:     default: Guest Additions Version: 4.2.0
I, [2015-04-24T11:34:43.830769 #9300]  INFO -- default-precise32: Vagrant instance <default-precise32> created.
I, [2015-04-24T11:34:43.832541 #9300]  INFO -- default-precise32: Finished creating <default-precise32> (1m29.02s).
I, [2015-04-24T11:34:43.832766 #9300]  INFO -- default-precise32: -----> Converging <default-precise32>...
I, [2015-04-24T11:34:43.834035 #9300]  INFO -- default-precise32: Preparing files for transfer
I, [2015-04-24T11:34:43.834179 #9300]  INFO -- default-precise32: Preparing dna.json
I, [2015-04-24T11:34:43.834790 #9300]  INFO -- default-precise32: Resolving cookbook dependencies with Berkshelf 3.2.3...
I, [2015-04-24T11:34:44.140567 #9300]  INFO -- default-precise32: Removing non-cookbook files before transfer
I, [2015-04-24T11:34:44.143901 #9300]  INFO -- default-precise32: Preparing data_bags
I, [2015-04-24T11:34:44.144176 #9300]  INFO -- default-precise32: Preparing environments
I, [2015-04-24T11:34:44.144383 #9300]  INFO -- default-precise32: Preparing nodes
I, [2015-04-24T11:34:44.144708 #9300]  INFO -- default-precise32: Preparing roles
I, [2015-04-24T11:34:44.144909 #9300]  INFO -- default-precise32: Preparing solo.rb
I, [2015-04-24T11:34:44.839197 #9300]  INFO -- default-precise32: ==> default: Setting hostname...==> default: Machine not provisioning because `--no-provision` is specified.-----> Installing Chef Omnibus (install only if missing)
I, [2015-04-24T11:34:44.840975 #9300]  INFO -- default-precise32: downloading https://www.chef.io/chef/install.sh
I, [2015-04-24T11:34:44.842329 #9300]  INFO -- default-precise32:   to file /tmp/install.sh
I, [2015-04-24T11:34:44.845056 #9300]  INFO -- default-precise32: trying wget...
I, [2015-04-24T11:34:46.228480 #9300]  INFO -- default-precise32: Downloading Chef  for ubuntu...
I, [2015-04-24T11:34:46.230710 #9300]  INFO -- default-precise32: downloading https://www.chef.io/chef/metadata?v=&prerelease=false&nightlies=false&p=ubuntu&pv=12.04&m=i686
I, [2015-04-24T11:34:46.232413 #9300]  INFO -- default-precise32:   to file /tmp/install.sh.1224/metadata.txt
I, [2015-04-24T11:34:46.234820 #9300]  INFO -- default-precise32: trying wget...
I, [2015-04-24T11:34:46.988606 #9300]  INFO -- default-precise32: url	https://opscode-omnibus-packages.s3.amazonaws.com/ubuntu/12.04/i686/chef_12.2.1-1_i386.deb
I, [2015-04-24T11:34:46.991419 #9300]  INFO -- default-precise32: md5	0c7c11da89b66bae5542b90ad9201781
I, [2015-04-24T11:34:46.994447 #9300]  INFO -- default-precise32: sha256	a7f745835dc7f586dd7a5fb3d585ba39b2fe5e02e69a239eaaa77c18277c4624
I, [2015-04-24T11:34:47.080430 #9300]  INFO -- default-precise32: downloaded metadata file looks valid...
I, [2015-04-24T11:34:47.304392 #9300]  INFO -- default-precise32: downloading https://opscode-omnibus-packages.s3.amazonaws.com/ubuntu/12.04/i686/chef_12.2.1-1_i386.deb
I, [2015-04-24T11:34:47.306778 #9300]  INFO -- default-precise32:   to file /tmp/install.sh.1224/chef_12.2.1-1_i386.deb
I, [2015-04-24T11:34:47.308829 #9300]  INFO -- default-precise32: trying wget...
I, [2015-04-24T11:35:40.166459 #9300]  INFO -- default-precise32: Comparing checksum with sha256sum...
I, [2015-04-24T11:35:40.624483 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:35:40.626421 #9300]  INFO -- default-precise32: WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING
I, [2015-04-24T11:35:40.627238 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:35:40.628598 #9300]  INFO -- default-precise32: You are installing an omnibus package without a version pin.  If you are installing
I, [2015-04-24T11:35:40.630345 #9300]  INFO -- default-precise32: on production servers via an automated process this is DANGEROUS and you will
I, [2015-04-24T11:35:40.631686 #9300]  INFO -- default-precise32: be upgraded without warning on new releases, even to new major release.
I, [2015-04-24T11:35:40.633792 #9300]  INFO -- default-precise32: Letting the version float is only appropriate in desktop, test, development or
I, [2015-04-24T11:35:40.636049 #9300]  INFO -- default-precise32: CI/CD environments.
I, [2015-04-24T11:35:40.637295 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:35:40.639286 #9300]  INFO -- default-precise32: WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING
I, [2015-04-24T11:35:40.640079 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:35:40.641210 #9300]  INFO -- default-precise32: Installing Chef 
I, [2015-04-24T11:35:40.642863 #9300]  INFO -- default-precise32: installing with dpkg...
I, [2015-04-24T11:35:41.081039 #9300]  INFO -- default-precise32: Selecting previously unselected package chef.
I, [2015-04-24T11:35:41.746621 #9300]  INFO -- default-precise32: (Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 29361 files and directories currently installed.)
I, [2015-04-24T11:35:41.749242 #9300]  INFO -- default-precise32: Unpacking chef (from .../chef_12.2.1-1_i386.deb) ...
I, [2015-04-24T11:36:37.510208 #9300]  INFO -- default-precise32: Setting up chef (12.2.1-1) ...
I, [2015-04-24T11:36:39.824530 #9300]  INFO -- default-precise32: Thank you for installing Chef!
I, [2015-04-24T11:36:40.601158 #9300]  INFO -- default-precise32: Transferring files to <default-precise32>
I, [2015-04-24T11:36:55.281954 #9300]  INFO -- default-precise32: Starting Chef Client, version 12.2.1
I, [2015-04-24T11:37:03.502289 #9300]  INFO -- default-precise32: Compiling Cookbooks...
I, [2015-04-24T11:37:03.648197 #9300]  INFO -- default-precise32: Converging 86 resources
I, [2015-04-24T11:37:03.654379 #9300]  INFO -- default-precise32: Recipe: apache2::default
I, [2015-04-24T11:38:15.001297 #9300]  INFO -- default-precise32:   * apt_package[apache2] action install
I, [2015-04-24T11:38:15.006470 #9300]  INFO -- default-precise32:     - install version 2.2.22-1ubuntu1 of package apache2
I, [2015-04-24T11:38:15.032950 #9300]  INFO -- default-precise32:   * directory[/etc/apache2/sites-available] action create (up to date)
I, [2015-04-24T11:38:15.042870 #9300]  INFO -- default-precise32:   * directory[/etc/apache2/sites-enabled] action create (up to date)
I, [2015-04-24T11:38:15.052829 #9300]  INFO -- default-precise32:   * directory[/etc/apache2/mods-available] action create (up to date)
I, [2015-04-24T11:38:15.063191 #9300]  INFO -- default-precise32:   * directory[/etc/apache2/mods-enabled] action create (up to date)
I, [2015-04-24T11:38:15.067997 #9300]  INFO -- default-precise32:   * directory[/etc/apache2/conf-available] action create
I, [2015-04-24T11:38:15.075210 #9300]  INFO -- default-precise32:     - create new directory /etc/apache2/conf-available
I, [2015-04-24T11:38:15.078143 #9300]  INFO -- default-precise32:     - change mode from '' to '0755'
I, [2015-04-24T11:38:15.080403 #9300]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:38:15.089528 #9300]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:38:15.096805 #9300]  INFO -- default-precise32:   * directory[/etc/apache2/conf-enabled] action create
I, [2015-04-24T11:38:15.104163 #9300]  INFO -- default-precise32:     - create new directory /etc/apache2/conf-enabled
I, [2015-04-24T11:38:15.106199 #9300]  INFO -- default-precise32:     - change mode from '' to '0755'
I, [2015-04-24T11:38:15.108663 #9300]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:38:15.112608 #9300]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:38:15.119955 #9300]  INFO -- default-precise32:   * link[/etc/apache2/sites-enabled/default] action delete (up to date)
I, [2015-04-24T11:38:15.128832 #9300]  INFO -- default-precise32:   * file[/etc/apache2/sites-available/default] action delete
I, [2015-04-24T11:38:15.131336 #9300]  INFO -- default-precise32:     - delete file /etc/apache2/sites-available/default
I, [2015-04-24T11:38:15.136159 #9300]  INFO -- default-precise32:   * link[/etc/apache2/sites-enabled/000-default] action delete
I, [2015-04-24T11:38:15.138596 #9300]  INFO -- default-precise32:     - delete link at /etc/apache2/sites-enabled/000-default
I, [2015-04-24T11:38:15.143473 #9300]  INFO -- default-precise32:   * file[/etc/apache2/sites-available/000-default] action delete (up to date)
I, [2015-04-24T11:38:15.156967 #9300]  INFO -- default-precise32:   * directory[/etc/apache2/conf.d] action delete
I, [2015-04-24T11:38:15.159881 #9300]  INFO -- default-precise32:     - delete existing directory /etc/apache2/conf.d
I, [2015-04-24T11:38:15.166639 #9300]  INFO -- default-precise32:   * directory[/var/log/apache2] action create
I, [2015-04-24T11:38:15.171585 #9300]  INFO -- default-precise32:     - change mode from '0750' to '0755'
I, [2015-04-24T11:38:15.508252 #9300]  INFO -- default-precise32:   * apt_package[perl] action install (up to date)
I, [2015-04-24T11:38:15.526911 #9300]  INFO -- default-precise32:   * link[/usr/sbin/a2ensite] action delete
I, [2015-04-24T11:38:15.529952 #9300]  INFO -- default-precise32:     - delete link at /usr/sbin/a2ensite
I, [2015-04-24T11:38:15.939684 #9300]  INFO -- default-precise32:   * template[/usr/sbin/a2ensite] action create
I, [2015-04-24T11:38:16.106529 #9300]  INFO -- default-precise32:     - create new file /usr/sbin/a2ensite
I, [2015-04-24T11:38:16.106802 #9300]  INFO -- default-precise32:     - update content in file /usr/sbin/a2ensite from none to ce53f4
I, [2015-04-24T11:38:16.107115 #9300]  INFO -- default-precise32:     --- /usr/sbin/a2ensite	2015-04-24 08:38:15.928745358 +0000
I, [2015-04-24T11:38:16.107369 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-1siwkkh	2015-04-24 08:38:15.928745358 +0000
I, [2015-04-24T11:38:16.107495 #9300]  INFO -- default-precise32:     @@ -1 +1,533 @@
I, [2015-04-24T11:38:16.107642 #9300]  INFO -- default-precise32: +#!/usr/bin/perl -w
I, [2015-04-24T11:38:16.107733 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:16.107895 #9300]  INFO -- default-precise32:     +# a2enmod by Stefan Fritsch <sf@debian.org>
I, [2015-04-24T11:38:16.107986 #9300]  INFO -- default-precise32:     +# Licensed under Apache License 2.0
I, [2015-04-24T11:38:16.108189 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:16.108497 #9300]  INFO -- default-precise32:     +# The coding style is "perltidy -pbp"
I, [2015-04-24T11:38:16.108745 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.108917 #9300]  INFO -- default-precise32:     +use strict;
I, [2015-04-24T11:38:16.109095 #9300]  INFO -- default-precise32:     +use Cwd 'realpath';
I, [2015-04-24T11:38:16.109315 #9300]  INFO -- default-precise32: +use File::Spec;
I, [2015-04-24T11:38:16.109495 #9300]  INFO -- default-precise32:     +use File::Basename;
I, [2015-04-24T11:38:16.109701 #9300]  INFO -- default-precise32:     +use File::Path;
I, [2015-04-24T11:38:16.109969 #9300]  INFO -- default-precise32:     +use Getopt::Long;
I, [2015-04-24T11:38:16.110078 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.110349 #9300]  INFO -- default-precise32:     +my $quiet;
I, [2015-04-24T11:38:16.110375 #9300]  INFO -- default-precise32:     +my $force;
I, [2015-04-24T11:38:16.110498 #9300]  INFO -- default-precise32:     +my $maintmode;
I, [2015-04-24T11:38:16.110610 #9300]  INFO -- default-precise32: +my $purge;
I, [2015-04-24T11:38:16.110827 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.110980 #9300]  INFO -- default-precise32:     +Getopt::Long::Configure('bundling');
I, [2015-04-24T11:38:16.111357 #9300]  INFO -- default-precise32: +GetOptions(
I, [2015-04-24T11:38:16.111566 #9300]  INFO -- default-precise32:     +    'quiet|q'     => \$quiet,
I, [2015-04-24T11:38:16.111791 #9300]  INFO -- default-precise32:     +    'force|f'     => \$force,
I, [2015-04-24T11:38:16.111816 #9300]  INFO -- default-precise32:     +    'maintmode|m' => \$maintmode,
I, [2015-04-24T11:38:16.112016 #9300]  INFO -- default-precise32:     +    'purge|p'     => \$purge
I, [2015-04-24T11:38:16.112247 #9300]  INFO -- default-precise32:     +) or exit 2;
I, [2015-04-24T11:38:16.112493 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.112620 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:16.112832 #9300]  INFO -- default-precise32:     +$basename =~ /^a2(en|dis)(mod|site|conf)((?:-.+)?)$/
I, [2015-04-24T11:38:16.113098 #9300]  INFO -- default-precise32:     +    or die "$basename call name unknown\n";
I, [2015-04-24T11:38:16.113387 #9300]  INFO -- default-precise32:     +my $act        = $1;
I, [2015-04-24T11:38:16.113621 #9300]  INFO -- default-precise32:     +my $obj        = $2;
I, [2015-04-24T11:38:16.113726 #9300]  INFO -- default-precise32:     +my $dir_suffix = $3;
I, [2015-04-24T11:38:16.113832 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.113856 #9300]  INFO -- default-precise32:     +my $env_file = $ENV{APACHE_ENVVARS}
I, [2015-04-24T11:38:16.113875 #9300]  INFO -- default-precise32:     +    || (
I, [2015-04-24T11:38:16.113893 #9300]  INFO -- default-precise32:     +    $ENV{APACHE_CONFDIR}
I, [2015-04-24T11:38:16.114107 #9300]  INFO -- default-precise32:     +    ? "$ENV{APACHE_CONFDIR}/envvars"
I, [2015-04-24T11:38:16.114306 #9300]  INFO -- default-precise32:     +    : "/etc/apache2$dir_suffix/envvars"
I, [2015-04-24T11:38:16.114481 #9300]  INFO -- default-precise32:     +    );
I, [2015-04-24T11:38:16.114686 #9300]  INFO -- default-precise32:     +$ENV{LANG} = 'C';
I, [2015-04-24T11:38:16.114906 #9300]  INFO -- default-precise32:     +read_env_file($env_file);
I, [2015-04-24T11:38:16.115139 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.115399 #9300]  INFO -- default-precise32:     +$act .= 'able';
I, [2015-04-24T11:38:16.115691 #9300]  INFO -- default-precise32:     +my ( $name, $dir, $sffx, $reload );
I, [2015-04-24T11:38:16.115891 #9300]  INFO -- default-precise32:     +if ( $obj eq 'mod' ) {
I, [2015-04-24T11:38:16.116109 #9300]  INFO -- default-precise32:     +    $obj    = 'module';
I, [2015-04-24T11:38:16.116381 #9300]  INFO -- default-precise32:     +    $dir    = 'mods';
I, [2015-04-24T11:38:16.123259 #9300]  INFO -- default-precise32:     +    $sffx   = '.load';
I, [2015-04-24T11:38:16.123525 #9300]  INFO -- default-precise32:     +    $reload = 'restart';
I, [2015-04-24T11:38:16.123771 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:16.123974 #9300]  INFO -- default-precise32:     +elsif ( $obj eq 'conf' ) {
I, [2015-04-24T11:38:16.124203 #9300]  INFO -- default-precise32:     +    $obj    = 'conf';
I, [2015-04-24T11:38:16.124438 #9300]  INFO -- default-precise32:     +    $dir    = 'conf';
I, [2015-04-24T11:38:16.124475 #9300]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:38:16.124496 #9300]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:38:16.124673 #9300]  INFO -- default-precise32: +}
I, [2015-04-24T11:38:16.124794 #9300]  INFO -- default-precise32: +else {
I, [2015-04-24T11:38:16.124819 #9300]  INFO -- default-precise32:     +    $dir    = 'sites';
I, [2015-04-24T11:38:16.125057 #9300]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:38:16.125160 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:16.125381 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:16.125494 #9300]  INFO -- default-precise32: +$name = ucfirst($obj);
I, [2015-04-24T11:38:16.125597 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:16.125827 #9300]  INFO -- default-precise32:     +my $confdir = $ENV{APACHE_CONFDIR} || "/etc/apache2$dir_suffix";
I, [2015-04-24T11:38:16.126036 #9300]  INFO -- default-precise32:     +my $availdir = $ENV{ uc("APACHE_${dir}_AVAILABLE") }
I, [2015-04-24T11:38:16.126254 #9300]  INFO -- default-precise32:     +    || "$confdir/$dir-available";
I, [2015-04-24T11:38:16.126500 #9300]  INFO -- default-precise32:     +my $enabldir = $ENV{ uc("APACHE_${dir}_ENABLED") } || "$confdir/$dir-enabled";
I, [2015-04-24T11:38:16.126707 #9300]  INFO -- default-precise32:     +my $statedir = $ENV{ uc("APACHE_STATE_DIRECTORY") } || "/usr/lib/apache2";
I, [2015-04-24T11:38:16.126939 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.127160 #9300]  INFO -- default-precise32:     +$statedir .= "/$obj";
I, [2015-04-24T11:38:16.127396 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.127620 #9300]  INFO -- default-precise32:     +my $choicedir = $act eq 'enable' ? $availdir : $enabldir;
I, [2015-04-24T11:38:16.127933 #9300]  INFO -- default-precise32:     +my $linkdir = File::Spec->abs2rel( $availdir, $enabldir );
I, [2015-04-24T11:38:16.130060 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.132202 #9300]  INFO -- default-precise32:     +my $request_reload = 0;
I, [2015-04-24T11:38:16.134652 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.137019 #9300]  INFO -- default-precise32:     +my $rc = 0;
I, [2015-04-24T11:38:16.139282 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.142192 #9300]  INFO -- default-precise32:     +if ( !scalar @ARGV ) {
I, [2015-04-24T11:38:16.144374 #9300]  INFO -- default-precise32:     +    my @choices = myglob('*');
I, [2015-04-24T11:38:16.147055 #9300]  INFO -- default-precise32:     +    print "Your choices are: @choices\n";
I, [2015-04-24T11:38:16.149512 #9300]  INFO -- default-precise32:     +    print "Which ${obj}(s) do you want to $act (wildcards ok)?\n";
I, [2015-04-24T11:38:16.151744 #9300]  INFO -- default-precise32:     +    my $input = <>;
I, [2015-04-24T11:38:16.154185 #9300]  INFO -- default-precise32:     +    @ARGV = split /\s+/, $input;
I, [2015-04-24T11:38:16.156177 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.158839 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:16.160953 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.163284 #9300]  INFO -- default-precise32:     +my @objs;
I, [2015-04-24T11:38:16.165914 #9300]  INFO -- default-precise32:     +foreach my $arg (@ARGV) {
I, [2015-04-24T11:38:16.168157 #9300]  INFO -- default-precise32:     +    $arg =~ s/${sffx}$//;
I, [2015-04-24T11:38:16.170688 #9300]  INFO -- default-precise32:     +    my @glob = myglob($arg);
I, [2015-04-24T11:38:16.173138 #9300]  INFO -- default-precise32:     +    if ( !@glob ) {
I, [2015-04-24T11:38:16.175352 #9300]  INFO -- default-precise32:     +        error("No $obj found matching $arg!\n");
I, [2015-04-24T11:38:16.177853 #9300]  INFO -- default-precise32:     +        $rc = 1;
I, [2015-04-24T11:38:16.179989 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:16.182170 #9300]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:38:16.184344 #9300]  INFO -- default-precise32:     +        push @objs, @glob;
I, [2015-04-24T11:38:16.186994 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:16.189714 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:16.191312 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.193839 #9300]  INFO -- default-precise32:     +foreach my $acton (@objs) {
I, [2015-04-24T11:38:16.196170 #9300]  INFO -- default-precise32:     +    doit($acton) or $rc = 1;
I, [2015-04-24T11:38:16.199096 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:16.200841 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.203161 #9300]  INFO -- default-precise32:     +info(
I, [2015-04-24T11:38:16.205309 #9300]  INFO -- default-precise32:     +    "To activate the new configuration, you need to run:\n  service apache2 $reload\n"
I, [2015-04-24T11:38:16.207474 #9300]  INFO -- default-precise32:     +) if $request_reload;
I, [2015-04-24T11:38:16.210032 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.212300 #9300]  INFO -- default-precise32:     +exit($rc);
I, [2015-04-24T11:38:16.214768 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.216974 #9300]  INFO -- default-precise32:     +##############################################################################
I, [2015-04-24T11:38:16.219312 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.221799 #9300]  INFO -- default-precise32:     +sub myglob {
I, [2015-04-24T11:38:16.224188 #9300]  INFO -- default-precise32:     +    my $arg = shift;
I, [2015-04-24T11:38:16.226754 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.229590 #9300]  INFO -- default-precise32:     +    my @glob = map {
I, [2015-04-24T11:38:16.231890 #9300]  INFO -- default-precise32:     +        s{^$choicedir/}{};
I, [2015-04-24T11:38:16.234315 #9300]  INFO -- default-precise32:     +        s{$sffx$}{};
I, [2015-04-24T11:38:16.236482 #9300]  INFO -- default-precise32:     +        $_
I, [2015-04-24T11:38:16.238979 #9300]  INFO -- default-precise32:     +    } glob("$choicedir/$arg$sffx");
I, [2015-04-24T11:38:16.240990 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.243241 #9300]  INFO -- default-precise32:     +    return @glob;
I, [2015-04-24T11:38:16.245349 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:16.248420 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.252108 #9300]  INFO -- default-precise32:     +sub doit {
I, [2015-04-24T11:38:16.256147 #9300]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:38:16.260025 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.263381 #9300]  INFO -- default-precise32:     +    my ( $conftgt, $conflink );
I, [2015-04-24T11:38:16.266851 #9300]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:38:16.270444 #9300]  INFO -- default-precise32:     +        if ( $acton eq 'cgi' && threaded() ) {
I, [2015-04-24T11:38:16.274110 #9300]  INFO -- default-precise32:     +            print
I, [2015-04-24T11:38:16.277808 #9300]  INFO -- default-precise32:     +                "Your MPM seems to be threaded. Selecting cgid instead of cgi.\n";
I, [2015-04-24T11:38:16.281489 #9300]  INFO -- default-precise32:     +            $acton = 'cgid';
I, [2015-04-24T11:38:16.285198 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:16.288401 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.292106 #9300]  INFO -- default-precise32:     +        $conftgt = "$availdir/$acton.conf";
I, [2015-04-24T11:38:16.296109 #9300]  INFO -- default-precise32:     +        if ( -e $conftgt ) {
I, [2015-04-24T11:38:16.300386 #9300]  INFO -- default-precise32:     +            $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:38:16.303859 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:16.307372 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:16.310741 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.314983 #9300]  INFO -- default-precise32:     +    my $tgt  = "$availdir/$acton$sffx";
I, [2015-04-24T11:38:16.318975 #9300]  INFO -- default-precise32:     +    my $link = "$enabldir/$acton$sffx";
I, [2015-04-24T11:38:16.322516 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.326051 #9300]  INFO -- default-precise32:     +    if ( !-e $tgt ) {
I, [2015-04-24T11:38:16.329197 #9300]  INFO -- default-precise32:     +        if ( -l $link && !-e $link ) {
I, [2015-04-24T11:38:16.333136 #9300]  INFO -- default-precise32:     +            if ( $act eq 'disable' ) {
I, [2015-04-24T11:38:16.336611 #9300]  INFO -- default-precise32:     +                info("removing dangling symlink $link\n");
I, [2015-04-24T11:38:16.340477 #9300]  INFO -- default-precise32:     +                unlink($link);
I, [2015-04-24T11:38:16.343862 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.347535 #9300]  INFO -- default-precise32:     +                # force a .conf path. It may exist as dangling link, too
I, [2015-04-24T11:38:16.350889 #9300]  INFO -- default-precise32:     +                $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:38:16.354419 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.358298 #9300]  INFO -- default-precise32:     +                if ( -l $conflink && !-e $conflink ) {
I, [2015-04-24T11:38:16.362023 #9300]  INFO -- default-precise32:     +                    info("removing dangling symlink $conflink\n");
I, [2015-04-24T11:38:16.367071 #9300]  INFO -- default-precise32:     +                    unlink($conflink);
I, [2015-04-24T11:38:16.370728 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:16.374426 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.378313 #9300]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:38:16.382017 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:16.385359 #9300]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:38:16.389716 #9300]  INFO -- default-precise32:     +                error("$link is a dangling symlink!\n");
I, [2015-04-24T11:38:16.393220 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:16.396808 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:16.400007 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.403990 #9300]  INFO -- default-precise32:     +        if ( $purge ) {
I, [2015-04-24T11:38:16.407420 #9300]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:16.410771 #9300]  INFO -- default-precise32:     +            # exit silently, we are purging anyway
I, [2015-04-24T11:38:16.414124 #9300]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:38:16.417152 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:16.420201 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.423757 #9300]  INFO -- default-precise32:     +        error("$name $acton does not exist!\n");
I, [2015-04-24T11:38:16.426875 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:16.429937 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:16.433075 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.436661 #9300]  INFO -- default-precise32:     +    # handle module dependencies
I, [2015-04-24T11:38:16.440209 #9300]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:38:16.443533 #9300]  INFO -- default-precise32:     +        if ( $act eq 'enable' ) {
I, [2015-04-24T11:38:16.446730 #9300]  INFO -- default-precise32:     +            if ( $acton eq 'mpm_itk' ) {
I, [2015-04-24T11:38:16.450924 #9300]  INFO -- default-precise32:     +                warning(  "MPM_ITK is a third party module that is not part "
I, [2015-04-24T11:38:16.454494 #9300]  INFO -- default-precise32:     +                        . "of the official Apache HTTPD. It has seen less "
I, [2015-04-24T11:38:16.457820 #9300]  INFO -- default-precise32:     +                        . "testing than the official MPM modules." );
I, [2015-04-24T11:38:16.461127 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:16.464827 #9300]  INFO -- default-precise32:     +            my @depends = get_deps("$availdir/$acton.load");
I, [2015-04-24T11:38:16.468201 #9300]  INFO -- default-precise32:     +            do_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:38:16.471692 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.475172 #9300]  INFO -- default-precise32:     +            my @conflicts = get_deps( "$availdir/$acton.load", "Conflicts" );
I, [2015-04-24T11:38:16.479114 #9300]  INFO -- default-precise32:     +            check_conflicts( $acton, @conflicts ) or return 0;
I, [2015-04-24T11:38:16.482818 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:16.486223 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:16.488872 #9300]  INFO -- default-precise32:     +            my @depending;
I, [2015-04-24T11:38:16.491349 #9300]  INFO -- default-precise32:     +            foreach my $d ( glob("$enabldir/*.load") ) {
I, [2015-04-24T11:38:16.494071 #9300]  INFO -- default-precise32:     +                my @deps = get_deps($d);
I, [2015-04-24T11:38:16.496342 #9300]  INFO -- default-precise32:     +                if ( is_in( $acton, @deps ) ) {
I, [2015-04-24T11:38:16.498998 #9300]  INFO -- default-precise32:     +                    $d =~ m,/([^/]+).load$,;
I, [2015-04-24T11:38:16.501178 #9300]  INFO -- default-precise32:     +                    push @depending, $1;
I, [2015-04-24T11:38:16.503310 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:16.505669 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:16.507264 #9300]  INFO -- default-precise32:     +            if ( scalar @depending ) {
I, [2015-04-24T11:38:16.512617 #9300]  INFO -- default-precise32:     +                if ($force) {
I, [2015-04-24T11:38:16.514946 #9300]  INFO -- default-precise32:     +                    do_deps( $acton, @depending ) or return 0;
I, [2015-04-24T11:38:16.516907 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:16.519011 #9300]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:38:16.520904 #9300]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:38:16.523716 #9300]  INFO -- default-precise32:     +                        "The following modules depend on $acton ",
I, [2015-04-24T11:38:16.526474 #9300]  INFO -- default-precise32:     +                        "and need to be disabled first: @depending\n"
I, [2015-04-24T11:38:16.528770 #9300]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:38:16.531180 #9300]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:38:16.533933 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:16.536420 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:16.539069 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:16.541536 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:16.544170 #9300]  INFO -- default-precise32:     +    elsif ( $act eq 'enable' ) {
I, [2015-04-24T11:38:16.546869 #9300]  INFO -- default-precise32:     +        my @depends = get_deps("$availdir/$acton$sffx");
I, [2015-04-24T11:38:16.549209 #9300]  INFO -- default-precise32:     +        warn_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:38:16.552182 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:16.554205 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.556948 #9300]  INFO -- default-precise32:     +    if ( $act eq 'enable' ) {
I, [2015-04-24T11:38:16.559327 #9300]  INFO -- default-precise32:     +        my $check = check_link( $tgt, $link );
I, [2015-04-24T11:38:16.561951 #9300]  INFO -- default-precise32:     +        if ( $check eq 'ok' ) {
I, [2015-04-24T11:38:16.564172 #9300]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:38:16.566358 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.568792 #9300]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:38:16.571336 #9300]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:38:16.573772 #9300]  INFO -- default-precise32:     +                if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:38:16.576144 #9300]  INFO -- default-precise32:     +                    info("$name $acton already enabled\n");
I, [2015-04-24T11:38:16.578773 #9300]  INFO -- default-precise32:     +                    return 1;
I, [2015-04-24T11:38:16.581023 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:16.583673 #9300]  INFO -- default-precise32:     +                elsif ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:38:16.586799 #9300]  INFO -- default-precise32:     +                    print "Enabling config file $acton.conf.\n";
I, [2015-04-24T11:38:16.588878 #9300]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:38:16.591533 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:16.593916 #9300]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:38:16.596049 #9300]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:38:16.598614 #9300]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:38:16.600909 #9300]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:38:16.603526 #9300]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:38:16.605877 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:16.608616 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:16.610963 #9300]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:38:16.614057 #9300]  INFO -- default-precise32:     +                info("$name $acton already enabled\n");
I, [2015-04-24T11:38:16.616547 #9300]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:38:16.618832 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:16.623556 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:16.626188 #9300]  INFO -- default-precise32:     +        elsif ( $check eq 'missing' ) {
I, [2015-04-24T11:38:16.628633 #9300]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:38:16.631249 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.634133 #9300]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:38:16.636339 #9300]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:38:16.638855 #9300]  INFO -- default-precise32:     +                if ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:38:16.641082 #9300]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:38:16.643347 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:16.645349 #9300]  INFO -- default-precise32:     +                elsif ( $confcheck ne 'ok' ) {
I, [2015-04-24T11:38:16.647778 #9300]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:38:16.650027 #9300]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:38:16.651907 #9300]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:38:16.653958 #9300]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:38:16.655848 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:16.658241 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:16.659919 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.661959 #9300]  INFO -- default-precise32:     +            print "Enabling $obj $acton.\n";
I, [2015-04-24T11:38:16.663997 #9300]  INFO -- default-precise32:     +            if ( $acton eq 'ssl' ) {
I, [2015-04-24T11:38:16.666115 #9300]  INFO -- default-precise32:     +                info(     "See /usr/share/doc/apache2/README.Debian.gz on "
I, [2015-04-24T11:38:16.668056 #9300]  INFO -- default-precise32:     +                        . "how to configure SSL and create self-signed certificates.\n"
I, [2015-04-24T11:38:16.671858 #9300]  INFO -- default-precise32:     +                );
I, [2015-04-24T11:38:16.672535 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:16.674733 #9300]  INFO -- default-precise32:     +            return add_link( $tgt, $link )
I, [2015-04-24T11:38:16.676708 #9300]  INFO -- default-precise32:     +                && switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:16.679007 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:16.680840 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:16.682930 #9300]  INFO -- default-precise32:     +            error("$name $acton not properly enabled: $check\n");
I, [2015-04-24T11:38:16.684872 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:16.686960 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:16.688842 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:16.690802 #9300]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:38:16.692743 #9300]  INFO -- default-precise32:     +        if ( -e $link || -l $link ) {
I, [2015-04-24T11:38:16.694732 #9300]  INFO -- default-precise32:     +            remove_link($link);
I, [2015-04-24T11:38:16.697206 #9300]  INFO -- default-precise32:     +            if ( $conflink && -e $conflink ) {
I, [2015-04-24T11:38:16.701779 #9300]  INFO -- default-precise32:     +                remove_link($conflink);
I, [2015-04-24T11:38:16.702167 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:16.704015 #9300]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:16.706033 #9300]  INFO -- default-precise32:     +            print "$name $acton disabled.\n";
I, [2015-04-24T11:38:16.707856 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:16.710120 #9300]  INFO -- default-precise32:     +        elsif ( $conflink && -e $conflink ) {
I, [2015-04-24T11:38:16.711968 #9300]  INFO -- default-precise32:     +            print "Disabling stale config file $acton.conf.\n";
I, [2015-04-24T11:38:16.714270 #9300]  INFO -- default-precise32:     +            remove_link($conflink);
I, [2015-04-24T11:38:16.716328 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:16.718225 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:16.721369 #9300]  INFO -- default-precise32:     +            info("$name $acton already disabled\n");
I, [2015-04-24T11:38:16.723723 #9300]  INFO -- default-precise32:     +            if ( $purge ) {
I, [2015-04-24T11:38:16.725865 #9300]  INFO -- default-precise32:     +                switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:16.727733 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:16.731822 #9300]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:38:16.732471 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:16.735240 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:16.736805 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.738949 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:16.741279 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:16.742384 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.744366 #9300]  INFO -- default-precise32:     +sub get_deps {
I, [2015-04-24T11:38:16.746385 #9300]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:38:16.749289 #9300]  INFO -- default-precise32:     +    my $type = shift || "Depends";
I, [2015-04-24T11:38:16.750289 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.752297 #9300]  INFO -- default-precise32:     +    my $fd;
I, [2015-04-24T11:38:16.755871 #9300]  INFO -- default-precise32:     +    if ( !open( $fd, '<', $file ) ) {
I, [2015-04-24T11:38:16.760512 #9300]  INFO -- default-precise32:     +        error("Can't open $file: $!");
I, [2015-04-24T11:38:16.765463 #9300]  INFO -- default-precise32:     +        return;
I, [2015-04-24T11:38:16.770711 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:16.774981 #9300]  INFO -- default-precise32:     +    my $line;
I, [2015-04-24T11:38:16.779169 #9300]  INFO -- default-precise32:     +    while ( defined( $line = <$fd> ) ) {
I, [2015-04-24T11:38:16.783732 #9300]  INFO -- default-precise32:     +        chomp $line;
I, [2015-04-24T11:38:16.789927 #9300]  INFO -- default-precise32:     +        if ( $line =~ /^# $type:\s+(.*?)\s*$/ ) {
I, [2015-04-24T11:38:16.792065 #9300]  INFO -- default-precise32: +            my $deps = $1;
I, [2015-04-24T11:38:16.795582 #9300]  INFO -- default-precise32: +            return split( /[\n\s]+/, $deps );
I, [2015-04-24T11:38:16.798265 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:16.799846 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:16.804629 #9300]  INFO -- default-precise32:     +        # only check until the first non-empty non-comment line
I, [2015-04-24T11:38:16.809163 #9300]  INFO -- default-precise32:     +        last if ( $line !~ /^\s*(?:#.*)?$/ );
I, [2015-04-24T11:38:16.813812 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:16.818506 #9300]  INFO -- default-precise32:     +    return;
I, [2015-04-24T11:38:16.823138 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:16.827626 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.832498 #9300]  INFO -- default-precise32:     +sub do_deps {
I, [2015-04-24T11:38:16.837721 #9300]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:38:16.842728 #9300]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:38:16.844886 #9300]  INFO -- default-precise32: +        info("Considering dependency $d for $acton:\n");
I, [2015-04-24T11:38:16.848132 #9300]  INFO -- default-precise32: +        if ( !doit($d) ) {
I, [2015-04-24T11:38:16.851351 #9300]  INFO -- default-precise32:     +            error("Could not $act dependency $d for $acton, aborting\n");
I, [2015-04-24T11:38:16.854120 #9300]  INFO -- default-precise32: +            return 0;
I, [2015-04-24T11:38:16.855561 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:16.860214 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:16.865192 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:16.870484 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:16.874794 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.880314 #9300]  INFO -- default-precise32:     +sub warn_deps {
I, [2015-04-24T11:38:16.884820 #9300]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:38:16.889574 #9300]  INFO -- default-precise32:     +    my $modsenabldir = $ENV{APACHE_MODS_ENABLED} || "$confdir/mods-enabled";
I, [2015-04-24T11:38:16.894284 #9300]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:38:16.898739 #9300]  INFO -- default-precise32:     +        info("Checking dependency $d for $acton:\n");
I, [2015-04-24T11:38:16.902186 #9300]  INFO -- default-precise32: +        if ( !-e "$modsenabldir/$d.load" ) {
I, [2015-04-24T11:38:16.902220 #9300]  INFO -- default-precise32:     +            warning(
I, [2015-04-24T11:38:16.906960 #9300]  INFO -- default-precise32:     +                "Module $d is not enabled, but $acton depends on it, aborting\n"
I, [2015-04-24T11:38:16.912107 #9300]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:38:16.916667 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:16.921175 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:16.925995 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:16.930788 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:16.934821 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:16.937368 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.942062 #9300]  INFO -- default-precise32:     +sub check_conflicts {
I, [2015-04-24T11:38:16.942096 #9300]  INFO -- default-precise32:     +    my $acton    = shift;
I, [2015-04-24T11:38:16.942117 #9300]  INFO -- default-precise32:     +    my $haderror = 0;
I, [2015-04-24T11:38:16.942137 #9300]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:38:16.942156 #9300]  INFO -- default-precise32:     +        info("Considering conflict $d for $acton:\n");
I, [2015-04-24T11:38:16.942184 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.942204 #9300]  INFO -- default-precise32:     +        my $tgt  = "$availdir/$d$sffx";
I, [2015-04-24T11:38:16.942223 #9300]  INFO -- default-precise32:     +        my $link = "$enabldir/$d$sffx";
I, [2015-04-24T11:38:16.942241 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.942260 #9300]  INFO -- default-precise32:     +        my $confcheck = check_link( $tgt, $link );
I, [2015-04-24T11:38:16.942279 #9300]  INFO -- default-precise32:     +        if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:38:16.942306 #9300]  INFO -- default-precise32:     +            error(
I, [2015-04-24T11:38:16.942332 #9300]  INFO -- default-precise32:     +                "Module $d is enabled - cannot proceed due to conflicts. It needs to be disabled first!\n"
I, [2015-04-24T11:38:16.944109 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:16.948610 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.979302 #9300]  INFO -- default-precise32:     +            # Don't return immediately, there could be several conflicts
I, [2015-04-24T11:38:16.979382 #9300]  INFO -- default-precise32:     +            $haderror++;
I, [2015-04-24T11:38:16.979408 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:16.979428 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:16.979448 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.979467 #9300]  INFO -- default-precise32:     +    if ($haderror) {
I, [2015-04-24T11:38:16.979495 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:16.979516 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:16.979535 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.979554 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:16.979572 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:16.979590 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.979617 #9300]  INFO -- default-precise32:     +sub add_link {
I, [2015-04-24T11:38:16.979659 #9300]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:38:16.979678 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:16.984479 #9300]  INFO -- default-precise32:     +    # create relative link
I, [2015-04-24T11:38:16.989688 #9300]  INFO -- default-precise32:     +    if ( !symlink( File::Spec->abs2rel( $tgt, dirname($link) ), $link ) ) {
I, [2015-04-24T11:38:16.993727 #9300]  INFO -- default-precise32:     +        die("Could not create $link: $!\n");
I, [2015-04-24T11:38:16.996058 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:16.998343 #9300]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:38:17.000473 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:17.003366 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.006068 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.008361 #9300]  INFO -- default-precise32:     +sub check_link {
I, [2015-04-24T11:38:17.010992 #9300]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:38:17.018316 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.018364 #9300]  INFO -- default-precise32:     +    if ( !-e $link ) {
I, [2015-04-24T11:38:17.018387 #9300]  INFO -- default-precise32:     +        if ( -l $link ) {
I, [2015-04-24T11:38:17.018406 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.018425 #9300]  INFO -- default-precise32:     +            # points to nowhere
I, [2015-04-24T11:38:17.018444 #9300]  INFO -- default-precise32:     +            info("Removing dangling link $link");
I, [2015-04-24T11:38:17.018463 #9300]  INFO -- default-precise32:     +            unlink($link) or die "Could not remove $link\n";
I, [2015-04-24T11:38:17.018482 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.018501 #9300]  INFO -- default-precise32:     +        return 'missing';
I, [2015-04-24T11:38:17.018519 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.018537 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.018555 #9300]  INFO -- default-precise32:     +    if ( -e $link && !-l $link ) {
I, [2015-04-24T11:38:17.018573 #9300]  INFO -- default-precise32:     +        return "$link is a real file, not touching it";
I, [2015-04-24T11:38:17.018592 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.018610 #9300]  INFO -- default-precise32:     +    if ( realpath($link) ne realpath($tgt) ) {
I, [2015-04-24T11:38:17.018647 #9300]  INFO -- default-precise32:     +        return "$link exists but does not point to $tgt, not touching it";
I, [2015-04-24T11:38:17.018666 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.018684 #9300]  INFO -- default-precise32:     +    return 'ok';
I, [2015-04-24T11:38:17.018701 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.018719 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.018736 #9300]  INFO -- default-precise32:     +sub remove_link {
I, [2015-04-24T11:38:17.018754 #9300]  INFO -- default-precise32:     +    my ($link) = @_;
I, [2015-04-24T11:38:17.018772 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.018790 #9300]  INFO -- default-precise32:     +    if ( -l $link ) {
I, [2015-04-24T11:38:17.018808 #9300]  INFO -- default-precise32:     +        unlink($link) or die "Could not remove $link: $!\n";
I, [2015-04-24T11:38:17.018826 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.018844 #9300]  INFO -- default-precise32:     +    elsif ( -e $link ) {
I, [2015-04-24T11:38:17.018862 #9300]  INFO -- default-precise32:     +        error("$link is not a symbolic link, not deleting\n");
I, [2015-04-24T11:38:17.018880 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:17.018898 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.018915 #9300]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:38:17.018933 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:17.018950 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.018968 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.018985 #9300]  INFO -- default-precise32:     +sub threaded {
I, [2015-04-24T11:38:17.019021 #9300]  INFO -- default-precise32:     +    my $result = "";
I, [2015-04-24T11:38:17.019056 #9300]  INFO -- default-precise32:     +    $result = qx{/usr/sbin/apache2ctl -V | grep 'threaded'}
I, [2015-04-24T11:38:17.019095 #9300]  INFO -- default-precise32:     +        if -x '/usr/sbin/apache2ctl';
I, [2015-04-24T11:38:17.019115 #9300]  INFO -- default-precise32:     +    if ( $? != 0 ) {
I, [2015-04-24T11:38:17.019132 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.019150 #9300]  INFO -- default-precise32:     +        # config doesn't work
I, [2015-04-24T11:38:17.019169 #9300]  INFO -- default-precise32:     +        if ( -e "$enabldir/mpm_prefork.load" || -e "$enabldir/mpm_itk.load" )
I, [2015-04-24T11:38:17.019192 #9300]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:38:17.019212 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:17.019230 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.019248 #9300]  INFO -- default-precise32:     +        elsif (-e "$enabldir/mpm_worker.load"
I, [2015-04-24T11:38:17.019283 #9300]  INFO -- default-precise32:     +            || -e "$enabldir/mpm_event.load" )
I, [2015-04-24T11:38:17.019303 #9300]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:38:17.019326 #9300]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:38:17.019346 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.019363 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:17.019382 #9300]  INFO -- default-precise32:     +            error("Can't determine enabled MPM");
I, [2015-04-24T11:38:17.019400 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.019418 #9300]  INFO -- default-precise32:     +            # do what user requested
I, [2015-04-24T11:38:17.019436 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:17.019454 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.019471 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.019489 #9300]  INFO -- default-precise32:     +    if ( $result =~ / no/ ) {
I, [2015-04-24T11:38:17.019507 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:17.019524 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.019542 #9300]  INFO -- default-precise32:     +    elsif ( $result =~ / yes/ ) {
I, [2015-04-24T11:38:17.019560 #9300]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:38:17.019577 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.019595 #9300]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:38:17.019613 #9300]  INFO -- default-precise32:     +        die("Can't parse output from apache2ctl -V:\n$result\n");
I, [2015-04-24T11:38:17.019631 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.019648 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.019665 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.019683 #9300]  INFO -- default-precise32:     +sub info {
I, [2015-04-24T11:38:17.019700 #9300]  INFO -- default-precise32:     +    print @_ if !$quiet;
I, [2015-04-24T11:38:17.019718 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.019735 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.019752 #9300]  INFO -- default-precise32:     +sub error {
I, [2015-04-24T11:38:17.019770 #9300]  INFO -- default-precise32:     +    print STDERR 'ERROR: ', @_;
I, [2015-04-24T11:38:17.022564 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:17.026546 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.030090 #9300]  INFO -- default-precise32:     +sub warning {
I, [2015-04-24T11:38:17.038390 #9300]  INFO -- default-precise32:     +    print STDERR 'WARNING: ', @_;
I, [2015-04-24T11:38:17.041225 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.043731 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.043763 #9300]  INFO -- default-precise32:     +sub is_in {
I, [2015-04-24T11:38:17.046668 #9300]  INFO -- default-precise32:     +    my $needle = shift;
I, [2015-04-24T11:38:17.048959 #9300]  INFO -- default-precise32:     +    foreach my $e (@_) {
I, [2015-04-24T11:38:17.051873 #9300]  INFO -- default-precise32:     +        return 1 if $needle eq $e;
I, [2015-04-24T11:38:17.054176 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.056677 #9300]  INFO -- default-precise32:     +    return 0;
I, [2015-04-24T11:38:17.060206 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.064242 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.064285 #9300]  INFO -- default-precise32:     +sub read_env_file {
I, [2015-04-24T11:38:17.064308 #9300]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:38:17.064335 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.064356 #9300]  INFO -- default-precise32:     +    -r $file or return;
I, [2015-04-24T11:38:17.064375 #9300]  INFO -- default-precise32:     +    my @lines = qx{env - sh -c '. $file && env'};
I, [2015-04-24T11:38:17.064417 #9300]  INFO -- default-precise32:     +    if ($?) {
I, [2015-04-24T11:38:17.064449 #9300]  INFO -- default-precise32:     +        die "Could not read $file\n";
I, [2015-04-24T11:38:17.064480 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.064498 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.064516 #9300]  INFO -- default-precise32:     +    foreach my $l (@lines) {
I, [2015-04-24T11:38:17.064534 #9300]  INFO -- default-precise32:     +        chomp $l;
I, [2015-04-24T11:38:17.064553 #9300]  INFO -- default-precise32:     +        $l =~ /^(.*)?=(.*)$/ or die "Could not parse $file\n";
I, [2015-04-24T11:38:17.064572 #9300]  INFO -- default-precise32:     +        $ENV{$1} = $2;
I, [2015-04-24T11:38:17.064590 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.064607 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.064625 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.064642 #9300]  INFO -- default-precise32:     +sub switch_marker {
I, [2015-04-24T11:38:17.064661 #9300]  INFO -- default-precise32:     +    die('usage: switch_marker([module|site|conf], [enable|disable], $name)')
I, [2015-04-24T11:38:17.064679 #9300]  INFO -- default-precise32:     +        if @_ != 3;
I, [2015-04-24T11:38:17.064697 #9300]  INFO -- default-precise32:     +    my $which = shift;
I, [2015-04-24T11:38:17.064715 #9300]  INFO -- default-precise32:     +    my $what  = shift;
I, [2015-04-24T11:38:17.064733 #9300]  INFO -- default-precise32:     +    my $name  = shift;
I, [2015-04-24T11:38:17.064750 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.065991 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:17.068808 #9300]  INFO -- default-precise32:     +    $mode = "maint" if $maintmode;
I, [2015-04-24T11:38:17.070758 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.073051 #9300]  INFO -- default-precise32:     +    #print("switch_marker $which $what $name\n");
I, [2015-04-24T11:38:17.075601 #9300]  INFO -- default-precise32:     +    # TODO: get rid of the magic string(s)
I, [2015-04-24T11:38:17.077499 #9300]  INFO -- default-precise32:     +    my $state_marker_dir = "$statedir/$what" . "d" . "_by_$mode";
I, [2015-04-24T11:38:17.080807 #9300]  INFO -- default-precise32:     +    my $state_marker     = "$state_marker_dir/$name";
I, [2015-04-24T11:38:17.083517 #9300]  INFO -- default-precise32:     +    if ( !-d $state_marker_dir ) {
I, [2015-04-24T11:38:17.086125 #9300]  INFO -- default-precise32:     +        File::Path::mkpath("$state_marker_dir")
I, [2015-04-24T11:38:17.088727 #9300]  INFO -- default-precise32:     +            || error(
I, [2015-04-24T11:38:17.091077 #9300]  INFO -- default-precise32:     +            "Failed to create marker directory: '$state_marker_dir'\n");
I, [2015-04-24T11:38:17.094094 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.096072 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.098735 #9300]  INFO -- default-precise32:     +    # XXX: swap find with perl alternative
I, [2015-04-24T11:38:17.101141 #9300]  INFO -- default-precise32:     +    my @markers = qx{find "$statedir" -type f -a -name "$name"};
I, [2015-04-24T11:38:17.103303 #9300]  INFO -- default-precise32:     +    chomp(@markers);
I, [2015-04-24T11:38:17.105420 #9300]  INFO -- default-precise32:     +    foreach (@markers) {
I, [2015-04-24T11:38:17.107721 #9300]  INFO -- default-precise32:     +        unless ( unlink $_ ) {
I, [2015-04-24T11:38:17.110029 #9300]  INFO -- default-precise32:     +            error("Failed to remove old marker '$_'!\n") && return 0;
I, [2015-04-24T11:38:17.112579 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.115041 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.117561 #9300]  INFO -- default-precise32:     +    unless ($purge) {
I, [2015-04-24T11:38:17.119871 #9300]  INFO -- default-precise32:     +        qx{touch "$state_marker"};
I, [2015-04-24T11:38:17.122846 #9300]  INFO -- default-precise32:     +        if ( $? != 0 ) {
I, [2015-04-24T11:38:17.125214 #9300]  INFO -- default-precise32:     +            error("Failed to create marker '$state_marker'!\n") && return 0;
I, [2015-04-24T11:38:17.127821 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.130857 #9300]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:38:17.133174 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.136109 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.139188 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.145095 #9300]  INFO -- default-precise32: +# vim: syntax=perl sw=4 sts=4 sr et
I, [2015-04-24T11:38:17.148112 #9300]  INFO -- default-precise32:     - change mode from '' to '0700'
I, [2015-04-24T11:38:17.150947 #9300]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:38:17.154700 #9300]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:38:17.161161 #9300]  INFO -- default-precise32:   * link[/usr/sbin/a2dissite] action delete
I, [2015-04-24T11:38:17.164127 #9300]  INFO -- default-precise32:     - delete link at /usr/sbin/a2dissite
I, [2015-04-24T11:38:17.173815 #9300]  INFO -- default-precise32:   * template[/usr/sbin/a2dissite] action create
I, [2015-04-24T11:38:17.187857 #9300]  INFO -- default-precise32:     - create new file /usr/sbin/a2dissite
I, [2015-04-24T11:38:17.190043 #9300]  INFO -- default-precise32:     - update content in file /usr/sbin/a2dissite from none to ce53f4
I, [2015-04-24T11:38:17.194294 #9300]  INFO -- default-precise32:     --- /usr/sbin/a2dissite	2015-04-24 08:38:17.164729822 +0000
I, [2015-04-24T11:38:17.197267 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-igqflu	2015-04-24 08:38:17.164729822 +0000
I, [2015-04-24T11:38:17.199275 #9300]  INFO -- default-precise32:     @@ -1 +1,533 @@
I, [2015-04-24T11:38:17.201298 #9300]  INFO -- default-precise32:     +#!/usr/bin/perl -w
I, [2015-04-24T11:38:17.203288 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:17.205212 #9300]  INFO -- default-precise32:     +# a2enmod by Stefan Fritsch <sf@debian.org>
I, [2015-04-24T11:38:17.207883 #9300]  INFO -- default-precise32:     +# Licensed under Apache License 2.0
I, [2015-04-24T11:38:17.211054 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:17.213140 #9300]  INFO -- default-precise32:     +# The coding style is "perltidy -pbp"
I, [2015-04-24T11:38:17.260330 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.260410 #9300]  INFO -- default-precise32:     +use strict;
I, [2015-04-24T11:38:17.260443 #9300]  INFO -- default-precise32:     +use Cwd 'realpath';
I, [2015-04-24T11:38:17.260465 #9300]  INFO -- default-precise32:     +use File::Spec;
I, [2015-04-24T11:38:17.260485 #9300]  INFO -- default-precise32:     +use File::Basename;
I, [2015-04-24T11:38:17.260505 #9300]  INFO -- default-precise32:     +use File::Path;
I, [2015-04-24T11:38:17.260524 #9300]  INFO -- default-precise32:     +use Getopt::Long;
I, [2015-04-24T11:38:17.260543 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.260562 #9300]  INFO -- default-precise32:     +my $quiet;
I, [2015-04-24T11:38:17.260581 #9300]  INFO -- default-precise32:     +my $force;
I, [2015-04-24T11:38:17.260600 #9300]  INFO -- default-precise32:     +my $maintmode;
I, [2015-04-24T11:38:17.260619 #9300]  INFO -- default-precise32:     +my $purge;
I, [2015-04-24T11:38:17.260649 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.260706 #9300]  INFO -- default-precise32:     +Getopt::Long::Configure('bundling');
I, [2015-04-24T11:38:17.260725 #9300]  INFO -- default-precise32:     +GetOptions(
I, [2015-04-24T11:38:17.260744 #9300]  INFO -- default-precise32:     +    'quiet|q'     => \$quiet,
I, [2015-04-24T11:38:17.260762 #9300]  INFO -- default-precise32:     +    'force|f'     => \$force,
I, [2015-04-24T11:38:17.260781 #9300]  INFO -- default-precise32:     +    'maintmode|m' => \$maintmode,
I, [2015-04-24T11:38:17.260800 #9300]  INFO -- default-precise32:     +    'purge|p'     => \$purge
I, [2015-04-24T11:38:17.260818 #9300]  INFO -- default-precise32:     +) or exit 2;
I, [2015-04-24T11:38:17.260836 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.260854 #9300]  INFO -- default-precise32:     +my $basename = basename($0);
I, [2015-04-24T11:38:17.260872 #9300]  INFO -- default-precise32:     +$basename =~ /^a2(en|dis)(mod|site|conf)((?:-.+)?)$/
I, [2015-04-24T11:38:17.260892 #9300]  INFO -- default-precise32:     +    or die "$basename call name unknown\n";
I, [2015-04-24T11:38:17.260910 #9300]  INFO -- default-precise32:     +my $act        = $1;
I, [2015-04-24T11:38:17.260929 #9300]  INFO -- default-precise32:     +my $obj        = $2;
I, [2015-04-24T11:38:17.260947 #9300]  INFO -- default-precise32:     +my $dir_suffix = $3;
I, [2015-04-24T11:38:17.260965 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.260983 #9300]  INFO -- default-precise32:     +my $env_file = $ENV{APACHE_ENVVARS}
I, [2015-04-24T11:38:17.261026 #9300]  INFO -- default-precise32:     +    || (
I, [2015-04-24T11:38:17.261060 #9300]  INFO -- default-precise32:     +    $ENV{APACHE_CONFDIR}
I, [2015-04-24T11:38:17.261079 #9300]  INFO -- default-precise32:     +    ? "$ENV{APACHE_CONFDIR}/envvars"
I, [2015-04-24T11:38:17.261098 #9300]  INFO -- default-precise32:     +    : "/etc/apache2$dir_suffix/envvars"
I, [2015-04-24T11:38:17.261117 #9300]  INFO -- default-precise32:     +    );
I, [2015-04-24T11:38:17.261135 #9300]  INFO -- default-precise32:     +$ENV{LANG} = 'C';
I, [2015-04-24T11:38:17.261155 #9300]  INFO -- default-precise32:     +read_env_file($env_file);
I, [2015-04-24T11:38:17.261173 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.261192 #9300]  INFO -- default-precise32:     +$act .= 'able';
I, [2015-04-24T11:38:17.261210 #9300]  INFO -- default-precise32:     +my ( $name, $dir, $sffx, $reload );
I, [2015-04-24T11:38:17.261240 #9300]  INFO -- default-precise32:     +if ( $obj eq 'mod' ) {
I, [2015-04-24T11:38:17.261260 #9300]  INFO -- default-precise32:     +    $obj    = 'module';
I, [2015-04-24T11:38:17.261279 #9300]  INFO -- default-precise32:     +    $dir    = 'mods';
I, [2015-04-24T11:38:17.261298 #9300]  INFO -- default-precise32:     +    $sffx   = '.load';
I, [2015-04-24T11:38:17.261317 #9300]  INFO -- default-precise32:     +    $reload = 'restart';
I, [2015-04-24T11:38:17.261342 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.261362 #9300]  INFO -- default-precise32:     +elsif ( $obj eq 'conf' ) {
I, [2015-04-24T11:38:17.261381 #9300]  INFO -- default-precise32:     +    $obj    = 'conf';
I, [2015-04-24T11:38:17.261400 #9300]  INFO -- default-precise32:     +    $dir    = 'conf';
I, [2015-04-24T11:38:17.261419 #9300]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:38:17.261448 #9300]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:38:17.261468 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.261487 #9300]  INFO -- default-precise32:     +else {
I, [2015-04-24T11:38:17.261506 #9300]  INFO -- default-precise32:     +    $dir    = 'sites';
I, [2015-04-24T11:38:17.261525 #9300]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:38:17.261544 #9300]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:38:17.261562 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.261581 #9300]  INFO -- default-precise32:     +$name = ucfirst($obj);
I, [2015-04-24T11:38:17.261611 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.261632 #9300]  INFO -- default-precise32:     +my $confdir = $ENV{APACHE_CONFDIR} || "/etc/apache2$dir_suffix";
I, [2015-04-24T11:38:17.261652 #9300]  INFO -- default-precise32:     +my $availdir = $ENV{ uc("APACHE_${dir}_AVAILABLE") }
I, [2015-04-24T11:38:17.261672 #9300]  INFO -- default-precise32:     +    || "$confdir/$dir-available";
I, [2015-04-24T11:38:17.261691 #9300]  INFO -- default-precise32:     +my $enabldir = $ENV{ uc("APACHE_${dir}_ENABLED") } || "$confdir/$dir-enabled";
I, [2015-04-24T11:38:17.261711 #9300]  INFO -- default-precise32:     +my $statedir = $ENV{ uc("APACHE_STATE_DIRECTORY") } || "/usr/lib/apache2";
I, [2015-04-24T11:38:17.261730 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.261762 #9300]  INFO -- default-precise32:     +$statedir .= "/$obj";
I, [2015-04-24T11:38:17.261781 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.261800 #9300]  INFO -- default-precise32:     +my $choicedir = $act eq 'enable' ? $availdir : $enabldir;
I, [2015-04-24T11:38:17.261819 #9300]  INFO -- default-precise32:     +my $linkdir = File::Spec->abs2rel( $availdir, $enabldir );
I, [2015-04-24T11:38:17.261839 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.261858 #9300]  INFO -- default-precise32:     +my $request_reload = 0;
I, [2015-04-24T11:38:17.261889 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.261907 #9300]  INFO -- default-precise32:     +my $rc = 0;
I, [2015-04-24T11:38:17.261925 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.261944 #9300]  INFO -- default-precise32:     +if ( !scalar @ARGV ) {
I, [2015-04-24T11:38:17.261962 #9300]  INFO -- default-precise32:     +    my @choices = myglob('*');
I, [2015-04-24T11:38:17.261981 #9300]  INFO -- default-precise32:     +    print "Your choices are: @choices\n";
I, [2015-04-24T11:38:17.262024 #9300]  INFO -- default-precise32:     +    print "Which ${obj}(s) do you want to $act (wildcards ok)?\n";
I, [2015-04-24T11:38:17.262045 #9300]  INFO -- default-precise32:     +    my $input = <>;
I, [2015-04-24T11:38:17.262063 #9300]  INFO -- default-precise32:     +    @ARGV = split /\s+/, $input;
I, [2015-04-24T11:38:17.262081 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.262099 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.262132 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.262149 #9300]  INFO -- default-precise32:     +my @objs;
I, [2015-04-24T11:38:17.262167 #9300]  INFO -- default-precise32:     +foreach my $arg (@ARGV) {
I, [2015-04-24T11:38:17.262185 #9300]  INFO -- default-precise32:     +    $arg =~ s/${sffx}$//;
I, [2015-04-24T11:38:17.262212 #9300]  INFO -- default-precise32:     +    my @glob = myglob($arg);
I, [2015-04-24T11:38:17.262231 #9300]  INFO -- default-precise32:     +    if ( !@glob ) {
I, [2015-04-24T11:38:17.262250 #9300]  INFO -- default-precise32:     +        error("No $obj found matching $arg!\n");
I, [2015-04-24T11:38:17.262269 #9300]  INFO -- default-precise32:     +        $rc = 1;
I, [2015-04-24T11:38:17.262287 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.262305 #9300]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:38:17.262328 #9300]  INFO -- default-precise32:     +        push @objs, @glob;
I, [2015-04-24T11:38:17.262348 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.262365 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.262384 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.262402 #9300]  INFO -- default-precise32:     +foreach my $acton (@objs) {
I, [2015-04-24T11:38:17.262433 #9300]  INFO -- default-precise32:     +    doit($acton) or $rc = 1;
I, [2015-04-24T11:38:17.262452 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.262470 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.262488 #9300]  INFO -- default-precise32:     +info(
I, [2015-04-24T11:38:17.262511 #9300]  INFO -- default-precise32:     +    "To activate the new configuration, you need to run:\n  service apache2 $reload\n"
I, [2015-04-24T11:38:17.262531 #9300]  INFO -- default-precise32:     +) if $request_reload;
I, [2015-04-24T11:38:17.262563 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.262582 #9300]  INFO -- default-precise32:     +exit($rc);
I, [2015-04-24T11:38:17.262600 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.262618 #9300]  INFO -- default-precise32:     +##############################################################################
I, [2015-04-24T11:38:17.262637 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.262655 #9300]  INFO -- default-precise32:     +sub myglob {
I, [2015-04-24T11:38:17.262673 #9300]  INFO -- default-precise32:     +    my $arg = shift;
I, [2015-04-24T11:38:17.262703 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.262734 #9300]  INFO -- default-precise32:     +    my @glob = map {
I, [2015-04-24T11:38:17.262753 #9300]  INFO -- default-precise32:     +        s{^$choicedir/}{};
I, [2015-04-24T11:38:17.262772 #9300]  INFO -- default-precise32:     +        s{$sffx$}{};
I, [2015-04-24T11:38:17.262790 #9300]  INFO -- default-precise32:     +        $_
I, [2015-04-24T11:38:17.262808 #9300]  INFO -- default-precise32:     +    } glob("$choicedir/$arg$sffx");
I, [2015-04-24T11:38:17.262826 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.262844 #9300]  INFO -- default-precise32:     +    return @glob;
I, [2015-04-24T11:38:17.262863 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.262881 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.262899 #9300]  INFO -- default-precise32:     +sub doit {
I, [2015-04-24T11:38:17.262927 #9300]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:38:17.262946 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.262965 #9300]  INFO -- default-precise32:     +    my ( $conftgt, $conflink );
I, [2015-04-24T11:38:17.262983 #9300]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:38:17.263012 #9300]  INFO -- default-precise32:     +        if ( $acton eq 'cgi' && threaded() ) {
I, [2015-04-24T11:38:17.263034 #9300]  INFO -- default-precise32:     +            print
I, [2015-04-24T11:38:17.263054 #9300]  INFO -- default-precise32:     +                "Your MPM seems to be threaded. Selecting cgid instead of cgi.\n";
I, [2015-04-24T11:38:17.263074 #9300]  INFO -- default-precise32:     +            $acton = 'cgid';
I, [2015-04-24T11:38:17.263093 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.263111 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.263130 #9300]  INFO -- default-precise32:     +        $conftgt = "$availdir/$acton.conf";
I, [2015-04-24T11:38:17.263149 #9300]  INFO -- default-precise32:     +        if ( -e $conftgt ) {
I, [2015-04-24T11:38:17.263167 #9300]  INFO -- default-precise32:     +            $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:38:17.263200 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.263220 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.263238 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.263256 #9300]  INFO -- default-precise32:     +    my $tgt  = "$availdir/$acton$sffx";
I, [2015-04-24T11:38:17.263275 #9300]  INFO -- default-precise32:     +    my $link = "$enabldir/$acton$sffx";
I, [2015-04-24T11:38:17.263293 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.263311 #9300]  INFO -- default-precise32:     +    if ( !-e $tgt ) {
I, [2015-04-24T11:38:17.263337 #9300]  INFO -- default-precise32:     +        if ( -l $link && !-e $link ) {
I, [2015-04-24T11:38:17.263356 #9300]  INFO -- default-precise32:     +            if ( $act eq 'disable' ) {
I, [2015-04-24T11:38:17.263376 #9300]  INFO -- default-precise32:     +                info("removing dangling symlink $link\n");
I, [2015-04-24T11:38:17.263396 #9300]  INFO -- default-precise32:     +                unlink($link);
I, [2015-04-24T11:38:17.263418 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.266708 #9300]  INFO -- default-precise32:  .conf path. It may exist as dangling link, too
I, [2015-04-24T11:38:17.266739 #9300]  INFO -- default-precise32:     +                $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:38:17.266760 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.266779 #9300]  INFO -- default-precise32:     +                if ( -l $conflink && !-e $conflink ) {
I, [2015-04-24T11:38:17.266799 #9300]  INFO -- default-precise32:     +                    info("removing dangling symlink $conflink\n");
I, [2015-04-24T11:38:17.266819 #9300]  INFO -- default-precise32:     +                    unlink($conflink);
I, [2015-04-24T11:38:17.266837 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.266856 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.266874 #9300]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:38:17.266893 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.266923 #9300]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:38:17.266944 #9300]  INFO -- default-precise32:     +                error("$link is a dangling symlink!\n");
I, [2015-04-24T11:38:17.266963 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.266982 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.267036 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.267057 #9300]  INFO -- default-precise32:     +        if ( $purge ) {
I, [2015-04-24T11:38:17.267076 #9300]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:17.267096 #9300]  INFO -- default-precise32:     +            # exit silently, we are purging anyway
I, [2015-04-24T11:38:17.267115 #9300]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:38:17.267134 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.267151 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.267170 #9300]  INFO -- default-precise32:     +        error("$name $acton does not exist!\n");
I, [2015-04-24T11:38:17.267189 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:17.267207 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.267225 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.267243 #9300]  INFO -- default-precise32:     +    # handle module dependencies
I, [2015-04-24T11:38:17.267262 #9300]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:38:17.267281 #9300]  INFO -- default-precise32:     +        if ( $act eq 'enable' ) {
I, [2015-04-24T11:38:17.267300 #9300]  INFO -- default-precise32:     +            if ( $acton eq 'mpm_itk' ) {
I, [2015-04-24T11:38:17.267324 #9300]  INFO -- default-precise32:     +                warning(  "MPM_ITK is a third party module that is not part "
I, [2015-04-24T11:38:17.267346 #9300]  INFO -- default-precise32:     +                        . "of the official Apache HTTPD. It has seen less "
I, [2015-04-24T11:38:17.267381 #9300]  INFO -- default-precise32:     +                        . "testing than the official MPM modules." );
I, [2015-04-24T11:38:17.267400 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.267419 #9300]  INFO -- default-precise32:     +            my @depends = get_deps("$availdir/$acton.load");
I, [2015-04-24T11:38:17.268370 #9300]  INFO -- default-precise32:     +            do_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:38:17.268611 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.268839 #9300]  INFO -- default-precise32:     +            my @conflicts = get_deps( "$availdir/$acton.load", "Conflicts" );
I, [2015-04-24T11:38:17.269068 #9300]  INFO -- default-precise32:     +            check_conflicts( $acton, @conflicts ) or return 0;
I, [2015-04-24T11:38:17.269293 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.269522 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:17.269740 #9300]  INFO -- default-precise32:     +            my @depending;
I, [2015-04-24T11:38:17.269964 #9300]  INFO -- default-precise32:     +            foreach my $d ( glob("$enabldir/*.load") ) {
I, [2015-04-24T11:38:17.270207 #9300]  INFO -- default-precise32:     +                my @deps = get_deps($d);
I, [2015-04-24T11:38:17.270447 #9300]  INFO -- default-precise32:     +                if ( is_in( $acton, @deps ) ) {
I, [2015-04-24T11:38:17.270670 #9300]  INFO -- default-precise32:     +                    $d =~ m,/([^/]+).load$,;
I, [2015-04-24T11:38:17.270877 #9300]  INFO -- default-precise32:     +                    push @depending, $1;
I, [2015-04-24T11:38:17.271118 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.271240 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.271477 #9300]  INFO -- default-precise32:     +            if ( scalar @depending ) {
I, [2015-04-24T11:38:17.271710 #9300]  INFO -- default-precise32:     +                if ($force) {
I, [2015-04-24T11:38:17.271823 #9300]  INFO -- default-precise32:     +                    do_deps( $acton, @depending ) or return 0;
I, [2015-04-24T11:38:17.272062 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.272287 #9300]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:38:17.272516 #9300]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:38:17.272677 #9300]  INFO -- default-precise32:     +                        "The following modules depend on $acton ",
I, [2015-04-24T11:38:17.300274 #9300]  INFO -- default-precise32:     +                        "and need to be disabled first: @depending\n"
I, [2015-04-24T11:38:17.300546 #9300]  INFO -- default-precise32: +                    );
I, [2015-04-24T11:38:17.300802 #9300]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:38:17.301049 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.301272 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.301542 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.301756 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.301975 #9300]  INFO -- default-precise32:     +    elsif ( $act eq 'enable' ) {
I, [2015-04-24T11:38:17.302130 #9300]  INFO -- default-precise32:     +        my @depends = get_deps("$availdir/$acton$sffx");
I, [2015-04-24T11:38:17.302157 #9300]  INFO -- default-precise32:     +        warn_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:38:17.302178 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.302196 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.302215 #9300]  INFO -- default-precise32:     +    if ( $act eq 'enable' ) {
I, [2015-04-24T11:38:17.302234 #9300]  INFO -- default-precise32:     +        my $check = check_link( $tgt, $link );
I, [2015-04-24T11:38:17.302253 #9300]  INFO -- default-precise32:     +        if ( $check eq 'ok' ) {
I, [2015-04-24T11:38:17.302271 #9300]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:38:17.302290 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.302323 #9300]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:38:17.302345 #9300]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:38:17.302654 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:17.302829 #9300]  INFO -- default-precise32: +                    info("$name $acton already enabled\n");
I, [2015-04-24T11:38:17.303070 #9300]  INFO -- default-precise32:     +                    return 1;
I, [2015-04-24T11:38:17.303357 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.303391 #9300]  INFO -- default-precise32:     +                elsif ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:38:17.303413 #9300]  INFO -- default-precise32:     +                    print "Enabling config file $acton.conf.\n";
I, [2015-04-24T11:38:17.303433 #9300]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:38:17.303452 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.303471 #9300]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:38:17.303490 #9300]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:38:17.303510 #9300]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:38:17.303529 #9300]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:38:17.303548 #9300]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:38:17.303567 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.303586 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.303604 #9300]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:38:17.303623 #9300]  INFO -- default-precise32:     +                info("$name $acton already enabled\n");
I, [2015-04-24T11:38:17.303642 #9300]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:38:17.303660 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.303678 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.303713 #9300]  INFO -- default-precise32:     +        elsif ( $check eq 'missing' ) {
I, [2015-04-24T11:38:17.303733 #9300]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:38:17.303751 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.303770 #9300]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:38:17.303789 #9300]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:38:17.303809 #9300]  INFO -- default-precise32:     +                if ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:38:17.303828 #9300]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:38:17.303847 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.303866 #9300]  INFO -- default-precise32:     +                elsif ( $confcheck ne 'ok' ) {
I, [2015-04-24T11:38:17.303885 #9300]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:38:17.303904 #9300]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:38:17.303924 #9300]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:38:17.303943 #9300]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:38:17.303961 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.303980 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.303998 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.304042 #9300]  INFO -- default-precise32:     +            print "Enabling $obj $acton.\n";
I, [2015-04-24T11:38:17.304062 #9300]  INFO -- default-precise32:     +            if ( $acton eq 'ssl' ) {
I, [2015-04-24T11:38:17.304082 #9300]  INFO -- default-precise32:     +                info(     "See /usr/share/doc/apache2/README.Debian.gz on "
I, [2015-04-24T11:38:17.304101 #9300]  INFO -- default-precise32:     +                        . "how to configure SSL and create self-signed certificates.\n"
I, [2015-04-24T11:38:17.304121 #9300]  INFO -- default-precise32:     +                );
I, [2015-04-24T11:38:17.304155 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.304179 #9300]  INFO -- default-precise32:     +            return add_link( $tgt, $link )
I, [2015-04-24T11:38:17.304198 #9300]  INFO -- default-precise32:     +                && switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:17.304218 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.304237 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:17.304256 #9300]  INFO -- default-precise32:     +            error("$name $acton not properly enabled: $check\n");
I, [2015-04-24T11:38:17.304275 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:17.304295 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.304313 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.304338 #9300]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:38:17.304357 #9300]  INFO -- default-precise32:     +        if ( -e $link || -l $link ) {
I, [2015-04-24T11:38:17.304376 #9300]  INFO -- default-precise32:     +            remove_link($link);
I, [2015-04-24T11:38:17.304395 #9300]  INFO -- default-precise32:     +            if ( $conflink && -e $conflink ) {
I, [2015-04-24T11:38:17.304414 #9300]  INFO -- default-precise32:     +                remove_link($conflink);
I, [2015-04-24T11:38:17.304433 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.304452 #9300]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:17.304471 #9300]  INFO -- default-precise32:     +            print "$name $acton disabled.\n";
I, [2015-04-24T11:38:17.304489 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.304508 #9300]  INFO -- default-precise32:     +        elsif ( $conflink && -e $conflink ) {
I, [2015-04-24T11:38:17.304536 #9300]  INFO -- default-precise32:     +            print "Disabling stale config file $acton.conf.\n";
I, [2015-04-24T11:38:17.304571 #9300]  INFO -- default-precise32:     +            remove_link($conflink);
I, [2015-04-24T11:38:17.304590 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.304609 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:17.304628 #9300]  INFO -- default-precise32:     +            info("$name $acton already disabled\n");
I, [2015-04-24T11:38:17.304647 #9300]  INFO -- default-precise32:     +            if ( $purge ) {
I, [2015-04-24T11:38:17.304666 #9300]  INFO -- default-precise32:     +                switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:17.304684 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.304703 #9300]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:38:17.304721 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.304740 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.304758 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.304776 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:17.304794 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.304812 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.304831 #9300]  INFO -- default-precise32:     +sub get_deps {
I, [2015-04-24T11:38:17.304849 #9300]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:38:17.304868 #9300]  INFO -- default-precise32:     +    my $type = shift || "Depends";
I, [2015-04-24T11:38:17.304885 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.304916 #9300]  INFO -- default-precise32:     +    my $fd;
I, [2015-04-24T11:38:17.304935 #9300]  INFO -- default-precise32:     +    if ( !open( $fd, '<', $file ) ) {
I, [2015-04-24T11:38:17.304954 #9300]  INFO -- default-precise32:     +        error("Can't open $file: $!");
I, [2015-04-24T11:38:17.304972 #9300]  INFO -- default-precise32:     +        return;
I, [2015-04-24T11:38:17.304991 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.305020 #9300]  INFO -- default-precise32:     +    my $line;
I, [2015-04-24T11:38:17.305043 #9300]  INFO -- default-precise32:     +    while ( defined( $line = <$fd> ) ) {
I, [2015-04-24T11:38:17.305063 #9300]  INFO -- default-precise32:     +        chomp $line;
I, [2015-04-24T11:38:17.305082 #9300]  INFO -- default-precise32:     +        if ( $line =~ /^# $type:\s+(.*?)\s*$/ ) {
I, [2015-04-24T11:38:17.305101 #9300]  INFO -- default-precise32:     +            my $deps = $1;
I, [2015-04-24T11:38:17.305120 #9300]  INFO -- default-precise32:     +            return split( /[\n\s]+/, $deps );
I, [2015-04-24T11:38:17.305151 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.305170 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.305189 #9300]  INFO -- default-precise32:     +        # only check until the first non-empty non-comment line
I, [2015-04-24T11:38:17.305208 #9300]  INFO -- default-precise32:     +        last if ( $line !~ /^\s*(?:#.*)?$/ );
I, [2015-04-24T11:38:17.305238 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.305256 #9300]  INFO -- default-precise32:     +    return;
I, [2015-04-24T11:38:17.305273 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.305291 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.305309 #9300]  INFO -- default-precise32:     +sub do_deps {
I, [2015-04-24T11:38:17.305332 #9300]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:38:17.305351 #9300]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:38:17.305369 #9300]  INFO -- default-precise32:     +        info("Considering dependency $d for $acton:\n");
I, [2015-04-24T11:38:17.305388 #9300]  INFO -- default-precise32:     +        if ( !doit($d) ) {
I, [2015-04-24T11:38:17.305406 #9300]  INFO -- default-precise32:     +            error("Could not $act dependency $d for $acton, aborting\n");
I, [2015-04-24T11:38:17.305425 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:17.305442 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.305460 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.305495 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:17.305514 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.305532 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.305549 #9300]  INFO -- default-precise32:     +sub warn_deps {
I, [2015-04-24T11:38:17.305568 #9300]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:38:17.305586 #9300]  INFO -- default-precise32:     +    my $modsenabldir = $ENV{APACHE_MODS_ENABLED} || "$confdir/mods-enabled";
I, [2015-04-24T11:38:17.305617 #9300]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:38:17.305648 #9300]  INFO -- default-precise32:     +        info("Checking dependency $d for $acton:\n");
I, [2015-04-24T11:38:17.305667 #9300]  INFO -- default-precise32:     +        if ( !-e "$modsenabldir/$d.load" ) {
I, [2015-04-24T11:38:17.305685 #9300]  INFO -- default-precise32:     +            warning(
I, [2015-04-24T11:38:17.305704 #9300]  INFO -- default-precise32:     +                "Module $d is not enabled, but $acton depends on it, aborting\n"
I, [2015-04-24T11:38:17.308174 #9300]  INFO -- default-precise32:  +            );
I, [2015-04-24T11:38:17.308203 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:17.308224 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.308242 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.308278 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:17.308297 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.308315 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.308341 #9300]  INFO -- default-precise32:     +sub check_conflicts {
I, [2015-04-24T11:38:17.308359 #9300]  INFO -- default-precise32:     +    my $acton    = shift;
I, [2015-04-24T11:38:17.308382 #9300]  INFO -- default-precise32:     +    my $haderror = 0;
I, [2015-04-24T11:38:17.308401 #9300]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:38:17.308420 #9300]  INFO -- default-precise32:     +        info("Considering conflict $d for $acton:\n");
I, [2015-04-24T11:38:17.308438 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.308457 #9300]  INFO -- default-precise32:     +        my $tgt  = "$availdir/$d$sffx";
I, [2015-04-24T11:38:17.308475 #9300]  INFO -- default-precise32:     +        my $link = "$enabldir/$d$sffx";
I, [2015-04-24T11:38:17.308493 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.308511 #9300]  INFO -- default-precise32:     +        my $confcheck = check_link( $tgt, $link );
I, [2015-04-24T11:38:17.308530 #9300]  INFO -- default-precise32:     +        if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:38:17.308548 #9300]  INFO -- default-precise32:     +            error(
I, [2015-04-24T11:38:17.308567 #9300]  INFO -- default-precise32:     +                "Module $d is enabled - cannot proceed due to conflicts. It needs to be disabled first!\n"
I, [2015-04-24T11:38:17.308585 #9300]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:38:17.308603 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.308622 #9300]  INFO -- default-precise32:     +            # Don't return immediately, there could be several conflicts
I, [2015-04-24T11:38:17.308640 #9300]  INFO -- default-precise32:     +            $haderror++;
I, [2015-04-24T11:38:17.308659 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.308677 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.308694 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.308722 #9300]  INFO -- default-precise32:     +    if ($haderror) {
I, [2015-04-24T11:38:17.308741 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:17.308759 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.308777 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.308794 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:17.308812 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.308829 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.308847 #9300]  INFO -- default-precise32:     +sub add_link {
I, [2015-04-24T11:38:17.308865 #9300]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:38:17.308883 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.308901 #9300]  INFO -- default-precise32:     +    # create relative link
I, [2015-04-24T11:38:17.308919 #9300]  INFO -- default-precise32:     +    if ( !symlink( File::Spec->abs2rel( $tgt, dirname($link) ), $link ) ) {
I, [2015-04-24T11:38:17.308956 #9300]  INFO -- default-precise32:     +        die("Could not create $link: $!\n");
I, [2015-04-24T11:38:17.308975 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.308993 #9300]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:38:17.309028 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:17.309047 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.309065 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.309083 #9300]  INFO -- default-precise32:     +sub check_link {
I, [2015-04-24T11:38:17.309101 #9300]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:38:17.309119 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.309137 #9300]  INFO -- default-precise32:     +    if ( !-e $link ) {
I, [2015-04-24T11:38:17.309155 #9300]  INFO -- default-precise32:     +        if ( -l $link ) {
I, [2015-04-24T11:38:17.309173 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.309191 #9300]  INFO -- default-precise32:     +            # points to nowhere
I, [2015-04-24T11:38:17.309210 #9300]  INFO -- default-precise32:     +            info("Removing dangling link $link");
I, [2015-04-24T11:38:17.309253 #9300]  INFO -- default-precise32:     +            unlink($link) or die "Could not remove $link\n";
I, [2015-04-24T11:38:17.309273 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.309292 #9300]  INFO -- default-precise32:     +        return 'missing';
I, [2015-04-24T11:38:17.309309 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.309342 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.309364 #9300]  INFO -- default-precise32:     +    if ( -e $link && !-l $link ) {
I, [2015-04-24T11:38:17.309383 #9300]  INFO -- default-precise32:     +        return "$link is a real file, not touching it";
I, [2015-04-24T11:38:17.309401 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.309419 #9300]  INFO -- default-precise32:     +    if ( realpath($link) ne realpath($tgt) ) {
I, [2015-04-24T11:38:17.309437 #9300]  INFO -- default-precise32:     +        return "$link exists but does not point to $tgt, not touching it";
I, [2015-04-24T11:38:17.309470 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.309489 #9300]  INFO -- default-precise32:     +    return 'ok';
I, [2015-04-24T11:38:17.309507 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.309524 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.309542 #9300]  INFO -- default-precise32:     +sub remove_link {
I, [2015-04-24T11:38:17.309559 #9300]  INFO -- default-precise32:     +    my ($link) = @_;
I, [2015-04-24T11:38:17.309577 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.309594 #9300]  INFO -- default-precise32:     +    if ( -l $link ) {
I, [2015-04-24T11:38:17.309613 #9300]  INFO -- default-precise32:     +        unlink($link) or die "Could not remove $link: $!\n";
I, [2015-04-24T11:38:17.309631 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.309649 #9300]  INFO -- default-precise32:     +    elsif ( -e $link ) {
I, [2015-04-24T11:38:17.309679 #9300]  INFO -- default-precise32:     +        error("$link is not a symbolic link, not deleting\n");
I, [2015-04-24T11:38:17.309697 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:17.309727 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.309745 #9300]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:38:17.311483 #9300]  INFO -- default-precise32: +    return 1;
I, [2015-04-24T11:38:17.341426 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.341676 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.341894 #9300]  INFO -- default-precise32:     +sub threaded {
I, [2015-04-24T11:38:17.342108 #9300]  INFO -- default-precise32:     +    my $result = "";
I, [2015-04-24T11:38:17.342362 #9300]  INFO -- default-precise32:     +    $result = qx{/usr/sbin/apache2ctl -V | grep 'threaded'}
I, [2015-04-24T11:38:17.342618 #9300]  INFO -- default-precise32:     +        if -x '/usr/sbin/apache2ctl';
I, [2015-04-24T11:38:17.342831 #9300]  INFO -- default-precise32:     +    if ( $? != 0 ) {
I, [2015-04-24T11:38:17.343083 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.343436 #9300]  INFO -- default-precise32:     +        # config doesn't work
I, [2015-04-24T11:38:17.343698 #9300]  INFO -- default-precise32:     +        if ( -e "$enabldir/mpm_prefork.load" || -e "$enabldir/mpm_itk.load" )
I, [2015-04-24T11:38:17.343724 #9300]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:38:17.343744 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:17.343763 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.343781 #9300]  INFO -- default-precise32:     +        elsif (-e "$enabldir/mpm_worker.load"
I, [2015-04-24T11:38:17.343800 #9300]  INFO -- default-precise32:     +            || -e "$enabldir/mpm_event.load" )
I, [2015-04-24T11:38:17.343819 #9300]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:38:17.343837 #9300]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:38:17.343865 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.343885 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:17.343903 #9300]  INFO -- default-precise32:     +            error("Can't determine enabled MPM");
I, [2015-04-24T11:38:17.344217 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:17.344513 #9300]  INFO -- default-precise32:     +            # do what user requested
I, [2015-04-24T11:38:17.344702 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:17.344851 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.344875 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.345075 #9300]  INFO -- default-precise32:     +    if ( $result =~ / no/ ) {
I, [2015-04-24T11:38:17.345240 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:17.345416 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:17.345607 #9300]  INFO -- default-precise32: +    elsif ( $result =~ / yes/ ) {
I, [2015-04-24T11:38:17.346763 #9300]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:38:17.346791 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.346811 #9300]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:38:17.346830 #9300]  INFO -- default-precise32:     +        die("Can't parse output from apache2ctl -V:\n$result\n");
I, [2015-04-24T11:38:17.349965 #9300]  INFO -- default-precise32: +    }
I, [2015-04-24T11:38:17.350867 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.353043 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.355328 #9300]  INFO -- default-precise32:     +sub info {
I, [2015-04-24T11:38:17.357475 #9300]  INFO -- default-precise32:     +    print @_ if !$quiet;
I, [2015-04-24T11:38:17.360071 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.362348 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.365116 #9300]  INFO -- default-precise32:     +sub error {
I, [2015-04-24T11:38:17.367725 #9300]  INFO -- default-precise32:     +    print STDERR 'ERROR: ', @_;
I, [2015-04-24T11:38:17.371186 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.372642 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.375114 #9300]  INFO -- default-precise32:     +sub warning {
I, [2015-04-24T11:38:17.377815 #9300]  INFO -- default-precise32:     +    print STDERR 'WARNING: ', @_;
I, [2015-04-24T11:38:17.382184 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.384369 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.386918 #9300]  INFO -- default-precise32:     +sub is_in {
I, [2015-04-24T11:38:17.389704 #9300]  INFO -- default-precise32:     +    my $needle = shift;
I, [2015-04-24T11:38:17.392025 #9300]  INFO -- default-precise32:     +    foreach my $e (@_) {
I, [2015-04-24T11:38:17.395316 #9300]  INFO -- default-precise32:     +        return 1 if $needle eq $e;
I, [2015-04-24T11:38:17.397848 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.400096 #9300]  INFO -- default-precise32:     +    return 0;
I, [2015-04-24T11:38:17.402339 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.404774 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.407188 #9300]  INFO -- default-precise32:     +sub read_env_file {
I, [2015-04-24T11:38:17.410178 #9300]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:38:17.412028 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.414271 #9300]  INFO -- default-precise32:     +    -r $file or return;
I, [2015-04-24T11:38:17.416524 #9300]  INFO -- default-precise32:     +    my @lines = qx{env - sh -c '. $file && env'};
I, [2015-04-24T11:38:17.419187 #9300]  INFO -- default-precise32:     +    if ($?) {
I, [2015-04-24T11:38:17.421867 #9300]  INFO -- default-precise32:     +        die "Could not read $file\n";
I, [2015-04-24T11:38:17.424193 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.426693 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.429018 #9300]  INFO -- default-precise32:     +    foreach my $l (@lines) {
I, [2015-04-24T11:38:17.431210 #9300]  INFO -- default-precise32:     +        chomp $l;
I, [2015-04-24T11:38:17.433903 #9300]  INFO -- default-precise32:     +        $l =~ /^(.*)?=(.*)$/ or die "Could not parse $file\n";
I, [2015-04-24T11:38:17.436071 #9300]  INFO -- default-precise32:     +        $ENV{$1} = $2;
I, [2015-04-24T11:38:17.438414 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.440853 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.443303 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.445815 #9300]  INFO -- default-precise32:     +sub switch_marker {
I, [2015-04-24T11:38:17.448740 #9300]  INFO -- default-precise32:     +    die('usage: switch_marker([module|site|conf], [enable|disable], $name)')
I, [2015-04-24T11:38:17.451196 #9300]  INFO -- default-precise32:     +        if @_ != 3;
I, [2015-04-24T11:38:17.454112 #9300]  INFO -- default-precise32:     +    my $which = shift;
I, [2015-04-24T11:38:17.456200 #9300]  INFO -- default-precise32:     +    my $what  = shift;
I, [2015-04-24T11:38:17.459204 #9300]  INFO -- default-precise32:     +    my $name  = shift;
I, [2015-04-24T11:38:17.460826 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.463239 #9300]  INFO -- default-precise32:     +    my $mode = "admin";
I, [2015-04-24T11:38:17.465838 #9300]  INFO -- default-precise32:     +    $mode = "maint" if $maintmode;
I, [2015-04-24T11:38:17.467802 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.470359 #9300]  INFO -- default-precise32:     +    #print("switch_marker $which $what $name\n");
I, [2015-04-24T11:38:17.472680 #9300]  INFO -- default-precise32:     +    # TODO: get rid of the magic string(s)
I, [2015-04-24T11:38:17.475071 #9300]  INFO -- default-precise32:     +    my $state_marker_dir = "$statedir/$what" . "d" . "_by_$mode";
I, [2015-04-24T11:38:17.477062 #9300]  INFO -- default-precise32:     +    my $state_marker     = "$state_marker_dir/$name";
I, [2015-04-24T11:38:17.479953 #9300]  INFO -- default-precise32:     +    if ( !-d $state_marker_dir ) {
I, [2015-04-24T11:38:17.482359 #9300]  INFO -- default-precise32:     +        File::Path::mkpath("$state_marker_dir")
I, [2015-04-24T11:38:17.485057 #9300]  INFO -- default-precise32:     +            || error(
I, [2015-04-24T11:38:17.487678 #9300]  INFO -- default-precise32:     +            "Failed to create marker directory: '$state_marker_dir'\n");
I, [2015-04-24T11:38:17.490170 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.492259 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.494848 #9300]  INFO -- default-precise32:     +    # XXX: swap find with perl alternative
I, [2015-04-24T11:38:17.497462 #9300]  INFO -- default-precise32:     +    my @markers = qx{find "$statedir" -type f -a -name "$name"};
I, [2015-04-24T11:38:17.500067 #9300]  INFO -- default-precise32:     +    chomp(@markers);
I, [2015-04-24T11:38:17.502847 #9300]  INFO -- default-precise32:     +    foreach (@markers) {
I, [2015-04-24T11:38:17.505039 #9300]  INFO -- default-precise32:     +        unless ( unlink $_ ) {
I, [2015-04-24T11:38:17.507225 #9300]  INFO -- default-precise32:     +            error("Failed to remove old marker '$_'!\n") && return 0;
I, [2015-04-24T11:38:17.509813 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.511911 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.514772 #9300]  INFO -- default-precise32:     +    unless ($purge) {
I, [2015-04-24T11:38:17.517026 #9300]  INFO -- default-precise32:     +        qx{touch "$state_marker"};
I, [2015-04-24T11:38:17.519714 #9300]  INFO -- default-precise32:     +        if ( $? != 0 ) {
I, [2015-04-24T11:38:17.522347 #9300]  INFO -- default-precise32:     +            error("Failed to create marker '$state_marker'!\n") && return 0;
I, [2015-04-24T11:38:17.525126 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.527573 #9300]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:38:17.530092 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.532198 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.534857 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.544198 #9300]  INFO -- default-precise32:     +# vim: syntax=perl sw=4 sts=4 sr et
I, [2015-04-24T11:38:17.546655 #9300]  INFO -- default-precise32:     - change mode from '' to '0700'
I, [2015-04-24T11:38:17.549084 #9300]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:38:17.553198 #9300]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:38:17.556344 #9300]  INFO -- default-precise32:   * link[/usr/sbin/a2enmod] action delete (skipped due to only_if)
I, [2015-04-24T11:38:17.591383 #9300]  INFO -- default-precise32:   * template[/usr/sbin/a2enmod] action create
I, [2015-04-24T11:38:17.594247 #9300]  INFO -- default-precise32:     - update content in file /usr/sbin/a2enmod from 549dfe to ce53f4
I, [2015-04-24T11:38:17.598199 #9300]  INFO -- default-precise32:     --- /usr/sbin/a2enmod	2012-02-07 04:16:57.000000000 +0000
I, [2015-04-24T11:38:17.601311 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-1lc8emr	2015-04-24 08:38:17.556724892 +0000
I, [2015-04-24T11:38:17.604175 #9300]  INFO -- default-precise32:     @@ -2,23 +2,31 @@
I, [2015-04-24T11:38:17.607168 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:17.607201 #9300]  INFO -- default-precise32:      # a2enmod by Stefan Fritsch <sf@debian.org>
I, [2015-04-24T11:38:17.607431 #9300]  INFO -- default-precise32:  # Licensed under Apache License 2.0
I, [2015-04-24T11:38:17.610289 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:17.612221 #9300]  INFO -- default-precise32:     +# The coding style is "perltidy -pbp"
I, [2015-04-24T11:38:17.613233 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:17.615184 #9300]  INFO -- default-precise32:      use strict;
I, [2015-04-24T11:38:17.617208 #9300]  INFO -- default-precise32:      use Cwd 'realpath';
I, [2015-04-24T11:38:17.620990 #9300]  INFO -- default-precise32:      use File::Spec;
I, [2015-04-24T11:38:17.621039 #9300]  INFO -- default-precise32:      use File::Basename;
I, [2015-04-24T11:38:17.621062 #9300]  INFO -- default-precise32:     +use File::Path;
I, [2015-04-24T11:38:17.621102 #9300]  INFO -- default-precise32:      use Getopt::Long;
I, [2015-04-24T11:38:17.623177 #9300]  INFO -- default-precise32:  
I, [2015-04-24T11:38:17.625056 #9300]  INFO -- default-precise32:      my $quiet;
I, [2015-04-24T11:38:17.627168 #9300]  INFO -- default-precise32:      my $force;
I, [2015-04-24T11:38:17.629347 #9300]  INFO -- default-precise32:     +my $maintmode;
I, [2015-04-24T11:38:17.632186 #9300]  INFO -- default-precise32:     +my $purge;
I, [2015-04-24T11:38:17.633948 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.636193 #9300]  INFO -- default-precise32:      Getopt::Long::Configure('bundling');
I, [2015-04-24T11:38:17.638388 #9300]  INFO -- default-precise32:      GetOptions(
I, [2015-04-24T11:38:17.641103 #9300]  INFO -- default-precise32:     -    'quiet|q' => \$quiet,
I, [2015-04-24T11:38:17.644158 #9300]  INFO -- default-precise32:     -    'force|f' => \$force
I, [2015-04-24T11:38:17.646269 #9300]  INFO -- default-precise32:     +    'quiet|q'     => \$quiet,
I, [2015-04-24T11:38:17.694292 #9300]  INFO -- default-precise32:     +    'force|f'     => \$force,
I, [2015-04-24T11:38:17.694366 #9300]  INFO -- default-precise32:     +    'maintmode|m' => \$maintmode,
I, [2015-04-24T11:38:17.694390 #9300]  INFO -- default-precise32:     +    'purge|p'     => \$purge
I, [2015-04-24T11:38:17.694411 #9300]  INFO -- default-precise32:      ) or exit 2;
I, [2015-04-24T11:38:17.694455 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.694475 #9300]  INFO -- default-precise32:      my $basename = basename($0);
I, [2015-04-24T11:38:17.694502 #9300]  INFO -- default-precise32:     -$basename =~ /^a2(en|dis)(mod|site)((?:-.+)?)$/
I, [2015-04-24T11:38:17.694523 #9300]  INFO -- default-precise32:     +$basename =~ /^a2(en|dis)(mod|site|conf)((?:-.+)?)$/
I, [2015-04-24T11:38:17.694578 #9300]  INFO -- default-precise32:   or die "$basename call name unknown\n";
I, [2015-04-24T11:38:17.694601 #9300]  INFO -- default-precise32:      my $act        = $1;
I, [2015-04-24T11:38:17.694621 #9300]  INFO -- default-precise32:      my $obj        = $2;
I, [2015-04-24T11:38:17.694639 #9300]  INFO -- default-precise32:     @@ -30,7 +38,7 @@
I, [2015-04-24T11:38:17.694663 #9300]  INFO -- default-precise32:   ? "$ENV{APACHE_CONFDIR}/envvars"
I, [2015-04-24T11:38:17.694686 #9300]  INFO -- default-precise32:   : "/etc/apache2$dir_suffix/envvars"
I, [2015-04-24T11:38:17.694709 #9300]  INFO -- default-precise32:   );
I, [2015-04-24T11:38:17.694728 #9300]  INFO -- default-precise32:     -$ENV{LANG}='C';
I, [2015-04-24T11:38:17.694746 #9300]  INFO -- default-precise32:     +$ENV{LANG} = 'C';
I, [2015-04-24T11:38:17.694764 #9300]  INFO -- default-precise32:      read_env_file($env_file);
I, [2015-04-24T11:38:17.694781 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.694813 #9300]  INFO -- default-precise32:      $act .= 'able';
I, [2015-04-24T11:38:17.694831 #9300]  INFO -- default-precise32:     @@ -41,17 +49,27 @@
I, [2015-04-24T11:38:17.694854 #9300]  INFO -- default-precise32:   $sffx   = '.load';
I, [2015-04-24T11:38:17.694877 #9300]  INFO -- default-precise32:   $reload = 'restart';
I, [2015-04-24T11:38:17.694895 #9300]  INFO -- default-precise32:      }
I, [2015-04-24T11:38:17.694913 #9300]  INFO -- default-precise32:     +elsif ( $obj eq 'conf' ) {
I, [2015-04-24T11:38:17.694931 #9300]  INFO -- default-precise32:     +    $obj    = 'conf';
I, [2015-04-24T11:38:17.694949 #9300]  INFO -- default-precise32:     +    $dir    = 'conf';
I, [2015-04-24T11:38:17.694967 #9300]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:38:17.694985 #9300]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:38:17.695020 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.695043 #9300]  INFO -- default-precise32:      else {
I, [2015-04-24T11:38:17.695066 #9300]  INFO -- default-precise32:   $dir    = 'sites';
I, [2015-04-24T11:38:17.695085 #9300]  INFO -- default-precise32:     -    $sffx   = '';
I, [2015-04-24T11:38:17.695103 #9300]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:38:17.695144 #9300]  INFO -- default-precise32:   $reload = 'reload';
I, [2015-04-24T11:38:17.695164 #9300]  INFO -- default-precise32:      }
I, [2015-04-24T11:38:17.695182 #9300]  INFO -- default-precise32:      $name = ucfirst($obj);
I, [2015-04-24T11:38:17.695200 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.695219 #9300]  INFO -- default-precise32:     -my $confdir  = $ENV{APACHE_CONFDIR}                  || "/etc/apache2$dir_suffix";
I, [2015-04-24T11:38:17.695238 #9300]  INFO -- default-precise32:     -my $availdir = $ENV{ uc("APACHE_${dir}_AVAILABLE") } || "$confdir/$dir-available";
I, [2015-04-24T11:38:17.695256 #9300]  INFO -- default-precise32:     -my $enabldir = $ENV{ uc("APACHE_${dir}_ENABLED") }   || "$confdir/$dir-enabled";
I, [2015-04-24T11:38:17.695275 #9300]  INFO -- default-precise32:     +my $confdir = $ENV{APACHE_CONFDIR} || "/etc/apache2$dir_suffix";
I, [2015-04-24T11:38:17.695293 #9300]  INFO -- default-precise32:     +my $availdir = $ENV{ uc("APACHE_${dir}_AVAILABLE") }
I, [2015-04-24T11:38:17.695312 #9300]  INFO -- default-precise32:     +    || "$confdir/$dir-available";
I, [2015-04-24T11:38:17.695337 #9300]  INFO -- default-precise32:     +my $enabldir = $ENV{ uc("APACHE_${dir}_ENABLED") } || "$confdir/$dir-enabled";
I, [2015-04-24T11:38:17.695356 #9300]  INFO -- default-precise32:     +my $statedir = $ENV{ uc("APACHE_STATE_DIRECTORY") } || "/usr/lib/apache2";
I, [2015-04-24T11:38:17.695374 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.695396 #9300]  INFO -- default-precise32:     +$statedir .= "/$obj";
I, [2015-04-24T11:38:17.695415 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.695432 #9300]  INFO -- default-precise32:      my $choicedir = $act eq 'enable' ? $availdir : $enabldir;
I, [2015-04-24T11:38:17.695451 #9300]  INFO -- default-precise32:      my $linkdir = File::Spec->abs2rel( $availdir, $enabldir );
I, [2015-04-24T11:38:17.695469 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.695486 #9300]  INFO -- default-precise32:     @@ -70,6 +88,7 @@
I, [2015-04-24T11:38:17.695504 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.695521 #9300]  INFO -- default-precise32:      my @objs;
I, [2015-04-24T11:38:17.695539 #9300]  INFO -- default-precise32:      foreach my $arg (@ARGV) {
I, [2015-04-24T11:38:17.695557 #9300]  INFO -- default-precise32:     +    $arg =~ s/${sffx}$//;
I, [2015-04-24T11:38:17.695579 #9300]  INFO -- default-precise32:   my @glob = myglob($arg);
I, [2015-04-24T11:38:17.695602 #9300]  INFO -- default-precise32:   if ( !@glob ) {
I, [2015-04-24T11:38:17.695626 #9300]  INFO -- default-precise32:       error("No $obj found matching $arg!\n");
I, [2015-04-24T11:38:17.695645 #9300]  INFO -- default-precise32:     @@ -84,8 +103,9 @@
I, [2015-04-24T11:38:17.695666 #9300]  INFO -- default-precise32:   doit($acton) or $rc = 1;
I, [2015-04-24T11:38:17.695684 #9300]  INFO -- default-precise32:      }
I, [2015-04-24T11:38:17.695702 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.695719 #9300]  INFO -- default-precise32:     -info("To activate the new configuration, you need to run:\n  service apache2 $reload\n")
I, [2015-04-24T11:38:17.695737 #9300]  INFO -- default-precise32:     -    if $request_reload;
I, [2015-04-24T11:38:17.695774 #9300]  INFO -- default-precise32:     +info(
I, [2015-04-24T11:38:17.695793 #9300]  INFO -- default-precise32:     +    "To activate the new configuration, you need to run:\n  service apache2 $reload\n"
I, [2015-04-24T11:38:17.695811 #9300]  INFO -- default-precise32:     +) if $request_reload;
I, [2015-04-24T11:38:17.695829 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.695846 #9300]  INFO -- default-precise32:      exit($rc);
I, [2015-04-24T11:38:17.695864 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.695881 #9300]  INFO -- default-precise32:     @@ -97,29 +117,20 @@
I, [2015-04-24T11:38:17.695904 #9300]  INFO -- default-precise32:   my @glob = map {
I, [2015-04-24T11:38:17.695926 #9300]  INFO -- default-precise32:       s{^$choicedir/}{};
I, [2015-04-24T11:38:17.695948 #9300]  INFO -- default-precise32:       s{$sffx$}{};
I, [2015-04-24T11:38:17.695967 #9300]  INFO -- default-precise32:     -        s{^000-default$}{default};
I, [2015-04-24T11:38:17.695989 #9300]  INFO -- default-precise32:       $_
I, [2015-04-24T11:38:17.696023 #9300]  INFO -- default-precise32:   } glob("$choicedir/$arg$sffx");
I, [2015-04-24T11:38:17.696043 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.696061 #9300]  INFO -- default-precise32:     -    # use same rules as apache's Include directive
I, [2015-04-24T11:38:17.696080 #9300]  INFO -- default-precise32:     -    @glob = grep( /^[[:alnum:]][-._[:alnum:]]*$/, @glob );
I, [2015-04-24T11:38:17.696099 #9300]  INFO -- default-precise32:     -    @glob = grep( !/\.dpkg/, @glob );
I, [2015-04-24T11:38:17.696117 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:17.696138 #9300]  INFO -- default-precise32:   return @glob;
I, [2015-04-24T11:38:17.696156 #9300]  INFO -- default-precise32:      }
I, [2015-04-24T11:38:17.696174 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.696192 #9300]  INFO -- default-precise32:      sub doit {
I, [2015-04-24T11:38:17.696230 #9300]  INFO -- default-precise32:   my $acton = shift;
I, [2015-04-24T11:38:17.696249 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.696267 #9300]  INFO -- default-precise32:     -    my $prio = "";
I, [2015-04-24T11:38:17.696299 #9300]  INFO -- default-precise32:     -    if ( $obj eq 'site' && $acton eq 'default' ) {
I, [2015-04-24T11:38:17.696323 #9300]  INFO -- default-precise32:     -        $prio = '000-';
I, [2015-04-24T11:38:17.696343 #9300]  INFO -- default-precise32:     -    }
I, [2015-04-24T11:38:17.696361 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:17.696383 #9300]  INFO -- default-precise32:   my ( $conftgt, $conflink );
I, [2015-04-24T11:38:17.696406 #9300]  INFO -- default-precise32:   if ( $obj eq 'module' ) {
I, [2015-04-24T11:38:17.696429 #9300]  INFO -- default-precise32:       if ( $acton eq 'cgi' && threaded() ) {
I, [2015-04-24T11:38:17.696448 #9300]  INFO -- default-precise32:     -            print "Your MPM seems to be threaded. Selecting cgid instead of cgi.\n";
I, [2015-04-24T11:38:17.696467 #9300]  INFO -- default-precise32:     +            print
I, [2015-04-24T11:38:17.696485 #9300]  INFO -- default-precise32:     +                "Your MPM seems to be threaded. Selecting cgid instead of cgi.\n";
I, [2015-04-24T11:38:17.696508 #9300]  INFO -- default-precise32:           $acton = 'cgid';
I, [2015-04-24T11:38:17.696529 #9300]  INFO -- default-precise32:       }
I, [2015-04-24T11:38:17.696548 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.696565 #9300]  INFO -- default-precise32:     @@ -130,20 +141,35 @@
I, [2015-04-24T11:38:17.696586 #9300]  INFO -- default-precise32:   }
I, [2015-04-24T11:38:17.696604 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.696625 #9300]  INFO -- default-precise32:   my $tgt  = "$availdir/$acton$sffx";
I, [2015-04-24T11:38:17.696644 #9300]  INFO -- default-precise32:     -    my $link = "$enabldir/$prio$acton$sffx";
I, [2015-04-24T11:38:17.696662 #9300]  INFO -- default-precise32:     +    my $link = "$enabldir/$acton$sffx";
I, [2015-04-24T11:38:17.696679 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.696701 #9300]  INFO -- default-precise32:   if ( !-e $tgt ) {
I, [2015-04-24T11:38:17.696739 #9300]  INFO -- default-precise32:       if ( -l $link && !-e $link ) {
I, [2015-04-24T11:38:17.696758 #9300]  INFO -- default-precise32:     -		if ( $act eq 'disable' ) {
I, [2015-04-24T11:38:17.696777 #9300]  INFO -- default-precise32:     -			info("removing dangling symlink $link\n");
I, [2015-04-24T11:38:17.696794 #9300]  INFO -- default-precise32:     -			unlink($link);
I, [2015-04-24T11:38:17.696812 #9300]  INFO -- default-precise32:     -			return 1;
I, [2015-04-24T11:38:17.696830 #9300]  INFO -- default-precise32:     -		}
I, [2015-04-24T11:38:17.696847 #9300]  INFO -- default-precise32:     -		else {
I, [2015-04-24T11:38:17.696866 #9300]  INFO -- default-precise32:     -			error("$link is a dangling symlink!\n");
I, [2015-04-24T11:38:17.696883 #9300]  INFO -- default-precise32:     -		}
I, [2015-04-24T11:38:17.696901 #9300]  INFO -- default-precise32:     -	}
I, [2015-04-24T11:38:17.696919 #9300]  INFO -- default-precise32:     +            if ( $act eq 'disable' ) {
I, [2015-04-24T11:38:17.696937 #9300]  INFO -- default-precise32:     +                info("removing dangling symlink $link\n");
I, [2015-04-24T11:38:17.696956 #9300]  INFO -- default-precise32:     +                unlink($link);
I, [2015-04-24T11:38:17.696974 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.700094 #9300]  INFO -- default-precise32: h. It may exist as dangling link, too
I, [2015-04-24T11:38:17.700126 #9300]  INFO -- default-precise32:     +                $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:38:17.700146 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.700165 #9300]  INFO -- default-precise32:     +                if ( -l $conflink && !-e $conflink ) {
I, [2015-04-24T11:38:17.700184 #9300]  INFO -- default-precise32:     +                    info("removing dangling symlink $conflink\n");
I, [2015-04-24T11:38:17.700203 #9300]  INFO -- default-precise32:     +                    unlink($conflink);
I, [2015-04-24T11:38:17.700222 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.700246 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.700265 #9300]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:38:17.700283 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.700302 #9300]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:38:17.700325 #9300]  INFO -- default-precise32:     +                error("$link is a dangling symlink!\n");
I, [2015-04-24T11:38:17.700346 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.700365 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.700382 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.700401 #9300]  INFO -- default-precise32:     +        if ( $purge ) {
I, [2015-04-24T11:38:17.700419 #9300]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:17.700438 #9300]  INFO -- default-precise32:     +            # exit silently, we are purging anyway
I, [2015-04-24T11:38:17.700456 #9300]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:38:17.700475 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.700493 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.700516 #9300]  INFO -- default-precise32:       error("$name $acton does not exist!\n");
I, [2015-04-24T11:38:17.700539 #9300]  INFO -- default-precise32:       return 0;
I, [2015-04-24T11:38:17.700574 #9300]  INFO -- default-precise32:   }
I, [2015-04-24T11:38:17.700605 #9300]  INFO -- default-precise32:     @@ -151,28 +177,44 @@
I, [2015-04-24T11:38:17.700627 #9300]  INFO -- default-precise32:   # handle module dependencies
I, [2015-04-24T11:38:17.700667 #9300]  INFO -- default-precise32:   if ( $obj eq 'module' ) {
I, [2015-04-24T11:38:17.700691 #9300]  INFO -- default-precise32:       if ( $act eq 'enable' ) {
I, [2015-04-24T11:38:17.700710 #9300]  INFO -- default-precise32:     -            my $depends = qx{grep "# Depends:" "$availdir/$acton.load"|cut -f2 -d:};
I, [2015-04-24T11:38:17.700729 #9300]  INFO -- default-precise32:     -            $depends =~ s,^[\s\n]+,,;
I, [2015-04-24T11:38:17.700748 #9300]  INFO -- default-precise32:     -            $depends =~ s,[\s\n]+$,,;
I, [2015-04-24T11:38:17.700766 #9300]  INFO -- default-precise32:     -            do_deps( $acton, split( /[\n\s]+/, $depends ) ) or return 0;
I, [2015-04-24T11:38:17.700785 #9300]  INFO -- default-precise32:     +            if ( $acton eq 'mpm_itk' ) {
I, [2015-04-24T11:38:17.700815 #9300]  INFO -- default-precise32:     +                warning(  "MPM_ITK is a third party module that is not part "
I, [2015-04-24T11:38:17.700835 #9300]  INFO -- default-precise32:     +                        . "of the official Apache HTTPD. It has seen less "
I, [2015-04-24T11:38:17.700866 #9300]  INFO -- default-precise32:     +                        . "testing than the official MPM modules." );
I, [2015-04-24T11:38:17.700884 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.700903 #9300]  INFO -- default-precise32:     +            my @depends = get_deps("$availdir/$acton.load");
I, [2015-04-24T11:38:17.700922 #9300]  INFO -- default-precise32:     +            do_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:38:17.700940 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.700958 #9300]  INFO -- default-precise32:     +            my @conflicts = get_deps( "$availdir/$acton.load", "Conflicts" );
I, [2015-04-24T11:38:17.700977 #9300]  INFO -- default-precise32:     +            check_conflicts( $acton, @conflicts ) or return 0;
I, [2015-04-24T11:38:17.700999 #9300]  INFO -- default-precise32:       }
I, [2015-04-24T11:38:17.701035 #9300]  INFO -- default-precise32:       else {
I, [2015-04-24T11:38:17.701055 #9300]  INFO -- default-precise32:     -            my @depends = qx{egrep "# Depends:.*${acton}( |\$)" $enabldir/*.load};
I, [2015-04-24T11:38:17.701074 #9300]  INFO -- default-precise32:     -            @depends = grep {s{^.*?/([^/]*?)\.load:.*}{$1}s} @depends;
I, [2015-04-24T11:38:17.701096 #9300]  INFO -- default-precise32:     -            if ( scalar @depends ) {
I, [2015-04-24T11:38:17.701116 #9300]  INFO -- default-precise32:     +            my @depending;
I, [2015-04-24T11:38:17.701134 #9300]  INFO -- default-precise32:     +            foreach my $d ( glob("$enabldir/*.load") ) {
I, [2015-04-24T11:38:17.701153 #9300]  INFO -- default-precise32:     +                my @deps = get_deps($d);
I, [2015-04-24T11:38:17.701171 #9300]  INFO -- default-precise32:     +                if ( is_in( $acton, @deps ) ) {
I, [2015-04-24T11:38:17.701190 #9300]  INFO -- default-precise32:     +                    $d =~ m,/([^/]+).load$,;
I, [2015-04-24T11:38:17.701209 #9300]  INFO -- default-precise32:     +                    push @depending, $1;
I, [2015-04-24T11:38:17.701227 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.701245 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.701264 #9300]  INFO -- default-precise32:     +            if ( scalar @depending ) {
I, [2015-04-24T11:38:17.701303 #9300]  INFO -- default-precise32:               if ($force) {
I, [2015-04-24T11:38:17.701329 #9300]  INFO -- default-precise32:     -                    do_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:38:17.702936 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:17.703196 #9300]  INFO -- default-precise32:               }
I, [2015-04-24T11:38:17.703449 #9300]  INFO -- default-precise32:               else {
I, [2015-04-24T11:38:17.703671 #9300]  INFO -- default-precise32:                   error(
I, [2015-04-24T11:38:17.703910 #9300]  INFO -- default-precise32:                       "The following modules depend on $acton ",
I, [2015-04-24T11:38:17.704160 #9300]  INFO -- default-precise32:     -                        "and need to be disabled first: @depends\n"
I, [2015-04-24T11:38:17.704381 #9300]  INFO -- default-precise32:     +                        "and need to be disabled first: @depending\n"
I, [2015-04-24T11:38:17.704610 #9300]  INFO -- default-precise32:                   );
I, [2015-04-24T11:38:17.704858 #9300]  INFO -- default-precise32:                   return 0;
I, [2015-04-24T11:38:17.705114 #9300]  INFO -- default-precise32:               }
I, [2015-04-24T11:38:17.705336 #9300]  INFO -- default-precise32:           }
I, [2015-04-24T11:38:17.705569 #9300]  INFO -- default-precise32:       }
I, [2015-04-24T11:38:17.705782 #9300]  INFO -- default-precise32:   }
I, [2015-04-24T11:38:17.706034 #9300]  INFO -- default-precise32:     +    elsif ( $act eq 'enable' ) {
I, [2015-04-24T11:38:17.706296 #9300]  INFO -- default-precise32:     +        my @depends = get_deps("$availdir/$acton$sffx");
I, [2015-04-24T11:38:17.706530 #9300]  INFO -- default-precise32:     +        warn_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:38:17.706771 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.707012 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.707240 #9300]  INFO -- default-precise32:   if ( $act eq 'enable' ) {
I, [2015-04-24T11:38:17.707484 #9300]  INFO -- default-precise32:       my $check = check_link( $tgt, $link );
I, [2015-04-24T11:38:17.707714 #9300]  INFO -- default-precise32:     @@ -190,7 +232,9 @@
I, [2015-04-24T11:38:17.735193 #9300]  INFO -- default-precise32:                   add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:38:17.735587 #9300]  INFO -- default-precise32:               }
I, [2015-04-24T11:38:17.735638 #9300]  INFO -- default-precise32:               else {
I, [2015-04-24T11:38:17.735661 #9300]  INFO -- default-precise32:     -                    error("Config file $acton.conf not properly enabled: $confcheck\n");
I, [2015-04-24T11:38:17.735681 #9300]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:38:17.735700 #9300]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:38:17.735726 #9300]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:38:17.735750 #9300]  INFO -- default-precise32:                   return 0;
I, [2015-04-24T11:38:17.735773 #9300]  INFO -- default-precise32:               }
I, [2015-04-24T11:38:17.735795 #9300]  INFO -- default-precise32:           }
I, [2015-04-24T11:38:17.735814 #9300]  INFO -- default-precise32:     @@ -208,17 +252,21 @@
I, [2015-04-24T11:38:17.735867 #9300]  INFO -- default-precise32:                   add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:38:17.735902 #9300]  INFO -- default-precise32:               }
I, [2015-04-24T11:38:17.735926 #9300]  INFO -- default-precise32:               elsif ( $confcheck ne 'ok' ) {
I, [2015-04-24T11:38:17.735945 #9300]  INFO -- default-precise32:     -                    error("Config file $acton.conf not properly enabled: $confcheck\n");
I, [2015-04-24T11:38:17.735964 #9300]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:38:17.735983 #9300]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:38:17.736014 #9300]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:38:17.736040 #9300]  INFO -- default-precise32:                   return 0;
I, [2015-04-24T11:38:17.736063 #9300]  INFO -- default-precise32:               }
I, [2015-04-24T11:38:17.736086 #9300]  INFO -- default-precise32:           }
I, [2015-04-24T11:38:17.736104 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.736127 #9300]  INFO -- default-precise32:           print "Enabling $obj $acton.\n";
I, [2015-04-24T11:38:17.736149 #9300]  INFO -- default-precise32:           if ( $acton eq 'ssl' ) {
I, [2015-04-24T11:38:17.736169 #9300]  INFO -- default-precise32:     -                info("See /usr/share/doc/apache2.2-common/README.Debian.gz on " .
I, [2015-04-24T11:38:17.736188 #9300]  INFO -- default-precise32:     -                     "how to configure SSL and create self-signed certificates.\n");
I, [2015-04-24T11:38:17.736206 #9300]  INFO -- default-precise32:     -	    }
I, [2015-04-24T11:38:17.736224 #9300]  INFO -- default-precise32:     -            return add_link( $tgt, $link );
I, [2015-04-24T11:38:17.736242 #9300]  INFO -- default-precise32:     +                info(     "See /usr/share/doc/apache2/README.Debian.gz on "
I, [2015-04-24T11:38:17.736261 #9300]  INFO -- default-precise32:     +                        . "how to configure SSL and create self-signed certificates.\n"
I, [2015-04-24T11:38:17.736280 #9300]  INFO -- default-precise32:     +                );
I, [2015-04-24T11:38:17.736299 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.736317 #9300]  INFO -- default-precise32:     +            return add_link( $tgt, $link )
I, [2015-04-24T11:38:17.736367 #9300]  INFO -- default-precise32:     +                && switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:17.736406 #9300]  INFO -- default-precise32:       }
I, [2015-04-24T11:38:17.736430 #9300]  INFO -- default-precise32:       else {
I, [2015-04-24T11:38:17.736453 #9300]  INFO -- default-precise32:           error("$name $acton not properly enabled: $check\n");
I, [2015-04-24T11:38:17.736472 #9300]  INFO -- default-precise32:     @@ -231,6 +279,7 @@
I, [2015-04-24T11:38:17.736494 #9300]  INFO -- default-precise32:           if ( $conflink && -e $conflink ) {
I, [2015-04-24T11:38:17.736517 #9300]  INFO -- default-precise32:               remove_link($conflink);
I, [2015-04-24T11:38:17.736539 #9300]  INFO -- default-precise32:           }
I, [2015-04-24T11:38:17.736558 #9300]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:17.736592 #9300]  INFO -- default-precise32:           print "$name $acton disabled.\n";
I, [2015-04-24T11:38:17.736614 #9300]  INFO -- default-precise32:       }
I, [2015-04-24T11:38:17.736649 #9300]  INFO -- default-precise32:       elsif ( $conflink && -e $conflink ) {
I, [2015-04-24T11:38:17.736676 #9300]  INFO -- default-precise32:     @@ -239,6 +288,9 @@
I, [2015-04-24T11:38:17.736711 #9300]  INFO -- default-precise32:       }
I, [2015-04-24T11:38:17.736734 #9300]  INFO -- default-precise32:       else {
I, [2015-04-24T11:38:17.736757 #9300]  INFO -- default-precise32:           info("$name $acton already disabled\n");
I, [2015-04-24T11:38:17.736777 #9300]  INFO -- default-precise32:     +            if ( $purge ) {
I, [2015-04-24T11:38:17.736796 #9300]  INFO -- default-precise32:     +                switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:17.736814 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.736836 #9300]  INFO -- default-precise32:           return 1;
I, [2015-04-24T11:38:17.736859 #9300]  INFO -- default-precise32:       }
I, [2015-04-24T11:38:17.736882 #9300]  INFO -- default-precise32:   }
I, [2015-04-24T11:38:17.736900 #9300]  INFO -- default-precise32:     @@ -246,6 +298,29 @@
I, [2015-04-24T11:38:17.736935 #9300]  INFO -- default-precise32:   return 1;
I, [2015-04-24T11:38:17.736954 #9300]  INFO -- default-precise32:      }
I, [2015-04-24T11:38:17.736972 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.736991 #9300]  INFO -- default-precise32:     +sub get_deps {
I, [2015-04-24T11:38:17.737021 #9300]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:38:17.737041 #9300]  INFO -- default-precise32:     +    my $type = shift || "Depends";
I, [2015-04-24T11:38:17.737060 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.737078 #9300]  INFO -- default-precise32:     +    my $fd;
I, [2015-04-24T11:38:17.737097 #9300]  INFO -- default-precise32:     +    if ( !open( $fd, '<', $file ) ) {
I, [2015-04-24T11:38:17.737115 #9300]  INFO -- default-precise32:     +        error("Can't open $file: $!");
I, [2015-04-24T11:38:17.737134 #9300]  INFO -- default-precise32:     +        return;
I, [2015-04-24T11:38:17.737152 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.737170 #9300]  INFO -- default-precise32:     +    my $line;
I, [2015-04-24T11:38:17.737188 #9300]  INFO -- default-precise32:     +    while ( defined( $line = <$fd> ) ) {
I, [2015-04-24T11:38:17.737215 #9300]  INFO -- default-precise32:     +        chomp $line;
I, [2015-04-24T11:38:17.737236 #9300]  INFO -- default-precise32:     +        if ( $line =~ /^# $type:\s+(.*?)\s*$/ ) {
I, [2015-04-24T11:38:17.737272 #9300]  INFO -- default-precise32:     +            my $deps = $1;
I, [2015-04-24T11:38:17.737292 #9300]  INFO -- default-precise32:     +            return split( /[\n\s]+/, $deps );
I, [2015-04-24T11:38:17.737311 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.737335 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.737354 #9300]  INFO -- default-precise32:     +        # only check until the first non-empty non-comment line
I, [2015-04-24T11:38:17.737373 #9300]  INFO -- default-precise32:     +        last if ( $line !~ /^\s*(?:#.*)?$/ );
I, [2015-04-24T11:38:17.737392 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.737410 #9300]  INFO -- default-precise32:     +    return;
I, [2015-04-24T11:38:17.737428 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.737445 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.737463 #9300]  INFO -- default-precise32:      sub do_deps {
I, [2015-04-24T11:38:17.737486 #9300]  INFO -- default-precise32:   my $acton = shift;
I, [2015-04-24T11:38:17.737510 #9300]  INFO -- default-precise32:   foreach my $d (@_) {
I, [2015-04-24T11:38:17.737529 #9300]  INFO -- default-precise32:     @@ -258,6 +333,48 @@
I, [2015-04-24T11:38:17.737551 #9300]  INFO -- default-precise32:   return 1;
I, [2015-04-24T11:38:17.737570 #9300]  INFO -- default-precise32:      }
I, [2015-04-24T11:38:17.737588 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.739725 #9300]  INFO -- default-precise32:     +sub warn_deps {
I, [2015-04-24T11:38:17.739755 #9300]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:38:17.739780 #9300]  INFO -- default-precise32:     +    my $modsenabldir = $ENV{APACHE_MODS_ENABLED} || "$confdir/mods-enabled";
I, [2015-04-24T11:38:17.739801 #9300]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:38:17.740065 #9300]  INFO -- default-precise32:     +        info("Checking dependency $d for $acton:\n");
I, [2015-04-24T11:38:17.740285 #9300]  INFO -- default-precise32:     +        if ( !-e "$modsenabldir/$d.load" ) {
I, [2015-04-24T11:38:17.740463 #9300]  INFO -- default-precise32:     +            warning(
I, [2015-04-24T11:38:17.740619 #9300]  INFO -- default-precise32: +                "Module $d is not enabled, but $acton depends on it, aborting\n"
I, [2015-04-24T11:38:17.740873 #9300]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:38:17.741102 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:17.741278 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.741438 #9300]  INFO -- default-precise32: +    }
I, [2015-04-24T11:38:17.741590 #9300]  INFO -- default-precise32: +    return 1;
I, [2015-04-24T11:38:17.741760 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.741969 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.742255 #9300]  INFO -- default-precise32:     +sub check_conflicts {
I, [2015-04-24T11:38:17.742374 #9300]  INFO -- default-precise32:     +    my $acton    = shift;
I, [2015-04-24T11:38:17.742484 #9300]  INFO -- default-precise32:     +    my $haderror = 0;
I, [2015-04-24T11:38:17.742612 #9300]  INFO -- default-precise32: +    foreach my $d (@_) {
I, [2015-04-24T11:38:17.781600 #9300]  INFO -- default-precise32:     +        info("Considering conflict $d for $acton:\n");
I, [2015-04-24T11:38:17.781674 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.781729 #9300]  INFO -- default-precise32:     +        my $tgt  = "$availdir/$d$sffx";
I, [2015-04-24T11:38:17.781756 #9300]  INFO -- default-precise32:     +        my $link = "$enabldir/$d$sffx";
I, [2015-04-24T11:38:17.781800 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.781822 #9300]  INFO -- default-precise32:     +        my $confcheck = check_link( $tgt, $link );
I, [2015-04-24T11:38:17.781844 #9300]  INFO -- default-precise32:     +        if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:38:17.781864 #9300]  INFO -- default-precise32:     +            error(
I, [2015-04-24T11:38:17.781884 #9300]  INFO -- default-precise32:     +                "Module $d is enabled - cannot proceed due to conflicts. It needs to be disabled first!\n"
I, [2015-04-24T11:38:17.781905 #9300]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:38:17.781923 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.781943 #9300]  INFO -- default-precise32:     +            # Don't return immediately, there could be several conflicts
I, [2015-04-24T11:38:17.781963 #9300]  INFO -- default-precise32:     +            $haderror++;
I, [2015-04-24T11:38:17.781983 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.782002 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.782033 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.782051 #9300]  INFO -- default-precise32:     +    if ($haderror) {
I, [2015-04-24T11:38:17.782070 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:17.782088 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.782106 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.782124 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:17.782142 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.782160 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.782178 #9300]  INFO -- default-precise32:      sub add_link {
I, [2015-04-24T11:38:17.782208 #9300]  INFO -- default-precise32:   my ( $tgt, $link ) = @_;
I, [2015-04-24T11:38:17.782228 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.782261 #9300]  INFO -- default-precise32:     @@ -307,13 +424,36 @@
I, [2015-04-24T11:38:17.782283 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.782301 #9300]  INFO -- default-precise32:      sub threaded {
I, [2015-04-24T11:38:17.782325 #9300]  INFO -- default-precise32:   my $result = "";
I, [2015-04-24T11:38:17.782344 #9300]  INFO -- default-precise32:     -    $result = qx{/usr/sbin/apache2 -V | grep 'threaded'} if -x '/usr/sbin/apache2';
I, [2015-04-24T11:38:17.782363 #9300]  INFO -- default-precise32:     +    $result = qx{/usr/sbin/apache2ctl -V | grep 'threaded'}
I, [2015-04-24T11:38:17.782383 #9300]  INFO -- default-precise32:     +        if -x '/usr/sbin/apache2ctl';
I, [2015-04-24T11:38:17.782402 #9300]  INFO -- default-precise32:     +    if ( $? != 0 ) {
I, [2015-04-24T11:38:17.782419 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.782459 #9300]  INFO -- default-precise32:     +        # config doesn't work
I, [2015-04-24T11:38:17.782478 #9300]  INFO -- default-precise32:     +        if ( -e "$enabldir/mpm_prefork.load" || -e "$enabldir/mpm_itk.load" )
I, [2015-04-24T11:38:17.782498 #9300]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:38:17.782516 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:17.782534 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.782553 #9300]  INFO -- default-precise32:     +        elsif (-e "$enabldir/mpm_worker.load"
I, [2015-04-24T11:38:17.782584 #9300]  INFO -- default-precise32:     +            || -e "$enabldir/mpm_event.load" )
I, [2015-04-24T11:38:17.782603 #9300]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:38:17.782623 #9300]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:38:17.782642 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.782661 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:17.782680 #9300]  INFO -- default-precise32:     +            error("Can't determine enabled MPM");
I, [2015-04-24T11:38:17.782705 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.782726 #9300]  INFO -- default-precise32:     +            # do what user requested
I, [2015-04-24T11:38:17.782746 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:17.782765 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.782783 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.782807 #9300]  INFO -- default-precise32:   if ( $result =~ / no/ ) {
I, [2015-04-24T11:38:17.782831 #9300]  INFO -- default-precise32:       return 0;
I, [2015-04-24T11:38:17.782855 #9300]  INFO -- default-precise32:   }
I, [2015-04-24T11:38:17.782874 #9300]  INFO -- default-precise32:     -    else {
I, [2015-04-24T11:38:17.782893 #9300]  INFO -- default-precise32:     +    elsif ( $result =~ / yes/ ) {
I, [2015-04-24T11:38:17.782927 #9300]  INFO -- default-precise32:       return 1;
I, [2015-04-24T11:38:17.782952 #9300]  INFO -- default-precise32:   }
I, [2015-04-24T11:38:17.782991 #9300]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:38:17.783012 #9300]  INFO -- default-precise32:     +        die("Can't parse output from apache2ctl -V:\n$result\n");
I, [2015-04-24T11:38:17.783032 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.783051 #9300]  INFO -- default-precise32:      }
I, [2015-04-24T11:38:17.783070 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.783142 #9300]  INFO -- default-precise32:      sub info {
I, [2015-04-24T11:38:17.783167 #9300]  INFO -- default-precise32:     @@ -324,6 +464,18 @@
I, [2015-04-24T11:38:17.783192 #9300]  INFO -- default-precise32:   print STDERR 'ERROR: ', @_;
I, [2015-04-24T11:38:17.783212 #9300]  INFO -- default-precise32:      }
I, [2015-04-24T11:38:17.783231 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.783250 #9300]  INFO -- default-precise32:     +sub warning {
I, [2015-04-24T11:38:17.783287 #9300]  INFO -- default-precise32:     +    print STDERR 'WARNING: ', @_;
I, [2015-04-24T11:38:17.783307 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.783326 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.783345 #9300]  INFO -- default-precise32:     +sub is_in {
I, [2015-04-24T11:38:17.783364 #9300]  INFO -- default-precise32:     +    my $needle = shift;
I, [2015-04-24T11:38:17.783395 #9300]  INFO -- default-precise32:     +    foreach my $e (@_) {
I, [2015-04-24T11:38:17.783414 #9300]  INFO -- default-precise32:     +        return 1 if $needle eq $e;
I, [2015-04-24T11:38:17.783432 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.783450 #9300]  INFO -- default-precise32:     +    return 0;
I, [2015-04-24T11:38:17.783468 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.783486 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.783505 #9300]  INFO -- default-precise32:      sub read_env_file {
I, [2015-04-24T11:38:17.783527 #9300]  INFO -- default-precise32:   my $file = shift;
I, [2015-04-24T11:38:17.783547 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:17.783565 #9300]  INFO -- default-precise32:     @@ -339,4 +491,43 @@
I, [2015-04-24T11:38:17.783600 #9300]  INFO -- default-precise32:       $ENV{$1} = $2;
I, [2015-04-24T11:38:17.783622 #9300]  INFO -- default-precise32:   }
I, [2015-04-24T11:38:17.783640 #9300]  INFO -- default-precise32:      }
I, [2015-04-24T11:38:17.783658 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.783711 #9300]  INFO -- default-precise32:     +sub switch_marker {
I, [2015-04-24T11:38:17.783751 #9300]  INFO -- default-precise32:     +    die('usage: switch_marker([module|site|conf], [enable|disable], $name)')
I, [2015-04-24T11:38:17.783771 #9300]  INFO -- default-precise32:     +        if @_ != 3;
I, [2015-04-24T11:38:17.783790 #9300]  INFO -- default-precise32:     +    my $which = shift;
I, [2015-04-24T11:38:17.783808 #9300]  INFO -- default-precise32:     +    my $what  = shift;
I, [2015-04-24T11:38:17.783826 #9300]  INFO -- default-precise32:     +    my $name  = shift;
I, [2015-04-24T11:38:17.783843 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.783861 #9300]  INFO -- default-precise32:     +    my $mode = "admin";
I, [2015-04-24T11:38:17.783879 #9300]  INFO -- default-precise32:     +    $mode = "maint" if $maintmode;
I, [2015-04-24T11:38:17.783896 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.783914 #9300]  INFO -- default-precise32:     +    #print("switch_marker $which $what $name\n");
I, [2015-04-24T11:38:17.783932 #9300]  INFO -- default-precise32:     +    # TODO: get rid of the magic string(s)
I, [2015-04-24T11:38:17.783950 #9300]  INFO -- default-precise32:     +    my $state_marker_dir = "$statedir/$what" . "d" . "_by_$mode";
I, [2015-04-24T11:38:17.783969 #9300]  INFO -- default-precise32:     +    my $state_marker     = "$state_marker_dir/$name";
I, [2015-04-24T11:38:17.783987 #9300]  INFO -- default-precise32:     +    if ( !-d $state_marker_dir ) {
I, [2015-04-24T11:38:17.784005 #9300]  INFO -- default-precise32:     +        File::Path::mkpath("$state_marker_dir")
I, [2015-04-24T11:38:17.784024 #9300]  INFO -- default-precise32:     +            || error(
I, [2015-04-24T11:38:17.784042 #9300]  INFO -- default-precise32:     +            "Failed to create marker directory: '$state_marker_dir'\n");
I, [2015-04-24T11:38:17.784060 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.784097 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.784118 #9300]  INFO -- default-precise32:     +    # XXX: swap find with perl alternative
I, [2015-04-24T11:38:17.784137 #9300]  INFO -- default-precise32:     +    my @markers = qx{find "$statedir" -type f -a -name "$name"};
I, [2015-04-24T11:38:17.784156 #9300]  INFO -- default-precise32:     +    chomp(@markers);
I, [2015-04-24T11:38:17.784174 #9300]  INFO -- default-precise32:     +    foreach (@markers) {
I, [2015-04-24T11:38:17.784196 #9300]  INFO -- default-precise32:     +        unless ( unlink $_ ) {
I, [2015-04-24T11:38:17.784216 #9300]  INFO -- default-precise32:     +            error("Failed to remove old marker '$_'!\n") && return 0;
I, [2015-04-24T11:38:17.784235 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.784262 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.784283 #9300]  INFO -- default-precise32:     +    unless ($purge) {
I, [2015-04-24T11:38:17.784302 #9300]  INFO -- default-precise32:     +        qx{touch "$state_marker"};
I, [2015-04-24T11:38:17.784320 #9300]  INFO -- default-precise32:     +        if ( $? != 0 ) {
I, [2015-04-24T11:38:17.784360 #9300]  INFO -- default-precise32:     +            error("Failed to create marker '$state_marker'!\n") && return 0;
I, [2015-04-24T11:38:17.784379 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.784398 #9300]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:38:17.784416 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.784434 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.784451 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.787440 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:17.787716 #9300]  INFO -- default-precise32:     - change mode from '0755' to '0700'
I, [2015-04-24T11:38:17.787945 #9300]  INFO -- default-precise32:   * link[/usr/sbin/a2dismod] action delete
I, [2015-04-24T11:38:17.788192 #9300]  INFO -- default-precise32:     - delete link at /usr/sbin/a2dismod
I, [2015-04-24T11:38:17.788446 #9300]  INFO -- default-precise32:   * template[/usr/sbin/a2dismod] action create
I, [2015-04-24T11:38:17.821415 #9300]  INFO -- default-precise32:     - create new file /usr/sbin/a2dismod
I, [2015-04-24T11:38:17.821716 #9300]  INFO -- default-precise32:     - update content in file /usr/sbin/a2dismod from none to ce53f4
I, [2015-04-24T11:38:17.825201 #9300]  INFO -- default-precise32:     --- /usr/sbin/a2dismod	2015-04-24 08:38:17.756722378 +0000
I, [2015-04-24T11:38:17.825582 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-12xiy1s	2015-04-24 08:38:17.756722378 +0000
I, [2015-04-24T11:38:17.825818 #9300]  INFO -- default-precise32:     @@ -1 +1,533 @@
I, [2015-04-24T11:38:17.826046 #9300]  INFO -- default-precise32:     +#!/usr/bin/perl -w
I, [2015-04-24T11:38:17.826311 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:17.826530 #9300]  INFO -- default-precise32:     +# a2enmod by Stefan Fritsch <sf@debian.org>
I, [2015-04-24T11:38:17.826779 #9300]  INFO -- default-precise32:     +# Licensed under Apache License 2.0
I, [2015-04-24T11:38:17.826988 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:17.827220 #9300]  INFO -- default-precise32:     +# The coding style is "perltidy -pbp"
I, [2015-04-24T11:38:17.827480 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.827682 #9300]  INFO -- default-precise32:     +use strict;
I, [2015-04-24T11:38:17.827909 #9300]  INFO -- default-precise32:     +use Cwd 'realpath';
I, [2015-04-24T11:38:17.828124 #9300]  INFO -- default-precise32:     +use File::Spec;
I, [2015-04-24T11:38:17.828390 #9300]  INFO -- default-precise32:     +use File::Basename;
I, [2015-04-24T11:38:17.828613 #9300]  INFO -- default-precise32:     +use File::Path;
I, [2015-04-24T11:38:17.828834 #9300]  INFO -- default-precise32:     +use Getopt::Long;
I, [2015-04-24T11:38:17.829050 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.861644 #9300]  INFO -- default-precise32:     +my $quiet;
I, [2015-04-24T11:38:17.861902 #9300]  INFO -- default-precise32:     +my $force;
I, [2015-04-24T11:38:17.862121 #9300]  INFO -- default-precise32:     +my $maintmode;
I, [2015-04-24T11:38:17.862363 #9300]  INFO -- default-precise32:     +my $purge;
I, [2015-04-24T11:38:17.862597 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.862840 #9300]  INFO -- default-precise32:     +Getopt::Long::Configure('bundling');
I, [2015-04-24T11:38:17.863164 #9300]  INFO -- default-precise32:     +GetOptions(
I, [2015-04-24T11:38:17.863409 #9300]  INFO -- default-precise32:     +    'quiet|q'     => \$quiet,
I, [2015-04-24T11:38:17.863654 #9300]  INFO -- default-precise32:     +    'force|f'     => \$force,
I, [2015-04-24T11:38:17.863867 #9300]  INFO -- default-precise32:     +    'maintmode|m' => \$maintmode,
I, [2015-04-24T11:38:17.864108 #9300]  INFO -- default-precise32:     +    'purge|p'     => \$purge
I, [2015-04-24T11:38:17.864318 #9300]  INFO -- default-precise32:     +) or exit 2;
I, [2015-04-24T11:38:17.864546 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.864794 #9300]  INFO -- default-precise32:     +my $basename = basename($0);
I, [2015-04-24T11:38:17.864991 #9300]  INFO -- default-precise32:     +$basename =~ /^a2(en|dis)(mod|site|conf)((?:-.+)?)$/
I, [2015-04-24T11:38:17.865235 #9300]  INFO -- default-precise32:     +    or die "$basename call name unknown\n";
I, [2015-04-24T11:38:17.865463 #9300]  INFO -- default-precise32:     +my $act        = $1;
I, [2015-04-24T11:38:17.865717 #9300]  INFO -- default-precise32:     +my $obj        = $2;
I, [2015-04-24T11:38:17.865935 #9300]  INFO -- default-precise32:     +my $dir_suffix = $3;
I, [2015-04-24T11:38:17.866152 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.866395 #9300]  INFO -- default-precise32:     +my $env_file = $ENV{APACHE_ENVVARS}
I, [2015-04-24T11:38:17.901373 #9300]  INFO -- default-precise32:     +    || (
I, [2015-04-24T11:38:17.901615 #9300]  INFO -- default-precise32:     +    $ENV{APACHE_CONFDIR}
I, [2015-04-24T11:38:17.901647 #9300]  INFO -- default-precise32:     +    ? "$ENV{APACHE_CONFDIR}/envvars"
I, [2015-04-24T11:38:17.901668 #9300]  INFO -- default-precise32:     +    : "/etc/apache2$dir_suffix/envvars"
I, [2015-04-24T11:38:17.901687 #9300]  INFO -- default-precise32:     +    );
I, [2015-04-24T11:38:17.901706 #9300]  INFO -- default-precise32:     +$ENV{LANG} = 'C';
I, [2015-04-24T11:38:17.901724 #9300]  INFO -- default-precise32:     +read_env_file($env_file);
I, [2015-04-24T11:38:17.901742 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.901760 #9300]  INFO -- default-precise32:     +$act .= 'able';
I, [2015-04-24T11:38:17.901779 #9300]  INFO -- default-precise32:     +my ( $name, $dir, $sffx, $reload );
I, [2015-04-24T11:38:17.901797 #9300]  INFO -- default-precise32:     +if ( $obj eq 'mod' ) {
I, [2015-04-24T11:38:17.901815 #9300]  INFO -- default-precise32:     +    $obj    = 'module';
I, [2015-04-24T11:38:17.901834 #9300]  INFO -- default-precise32:     +    $dir    = 'mods';
I, [2015-04-24T11:38:17.901852 #9300]  INFO -- default-precise32:     +    $sffx   = '.load';
I, [2015-04-24T11:38:17.901870 #9300]  INFO -- default-precise32:     +    $reload = 'restart';
I, [2015-04-24T11:38:17.901888 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.901906 #9300]  INFO -- default-precise32:     +elsif ( $obj eq 'conf' ) {
I, [2015-04-24T11:38:17.901925 #9300]  INFO -- default-precise32:     +    $obj    = 'conf';
I, [2015-04-24T11:38:17.901943 #9300]  INFO -- default-precise32:     +    $dir    = 'conf';
I, [2015-04-24T11:38:17.901961 #9300]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:38:17.901979 #9300]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:38:17.901997 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.902038 #9300]  INFO -- default-precise32:     +else {
I, [2015-04-24T11:38:17.902075 #9300]  INFO -- default-precise32:     +    $dir    = 'sites';
I, [2015-04-24T11:38:17.902094 #9300]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:38:17.902111 #9300]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:38:17.902129 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.902147 #9300]  INFO -- default-precise32:     +$name = ucfirst($obj);
I, [2015-04-24T11:38:17.902164 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.902182 #9300]  INFO -- default-precise32:     +my $confdir = $ENV{APACHE_CONFDIR} || "/etc/apache2$dir_suffix";
I, [2015-04-24T11:38:17.902208 #9300]  INFO -- default-precise32:     +my $availdir = $ENV{ uc("APACHE_${dir}_AVAILABLE") }
I, [2015-04-24T11:38:17.902227 #9300]  INFO -- default-precise32:     +    || "$confdir/$dir-available";
I, [2015-04-24T11:38:17.902246 #9300]  INFO -- default-precise32:     +my $enabldir = $ENV{ uc("APACHE_${dir}_ENABLED") } || "$confdir/$dir-enabled";
I, [2015-04-24T11:38:17.902265 #9300]  INFO -- default-precise32:     +my $statedir = $ENV{ uc("APACHE_STATE_DIRECTORY") } || "/usr/lib/apache2";
I, [2015-04-24T11:38:17.902283 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.902300 #9300]  INFO -- default-precise32:     +$statedir .= "/$obj";
I, [2015-04-24T11:38:17.902323 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.902351 #9300]  INFO -- default-precise32:     +my $choicedir = $act eq 'enable' ? $availdir : $enabldir;
I, [2015-04-24T11:38:17.902372 #9300]  INFO -- default-precise32:     +my $linkdir = File::Spec->abs2rel( $availdir, $enabldir );
I, [2015-04-24T11:38:17.902390 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.902408 #9300]  INFO -- default-precise32:     +my $request_reload = 0;
I, [2015-04-24T11:38:17.902426 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.902444 #9300]  INFO -- default-precise32:     +my $rc = 0;
I, [2015-04-24T11:38:17.902461 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.902479 #9300]  INFO -- default-precise32:     +if ( !scalar @ARGV ) {
I, [2015-04-24T11:38:17.902497 #9300]  INFO -- default-precise32:     +    my @choices = myglob('*');
I, [2015-04-24T11:38:17.902516 #9300]  INFO -- default-precise32:     +    print "Your choices are: @choices\n";
I, [2015-04-24T11:38:17.902534 #9300]  INFO -- default-precise32:     +    print "Which ${obj}(s) do you want to $act (wildcards ok)?\n";
I, [2015-04-24T11:38:17.902553 #9300]  INFO -- default-precise32:     +    my $input = <>;
I, [2015-04-24T11:38:17.902571 #9300]  INFO -- default-precise32:     +    @ARGV = split /\s+/, $input;
I, [2015-04-24T11:38:17.902589 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.902606 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.902624 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.902642 #9300]  INFO -- default-precise32:     +my @objs;
I, [2015-04-24T11:38:17.902660 #9300]  INFO -- default-precise32:     +foreach my $arg (@ARGV) {
I, [2015-04-24T11:38:17.902678 #9300]  INFO -- default-precise32:     +    $arg =~ s/${sffx}$//;
I, [2015-04-24T11:38:17.902720 #9300]  INFO -- default-precise32:     +    my @glob = myglob($arg);
I, [2015-04-24T11:38:17.902757 #9300]  INFO -- default-precise32:     +    if ( !@glob ) {
I, [2015-04-24T11:38:17.902776 #9300]  INFO -- default-precise32:     +        error("No $obj found matching $arg!\n");
I, [2015-04-24T11:38:17.902796 #9300]  INFO -- default-precise32:     +        $rc = 1;
I, [2015-04-24T11:38:17.902814 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.902832 #9300]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:38:17.902850 #9300]  INFO -- default-precise32:     +        push @objs, @glob;
I, [2015-04-24T11:38:17.902867 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.902885 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.902902 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.902920 #9300]  INFO -- default-precise32:     +foreach my $acton (@objs) {
I, [2015-04-24T11:38:17.902938 #9300]  INFO -- default-precise32:     +    doit($acton) or $rc = 1;
I, [2015-04-24T11:38:17.902956 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.902974 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.902991 #9300]  INFO -- default-precise32:     +info(
I, [2015-04-24T11:38:17.903028 #9300]  INFO -- default-precise32:     +    "To activate the new configuration, you need to run:\n  service apache2 $reload\n"
I, [2015-04-24T11:38:17.903053 #9300]  INFO -- default-precise32:     +) if $request_reload;
I, [2015-04-24T11:38:17.903072 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.903090 #9300]  INFO -- default-precise32:     +exit($rc);
I, [2015-04-24T11:38:17.903107 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.903125 #9300]  INFO -- default-precise32:     +##############################################################################
I, [2015-04-24T11:38:17.903143 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.903161 #9300]  INFO -- default-precise32:     +sub myglob {
I, [2015-04-24T11:38:17.903179 #9300]  INFO -- default-precise32:     +    my $arg = shift;
I, [2015-04-24T11:38:17.903196 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.903236 #9300]  INFO -- default-precise32:     +    my @glob = map {
I, [2015-04-24T11:38:17.903256 #9300]  INFO -- default-precise32:     +        s{^$choicedir/}{};
I, [2015-04-24T11:38:17.903274 #9300]  INFO -- default-precise32:     +        s{$sffx$}{};
I, [2015-04-24T11:38:17.903292 #9300]  INFO -- default-precise32:     +        $_
I, [2015-04-24T11:38:17.903309 #9300]  INFO -- default-precise32:     +    } glob("$choicedir/$arg$sffx");
I, [2015-04-24T11:38:17.903373 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.903392 #9300]  INFO -- default-precise32:     +    return @glob;
I, [2015-04-24T11:38:17.903422 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.903440 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.903474 #9300]  INFO -- default-precise32:     +sub doit {
I, [2015-04-24T11:38:17.903494 #9300]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:38:17.903512 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.903530 #9300]  INFO -- default-precise32:     +    my ( $conftgt, $conflink );
I, [2015-04-24T11:38:17.903549 #9300]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:38:17.903567 #9300]  INFO -- default-precise32:     +        if ( $acton eq 'cgi' && threaded() ) {
I, [2015-04-24T11:38:17.903586 #9300]  INFO -- default-precise32:     +            print
I, [2015-04-24T11:38:17.903605 #9300]  INFO -- default-precise32:     +                "Your MPM seems to be threaded. Selecting cgid instead of cgi.\n";
I, [2015-04-24T11:38:17.903624 #9300]  INFO -- default-precise32:     +            $acton = 'cgid';
I, [2015-04-24T11:38:17.903642 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.903661 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.903679 #9300]  INFO -- default-precise32:     +        $conftgt = "$availdir/$acton.conf";
I, [2015-04-24T11:38:17.903698 #9300]  INFO -- default-precise32:     +        if ( -e $conftgt ) {
I, [2015-04-24T11:38:17.903717 #9300]  INFO -- default-precise32:     +            $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:38:17.903736 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.903754 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.903772 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.903791 #9300]  INFO -- default-precise32:     +    my $tgt  = "$availdir/$acton$sffx";
I, [2015-04-24T11:38:17.903809 #9300]  INFO -- default-precise32:     +    my $link = "$enabldir/$acton$sffx";
I, [2015-04-24T11:38:17.903827 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.903846 #9300]  INFO -- default-precise32:     +    if ( !-e $tgt ) {
I, [2015-04-24T11:38:17.903864 #9300]  INFO -- default-precise32:     +        if ( -l $link && !-e $link ) {
I, [2015-04-24T11:38:17.903883 #9300]  INFO -- default-precise32:     +            if ( $act eq 'disable' ) {
I, [2015-04-24T11:38:17.903902 #9300]  INFO -- default-precise32:     +                info("removing dangling symlink $link\n");
I, [2015-04-24T11:38:17.903922 #9300]  INFO -- default-precise32:     +                unlink($link);
I, [2015-04-24T11:38:17.903940 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.904033 #9300]  INFO -- default-precise32:     +                # force a .conf path. It may exist as dangling link, too
I, [2015-04-24T11:38:17.904055 #9300]  INFO -- default-precise32:     +                $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:38:17.904074 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.904093 #9300]  INFO -- default-precise32:     +                if ( -l $conflink && !-e $conflink ) {
I, [2015-04-24T11:38:17.904112 #9300]  INFO -- default-precise32:     +                    info("removing dangling symlink $conflink\n");
I, [2015-04-24T11:38:17.904131 #9300]  INFO -- default-precise32:     +                    unlink($conflink);
I, [2015-04-24T11:38:17.904150 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.904167 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.904186 #9300]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:38:17.904205 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.904223 #9300]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:38:17.904242 #9300]  INFO -- default-precise32:     +                error("$link is a dangling symlink!\n");
I, [2015-04-24T11:38:17.904261 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.904279 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.904297 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.904315 #9300]  INFO -- default-precise32:     +        if ( $purge ) {
I, [2015-04-24T11:38:17.904349 #9300]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:17.904369 #9300]  INFO -- default-precise32:     +            # exit silently, we are purging anyway
I, [2015-04-24T11:38:17.904388 #9300]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:38:17.904407 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.904425 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.907596 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:17.907734 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:17.907945 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.908248 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.908482 #9300]  INFO -- default-precise32:     +    # handle module dependencies
I, [2015-04-24T11:38:17.908711 #9300]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:38:17.908917 #9300]  INFO -- default-precise32:     +        if ( $act eq 'enable' ) {
I, [2015-04-24T11:38:17.909239 #9300]  INFO -- default-precise32:     +            if ( $acton eq 'mpm_itk' ) {
I, [2015-04-24T11:38:17.909268 #9300]  INFO -- default-precise32:     +                warning(  "MPM_ITK is a third party module that is not part "
I, [2015-04-24T11:38:17.909289 #9300]  INFO -- default-precise32:     +                        . "of the official Apache HTTPD. It has seen less "
I, [2015-04-24T11:38:17.909327 #9300]  INFO -- default-precise32:     +                        . "testing than the official MPM modules." );
I, [2015-04-24T11:38:17.909370 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.909390 #9300]  INFO -- default-precise32:     +            my @depends = get_deps("$availdir/$acton.load");
I, [2015-04-24T11:38:17.909410 #9300]  INFO -- default-precise32:     +            do_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:38:17.909428 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.909447 #9300]  INFO -- default-precise32:     +            my @conflicts = get_deps( "$availdir/$acton.load", "Conflicts" );
I, [2015-04-24T11:38:17.909467 #9300]  INFO -- default-precise32:     +            check_conflicts( $acton, @conflicts ) or return 0;
I, [2015-04-24T11:38:17.909486 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.909504 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:17.909527 #9300]  INFO -- default-precise32:     +            my @depending;
I, [2015-04-24T11:38:17.909568 #9300]  INFO -- default-precise32:     +            foreach my $d ( glob("$enabldir/*.load") ) {
I, [2015-04-24T11:38:17.909615 #9300]  INFO -- default-precise32:     +                my @deps = get_deps($d);
I, [2015-04-24T11:38:17.909644 #9300]  INFO -- default-precise32:     +                if ( is_in( $acton, @deps ) ) {
I, [2015-04-24T11:38:17.909664 #9300]  INFO -- default-precise32:     +                    $d =~ m,/([^/]+).load$,;
I, [2015-04-24T11:38:17.909683 #9300]  INFO -- default-precise32:     +                    push @depending, $1;
I, [2015-04-24T11:38:17.909703 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.909722 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.909741 #9300]  INFO -- default-precise32:     +            if ( scalar @depending ) {
I, [2015-04-24T11:38:17.909760 #9300]  INFO -- default-precise32:     +                if ($force) {
I, [2015-04-24T11:38:17.909779 #9300]  INFO -- default-precise32:     +                    do_deps( $acton, @depending ) or return 0;
I, [2015-04-24T11:38:17.909798 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.909817 #9300]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:38:17.909836 #9300]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:38:17.909855 #9300]  INFO -- default-precise32:     +                        "The following modules depend on $acton ",
I, [2015-04-24T11:38:17.909875 #9300]  INFO -- default-precise32:     +                        "and need to be disabled first: @depending\n"
I, [2015-04-24T11:38:17.909929 #9300]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:38:17.909953 #9300]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:38:17.909972 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.909991 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.910022 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.910042 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.910062 #9300]  INFO -- default-precise32:     +    elsif ( $act eq 'enable' ) {
I, [2015-04-24T11:38:17.910081 #9300]  INFO -- default-precise32:     +        my @depends = get_deps("$availdir/$acton$sffx");
I, [2015-04-24T11:38:17.910100 #9300]  INFO -- default-precise32:     +        warn_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:38:17.910119 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.910157 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.910177 #9300]  INFO -- default-precise32:     +    if ( $act eq 'enable' ) {
I, [2015-04-24T11:38:17.910196 #9300]  INFO -- default-precise32:     +        my $check = check_link( $tgt, $link );
I, [2015-04-24T11:38:17.910215 #9300]  INFO -- default-precise32:     +        if ( $check eq 'ok' ) {
I, [2015-04-24T11:38:17.910234 #9300]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:38:17.910253 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.910272 #9300]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:38:17.910300 #9300]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:38:17.910326 #9300]  INFO -- default-precise32:     +                if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:38:17.910348 #9300]  INFO -- default-precise32:     +                    info("$name $acton already enabled\n");
I, [2015-04-24T11:38:17.910368 #9300]  INFO -- default-precise32:     +                    return 1;
I, [2015-04-24T11:38:17.910387 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.910406 #9300]  INFO -- default-precise32:     +                elsif ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:38:17.910430 #9300]  INFO -- default-precise32:     +                    print "Enabling config file $acton.conf.\n";
I, [2015-04-24T11:38:17.910451 #9300]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:38:17.910470 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.910489 #9300]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:38:17.910508 #9300]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:38:17.910528 #9300]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:38:17.910547 #9300]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:38:17.910566 #9300]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:38:17.910584 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.910603 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.910621 #9300]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:38:17.910640 #9300]  INFO -- default-precise32:     +                info("$name $acton already enabled\n");
I, [2015-04-24T11:38:17.910659 #9300]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:38:17.910678 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.910696 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.910714 #9300]  INFO -- default-precise32:     +        elsif ( $check eq 'missing' ) {
I, [2015-04-24T11:38:17.910754 #9300]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:38:17.910773 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.910792 #9300]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:38:17.910811 #9300]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:38:17.910830 #9300]  INFO -- default-precise32:     +                if ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:38:17.910850 #9300]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:38:17.910869 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.910888 #9300]  INFO -- default-precise32:     +                elsif ( $confcheck ne 'ok' ) {
I, [2015-04-24T11:38:17.910907 #9300]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:38:17.910972 #9300]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:38:17.910996 #9300]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:38:17.911029 #9300]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:38:17.911048 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:17.911067 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.911085 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.911104 #9300]  INFO -- default-precise32:     +            print "Enabling $obj $acton.\n";
I, [2015-04-24T11:38:17.911123 #9300]  INFO -- default-precise32:     +            if ( $acton eq 'ssl' ) {
I, [2015-04-24T11:38:17.911142 #9300]  INFO -- default-precise32:     +                info(     "See /usr/share/doc/apache2/README.Debian.gz on "
I, [2015-04-24T11:38:17.911161 #9300]  INFO -- default-precise32:     +                        . "how to configure SSL and create self-signed certificates.\n"
I, [2015-04-24T11:38:17.911180 #9300]  INFO -- default-precise32:     +                );
I, [2015-04-24T11:38:17.911199 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.911218 #9300]  INFO -- default-precise32:     +            return add_link( $tgt, $link )
I, [2015-04-24T11:38:17.911241 #9300]  INFO -- default-precise32:     +                && switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:17.911260 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.911279 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:17.911308 #9300]  INFO -- default-precise32:     +            error("$name $acton not properly enabled: $check\n");
I, [2015-04-24T11:38:17.911334 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:17.911354 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.911373 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.911391 #9300]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:38:17.911411 #9300]  INFO -- default-precise32:     +        if ( -e $link || -l $link ) {
I, [2015-04-24T11:38:17.911447 #9300]  INFO -- default-precise32:     +            remove_link($link);
I, [2015-04-24T11:38:17.913841 #9300]  INFO -- default-precise32: && -e $conflink ) {
I, [2015-04-24T11:38:17.913876 #9300]  INFO -- default-precise32:     +                remove_link($conflink);
I, [2015-04-24T11:38:17.913898 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.913917 #9300]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:17.913937 #9300]  INFO -- default-precise32:     +            print "$name $acton disabled.\n";
I, [2015-04-24T11:38:17.913956 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.913975 #9300]  INFO -- default-precise32:     +        elsif ( $conflink && -e $conflink ) {
I, [2015-04-24T11:38:17.913994 #9300]  INFO -- default-precise32:     +            print "Disabling stale config file $acton.conf.\n";
I, [2015-04-24T11:38:17.914033 #9300]  INFO -- default-precise32:     +            remove_link($conflink);
I, [2015-04-24T11:38:17.914054 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.914072 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:17.914092 #9300]  INFO -- default-precise32:     +            info("$name $acton already disabled\n");
I, [2015-04-24T11:38:17.914111 #9300]  INFO -- default-precise32:     +            if ( $purge ) {
I, [2015-04-24T11:38:17.914130 #9300]  INFO -- default-precise32:     +                switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:17.914149 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:17.914168 #9300]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:38:17.914186 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.914204 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.914222 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.914240 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:17.914281 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.914301 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.914327 #9300]  INFO -- default-precise32:     +sub get_deps {
I, [2015-04-24T11:38:17.914348 #9300]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:38:17.914368 #9300]  INFO -- default-precise32:     +    my $type = shift || "Depends";
I, [2015-04-24T11:38:17.914406 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.914426 #9300]  INFO -- default-precise32:     +    my $fd;
I, [2015-04-24T11:38:17.914445 #9300]  INFO -- default-precise32:     +    if ( !open( $fd, '<', $file ) ) {
I, [2015-04-24T11:38:17.914464 #9300]  INFO -- default-precise32:     +        error("Can't open $file: $!");
I, [2015-04-24T11:38:17.914484 #9300]  INFO -- default-precise32:     +        return;
I, [2015-04-24T11:38:17.914503 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.914522 #9300]  INFO -- default-precise32:     +    my $line;
I, [2015-04-24T11:38:17.914542 #9300]  INFO -- default-precise32:     +    while ( defined( $line = <$fd> ) ) {
I, [2015-04-24T11:38:17.914568 #9300]  INFO -- default-precise32:     +        chomp $line;
I, [2015-04-24T11:38:17.914589 #9300]  INFO -- default-precise32:     +        if ( $line =~ /^# $type:\s+(.*?)\s*$/ ) {
I, [2015-04-24T11:38:17.914610 #9300]  INFO -- default-precise32:     +            my $deps = $1;
I, [2015-04-24T11:38:17.914630 #9300]  INFO -- default-precise32:     +            return split( /[\n\s]+/, $deps );
I, [2015-04-24T11:38:17.914649 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.914668 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.914687 #9300]  INFO -- default-precise32:     +        # only check until the first non-empty non-comment line
I, [2015-04-24T11:38:17.914707 #9300]  INFO -- default-precise32:     +        last if ( $line !~ /^\s*(?:#.*)?$/ );
I, [2015-04-24T11:38:17.914726 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.914745 #9300]  INFO -- default-precise32:     +    return;
I, [2015-04-24T11:38:17.914763 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.914782 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.914800 #9300]  INFO -- default-precise32:     +sub do_deps {
I, [2015-04-24T11:38:17.914819 #9300]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:38:17.914839 #9300]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:38:17.914858 #9300]  INFO -- default-precise32:     +        info("Considering dependency $d for $acton:\n");
I, [2015-04-24T11:38:17.914878 #9300]  INFO -- default-precise32:     +        if ( !doit($d) ) {
I, [2015-04-24T11:38:17.914898 #9300]  INFO -- default-precise32:     +            error("Could not $act dependency $d for $acton, aborting\n");
I, [2015-04-24T11:38:17.914918 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:17.914937 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.914957 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.914998 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:17.915032 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.915052 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.915071 #9300]  INFO -- default-precise32:     +sub warn_deps {
I, [2015-04-24T11:38:17.915090 #9300]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:38:17.915110 #9300]  INFO -- default-precise32:     +    my $modsenabldir = $ENV{APACHE_MODS_ENABLED} || "$confdir/mods-enabled";
I, [2015-04-24T11:38:17.915130 #9300]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:38:17.915150 #9300]  INFO -- default-precise32:     +        info("Checking dependency $d for $acton:\n");
I, [2015-04-24T11:38:17.915170 #9300]  INFO -- default-precise32:     +        if ( !-e "$modsenabldir/$d.load" ) {
I, [2015-04-24T11:38:17.915189 #9300]  INFO -- default-precise32:     +            warning(
I, [2015-04-24T11:38:17.915209 #9300]  INFO -- default-precise32:     +                "Module $d is not enabled, but $acton depends on it, aborting\n"
I, [2015-04-24T11:38:17.915228 #9300]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:38:17.915248 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:17.915276 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.915297 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.915315 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:17.915341 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.915361 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.915380 #9300]  INFO -- default-precise32:     +sub check_conflicts {
I, [2015-04-24T11:38:17.915400 #9300]  INFO -- default-precise32:     +    my $acton    = shift;
I, [2015-04-24T11:38:17.915419 #9300]  INFO -- default-precise32:     +    my $haderror = 0;
I, [2015-04-24T11:38:17.915438 #9300]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:38:17.915462 #9300]  INFO -- default-precise32:     +        info("Considering conflict $d for $acton:\n");
I, [2015-04-24T11:38:17.915482 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.915502 #9300]  INFO -- default-precise32:     +        my $tgt  = "$availdir/$d$sffx";
I, [2015-04-24T11:38:17.915521 #9300]  INFO -- default-precise32:     +        my $link = "$enabldir/$d$sffx";
I, [2015-04-24T11:38:17.915540 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.915560 #9300]  INFO -- default-precise32:     +        my $confcheck = check_link( $tgt, $link );
I, [2015-04-24T11:38:17.915613 #9300]  INFO -- default-precise32:     +        if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:38:17.915633 #9300]  INFO -- default-precise32:     +            error(
I, [2015-04-24T11:38:17.915652 #9300]  INFO -- default-precise32:     +                "Module $d is enabled - cannot proceed due to conflicts. It needs to be disabled first!\n"
I, [2015-04-24T11:38:17.915671 #9300]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:38:17.915689 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.915709 #9300]  INFO -- default-precise32:     +            # Don't return immediately, there could be several conflicts
I, [2015-04-24T11:38:17.915728 #9300]  INFO -- default-precise32:     +            $haderror++;
I, [2015-04-24T11:38:17.915747 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.915765 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.915783 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.915801 #9300]  INFO -- default-precise32:     +    if ($haderror) {
I, [2015-04-24T11:38:17.915820 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:17.915893 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.915916 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.915935 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:17.915954 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.915972 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.918386 #9300]  INFO -- default-precise32: +sub add_link {
I, [2015-04-24T11:38:17.918630 #9300]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:38:17.918856 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.919112 #9300]  INFO -- default-precise32:     +    # create relative link
I, [2015-04-24T11:38:17.942296 #9300]  INFO -- default-precise32:     +    if ( !symlink( File::Spec->abs2rel( $tgt, dirname($link) ), $link ) ) {
I, [2015-04-24T11:38:17.942633 #9300]  INFO -- default-precise32:     +        die("Could not create $link: $!\n");
I, [2015-04-24T11:38:17.942848 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.943101 #9300]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:38:17.943360 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:17.943702 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.943927 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.944180 #9300]  INFO -- default-precise32:     +sub check_link {
I, [2015-04-24T11:38:17.944395 #9300]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:38:17.944621 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.944825 #9300]  INFO -- default-precise32:     +    if ( !-e $link ) {
I, [2015-04-24T11:38:17.945068 #9300]  INFO -- default-precise32:     +        if ( -l $link ) {
I, [2015-04-24T11:38:17.945283 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.945534 #9300]  INFO -- default-precise32:     +            # points to nowhere
I, [2015-04-24T11:38:17.945771 #9300]  INFO -- default-precise32:     +            info("Removing dangling link $link");
I, [2015-04-24T11:38:17.945976 #9300]  INFO -- default-precise32:     +            unlink($link) or die "Could not remove $link\n";
I, [2015-04-24T11:38:17.946422 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:17.987562 #9300]  INFO -- default-precise32:     +        return 'missing';
I, [2015-04-24T11:38:17.987919 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.988245 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.988455 #9300]  INFO -- default-precise32:     +    if ( -e $link && !-l $link ) {
I, [2015-04-24T11:38:17.988711 #9300]  INFO -- default-precise32:     +        return "$link is a real file, not touching it";
I, [2015-04-24T11:38:17.989081 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.989293 #9300]  INFO -- default-precise32:     +    if ( realpath($link) ne realpath($tgt) ) {
I, [2015-04-24T11:38:17.989511 #9300]  INFO -- default-precise32:     +        return "$link exists but does not point to $tgt, not touching it";
I, [2015-04-24T11:38:17.989764 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.990046 #9300]  INFO -- default-precise32:     +    return 'ok';
I, [2015-04-24T11:38:17.990266 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:17.990593 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.990841 #9300]  INFO -- default-precise32:     +sub remove_link {
I, [2015-04-24T11:38:17.991112 #9300]  INFO -- default-precise32:     +    my ($link) = @_;
I, [2015-04-24T11:38:17.991345 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:17.991617 #9300]  INFO -- default-precise32:     +    if ( -l $link ) {
I, [2015-04-24T11:38:17.991854 #9300]  INFO -- default-precise32:     +        unlink($link) or die "Could not remove $link: $!\n";
I, [2015-04-24T11:38:17.992113 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.992402 #9300]  INFO -- default-precise32:     +    elsif ( -e $link ) {
I, [2015-04-24T11:38:17.992675 #9300]  INFO -- default-precise32:     +        error("$link is not a symbolic link, not deleting\n");
I, [2015-04-24T11:38:17.992904 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:17.993154 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:17.994525 #9300]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:38:17.996522 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:17.999071 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:18.004138 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.004413 #9300]  INFO -- default-precise32:     +sub threaded {
I, [2015-04-24T11:38:18.005293 #9300]  INFO -- default-precise32:     +    my $result = "";
I, [2015-04-24T11:38:18.007510 #9300]  INFO -- default-precise32:     +    $result = qx{/usr/sbin/apache2ctl -V | grep 'threaded'}
I, [2015-04-24T11:38:18.009536 #9300]  INFO -- default-precise32:     +        if -x '/usr/sbin/apache2ctl';
I, [2015-04-24T11:38:18.011529 #9300]  INFO -- default-precise32:     +    if ( $? != 0 ) {
I, [2015-04-24T11:38:18.013897 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.015851 #9300]  INFO -- default-precise32:     +        # config doesn't work
I, [2015-04-24T11:38:18.018185 #9300]  INFO -- default-precise32:     +        if ( -e "$enabldir/mpm_prefork.load" || -e "$enabldir/mpm_itk.load" )
I, [2015-04-24T11:38:18.020207 #9300]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:38:18.022295 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:18.024231 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:18.026430 #9300]  INFO -- default-precise32:     +        elsif (-e "$enabldir/mpm_worker.load"
I, [2015-04-24T11:38:18.028430 #9300]  INFO -- default-precise32:     +            || -e "$enabldir/mpm_event.load" )
I, [2015-04-24T11:38:18.033563 #9300]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:38:18.033830 #9300]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:38:18.034599 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:18.036483 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:18.038527 #9300]  INFO -- default-precise32:     +            error("Can't determine enabled MPM");
I, [2015-04-24T11:38:18.040275 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.042448 #9300]  INFO -- default-precise32:     +            # do what user requested
I, [2015-04-24T11:38:18.044742 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:18.047175 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:18.049061 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.051359 #9300]  INFO -- default-precise32:     +    if ( $result =~ / no/ ) {
I, [2015-04-24T11:38:18.053243 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:18.055247 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.057125 #9300]  INFO -- default-precise32:     +    elsif ( $result =~ / yes/ ) {
I, [2015-04-24T11:38:18.059250 #9300]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:38:18.063431 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.063701 #9300]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:38:18.066090 #9300]  INFO -- default-precise32:     +        die("Can't parse output from apache2ctl -V:\n$result\n");
I, [2015-04-24T11:38:18.068058 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.070448 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:18.072097 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.074301 #9300]  INFO -- default-precise32:     +sub info {
I, [2015-04-24T11:38:18.076324 #9300]  INFO -- default-precise32:     +    print @_ if !$quiet;
I, [2015-04-24T11:38:18.079366 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:18.080512 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.082849 #9300]  INFO -- default-precise32:     +sub error {
I, [2015-04-24T11:38:18.084959 #9300]  INFO -- default-precise32:     +    print STDERR 'ERROR: ', @_;
I, [2015-04-24T11:38:18.087444 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:18.089159 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.092492 #9300]  INFO -- default-precise32:     +sub warning {
I, [2015-04-24T11:38:18.093649 #9300]  INFO -- default-precise32:     +    print STDERR 'WARNING: ', @_;
I, [2015-04-24T11:38:18.095819 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:18.097931 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.099942 #9300]  INFO -- default-precise32:     +sub is_in {
I, [2015-04-24T11:38:18.102244 #9300]  INFO -- default-precise32:     +    my $needle = shift;
I, [2015-04-24T11:38:18.104163 #9300]  INFO -- default-precise32:     +    foreach my $e (@_) {
I, [2015-04-24T11:38:18.106292 #9300]  INFO -- default-precise32:     +        return 1 if $needle eq $e;
I, [2015-04-24T11:38:18.108449 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.110557 #9300]  INFO -- default-precise32:     +    return 0;
I, [2015-04-24T11:38:18.112880 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:18.115219 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.117054 #9300]  INFO -- default-precise32:     +sub read_env_file {
I, [2015-04-24T11:38:18.121530 #9300]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:38:18.121840 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.124092 #9300]  INFO -- default-precise32:     +    -r $file or return;
I, [2015-04-24T11:38:18.126415 #9300]  INFO -- default-precise32:     +    my @lines = qx{env - sh -c '. $file && env'};
I, [2015-04-24T11:38:18.128306 #9300]  INFO -- default-precise32:     +    if ($?) {
I, [2015-04-24T11:38:18.139163 #9300]  INFO -- default-precise32:     +        die "Could not read $file\n";
I, [2015-04-24T11:38:18.139457 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.139719 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.140000 #9300]  INFO -- default-precise32:     +    foreach my $l (@lines) {
I, [2015-04-24T11:38:18.140272 #9300]  INFO -- default-precise32:     +        chomp $l;
I, [2015-04-24T11:38:18.142348 #9300]  INFO -- default-precise32:     +        $l =~ /^(.*)?=(.*)$/ or die "Could not parse $file\n";
I, [2015-04-24T11:38:18.145021 #9300]  INFO -- default-precise32:     +        $ENV{$1} = $2;
I, [2015-04-24T11:38:18.147482 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.150436 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:18.152493 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.155297 #9300]  INFO -- default-precise32:     +sub switch_marker {
I, [2015-04-24T11:38:18.157905 #9300]  INFO -- default-precise32:     +    die('usage: switch_marker([module|site|conf], [enable|disable], $name)')
I, [2015-04-24T11:38:18.160788 #9300]  INFO -- default-precise32:     +        if @_ != 3;
I, [2015-04-24T11:38:18.163435 #9300]  INFO -- default-precise32:     +    my $which = shift;
I, [2015-04-24T11:38:18.166168 #9300]  INFO -- default-precise32:     +    my $what  = shift;
I, [2015-04-24T11:38:18.168282 #9300]  INFO -- default-precise32:     +    my $name  = shift;
I, [2015-04-24T11:38:18.170373 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.172480 #9300]  INFO -- default-precise32:     +    my $mode = "admin";
I, [2015-04-24T11:38:18.175369 #9300]  INFO -- default-precise32:     +    $mode = "maint" if $maintmode;
I, [2015-04-24T11:38:18.177428 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.179655 #9300]  INFO -- default-precise32:     +    #print("switch_marker $which $what $name\n");
I, [2015-04-24T11:38:18.182103 #9300]  INFO -- default-precise32:     +    # TODO: get rid of the magic string(s)
I, [2015-04-24T11:38:18.185355 #9300]  INFO -- default-precise32:     +    my $state_marker_dir = "$statedir/$what" . "d" . "_by_$mode";
I, [2015-04-24T11:38:18.186710 #9300]  INFO -- default-precise32:     +    my $state_marker     = "$state_marker_dir/$name";
I, [2015-04-24T11:38:18.188838 #9300]  INFO -- default-precise32:     +    if ( !-d $state_marker_dir ) {
I, [2015-04-24T11:38:18.191028 #9300]  INFO -- default-precise32:     +        File::Path::mkpath("$state_marker_dir")
I, [2015-04-24T11:38:18.193269 #9300]  INFO -- default-precise32:     +            || error(
I, [2015-04-24T11:38:18.195345 #9300]  INFO -- default-precise32:     +            "Failed to create marker directory: '$state_marker_dir'\n");
I, [2015-04-24T11:38:18.197465 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.199656 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.202057 #9300]  INFO -- default-precise32:     +    # XXX: swap find with perl alternative
I, [2015-04-24T11:38:18.204088 #9300]  INFO -- default-precise32:     +    my @markers = qx{find "$statedir" -type f -a -name "$name"};
I, [2015-04-24T11:38:18.206431 #9300]  INFO -- default-precise32:     +    chomp(@markers);
I, [2015-04-24T11:38:18.210875 #9300]  INFO -- default-precise32:     +    foreach (@markers) {
I, [2015-04-24T11:38:18.211159 #9300]  INFO -- default-precise32:     +        unless ( unlink $_ ) {
I, [2015-04-24T11:38:18.213024 #9300]  INFO -- default-precise32:     +            error("Failed to remove old marker '$_'!\n") && return 0;
I, [2015-04-24T11:38:18.215040 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:18.217099 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.219189 #9300]  INFO -- default-precise32:     +    unless ($purge) {
I, [2015-04-24T11:38:18.221485 #9300]  INFO -- default-precise32:     +        qx{touch "$state_marker"};
I, [2015-04-24T11:38:18.223628 #9300]  INFO -- default-precise32:     +        if ( $? != 0 ) {
I, [2015-04-24T11:38:18.225914 #9300]  INFO -- default-precise32:     +            error("Failed to create marker '$state_marker'!\n") && return 0;
I, [2015-04-24T11:38:18.228049 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:18.230095 #9300]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:38:18.232575 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.235476 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:18.239731 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.243473 #9300]  INFO -- default-precise32:     +# vim: syntax=perl sw=4 sts=4 sr et
I, [2015-04-24T11:38:18.246022 #9300]  INFO -- default-precise32:     - change mode from '' to '0700'
I, [2015-04-24T11:38:18.248126 #9300]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:38:18.251439 #9300]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:38:18.254830 #9300]  INFO -- default-precise32:   * link[/usr/sbin/a2enconf] action delete (skipped due to only_if)
I, [2015-04-24T11:38:18.262301 #9300]  INFO -- default-precise32:   * template[/usr/sbin/a2enconf] action create
I, [2015-04-24T11:38:18.276232 #9300]  INFO -- default-precise32:     - create new file /usr/sbin/a2enconf
I, [2015-04-24T11:38:18.279014 #9300]  INFO -- default-precise32:     - update content in file /usr/sbin/a2enconf from none to ce53f4
I, [2015-04-24T11:38:18.282466 #9300]  INFO -- default-precise32:     --- /usr/sbin/a2enconf	2015-04-24 08:38:18.252716142 +0000
I, [2015-04-24T11:38:18.286065 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-15fngvy	2015-04-24 08:38:18.252716142 +0000
I, [2015-04-24T11:38:18.288398 #9300]  INFO -- default-precise32:     @@ -1 +1,533 @@
I, [2015-04-24T11:38:18.290145 #9300]  INFO -- default-precise32:     +#!/usr/bin/perl -w
I, [2015-04-24T11:38:18.291934 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:18.294274 #9300]  INFO -- default-precise32:     +# a2enmod by Stefan Fritsch <sf@debian.org>
I, [2015-04-24T11:38:18.298483 #9300]  INFO -- default-precise32:     +# Licensed under Apache License 2.0
I, [2015-04-24T11:38:18.298752 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:18.300208 #9300]  INFO -- default-precise32:     +# The coding style is "perltidy -pbp"
I, [2015-04-24T11:38:18.302438 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.304818 #9300]  INFO -- default-precise32:     +use strict;
I, [2015-04-24T11:38:18.307257 #9300]  INFO -- default-precise32:     +use Cwd 'realpath';
I, [2015-04-24T11:38:18.308519 #9300]  INFO -- default-precise32:     +use File::Spec;
I, [2015-04-24T11:38:18.310755 #9300]  INFO -- default-precise32:     +use File::Basename;
I, [2015-04-24T11:38:18.313088 #9300]  INFO -- default-precise32:     +use File::Path;
I, [2015-04-24T11:38:18.314540 #9300]  INFO -- default-precise32:     +use Getopt::Long;
I, [2015-04-24T11:38:18.316541 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.318468 #9300]  INFO -- default-precise32:     +my $quiet;
I, [2015-04-24T11:38:18.320495 #9300]  INFO -- default-precise32:     +my $force;
I, [2015-04-24T11:38:18.322524 #9300]  INFO -- default-precise32:     +my $maintmode;
I, [2015-04-24T11:38:18.323943 #9300]  INFO -- default-precise32:     +my $purge;
I, [2015-04-24T11:38:18.325558 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.328400 #9300]  INFO -- default-precise32:     +Getopt::Long::Configure('bundling');
I, [2015-04-24T11:38:18.331381 #9300]  INFO -- default-precise32:     +GetOptions(
I, [2015-04-24T11:38:18.332437 #9300]  INFO -- default-precise32:     +    'quiet|q'     => \$quiet,
I, [2015-04-24T11:38:18.334681 #9300]  INFO -- default-precise32:     +    'force|f'     => \$force,
I, [2015-04-24T11:38:18.337146 #9300]  INFO -- default-precise32:     +    'maintmode|m' => \$maintmode,
I, [2015-04-24T11:38:18.339510 #9300]  INFO -- default-precise32:     +    'purge|p'     => \$purge
I, [2015-04-24T11:38:18.341583 #9300]  INFO -- default-precise32:     +) or exit 2;
I, [2015-04-24T11:38:18.343539 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.345513 #9300]  INFO -- default-precise32:     +my $basename = basename($0);
I, [2015-04-24T11:38:18.347500 #9300]  INFO -- default-precise32:     +$basename =~ /^a2(en|dis)(mod|site|conf)((?:-.+)?)$/
I, [2015-04-24T11:38:18.349420 #9300]  INFO -- default-precise32:     +    or die "$basename call name unknown\n";
I, [2015-04-24T11:38:18.352458 #9300]  INFO -- default-precise32:     +my $act        = $1;
I, [2015-04-24T11:38:18.353488 #9300]  INFO -- default-precise32:     +my $obj        = $2;
I, [2015-04-24T11:38:18.357203 #9300]  INFO -- default-precise32:     +my $dir_suffix = $3;
I, [2015-04-24T11:38:18.357479 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.359514 #9300]  INFO -- default-precise32:     +my $env_file = $ENV{APACHE_ENVVARS}
I, [2015-04-24T11:38:18.361143 #9300]  INFO -- default-precise32:     +    || (
I, [2015-04-24T11:38:18.362896 #9300]  INFO -- default-precise32:     +    $ENV{APACHE_CONFDIR}
I, [2015-04-24T11:38:18.364350 #9300]  INFO -- default-precise32:     +    ? "$ENV{APACHE_CONFDIR}/envvars"
I, [2015-04-24T11:38:18.367347 #9300]  INFO -- default-precise32:     +    : "/etc/apache2$dir_suffix/envvars"
I, [2015-04-24T11:38:18.367472 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:18.369452 #9300]  INFO -- default-precise32:     +$ENV{LANG} = 'C';
I, [2015-04-24T11:38:18.371545 #9300]  INFO -- default-precise32:     +read_env_file($env_file);
I, [2015-04-24T11:38:18.372469 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:18.374460 #9300]  INFO -- default-precise32:     +$act .= 'able';
I, [2015-04-24T11:38:18.376396 #9300]  INFO -- default-precise32: +my ( $name, $dir, $sffx, $reload );
I, [2015-04-24T11:38:18.377464 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:18.378470 #9300]  INFO -- default-precise32:     +    $obj    = 'module';
I, [2015-04-24T11:38:18.379381 #9300]  INFO -- default-precise32: +    $dir    = 'mods';
I, [2015-04-24T11:38:18.380559 #9300]  INFO -- default-precise32:     +    $sffx   = '.load';
I, [2015-04-24T11:38:18.382407 #9300]  INFO -- default-precise32:     +    $reload = 'restart';
I, [2015-04-24T11:38:18.386491 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:18.386628 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:18.387430 #9300]  INFO -- default-precise32: +    $obj    = 'conf';
I, [2015-04-24T11:38:18.389077 #9300]  INFO -- default-precise32:     +    $dir    = 'conf';
I, [2015-04-24T11:38:18.392414 #9300]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:38:18.392446 #9300]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:38:18.392667 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:18.394275 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:18.395755 #9300]  INFO -- default-precise32:     +    $dir    = 'sites';
I, [2015-04-24T11:38:18.398445 #9300]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:38:18.400310 #9300]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:38:18.400341 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:18.401425 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:18.404424 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.406272 #9300]  INFO -- default-precise32: +my $confdir = $ENV{APACHE_CONFDIR} || "/etc/apache2$dir_suffix";
I, [2015-04-24T11:38:18.407611 #9300]  INFO -- default-precise32:     +my $availdir = $ENV{ uc("APACHE_${dir}_AVAILABLE") }
I, [2015-04-24T11:38:18.410426 #9300]  INFO -- default-precise32:     +    || "$confdir/$dir-available";
I, [2015-04-24T11:38:18.412273 #9300]  INFO -- default-precise32:     +my $enabldir = $ENV{ uc("APACHE_${dir}_ENABLED") } || "$confdir/$dir-enabled";
I, [2015-04-24T11:38:18.415245 #9300]  INFO -- default-precise32:     +my $statedir = $ENV{ uc("APACHE_STATE_DIRECTORY") } || "/usr/lib/apache2";
I, [2015-04-24T11:38:18.417473 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.419592 #9300]  INFO -- default-precise32:     +$statedir .= "/$obj";
I, [2015-04-24T11:38:18.422423 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.424439 #9300]  INFO -- default-precise32:     +my $choicedir = $act eq 'enable' ? $availdir : $enabldir;
I, [2015-04-24T11:38:18.426447 #9300]  INFO -- default-precise32: +my $linkdir = File::Spec->abs2rel( $availdir, $enabldir );
I, [2015-04-24T11:38:18.428562 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.430215 #9300]  INFO -- default-precise32:     +my $request_reload = 0;
I, [2015-04-24T11:38:18.432414 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.434598 #9300]  INFO -- default-precise32:     +my $rc = 0;
I, [2015-04-24T11:38:18.437106 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.439801 #9300]  INFO -- default-precise32:     +if ( !scalar @ARGV ) {
I, [2015-04-24T11:38:18.442425 #9300]  INFO -- default-precise32:     +    my @choices = myglob('*');
I, [2015-04-24T11:38:18.445167 #9300]  INFO -- default-precise32:     +    print "Your choices are: @choices\n";
I, [2015-04-24T11:38:18.447944 #9300]  INFO -- default-precise32:     +    print "Which ${obj}(s) do you want to $act (wildcards ok)?\n";
I, [2015-04-24T11:38:18.450524 #9300]  INFO -- default-precise32:     +    my $input = <>;
I, [2015-04-24T11:38:18.452613 #9300]  INFO -- default-precise32:     +    @ARGV = split /\s+/, $input;
I, [2015-04-24T11:38:18.455198 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.458419 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:18.459628 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.462171 #9300]  INFO -- default-precise32:     +my @objs;
I, [2015-04-24T11:38:18.464625 #9300]  INFO -- default-precise32:     +foreach my $arg (@ARGV) {
I, [2015-04-24T11:38:18.467127 #9300]  INFO -- default-precise32:     +    $arg =~ s/${sffx}$//;
I, [2015-04-24T11:38:18.469722 #9300]  INFO -- default-precise32:     +    my @glob = myglob($arg);
I, [2015-04-24T11:38:18.472161 #9300]  INFO -- default-precise32:     +    if ( !@glob ) {
I, [2015-04-24T11:38:18.475119 #9300]  INFO -- default-precise32:     +        error("No $obj found matching $arg!\n");
I, [2015-04-24T11:38:18.477869 #9300]  INFO -- default-precise32:     +        $rc = 1;
I, [2015-04-24T11:38:18.480142 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.482391 #9300]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:38:18.484791 #9300]  INFO -- default-precise32:     +        push @objs, @glob;
I, [2015-04-24T11:38:18.487098 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.489418 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:18.491586 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.494141 #9300]  INFO -- default-precise32:     +foreach my $acton (@objs) {
I, [2015-04-24T11:38:18.496413 #9300]  INFO -- default-precise32:     +    doit($acton) or $rc = 1;
I, [2015-04-24T11:38:18.498586 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:18.500683 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.503098 #9300]  INFO -- default-precise32:     +info(
I, [2015-04-24T11:38:18.505887 #9300]  INFO -- default-precise32:     +    "To activate the new configuration, you need to run:\n  service apache2 $reload\n"
I, [2015-04-24T11:38:18.508504 #9300]  INFO -- default-precise32:     +) if $request_reload;
I, [2015-04-24T11:38:18.510932 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.513418 #9300]  INFO -- default-precise32:     +exit($rc);
I, [2015-04-24T11:38:18.515460 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.518522 #9300]  INFO -- default-precise32:     +##############################################################################
I, [2015-04-24T11:38:18.519722 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.522053 #9300]  INFO -- default-precise32:     +sub myglob {
I, [2015-04-24T11:38:18.524533 #9300]  INFO -- default-precise32:     +    my $arg = shift;
I, [2015-04-24T11:38:18.525948 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.528102 #9300]  INFO -- default-precise32:     +    my @glob = map {
I, [2015-04-24T11:38:18.530111 #9300]  INFO -- default-precise32:     +        s{^$choicedir/}{};
I, [2015-04-24T11:38:18.532018 #9300]  INFO -- default-precise32:     +        s{$sffx$}{};
I, [2015-04-24T11:38:18.535013 #9300]  INFO -- default-precise32:     +        $_
I, [2015-04-24T11:38:18.536480 #9300]  INFO -- default-precise32:     +    } glob("$choicedir/$arg$sffx");
I, [2015-04-24T11:38:18.538477 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.540400 #9300]  INFO -- default-precise32:     +    return @glob;
I, [2015-04-24T11:38:18.542463 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:18.544377 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.546518 #9300]  INFO -- default-precise32:     +sub doit {
I, [2015-04-24T11:38:18.549438 #9300]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:38:18.551752 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.553991 #9300]  INFO -- default-precise32:     +    my ( $conftgt, $conflink );
I, [2015-04-24T11:38:18.556317 #9300]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:38:18.558591 #9300]  INFO -- default-precise32:     +        if ( $acton eq 'cgi' && threaded() ) {
I, [2015-04-24T11:38:18.561089 #9300]  INFO -- default-precise32:     +            print
I, [2015-04-24T11:38:18.563418 #9300]  INFO -- default-precise32:     +                "Your MPM seems to be threaded. Selecting cgid instead of cgi.\n";
I, [2015-04-24T11:38:18.565583 #9300]  INFO -- default-precise32:     +            $acton = 'cgid';
I, [2015-04-24T11:38:18.568454 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:18.570726 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.573324 #9300]  INFO -- default-precise32:     +        $conftgt = "$availdir/$acton.conf";
I, [2015-04-24T11:38:18.575436 #9300]  INFO -- default-precise32:     +        if ( -e $conftgt ) {
I, [2015-04-24T11:38:18.578233 #9300]  INFO -- default-precise32:     +            $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:38:18.580447 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:18.583421 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.585422 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.587581 #9300]  INFO -- default-precise32:     +    my $tgt  = "$availdir/$acton$sffx";
I, [2015-04-24T11:38:18.590461 #9300]  INFO -- default-precise32:     +    my $link = "$enabldir/$acton$sffx";
I, [2015-04-24T11:38:18.592136 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.594590 #9300]  INFO -- default-precise32:     +    if ( !-e $tgt ) {
I, [2015-04-24T11:38:18.597128 #9300]  INFO -- default-precise32:     +        if ( -l $link && !-e $link ) {
I, [2015-04-24T11:38:18.599402 #9300]  INFO -- default-precise32:     +            if ( $act eq 'disable' ) {
I, [2015-04-24T11:38:18.602034 #9300]  INFO -- default-precise32:     +                info("removing dangling symlink $link\n");
I, [2015-04-24T11:38:18.604445 #9300]  INFO -- default-precise32:     +                unlink($link);
I, [2015-04-24T11:38:18.607055 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.609423 #9300]  INFO -- default-precise32:     +                # force a .conf path. It may exist as dangling link, too
I, [2015-04-24T11:38:18.611581 #9300]  INFO -- default-precise32:     +                $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:38:18.614134 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.616374 #9300]  INFO -- default-precise32:     +                if ( -l $conflink && !-e $conflink ) {
I, [2015-04-24T11:38:18.618941 #9300]  INFO -- default-precise32:     +                    info("removing dangling symlink $conflink\n");
I, [2015-04-24T11:38:18.621083 #9300]  INFO -- default-precise32:     +                    unlink($conflink);
I, [2015-04-24T11:38:18.623587 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:18.626196 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.628426 #9300]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:38:18.631110 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:18.634135 #9300]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:38:18.642227 #9300]  INFO -- default-precise32:     +                error("$link is a dangling symlink!\n");
I, [2015-04-24T11:38:18.645674 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:18.649857 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:18.651891 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.654351 #9300]  INFO -- default-precise32:     +        if ( $purge ) {
I, [2015-04-24T11:38:18.656813 #9300]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:18.659718 #9300]  INFO -- default-precise32:     +            # exit silently, we are purging anyway
I, [2015-04-24T11:38:18.662027 #9300]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:38:18.664415 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:18.666212 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.668346 #9300]  INFO -- default-precise32:     +        error("$name $acton does not exist!\n");
I, [2015-04-24T11:38:18.670949 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:18.673457 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.675955 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.678436 #9300]  INFO -- default-precise32:     +    # handle module dependencies
I, [2015-04-24T11:38:18.680900 #9300]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:38:18.683023 #9300]  INFO -- default-precise32:     +        if ( $act eq 'enable' ) {
I, [2015-04-24T11:38:18.685365 #9300]  INFO -- default-precise32:     +            if ( $acton eq 'mpm_itk' ) {
I, [2015-04-24T11:38:18.688016 #9300]  INFO -- default-precise32:     +                warning(  "MPM_ITK is a third party module that is not part "
I, [2015-04-24T11:38:18.690466 #9300]  INFO -- default-precise32:     +                        . "of the official Apache HTTPD. It has seen less "
I, [2015-04-24T11:38:18.692566 #9300]  INFO -- default-precise32:     +                        . "testing than the official MPM modules." );
I, [2015-04-24T11:38:18.695035 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:18.697179 #9300]  INFO -- default-precise32:     +            my @depends = get_deps("$availdir/$acton.load");
I, [2015-04-24T11:38:18.699627 #9300]  INFO -- default-precise32:     +            do_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:38:18.702150 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.704303 #9300]  INFO -- default-precise32:     +            my @conflicts = get_deps( "$availdir/$acton.load", "Conflicts" );
I, [2015-04-24T11:38:18.706957 #9300]  INFO -- default-precise32:     +            check_conflicts( $acton, @conflicts ) or return 0;
I, [2015-04-24T11:38:18.709410 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:18.711469 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:18.714061 #9300]  INFO -- default-precise32:     +            my @depending;
I, [2015-04-24T11:38:18.716217 #9300]  INFO -- default-precise32:     +            foreach my $d ( glob("$enabldir/*.load") ) {
I, [2015-04-24T11:38:18.718619 #9300]  INFO -- default-precise32:     +                my @deps = get_deps($d);
I, [2015-04-24T11:38:18.720744 #9300]  INFO -- default-precise32:     +                if ( is_in( $acton, @deps ) ) {
I, [2015-04-24T11:38:18.723269 #9300]  INFO -- default-precise32:     +                    $d =~ m,/([^/]+).load$,;
I, [2015-04-24T11:38:18.725622 #9300]  INFO -- default-precise32:     +                    push @depending, $1;
I, [2015-04-24T11:38:18.727546 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:18.730081 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:18.732445 #9300]  INFO -- default-precise32:     +            if ( scalar @depending ) {
I, [2015-04-24T11:38:18.735378 #9300]  INFO -- default-precise32:     +                if ($force) {
I, [2015-04-24T11:38:18.738001 #9300]  INFO -- default-precise32:     +                    do_deps( $acton, @depending ) or return 0;
I, [2015-04-24T11:38:18.740289 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:18.742496 #9300]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:38:18.744901 #9300]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:38:18.747350 #9300]  INFO -- default-precise32:     +                        "The following modules depend on $acton ",
I, [2015-04-24T11:38:18.749664 #9300]  INFO -- default-precise32:     +                        "and need to be disabled first: @depending\n"
I, [2015-04-24T11:38:18.751913 #9300]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:38:18.754299 #9300]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:38:18.756707 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:18.759299 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:18.761420 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:18.763993 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.766131 #9300]  INFO -- default-precise32:     +    elsif ( $act eq 'enable' ) {
I, [2015-04-24T11:38:18.768471 #9300]  INFO -- default-precise32:     +        my @depends = get_deps("$availdir/$acton$sffx");
I, [2015-04-24T11:38:18.771198 #9300]  INFO -- default-precise32:     +        warn_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:38:18.774310 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.776039 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.778611 #9300]  INFO -- default-precise32:     +    if ( $act eq 'enable' ) {
I, [2015-04-24T11:38:18.781002 #9300]  INFO -- default-precise32:     +        my $check = check_link( $tgt, $link );
I, [2015-04-24T11:38:18.783306 #9300]  INFO -- default-precise32:     +        if ( $check eq 'ok' ) {
I, [2015-04-24T11:38:18.786144 #9300]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:38:18.787896 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.790637 #9300]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:38:18.793041 #9300]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:38:18.795430 #9300]  INFO -- default-precise32:     +                if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:38:18.797926 #9300]  INFO -- default-precise32:     +                    info("$name $acton already enabled\n");
I, [2015-04-24T11:38:18.800341 #9300]  INFO -- default-precise32:     +                    return 1;
I, [2015-04-24T11:38:18.802974 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:18.805895 #9300]  INFO -- default-precise32:     +                elsif ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:38:18.808194 #9300]  INFO -- default-precise32:     +                    print "Enabling config file $acton.conf.\n";
I, [2015-04-24T11:38:18.810995 #9300]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:38:18.813392 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:18.815806 #9300]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:38:18.818279 #9300]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:38:18.820746 #9300]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:38:18.823270 #9300]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:38:18.825407 #9300]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:38:18.828036 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:18.830437 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:18.833406 #9300]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:38:18.835953 #9300]  INFO -- default-precise32:     +                info("$name $acton already enabled\n");
I, [2015-04-24T11:38:18.839182 #9300]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:38:18.841857 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:18.844380 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:18.846961 #9300]  INFO -- default-precise32:     +        elsif ( $check eq 'missing' ) {
I, [2015-04-24T11:38:18.850158 #9300]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:38:18.851948 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.854833 #9300]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:38:18.857200 #9300]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:38:18.859428 #9300]  INFO -- default-precise32:     +                if ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:38:18.862441 #9300]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:38:18.865226 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:18.867913 #9300]  INFO -- default-precise32:     +                elsif ( $confcheck ne 'ok' ) {
I, [2015-04-24T11:38:18.870805 #9300]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:38:18.873115 #9300]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:38:18.875943 #9300]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:38:18.878990 #9300]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:38:18.881454 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:18.884466 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:18.886942 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.889789 #9300]  INFO -- default-precise32:     +            print "Enabling $obj $acton.\n";
I, [2015-04-24T11:38:18.892429 #9300]  INFO -- default-precise32:     +            if ( $acton eq 'ssl' ) {
I, [2015-04-24T11:38:18.895181 #9300]  INFO -- default-precise32:     +                info(     "See /usr/share/doc/apache2/README.Debian.gz on "
I, [2015-04-24T11:38:18.897618 #9300]  INFO -- default-precise32:     +                        . "how to configure SSL and create self-signed certificates.\n"
I, [2015-04-24T11:38:18.900450 #9300]  INFO -- default-precise32:     +                );
I, [2015-04-24T11:38:18.902919 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:18.906193 #9300]  INFO -- default-precise32:     +            return add_link( $tgt, $link )
I, [2015-04-24T11:38:18.908805 #9300]  INFO -- default-precise32:     +                && switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:18.911437 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:18.914176 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:18.916892 #9300]  INFO -- default-precise32:     +            error("$name $acton not properly enabled: $check\n");
I, [2015-04-24T11:38:18.919526 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:18.926656 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:18.930165 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.932862 #9300]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:38:18.935306 #9300]  INFO -- default-precise32:     +        if ( -e $link || -l $link ) {
I, [2015-04-24T11:38:18.937891 #9300]  INFO -- default-precise32:     +            remove_link($link);
I, [2015-04-24T11:38:18.940424 #9300]  INFO -- default-precise32:     +            if ( $conflink && -e $conflink ) {
I, [2015-04-24T11:38:18.943797 #9300]  INFO -- default-precise32:     +                remove_link($conflink);
I, [2015-04-24T11:38:18.946426 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:18.948611 #9300]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:18.951421 #9300]  INFO -- default-precise32:     +            print "$name $acton disabled.\n";
I, [2015-04-24T11:38:18.954381 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:18.957107 #9300]  INFO -- default-precise32:     +        elsif ( $conflink && -e $conflink ) {
I, [2015-04-24T11:38:18.959833 #9300]  INFO -- default-precise32:     +            print "Disabling stale config file $acton.conf.\n";
I, [2015-04-24T11:38:18.962403 #9300]  INFO -- default-precise32:     +            remove_link($conflink);
I, [2015-04-24T11:38:18.965096 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:18.967770 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:18.970470 #9300]  INFO -- default-precise32:     +            info("$name $acton already disabled\n");
I, [2015-04-24T11:38:18.973149 #9300]  INFO -- default-precise32:     +            if ( $purge ) {
I, [2015-04-24T11:38:18.975453 #9300]  INFO -- default-precise32:     +                switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:18.978152 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:18.980426 #9300]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:38:18.982964 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:18.985906 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:18.988064 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.990648 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:18.993141 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:18.995131 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:18.998342 #9300]  INFO -- default-precise32:     +sub get_deps {
I, [2015-04-24T11:38:19.000429 #9300]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:38:19.004313 #9300]  INFO -- default-precise32:     +    my $type = shift || "Depends";
I, [2015-04-24T11:38:19.007823 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.012996 #9300]  INFO -- default-precise32:     +    my $fd;
I, [2015-04-24T11:38:19.015646 #9300]  INFO -- default-precise32:     +    if ( !open( $fd, '<', $file ) ) {
I, [2015-04-24T11:38:19.017863 #9300]  INFO -- default-precise32:     +        error("Can't open $file: $!");
I, [2015-04-24T11:38:19.019746 #9300]  INFO -- default-precise32:     +        return;
I, [2015-04-24T11:38:19.021952 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.024078 #9300]  INFO -- default-precise32:     +    my $line;
I, [2015-04-24T11:38:19.026053 #9300]  INFO -- default-precise32:     +    while ( defined( $line = <$fd> ) ) {
I, [2015-04-24T11:38:19.027904 #9300]  INFO -- default-precise32:     +        chomp $line;
I, [2015-04-24T11:38:19.029865 #9300]  INFO -- default-precise32:     +        if ( $line =~ /^# $type:\s+(.*?)\s*$/ ) {
I, [2015-04-24T11:38:19.033010 #9300]  INFO -- default-precise32:     +            my $deps = $1;
I, [2015-04-24T11:38:19.033988 #9300]  INFO -- default-precise32:     +            return split( /[\n\s]+/, $deps );
I, [2015-04-24T11:38:19.036322 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:19.038172 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.042002 #9300]  INFO -- default-precise32:     +        # only check until the first non-empty non-comment line
I, [2015-04-24T11:38:19.044688 #9300]  INFO -- default-precise32:     +        last if ( $line !~ /^\s*(?:#.*)?$/ );
I, [2015-04-24T11:38:19.047818 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.050353 #9300]  INFO -- default-precise32:     +    return;
I, [2015-04-24T11:38:19.052834 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.055221 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.057822 #9300]  INFO -- default-precise32:     +sub do_deps {
I, [2015-04-24T11:38:19.060132 #9300]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:38:19.063114 #9300]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:38:19.065448 #9300]  INFO -- default-precise32:     +        info("Considering dependency $d for $acton:\n");
I, [2015-04-24T11:38:19.068418 #9300]  INFO -- default-precise32:     +        if ( !doit($d) ) {
I, [2015-04-24T11:38:19.071273 #9300]  INFO -- default-precise32:     +            error("Could not $act dependency $d for $acton, aborting\n");
I, [2015-04-24T11:38:19.073742 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:19.075988 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:19.078927 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.081368 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:19.083689 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.086225 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.088461 #9300]  INFO -- default-precise32:     +sub warn_deps {
I, [2015-04-24T11:38:19.091264 #9300]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:38:19.093796 #9300]  INFO -- default-precise32:     +    my $modsenabldir = $ENV{APACHE_MODS_ENABLED} || "$confdir/mods-enabled";
I, [2015-04-24T11:38:19.096201 #9300]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:38:19.098994 #9300]  INFO -- default-precise32:     +        info("Checking dependency $d for $acton:\n");
I, [2015-04-24T11:38:19.101969 #9300]  INFO -- default-precise32:     +        if ( !-e "$modsenabldir/$d.load" ) {
I, [2015-04-24T11:38:19.104659 #9300]  INFO -- default-precise32:     +            warning(
I, [2015-04-24T11:38:19.107436 #9300]  INFO -- default-precise32:     +                "Module $d is not enabled, but $acton depends on it, aborting\n"
I, [2015-04-24T11:38:19.110127 #9300]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:38:19.112455 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:19.114524 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:19.116609 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.119383 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:19.122053 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.124122 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.126985 #9300]  INFO -- default-precise32:     +sub check_conflicts {
I, [2015-04-24T11:38:19.129375 #9300]  INFO -- default-precise32:     +    my $acton    = shift;
I, [2015-04-24T11:38:19.132302 #9300]  INFO -- default-precise32:     +    my $haderror = 0;
I, [2015-04-24T11:38:19.135113 #9300]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:38:19.137919 #9300]  INFO -- default-precise32:     +        info("Considering conflict $d for $acton:\n");
I, [2015-04-24T11:38:19.139828 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.142314 #9300]  INFO -- default-precise32:     +        my $tgt  = "$availdir/$d$sffx";
I, [2015-04-24T11:38:19.145123 #9300]  INFO -- default-precise32:     +        my $link = "$enabldir/$d$sffx";
I, [2015-04-24T11:38:19.147133 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.149925 #9300]  INFO -- default-precise32:     +        my $confcheck = check_link( $tgt, $link );
I, [2015-04-24T11:38:19.152314 #9300]  INFO -- default-precise32:     +        if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:38:19.155175 #9300]  INFO -- default-precise32:     +            error(
I, [2015-04-24T11:38:19.157382 #9300]  INFO -- default-precise32:     +                "Module $d is enabled - cannot proceed due to conflicts. It needs to be disabled first!\n"
I, [2015-04-24T11:38:19.160451 #9300]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:38:19.162856 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.165441 #9300]  INFO -- default-precise32:     +            # Don't return immediately, there could be several conflicts
I, [2015-04-24T11:38:19.168135 #9300]  INFO -- default-precise32:     +            $haderror++;
I, [2015-04-24T11:38:19.170916 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:19.173406 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.175466 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.178351 #9300]  INFO -- default-precise32:     +    if ($haderror) {
I, [2015-04-24T11:38:19.180704 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:19.183416 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.185110 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.188071 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:19.191141 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.192981 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.195435 #9300]  INFO -- default-precise32:     +sub add_link {
I, [2015-04-24T11:38:19.198333 #9300]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:38:19.200598 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.203050 #9300]  INFO -- default-precise32:     +    # create relative link
I, [2015-04-24T11:38:19.205832 #9300]  INFO -- default-precise32:     +    if ( !symlink( File::Spec->abs2rel( $tgt, dirname($link) ), $link ) ) {
I, [2015-04-24T11:38:19.208338 #9300]  INFO -- default-precise32:     +        die("Could not create $link: $!\n");
I, [2015-04-24T11:38:19.210846 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.213159 #9300]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:38:19.216075 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:19.218842 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.221281 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.223424 #9300]  INFO -- default-precise32:     +sub check_link {
I, [2015-04-24T11:38:19.225802 #9300]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:38:19.227929 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.230411 #9300]  INFO -- default-precise32:     +    if ( !-e $link ) {
I, [2015-04-24T11:38:19.232238 #9300]  INFO -- default-precise32:     +        if ( -l $link ) {
I, [2015-04-24T11:38:19.235017 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.237237 #9300]  INFO -- default-precise32:     +            # points to nowhere
I, [2015-04-24T11:38:19.239804 #9300]  INFO -- default-precise32:     +            info("Removing dangling link $link");
I, [2015-04-24T11:38:19.242157 #9300]  INFO -- default-precise32:     +            unlink($link) or die "Could not remove $link\n";
I, [2015-04-24T11:38:19.244415 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:19.246815 #9300]  INFO -- default-precise32:     +        return 'missing';
I, [2015-04-24T11:38:19.249064 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.251068 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.253139 #9300]  INFO -- default-precise32:     +    if ( -e $link && !-l $link ) {
I, [2015-04-24T11:38:19.255392 #9300]  INFO -- default-precise32:     +        return "$link is a real file, not touching it";
I, [2015-04-24T11:38:19.257465 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.259395 #9300]  INFO -- default-precise32:     +    if ( realpath($link) ne realpath($tgt) ) {
I, [2015-04-24T11:38:19.261251 #9300]  INFO -- default-precise32:     +        return "$link exists but does not point to $tgt, not touching it";
I, [2015-04-24T11:38:19.263098 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.264954 #9300]  INFO -- default-precise32:     +    return 'ok';
I, [2015-04-24T11:38:19.267520 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.268590 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.270885 #9300]  INFO -- default-precise32:     +sub remove_link {
I, [2015-04-24T11:38:19.275282 #9300]  INFO -- default-precise32:     +    my ($link) = @_;
I, [2015-04-24T11:38:19.275602 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.276143 #9300]  INFO -- default-precise32:     +    if ( -l $link ) {
I, [2015-04-24T11:38:19.278534 #9300]  INFO -- default-precise32:     +        unlink($link) or die "Could not remove $link: $!\n";
I, [2015-04-24T11:38:19.280150 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.282165 #9300]  INFO -- default-precise32:     +    elsif ( -e $link ) {
I, [2015-04-24T11:38:19.283955 #9300]  INFO -- default-precise32:     +        error("$link is not a symbolic link, not deleting\n");
I, [2015-04-24T11:38:19.285607 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:19.287557 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.289581 #9300]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:38:19.291901 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:19.294493 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.296065 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.298167 #9300]  INFO -- default-precise32:     +sub threaded {
I, [2015-04-24T11:38:19.300401 #9300]  INFO -- default-precise32:     +    my $result = "";
I, [2015-04-24T11:38:19.304571 #9300]  INFO -- default-precise32:     +    $result = qx{/usr/sbin/apache2ctl -V | grep 'threaded'}
I, [2015-04-24T11:38:19.304840 #9300]  INFO -- default-precise32:     +        if -x '/usr/sbin/apache2ctl';
I, [2015-04-24T11:38:19.306613 #9300]  INFO -- default-precise32:     +    if ( $? != 0 ) {
I, [2015-04-24T11:38:19.308436 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.310522 #9300]  INFO -- default-precise32:     +        # config doesn't work
I, [2015-04-24T11:38:19.312330 #9300]  INFO -- default-precise32:     +        if ( -e "$enabldir/mpm_prefork.load" || -e "$enabldir/mpm_itk.load" )
I, [2015-04-24T11:38:19.314178 #9300]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:38:19.316105 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:19.318030 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:19.319606 #9300]  INFO -- default-precise32:     +        elsif (-e "$enabldir/mpm_worker.load"
I, [2015-04-24T11:38:19.321569 #9300]  INFO -- default-precise32:     +            || -e "$enabldir/mpm_event.load" )
I, [2015-04-24T11:38:19.323571 #9300]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:38:19.325600 #9300]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:38:19.327438 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:19.329837 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:19.334184 #9300]  INFO -- default-precise32:     +            error("Can't determine enabled MPM");
I, [2015-04-24T11:38:19.334494 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.336505 #9300]  INFO -- default-precise32:     +            # do what user requested
I, [2015-04-24T11:38:19.338427 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:19.340090 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:19.342120 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.343943 #9300]  INFO -- default-precise32:     +    if ( $result =~ / no/ ) {
I, [2015-04-24T11:38:19.346054 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:19.347599 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.349340 #9300]  INFO -- default-precise32:     +    elsif ( $result =~ / yes/ ) {
I, [2015-04-24T11:38:19.351444 #9300]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:38:19.353221 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.355113 #9300]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:38:19.356908 #9300]  INFO -- default-precise32:     +        die("Can't parse output from apache2ctl -V:\n$result\n");
I, [2015-04-24T11:38:19.359039 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.364044 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.364331 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.364631 #9300]  INFO -- default-precise32:     +sub info {
I, [2015-04-24T11:38:19.366547 #9300]  INFO -- default-precise32:     +    print @_ if !$quiet;
I, [2015-04-24T11:38:19.368500 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.370137 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.372020 #9300]  INFO -- default-precise32:     +sub error {
I, [2015-04-24T11:38:19.373935 #9300]  INFO -- default-precise32:     +    print STDERR 'ERROR: ', @_;
I, [2015-04-24T11:38:19.375606 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.377371 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.379285 #9300]  INFO -- default-precise32:     +sub warning {
I, [2015-04-24T11:38:19.381152 #9300]  INFO -- default-precise32:     +    print STDERR 'WARNING: ', @_;
I, [2015-04-24T11:38:19.383442 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.384530 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.386501 #9300]  INFO -- default-precise32:     +sub is_in {
I, [2015-04-24T11:38:19.389203 #9300]  INFO -- default-precise32:     +    my $needle = shift;
I, [2015-04-24T11:38:19.392781 #9300]  INFO -- default-precise32:     +    foreach my $e (@_) {
I, [2015-04-24T11:38:19.393150 #9300]  INFO -- default-precise32:     +        return 1 if $needle eq $e;
I, [2015-04-24T11:38:19.395080 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.397268 #9300]  INFO -- default-precise32:     +    return 0;
I, [2015-04-24T11:38:19.399517 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.400959 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.403053 #9300]  INFO -- default-precise32:     +sub read_env_file {
I, [2015-04-24T11:38:19.405050 #9300]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:38:19.407063 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.408640 #9300]  INFO -- default-precise32:     +    -r $file or return;
I, [2015-04-24T11:38:19.410903 #9300]  INFO -- default-precise32:     +    my @lines = qx{env - sh -c '. $file && env'};
I, [2015-04-24T11:38:19.412623 #9300]  INFO -- default-precise32:     +    if ($?) {
I, [2015-04-24T11:38:19.414820 #9300]  INFO -- default-precise32:     +        die "Could not read $file\n";
I, [2015-04-24T11:38:19.416545 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.418753 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.420511 #9300]  INFO -- default-precise32:     +    foreach my $l (@lines) {
I, [2015-04-24T11:38:19.423427 #9300]  INFO -- default-precise32:     +        chomp $l;
I, [2015-04-24T11:38:19.424408 #9300]  INFO -- default-precise32:     +        $l =~ /^(.*)?=(.*)$/ or die "Could not parse $file\n";
I, [2015-04-24T11:38:19.426452 #9300]  INFO -- default-precise32:     +        $ENV{$1} = $2;
I, [2015-04-24T11:38:19.428401 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.430612 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.432135 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.434231 #9300]  INFO -- default-precise32:     +sub switch_marker {
I, [2015-04-24T11:38:19.435975 #9300]  INFO -- default-precise32:     +    die('usage: switch_marker([module|site|conf], [enable|disable], $name)')
I, [2015-04-24T11:38:19.438230 #9300]  INFO -- default-precise32:     +        if @_ != 3;
I, [2015-04-24T11:38:19.440100 #9300]  INFO -- default-precise32:     +    my $which = shift;
I, [2015-04-24T11:38:19.442074 #9300]  INFO -- default-precise32:     +    my $what  = shift;
I, [2015-04-24T11:38:19.444252 #9300]  INFO -- default-precise32:     +    my $name  = shift;
I, [2015-04-24T11:38:19.446042 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.448704 #9300]  INFO -- default-precise32:     +    my $mode = "admin";
I, [2015-04-24T11:38:19.453424 #9300]  INFO -- default-precise32:     +    $mode = "maint" if $maintmode;
I, [2015-04-24T11:38:19.453754 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.454412 #9300]  INFO -- default-precise32:     +    #print("switch_marker $which $what $name\n");
I, [2015-04-24T11:38:19.456229 #9300]  INFO -- default-precise32:     +    # TODO: get rid of the magic string(s)
I, [2015-04-24T11:38:19.458179 #9300]  INFO -- default-precise32:     +    my $state_marker_dir = "$statedir/$what" . "d" . "_by_$mode";
I, [2015-04-24T11:38:19.460201 #9300]  INFO -- default-precise32:     +    my $state_marker     = "$state_marker_dir/$name";
I, [2015-04-24T11:38:19.463279 #9300]  INFO -- default-precise32:     +    if ( !-d $state_marker_dir ) {
I, [2015-04-24T11:38:19.464301 #9300]  INFO -- default-precise32:     +        File::Path::mkpath("$state_marker_dir")
I, [2015-04-24T11:38:19.466056 #9300]  INFO -- default-precise32:     +            || error(
I, [2015-04-24T11:38:19.467859 #9300]  INFO -- default-precise32:     +            "Failed to create marker directory: '$state_marker_dir'\n");
I, [2015-04-24T11:38:19.470221 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.471405 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:19.472174 #9300]  INFO -- default-precise32: +    # XXX: swap find with perl alternative
I, [2015-04-24T11:38:19.474243 #9300]  INFO -- default-precise32:     +    my @markers = qx{find "$statedir" -type f -a -name "$name"};
I, [2015-04-24T11:38:19.476131 #9300]  INFO -- default-precise32:     +    chomp(@markers);
I, [2015-04-24T11:38:19.478361 #9300]  INFO -- default-precise32:     +    foreach (@markers) {
I, [2015-04-24T11:38:19.482837 #9300]  INFO -- default-precise32:     +        unless ( unlink $_ ) {
I, [2015-04-24T11:38:19.483101 #9300]  INFO -- default-precise32:     +            error("Failed to remove old marker '$_'!\n") && return 0;
I, [2015-04-24T11:38:19.484178 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:19.486117 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.487974 #9300]  INFO -- default-precise32:     +    unless ($purge) {
I, [2015-04-24T11:38:19.489623 #9300]  INFO -- default-precise32:     +        qx{touch "$state_marker"};
I, [2015-04-24T11:38:19.491555 #9300]  INFO -- default-precise32:     +        if ( $? != 0 ) {
I, [2015-04-24T11:38:19.493530 #9300]  INFO -- default-precise32:     +            error("Failed to create marker '$state_marker'!\n") && return 0;
I, [2015-04-24T11:38:19.495819 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:19.497607 #9300]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:38:19.499951 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.502415 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.503967 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.517907 #9300]  INFO -- default-precise32:     +# vim: syntax=perl sw=4 sts=4 sr et
I, [2015-04-24T11:38:19.520523 #9300]  INFO -- default-precise32:     - change mode from '' to '0700'
I, [2015-04-24T11:38:19.522434 #9300]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:38:19.524471 #9300]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:38:19.527508 #9300]  INFO -- default-precise32:   * link[/usr/sbin/a2disconf] action delete (skipped due to only_if)
I, [2015-04-24T11:38:19.534516 #9300]  INFO -- default-precise32:   * template[/usr/sbin/a2disconf] action create
I, [2015-04-24T11:38:19.545560 #9300]  INFO -- default-precise32:     - create new file /usr/sbin/a2disconf
I, [2015-04-24T11:38:19.548512 #9300]  INFO -- default-precise32:     - update content in file /usr/sbin/a2disconf from none to ce53f4
I, [2015-04-24T11:38:19.550579 #9300]  INFO -- default-precise32:     --- /usr/sbin/a2disconf	2015-04-24 08:38:19.528700102 +0000
I, [2015-04-24T11:38:19.553936 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-yq5i0g	2015-04-24 08:38:19.524700151 +0000
I, [2015-04-24T11:38:19.555370 #9300]  INFO -- default-precise32:     @@ -1 +1,533 @@
I, [2015-04-24T11:38:19.557490 #9300]  INFO -- default-precise32:     +#!/usr/bin/perl -w
I, [2015-04-24T11:38:19.559517 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:19.561080 #9300]  INFO -- default-precise32:     +# a2enmod by Stefan Fritsch <sf@debian.org>
I, [2015-04-24T11:38:19.563434 #9300]  INFO -- default-precise32:     +# Licensed under Apache License 2.0
I, [2015-04-24T11:38:19.564508 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:19.567417 #9300]  INFO -- default-precise32:     +# The coding style is "perltidy -pbp"
I, [2015-04-24T11:38:19.568402 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.571953 #9300]  INFO -- default-precise32:     +use strict;
I, [2015-04-24T11:38:19.572448 #9300]  INFO -- default-precise32:     +use Cwd 'realpath';
I, [2015-04-24T11:38:19.574484 #9300]  INFO -- default-precise32:     +use File::Spec;
I, [2015-04-24T11:38:19.575578 #9300]  INFO -- default-precise32:     +use File::Basename;
I, [2015-04-24T11:38:19.577336 #9300]  INFO -- default-precise32:     +use File::Path;
I, [2015-04-24T11:38:19.579490 #9300]  INFO -- default-precise32:     +use Getopt::Long;
I, [2015-04-24T11:38:19.581342 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.583520 #9300]  INFO -- default-precise32:     +my $quiet;
I, [2015-04-24T11:38:19.585460 #9300]  INFO -- default-precise32:     +my $force;
I, [2015-04-24T11:38:19.589482 #9300]  INFO -- default-precise32:     +my $maintmode;
I, [2015-04-24T11:38:19.591477 #9300]  INFO -- default-precise32:     +my $purge;
I, [2015-04-24T11:38:19.592384 #9300]  INFO -- default-precise32: +
I, [2015-04-24T11:38:19.593463 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:19.595113 #9300]  INFO -- default-precise32:     +GetOptions(
I, [2015-04-24T11:38:19.596649 #9300]  INFO -- default-precise32:     +    'quiet|q'     => \$quiet,
I, [2015-04-24T11:38:19.600226 #9300]  INFO -- default-precise32:     +    'force|f'     => \$force,
I, [2015-04-24T11:38:19.600521 #9300]  INFO -- default-precise32:     +    'maintmode|m' => \$maintmode,
I, [2015-04-24T11:38:19.601927 #9300]  INFO -- default-precise32:     +    'purge|p'     => \$purge
I, [2015-04-24T11:38:19.604463 #9300]  INFO -- default-precise32:     +) or exit 2;
I, [2015-04-24T11:38:19.606076 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.607865 #9300]  INFO -- default-precise32:     +my $basename = basename($0);
I, [2015-04-24T11:38:19.609158 #9300]  INFO -- default-precise32:     +$basename =~ /^a2(en|dis)(mod|site|conf)((?:-.+)?)$/
I, [2015-04-24T11:38:19.610183 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:19.611669 #9300]  INFO -- default-precise32:     +my $act        = $1;
I, [2015-04-24T11:38:19.614295 #9300]  INFO -- default-precise32:     +my $obj        = $2;
I, [2015-04-24T11:38:19.615521 #9300]  INFO -- default-precise32:     +my $dir_suffix = $3;
I, [2015-04-24T11:38:19.617018 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.618473 #9300]  INFO -- default-precise32:     +my $env_file = $ENV{APACHE_ENVVARS}
I, [2015-04-24T11:38:19.620431 #9300]  INFO -- default-precise32:     +    || (
I, [2015-04-24T11:38:19.621108 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:19.622533 #9300]  INFO -- default-precise32:     +    ? "$ENV{APACHE_CONFDIR}/envvars"
I, [2015-04-24T11:38:19.624465 #9300]  INFO -- default-precise32:     +    : "/etc/apache2$dir_suffix/envvars"
I, [2015-04-24T11:38:19.626474 #9300]  INFO -- default-precise32:     +    );
I, [2015-04-24T11:38:19.630207 #9300]  INFO -- default-precise32:     +$ENV{LANG} = 'C';
I, [2015-04-24T11:38:19.630585 #9300]  INFO -- default-precise32:     +read_env_file($env_file);
I, [2015-04-24T11:38:19.632464 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.633475 #9300]  INFO -- default-precise32:     +$act .= 'able';
I, [2015-04-24T11:38:19.635337 #9300]  INFO -- default-precise32:     +my ( $name, $dir, $sffx, $reload );
I, [2015-04-24T11:38:19.637450 #9300]  INFO -- default-precise32: +if ( $obj eq 'mod' ) {
I, [2015-04-24T11:38:19.637487 #9300]  INFO -- default-precise32:     +    $obj    = 'module';
I, [2015-04-24T11:38:19.640467 #9300]  INFO -- default-precise32:     +    $dir    = 'mods';
I, [2015-04-24T11:38:19.640496 #9300]  INFO -- default-precise32:     +    $sffx   = '.load';
I, [2015-04-24T11:38:19.640516 #9300]  INFO -- default-precise32:     +    $reload = 'restart';
I, [2015-04-24T11:38:19.641142 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:19.643451 #9300]  INFO -- default-precise32:     +elsif ( $obj eq 'conf' ) {
I, [2015-04-24T11:38:19.644430 #9300]  INFO -- default-precise32:     +    $obj    = 'conf';
I, [2015-04-24T11:38:19.645450 #9300]  INFO -- default-precise32: +    $dir    = 'conf';
I, [2015-04-24T11:38:19.646508 #9300]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:38:19.648405 #9300]  INFO -- default-precise32:     +    $reload = 'reload';
I, [2015-04-24T11:38:19.649015 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.650444 #9300]  INFO -- default-precise32: +else {
I, [2015-04-24T11:38:19.652529 #9300]  INFO -- default-precise32:     +    $dir    = 'sites';
I, [2015-04-24T11:38:19.654224 #9300]  INFO -- default-precise32:     +    $sffx   = '.conf';
I, [2015-04-24T11:38:19.655480 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:19.656433 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.659490 #9300]  INFO -- default-precise32:     +$name = ucfirst($obj);
I, [2015-04-24T11:38:19.660043 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.662454 #9300]  INFO -- default-precise32:     +my $confdir = $ENV{APACHE_CONFDIR} || "/etc/apache2$dir_suffix";
I, [2015-04-24T11:38:19.664422 #9300]  INFO -- default-precise32:     +my $availdir = $ENV{ uc("APACHE_${dir}_AVAILABLE") }
I, [2015-04-24T11:38:19.666450 #9300]  INFO -- default-precise32:     +    || "$confdir/$dir-available";
I, [2015-04-24T11:38:19.666492 #9300]  INFO -- default-precise32:     +my $enabldir = $ENV{ uc("APACHE_${dir}_ENABLED") } || "$confdir/$dir-enabled";
I, [2015-04-24T11:38:19.668492 #9300]  INFO -- default-precise32: +my $statedir = $ENV{ uc("APACHE_STATE_DIRECTORY") } || "/usr/lib/apache2";
I, [2015-04-24T11:38:19.668608 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.671238 #9300]  INFO -- default-precise32:     +$statedir .= "/$obj";
I, [2015-04-24T11:38:19.672469 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.673072 #9300]  INFO -- default-precise32: +my $choicedir = $act eq 'enable' ? $availdir : $enabldir;
I, [2015-04-24T11:38:19.675485 #9300]  INFO -- default-precise32:     +my $linkdir = File::Spec->abs2rel( $availdir, $enabldir );
I, [2015-04-24T11:38:19.676330 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.678429 #9300]  INFO -- default-precise32:     +my $request_reload = 0;
I, [2015-04-24T11:38:19.680143 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.682469 #9300]  INFO -- default-precise32:     +my $rc = 0;
I, [2015-04-24T11:38:19.683817 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.684461 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:19.685945 #9300]  INFO -- default-precise32: +    my @choices = myglob('*');
I, [2015-04-24T11:38:19.689509 #9300]  INFO -- default-precise32:     +    print "Your choices are: @choices\n";
I, [2015-04-24T11:38:19.690044 #9300]  INFO -- default-precise32:     +    print "Which ${obj}(s) do you want to $act (wildcards ok)?\n";
I, [2015-04-24T11:38:19.691413 #9300]  INFO -- default-precise32:     +    my $input = <>;
I, [2015-04-24T11:38:19.693437 #9300]  INFO -- default-precise32:     +    @ARGV = split /\s+/, $input;
I, [2015-04-24T11:38:19.695312 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.697135 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.698921 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.700889 #9300]  INFO -- default-precise32:     +my @objs;
I, [2015-04-24T11:38:19.702568 #9300]  INFO -- default-precise32:     +foreach my $arg (@ARGV) {
I, [2015-04-24T11:38:19.704207 #9300]  INFO -- default-precise32:     +    $arg =~ s/${sffx}$//;
I, [2015-04-24T11:38:19.706235 #9300]  INFO -- default-precise32:     +    my @glob = myglob($arg);
I, [2015-04-24T11:38:19.709403 #9300]  INFO -- default-precise32:     +    if ( !@glob ) {
I, [2015-04-24T11:38:19.709815 #9300]  INFO -- default-precise32:     +        error("No $obj found matching $arg!\n");
I, [2015-04-24T11:38:19.712434 #9300]  INFO -- default-precise32:     +        $rc = 1;
I, [2015-04-24T11:38:19.714679 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.716724 #9300]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:38:19.719304 #9300]  INFO -- default-precise32:     +        push @objs, @glob;
I, [2015-04-24T11:38:19.721652 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.724430 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.726769 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.729077 #9300]  INFO -- default-precise32:     +foreach my $acton (@objs) {
I, [2015-04-24T11:38:19.731364 #9300]  INFO -- default-precise32:     +    doit($acton) or $rc = 1;
I, [2015-04-24T11:38:19.734315 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.736220 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.738559 #9300]  INFO -- default-precise32:     +info(
I, [2015-04-24T11:38:19.740594 #9300]  INFO -- default-precise32:     +    "To activate the new configuration, you need to run:\n  service apache2 $reload\n"
I, [2015-04-24T11:38:19.743612 #9300]  INFO -- default-precise32:     +) if $request_reload;
I, [2015-04-24T11:38:19.745436 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.748433 #9300]  INFO -- default-precise32:     +exit($rc);
I, [2015-04-24T11:38:19.750303 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.752470 #9300]  INFO -- default-precise32:     +##############################################################################
I, [2015-04-24T11:38:19.755058 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.757781 #9300]  INFO -- default-precise32:     +sub myglob {
I, [2015-04-24T11:38:19.760436 #9300]  INFO -- default-precise32:     +    my $arg = shift;
I, [2015-04-24T11:38:19.762293 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.764432 #9300]  INFO -- default-precise32:     +    my @glob = map {
I, [2015-04-24T11:38:19.767132 #9300]  INFO -- default-precise32:     +        s{^$choicedir/}{};
I, [2015-04-24T11:38:19.769291 #9300]  INFO -- default-precise32:     +        s{$sffx$}{};
I, [2015-04-24T11:38:19.771914 #9300]  INFO -- default-precise32:     +        $_
I, [2015-04-24T11:38:19.774436 #9300]  INFO -- default-precise32:     +    } glob("$choicedir/$arg$sffx");
I, [2015-04-24T11:38:19.776811 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.779315 #9300]  INFO -- default-precise32:     +    return @glob;
I, [2015-04-24T11:38:19.782427 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:19.783953 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.786342 #9300]  INFO -- default-precise32:     +sub doit {
I, [2015-04-24T11:38:19.788888 #9300]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:38:19.791299 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.793837 #9300]  INFO -- default-precise32:     +    my ( $conftgt, $conflink );
I, [2015-04-24T11:38:19.796283 #9300]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:38:19.798557 #9300]  INFO -- default-precise32:     +        if ( $acton eq 'cgi' && threaded() ) {
I, [2015-04-24T11:38:19.800996 #9300]  INFO -- default-precise32:     +            print
I, [2015-04-24T11:38:19.803441 #9300]  INFO -- default-precise32:     +                "Your MPM seems to be threaded. Selecting cgid instead of cgi.\n";
I, [2015-04-24T11:38:19.805971 #9300]  INFO -- default-precise32:     +            $acton = 'cgid';
I, [2015-04-24T11:38:19.808652 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:19.810562 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.813068 #9300]  INFO -- default-precise32:     +        $conftgt = "$availdir/$acton.conf";
I, [2015-04-24T11:38:19.816466 #9300]  INFO -- default-precise32:     +        if ( -e $conftgt ) {
I, [2015-04-24T11:38:19.818941 #9300]  INFO -- default-precise32:     +            $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:38:19.821591 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:19.823776 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.826457 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.829052 #9300]  INFO -- default-precise32:     +    my $tgt  = "$availdir/$acton$sffx";
I, [2015-04-24T11:38:19.831430 #9300]  INFO -- default-precise32:     +    my $link = "$enabldir/$acton$sffx";
I, [2015-04-24T11:38:19.833921 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.836410 #9300]  INFO -- default-precise32:     +    if ( !-e $tgt ) {
I, [2015-04-24T11:38:19.838974 #9300]  INFO -- default-precise32:     +        if ( -l $link && !-e $link ) {
I, [2015-04-24T11:38:19.841424 #9300]  INFO -- default-precise32:     +            if ( $act eq 'disable' ) {
I, [2015-04-24T11:38:19.843590 #9300]  INFO -- default-precise32:     +                info("removing dangling symlink $link\n");
I, [2015-04-24T11:38:19.846508 #9300]  INFO -- default-precise32:     +                unlink($link);
I, [2015-04-24T11:38:19.848180 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.850949 #9300]  INFO -- default-precise32:     +                # force a .conf path. It may exist as dangling link, too
I, [2015-04-24T11:38:19.853014 #9300]  INFO -- default-precise32:     +                $conflink = "$enabldir/$acton.conf";
I, [2015-04-24T11:38:19.855677 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.858123 #9300]  INFO -- default-precise32:     +                if ( -l $conflink && !-e $conflink ) {
I, [2015-04-24T11:38:19.860828 #9300]  INFO -- default-precise32:     +                    info("removing dangling symlink $conflink\n");
I, [2015-04-24T11:38:19.863248 #9300]  INFO -- default-precise32:     +                    unlink($conflink);
I, [2015-04-24T11:38:19.866441 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:19.868135 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.870443 #9300]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:38:19.872900 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:19.875270 #9300]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:38:19.877414 #9300]  INFO -- default-precise32:     +                error("$link is a dangling symlink!\n");
I, [2015-04-24T11:38:19.880164 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:19.882417 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:19.884817 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.887091 #9300]  INFO -- default-precise32:     +        if ( $purge ) {
I, [2015-04-24T11:38:19.889046 #9300]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:19.891295 #9300]  INFO -- default-precise32:     +            # exit silently, we are purging anyway
I, [2015-04-24T11:38:19.893685 #9300]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:38:19.895491 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:19.897222 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.899297 #9300]  INFO -- default-precise32:     +        error("$name $acton does not exist!\n");
I, [2015-04-24T11:38:19.901464 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:19.903535 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.905407 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.907459 #9300]  INFO -- default-precise32:     +    # handle module dependencies
I, [2015-04-24T11:38:19.909322 #9300]  INFO -- default-precise32:     +    if ( $obj eq 'module' ) {
I, [2015-04-24T11:38:19.911318 #9300]  INFO -- default-precise32:     +        if ( $act eq 'enable' ) {
I, [2015-04-24T11:38:19.913133 #9300]  INFO -- default-precise32:     +            if ( $acton eq 'mpm_itk' ) {
I, [2015-04-24T11:38:19.915469 #9300]  INFO -- default-precise32:     +                warning(  "MPM_ITK is a third party module that is not part "
I, [2015-04-24T11:38:19.917354 #9300]  INFO -- default-precise32:     +                        . "of the official Apache HTTPD. It has seen less "
I, [2015-04-24T11:38:19.919296 #9300]  INFO -- default-precise32:     +                        . "testing than the official MPM modules." );
I, [2015-04-24T11:38:19.921311 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:19.924500 #9300]  INFO -- default-precise32:     +            my @depends = get_deps("$availdir/$acton.load");
I, [2015-04-24T11:38:19.925451 #9300]  INFO -- default-precise32:     +            do_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:38:19.927592 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:19.929601 #9300]  INFO -- default-precise32:     +            my @conflicts = get_deps( "$availdir/$acton.load", "Conflicts" );
I, [2015-04-24T11:38:19.931960 #9300]  INFO -- default-precise32:     +            check_conflicts( $acton, @conflicts ) or return 0;
I, [2015-04-24T11:38:19.934382 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:19.936567 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:19.938763 #9300]  INFO -- default-precise32:     +            my @depending;
I, [2015-04-24T11:38:19.941189 #9300]  INFO -- default-precise32:     +            foreach my $d ( glob("$enabldir/*.load") ) {
I, [2015-04-24T11:38:19.943613 #9300]  INFO -- default-precise32:     +                my @deps = get_deps($d);
I, [2015-04-24T11:38:19.945736 #9300]  INFO -- default-precise32:     +                if ( is_in( $acton, @deps ) ) {
I, [2015-04-24T11:38:19.948204 #9300]  INFO -- default-precise32:     +                    $d =~ m,/([^/]+).load$,;
I, [2015-04-24T11:38:19.950565 #9300]  INFO -- default-precise32:     +                    push @depending, $1;
I, [2015-04-24T11:38:19.953392 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:19.956214 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:19.964645 #9300]  INFO -- default-precise32:     +            if ( scalar @depending ) {
I, [2015-04-24T11:38:19.970487 #9300]  INFO -- default-precise32:     +                if ($force) {
I, [2015-04-24T11:38:19.970526 #9300]  INFO -- default-precise32:     +                    do_deps( $acton, @depending ) or return 0;
I, [2015-04-24T11:38:19.970548 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:19.970568 #9300]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:38:19.970587 #9300]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:38:19.970606 #9300]  INFO -- default-precise32:     +                        "The following modules depend on $acton ",
I, [2015-04-24T11:38:19.972956 #9300]  INFO -- default-precise32:     +                        "and need to be disabled first: @depending\n"
I, [2015-04-24T11:38:19.974120 #9300]  INFO -- default-precise32: +                    );
I, [2015-04-24T11:38:19.976408 #9300]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:38:19.978603 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:19.981352 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:19.984099 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:19.987039 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:19.989920 #9300]  INFO -- default-precise32:     +    elsif ( $act eq 'enable' ) {
I, [2015-04-24T11:38:19.992927 #9300]  INFO -- default-precise32:     +        my @depends = get_deps("$availdir/$acton$sffx");
I, [2015-04-24T11:38:19.995869 #9300]  INFO -- default-precise32:     +        warn_deps( $acton, @depends ) or return 0;
I, [2015-04-24T11:38:19.998757 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.001164 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.003420 #9300]  INFO -- default-precise32:     +    if ( $act eq 'enable' ) {
I, [2015-04-24T11:38:20.006277 #9300]  INFO -- default-precise32:     +        my $check = check_link( $tgt, $link );
I, [2015-04-24T11:38:20.008442 #9300]  INFO -- default-precise32:     +        if ( $check eq 'ok' ) {
I, [2015-04-24T11:38:20.011420 #9300]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:38:20.014459 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.017110 #9300]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:38:20.019907 #9300]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:38:20.022734 #9300]  INFO -- default-precise32:     +                if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:38:20.025196 #9300]  INFO -- default-precise32:     +                    info("$name $acton already enabled\n");
I, [2015-04-24T11:38:20.027894 #9300]  INFO -- default-precise32:     +                    return 1;
I, [2015-04-24T11:38:20.030301 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:20.032351 #9300]  INFO -- default-precise32:     +                elsif ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:38:20.035216 #9300]  INFO -- default-precise32:     +                    print "Enabling config file $acton.conf.\n";
I, [2015-04-24T11:38:20.037763 #9300]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:38:20.040174 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:20.042479 #9300]  INFO -- default-precise32:     +                else {
I, [2015-04-24T11:38:20.044920 #9300]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:38:20.048059 #9300]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:38:20.050493 #9300]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:38:20.052550 #9300]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:38:20.055072 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:20.057198 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:20.059644 #9300]  INFO -- default-precise32:     +            else {
I, [2015-04-24T11:38:20.062013 #9300]  INFO -- default-precise32:     +                info("$name $acton already enabled\n");
I, [2015-04-24T11:38:20.064257 #9300]  INFO -- default-precise32:     +                return 1;
I, [2015-04-24T11:38:20.066780 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:20.069486 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:20.072820 #9300]  INFO -- default-precise32:     +        elsif ( $check eq 'missing' ) {
I, [2015-04-24T11:38:20.074453 #9300]  INFO -- default-precise32:     +            if ($conflink) {
I, [2015-04-24T11:38:20.076789 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.079157 #9300]  INFO -- default-precise32:     +                # handle .conf file
I, [2015-04-24T11:38:20.081204 #9300]  INFO -- default-precise32:     +                my $confcheck = check_link( $conftgt, $conflink );
I, [2015-04-24T11:38:20.083770 #9300]  INFO -- default-precise32:     +                if ( $confcheck eq 'missing' ) {
I, [2015-04-24T11:38:20.086046 #9300]  INFO -- default-precise32:     +                    add_link( $conftgt, $conflink ) or return 0;
I, [2015-04-24T11:38:20.088453 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:20.090971 #9300]  INFO -- default-precise32:     +                elsif ( $confcheck ne 'ok' ) {
I, [2015-04-24T11:38:20.093417 #9300]  INFO -- default-precise32:     +                    error(
I, [2015-04-24T11:38:20.095741 #9300]  INFO -- default-precise32:     +                        "Config file $acton.conf not properly enabled: $confcheck\n"
I, [2015-04-24T11:38:20.098303 #9300]  INFO -- default-precise32:     +                    );
I, [2015-04-24T11:38:20.100456 #9300]  INFO -- default-precise32:     +                    return 0;
I, [2015-04-24T11:38:20.104546 #9300]  INFO -- default-precise32:     +                }
I, [2015-04-24T11:38:20.105459 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:20.107831 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.110307 #9300]  INFO -- default-precise32:     +            print "Enabling $obj $acton.\n";
I, [2015-04-24T11:38:20.112462 #9300]  INFO -- default-precise32:     +            if ( $acton eq 'ssl' ) {
I, [2015-04-24T11:38:20.114547 #9300]  INFO -- default-precise32:     +                info(     "See /usr/share/doc/apache2/README.Debian.gz on "
I, [2015-04-24T11:38:20.116943 #9300]  INFO -- default-precise32:     +                        . "how to configure SSL and create self-signed certificates.\n"
I, [2015-04-24T11:38:20.118960 #9300]  INFO -- default-precise32:     +                );
I, [2015-04-24T11:38:20.121485 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:20.123988 #9300]  INFO -- default-precise32:     +            return add_link( $tgt, $link )
I, [2015-04-24T11:38:20.126519 #9300]  INFO -- default-precise32:     +                && switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:20.128844 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:20.133329 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:20.135366 #9300]  INFO -- default-precise32:     +            error("$name $acton not properly enabled: $check\n");
I, [2015-04-24T11:38:20.137899 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:20.140055 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:20.142287 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.144868 #9300]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:38:20.146950 #9300]  INFO -- default-precise32:     +        if ( -e $link || -l $link ) {
I, [2015-04-24T11:38:20.149024 #9300]  INFO -- default-precise32:     +            remove_link($link);
I, [2015-04-24T11:38:20.151154 #9300]  INFO -- default-precise32:     +            if ( $conflink && -e $conflink ) {
I, [2015-04-24T11:38:20.153950 #9300]  INFO -- default-precise32:     +                remove_link($conflink);
I, [2015-04-24T11:38:20.156149 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:20.158488 #9300]  INFO -- default-precise32:     +            switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:20.160929 #9300]  INFO -- default-precise32:     +            print "$name $acton disabled.\n";
I, [2015-04-24T11:38:20.163749 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:20.166432 #9300]  INFO -- default-precise32:     +        elsif ( $conflink && -e $conflink ) {
I, [2015-04-24T11:38:20.169155 #9300]  INFO -- default-precise32:     +            print "Disabling stale config file $acton.conf.\n";
I, [2015-04-24T11:38:20.171510 #9300]  INFO -- default-precise32:     +            remove_link($conflink);
I, [2015-04-24T11:38:20.174266 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:20.176566 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:20.179176 #9300]  INFO -- default-precise32:     +            info("$name $acton already disabled\n");
I, [2015-04-24T11:38:20.181792 #9300]  INFO -- default-precise32:     +            if ( $purge ) {
I, [2015-04-24T11:38:20.184362 #9300]  INFO -- default-precise32:     +                switch_marker( $obj, $act, $acton );
I, [2015-04-24T11:38:20.187120 #9300]  INFO -- default-precise32:     +            }
I, [2015-04-24T11:38:20.190712 #9300]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:38:20.193446 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:20.196458 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.198829 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.201358 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:20.203632 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:20.206213 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.208656 #9300]  INFO -- default-precise32:     +sub get_deps {
I, [2015-04-24T11:38:20.211272 #9300]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:38:20.213769 #9300]  INFO -- default-precise32:     +    my $type = shift || "Depends";
I, [2015-04-24T11:38:20.216016 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.218360 #9300]  INFO -- default-precise32:     +    my $fd;
I, [2015-04-24T11:38:20.220650 #9300]  INFO -- default-precise32:     +    if ( !open( $fd, '<', $file ) ) {
I, [2015-04-24T11:38:20.223422 #9300]  INFO -- default-precise32:     +        error("Can't open $file: $!");
I, [2015-04-24T11:38:20.226226 #9300]  INFO -- default-precise32:     +        return;
I, [2015-04-24T11:38:20.228437 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.230958 #9300]  INFO -- default-precise32:     +    my $line;
I, [2015-04-24T11:38:20.233204 #9300]  INFO -- default-precise32:     +    while ( defined( $line = <$fd> ) ) {
I, [2015-04-24T11:38:20.235526 #9300]  INFO -- default-precise32:     +        chomp $line;
I, [2015-04-24T11:38:20.238652 #9300]  INFO -- default-precise32:     +        if ( $line =~ /^# $type:\s+(.*?)\s*$/ ) {
I, [2015-04-24T11:38:20.240892 #9300]  INFO -- default-precise32:     +            my $deps = $1;
I, [2015-04-24T11:38:20.243452 #9300]  INFO -- default-precise32:     +            return split( /[\n\s]+/, $deps );
I, [2015-04-24T11:38:20.246445 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:20.248127 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.250338 #9300]  INFO -- default-precise32:     +        # only check until the first non-empty non-comment line
I, [2015-04-24T11:38:20.253248 #9300]  INFO -- default-precise32:     +        last if ( $line !~ /^\s*(?:#.*)?$/ );
I, [2015-04-24T11:38:20.255510 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.258188 #9300]  INFO -- default-precise32:     +    return;
I, [2015-04-24T11:38:20.260311 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:20.263019 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.265436 #9300]  INFO -- default-precise32:     +sub do_deps {
I, [2015-04-24T11:38:20.268052 #9300]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:38:20.270545 #9300]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:38:20.273046 #9300]  INFO -- default-precise32:     +        info("Considering dependency $d for $acton:\n");
I, [2015-04-24T11:38:20.275396 #9300]  INFO -- default-precise32:     +        if ( !doit($d) ) {
I, [2015-04-24T11:38:20.278157 #9300]  INFO -- default-precise32:     +            error("Could not $act dependency $d for $acton, aborting\n");
I, [2015-04-24T11:38:20.280589 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:20.283432 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:20.286291 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.288809 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:20.291534 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:20.294001 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.296201 #9300]  INFO -- default-precise32:     +sub warn_deps {
I, [2015-04-24T11:38:20.298439 #9300]  INFO -- default-precise32:     +    my $acton = shift;
I, [2015-04-24T11:38:20.300593 #9300]  INFO -- default-precise32:     +    my $modsenabldir = $ENV{APACHE_MODS_ENABLED} || "$confdir/mods-enabled";
I, [2015-04-24T11:38:20.303135 #9300]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:38:20.305344 #9300]  INFO -- default-precise32:     +        info("Checking dependency $d for $acton:\n");
I, [2015-04-24T11:38:20.307836 #9300]  INFO -- default-precise32:     +        if ( !-e "$modsenabldir/$d.load" ) {
I, [2015-04-24T11:38:20.310422 #9300]  INFO -- default-precise32:     +            warning(
I, [2015-04-24T11:38:20.312592 #9300]  INFO -- default-precise32:     +                "Module $d is not enabled, but $acton depends on it, aborting\n"
I, [2015-04-24T11:38:20.315225 #9300]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:38:20.317423 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:20.320165 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:20.322598 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.325192 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:20.327550 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:20.330164 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.332356 #9300]  INFO -- default-precise32:     +sub check_conflicts {
I, [2015-04-24T11:38:20.335018 #9300]  INFO -- default-precise32:     +    my $acton    = shift;
I, [2015-04-24T11:38:20.337435 #9300]  INFO -- default-precise32:     +    my $haderror = 0;
I, [2015-04-24T11:38:20.340074 #9300]  INFO -- default-precise32:     +    foreach my $d (@_) {
I, [2015-04-24T11:38:20.342615 #9300]  INFO -- default-precise32:     +        info("Considering conflict $d for $acton:\n");
I, [2015-04-24T11:38:20.345083 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.347346 #9300]  INFO -- default-precise32:     +        my $tgt  = "$availdir/$d$sffx";
I, [2015-04-24T11:38:20.350208 #9300]  INFO -- default-precise32:     +        my $link = "$enabldir/$d$sffx";
I, [2015-04-24T11:38:20.352159 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.354704 #9300]  INFO -- default-precise32:     +        my $confcheck = check_link( $tgt, $link );
I, [2015-04-24T11:38:20.357152 #9300]  INFO -- default-precise32:     +        if ( $confcheck eq 'ok' ) {
I, [2015-04-24T11:38:20.359354 #9300]  INFO -- default-precise32:     +            error(
I, [2015-04-24T11:38:20.361870 #9300]  INFO -- default-precise32:     +                "Module $d is enabled - cannot proceed due to conflicts. It needs to be disabled first!\n"
I, [2015-04-24T11:38:20.364025 #9300]  INFO -- default-precise32:     +            );
I, [2015-04-24T11:38:20.366434 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.369153 #9300]  INFO -- default-precise32:     +            # Don't return immediately, there could be several conflicts
I, [2015-04-24T11:38:20.371452 #9300]  INFO -- default-precise32:     +            $haderror++;
I, [2015-04-24T11:38:20.374080 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:20.376458 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.378550 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.380952 #9300]  INFO -- default-precise32:     +    if ($haderror) {
I, [2015-04-24T11:38:20.383369 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:20.399492 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.399542 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.399565 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:20.399585 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:20.399604 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.399623 #9300]  INFO -- default-precise32:     +sub add_link {
I, [2015-04-24T11:38:20.399642 #9300]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:38:20.399660 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.399679 #9300]  INFO -- default-precise32:     +    # create relative link
I, [2015-04-24T11:38:20.399704 #9300]  INFO -- default-precise32:     +    if ( !symlink( File::Spec->abs2rel( $tgt, dirname($link) ), $link ) ) {
I, [2015-04-24T11:38:20.399726 #9300]  INFO -- default-precise32:     +        die("Could not create $link: $!\n");
I, [2015-04-24T11:38:20.399745 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.399763 #9300]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:38:20.399781 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:20.399799 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:20.399817 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.399835 #9300]  INFO -- default-precise32:     +sub check_link {
I, [2015-04-24T11:38:20.399854 #9300]  INFO -- default-precise32:     +    my ( $tgt, $link ) = @_;
I, [2015-04-24T11:38:20.399871 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.399891 #9300]  INFO -- default-precise32:     +    if ( !-e $link ) {
I, [2015-04-24T11:38:20.399910 #9300]  INFO -- default-precise32:     +        if ( -l $link ) {
I, [2015-04-24T11:38:20.399928 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.399946 #9300]  INFO -- default-precise32:     +            # points to nowhere
I, [2015-04-24T11:38:20.399965 #9300]  INFO -- default-precise32:     +            info("Removing dangling link $link");
I, [2015-04-24T11:38:20.400006 #9300]  INFO -- default-precise32:     +            unlink($link) or die "Could not remove $link\n";
I, [2015-04-24T11:38:20.400026 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:20.400045 #9300]  INFO -- default-precise32:     +        return 'missing';
I, [2015-04-24T11:38:20.400063 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.400080 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.400099 #9300]  INFO -- default-precise32:     +    if ( -e $link && !-l $link ) {
I, [2015-04-24T11:38:20.400117 #9300]  INFO -- default-precise32:     +        return "$link is a real file, not touching it";
I, [2015-04-24T11:38:20.400136 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.400155 #9300]  INFO -- default-precise32:     +    if ( realpath($link) ne realpath($tgt) ) {
I, [2015-04-24T11:38:20.400174 #9300]  INFO -- default-precise32:     +        return "$link exists but does not point to $tgt, not touching it";
I, [2015-04-24T11:38:20.400193 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.400211 #9300]  INFO -- default-precise32:     +    return 'ok';
I, [2015-04-24T11:38:20.400229 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:20.400247 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.400280 #9300]  INFO -- default-precise32:     +sub remove_link {
I, [2015-04-24T11:38:20.400300 #9300]  INFO -- default-precise32:     +    my ($link) = @_;
I, [2015-04-24T11:38:20.400319 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.400337 #9300]  INFO -- default-precise32:     +    if ( -l $link ) {
I, [2015-04-24T11:38:20.400356 #9300]  INFO -- default-precise32:     +        unlink($link) or die "Could not remove $link: $!\n";
I, [2015-04-24T11:38:20.400375 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.400402 #9300]  INFO -- default-precise32:     +    elsif ( -e $link ) {
I, [2015-04-24T11:38:20.400421 #9300]  INFO -- default-precise32:     +        error("$link is not a symbolic link, not deleting\n");
I, [2015-04-24T11:38:20.400448 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:20.400469 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.400488 #9300]  INFO -- default-precise32:     +    $request_reload = 1;
I, [2015-04-24T11:38:20.400506 #9300]  INFO -- default-precise32:     +    return 1;
I, [2015-04-24T11:38:20.400524 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:20.400542 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.400560 #9300]  INFO -- default-precise32:     +sub threaded {
I, [2015-04-24T11:38:20.400579 #9300]  INFO -- default-precise32:     +    my $result = "";
I, [2015-04-24T11:38:20.400598 #9300]  INFO -- default-precise32:     +    $result = qx{/usr/sbin/apache2ctl -V | grep 'threaded'}
I, [2015-04-24T11:38:20.400641 #9300]  INFO -- default-precise32:     +        if -x '/usr/sbin/apache2ctl';
I, [2015-04-24T11:38:20.400660 #9300]  INFO -- default-precise32:     +    if ( $? != 0 ) {
I, [2015-04-24T11:38:20.400679 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.400704 #9300]  INFO -- default-precise32:     +        # config doesn't work
I, [2015-04-24T11:38:20.402323 #9300]  INFO -- default-precise32:     +        if ( -e "$enabldir/mpm_prefork.load" || -e "$enabldir/mpm_itk.load" )
I, [2015-04-24T11:38:20.404307 #9300]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:38:20.406627 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:20.408888 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:20.411069 #9300]  INFO -- default-precise32:     +        elsif (-e "$enabldir/mpm_worker.load"
I, [2015-04-24T11:38:20.413047 #9300]  INFO -- default-precise32:     +            || -e "$enabldir/mpm_event.load" )
I, [2015-04-24T11:38:20.415156 #9300]  INFO -- default-precise32:     +        {
I, [2015-04-24T11:38:20.417080 #9300]  INFO -- default-precise32:     +            return 1;
I, [2015-04-24T11:38:20.419278 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:20.421042 #9300]  INFO -- default-precise32:     +        else {
I, [2015-04-24T11:38:20.423240 #9300]  INFO -- default-precise32:     +            error("Can't determine enabled MPM");
I, [2015-04-24T11:38:20.424994 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.427716 #9300]  INFO -- default-precise32:     +            # do what user requested
I, [2015-04-24T11:38:20.438019 #9300]  INFO -- default-precise32:     +            return 0;
I, [2015-04-24T11:38:20.438087 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:20.438122 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.438141 #9300]  INFO -- default-precise32:     +    if ( $result =~ / no/ ) {
I, [2015-04-24T11:38:20.438160 #9300]  INFO -- default-precise32:     +        return 0;
I, [2015-04-24T11:38:20.438178 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.438196 #9300]  INFO -- default-precise32:     +    elsif ( $result =~ / yes/ ) {
I, [2015-04-24T11:38:20.438214 #9300]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:38:20.438232 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.438250 #9300]  INFO -- default-precise32:     +    else {
I, [2015-04-24T11:38:20.438284 #9300]  INFO -- default-precise32:     +        die("Can't parse output from apache2ctl -V:\n$result\n");
I, [2015-04-24T11:38:20.438303 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.438347 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:20.438382 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.438400 #9300]  INFO -- default-precise32:     +sub info {
I, [2015-04-24T11:38:20.438418 #9300]  INFO -- default-precise32:     +    print @_ if !$quiet;
I, [2015-04-24T11:38:20.438444 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:20.438463 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.438480 #9300]  INFO -- default-precise32:     +sub error {
I, [2015-04-24T11:38:20.438498 #9300]  INFO -- default-precise32:     +    print STDERR 'ERROR: ', @_;
I, [2015-04-24T11:38:20.438516 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:20.438554 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.438572 #9300]  INFO -- default-precise32:     +sub warning {
I, [2015-04-24T11:38:20.438602 #9300]  INFO -- default-precise32:     +    print STDERR 'WARNING: ', @_;
I, [2015-04-24T11:38:20.438621 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:20.438650 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.438668 #9300]  INFO -- default-precise32:     +sub is_in {
I, [2015-04-24T11:38:20.438685 #9300]  INFO -- default-precise32:     +    my $needle = shift;
I, [2015-04-24T11:38:20.438703 #9300]  INFO -- default-precise32:     +    foreach my $e (@_) {
I, [2015-04-24T11:38:20.438721 #9300]  INFO -- default-precise32:     +        return 1 if $needle eq $e;
I, [2015-04-24T11:38:20.438739 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.438757 #9300]  INFO -- default-precise32:     +    return 0;
I, [2015-04-24T11:38:20.438774 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:20.438791 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.438809 #9300]  INFO -- default-precise32:     +sub read_env_file {
I, [2015-04-24T11:38:20.438827 #9300]  INFO -- default-precise32:     +    my $file = shift;
I, [2015-04-24T11:38:20.438844 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.438872 #9300]  INFO -- default-precise32:     +    -r $file or return;
I, [2015-04-24T11:38:20.438891 #9300]  INFO -- default-precise32:     +    my @lines = qx{env - sh -c '. $file && env'};
I, [2015-04-24T11:38:20.438910 #9300]  INFO -- default-precise32:     +    if ($?) {
I, [2015-04-24T11:38:20.438928 #9300]  INFO -- default-precise32:     +        die "Could not read $file\n";
I, [2015-04-24T11:38:20.438946 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.438963 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.438981 #9300]  INFO -- default-precise32:     +    foreach my $l (@lines) {
I, [2015-04-24T11:38:20.438999 #9300]  INFO -- default-precise32:     +        chomp $l;
I, [2015-04-24T11:38:20.439017 #9300]  INFO -- default-precise32:     +        $l =~ /^(.*)?=(.*)$/ or die "Could not parse $file\n";
I, [2015-04-24T11:38:20.439051 #9300]  INFO -- default-precise32:     +        $ENV{$1} = $2;
I, [2015-04-24T11:38:20.439069 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.439087 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:20.439104 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.439122 #9300]  INFO -- default-precise32:     +sub switch_marker {
I, [2015-04-24T11:38:20.439140 #9300]  INFO -- default-precise32:     +    die('usage: switch_marker([module|site|conf], [enable|disable], $name)')
I, [2015-04-24T11:38:20.439159 #9300]  INFO -- default-precise32:     +        if @_ != 3;
I, [2015-04-24T11:38:20.439177 #9300]  INFO -- default-precise32:     +    my $which = shift;
I, [2015-04-24T11:38:20.439195 #9300]  INFO -- default-precise32:     +    my $what  = shift;
I, [2015-04-24T11:38:20.439213 #9300]  INFO -- default-precise32:     +    my $name  = shift;
I, [2015-04-24T11:38:20.439230 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.439248 #9300]  INFO -- default-precise32:     +    my $mode = "admin";
I, [2015-04-24T11:38:20.439278 #9300]  INFO -- default-precise32:     +    $mode = "maint" if $maintmode;
I, [2015-04-24T11:38:20.439296 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.439346 #9300]  INFO -- default-precise32:     +    #print("switch_marker $which $what $name\n");
I, [2015-04-24T11:38:20.439366 #9300]  INFO -- default-precise32:     +    # TODO: get rid of the magic string(s)
I, [2015-04-24T11:38:20.439401 #9300]  INFO -- default-precise32:     +    my $state_marker_dir = "$statedir/$what" . "d" . "_by_$mode";
I, [2015-04-24T11:38:20.439420 #9300]  INFO -- default-precise32:     +    my $state_marker     = "$state_marker_dir/$name";
I, [2015-04-24T11:38:20.439439 #9300]  INFO -- default-precise32:     +    if ( !-d $state_marker_dir ) {
I, [2015-04-24T11:38:20.439458 #9300]  INFO -- default-precise32:     +        File::Path::mkpath("$state_marker_dir")
I, [2015-04-24T11:38:20.439476 #9300]  INFO -- default-precise32:     +            || error(
I, [2015-04-24T11:38:20.439495 #9300]  INFO -- default-precise32:     +            "Failed to create marker directory: '$state_marker_dir'\n");
I, [2015-04-24T11:38:20.439513 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.439531 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.439549 #9300]  INFO -- default-precise32:     +    # XXX: swap find with perl alternative
I, [2015-04-24T11:38:20.439566 #9300]  INFO -- default-precise32:     +    my @markers = qx{find "$statedir" -type f -a -name "$name"};
I, [2015-04-24T11:38:20.439585 #9300]  INFO -- default-precise32:     +    chomp(@markers);
I, [2015-04-24T11:38:20.439615 #9300]  INFO -- default-precise32:     +    foreach (@markers) {
I, [2015-04-24T11:38:20.439660 #9300]  INFO -- default-precise32:     +        unless ( unlink $_ ) {
I, [2015-04-24T11:38:20.439679 #9300]  INFO -- default-precise32:     +            error("Failed to remove old marker '$_'!\n") && return 0;
I, [2015-04-24T11:38:20.439698 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:20.439716 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.439734 #9300]  INFO -- default-precise32:     +    unless ($purge) {
I, [2015-04-24T11:38:20.439751 #9300]  INFO -- default-precise32:     +        qx{touch "$state_marker"};
I, [2015-04-24T11:38:20.439769 #9300]  INFO -- default-precise32:     +        if ( $? != 0 ) {
I, [2015-04-24T11:38:20.439788 #9300]  INFO -- default-precise32:     +            error("Failed to create marker '$state_marker'!\n") && return 0;
I, [2015-04-24T11:38:20.439806 #9300]  INFO -- default-precise32:     +        }
I, [2015-04-24T11:38:20.439824 #9300]  INFO -- default-precise32:     +        return 1;
I, [2015-04-24T11:38:20.439842 #9300]  INFO -- default-precise32:     +    }
I, [2015-04-24T11:38:20.439860 #9300]  INFO -- default-precise32:     +}
I, [2015-04-24T11:38:20.439878 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.439896 #9300]  INFO -- default-precise32:     +# vim: syntax=perl sw=4 sts=4 sr et
I, [2015-04-24T11:38:20.439914 #9300]  INFO -- default-precise32:     - change mode from '' to '0700'
I, [2015-04-24T11:38:20.439932 #9300]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:38:20.441999 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:20.443238 #9300]  INFO -- default-precise32:   * directory[/etc/apache2/ssl] action create
I, [2015-04-24T11:38:20.447548 #9300]  INFO -- default-precise32:     - create new directory /etc/apache2/ssl
I, [2015-04-24T11:38:20.450242 #9300]  INFO -- default-precise32:     - change mode from '' to '0755'
I, [2015-04-24T11:38:20.452231 #9300]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:38:20.458100 #9300]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:38:20.471506 #9300]  INFO -- default-precise32:   * directory[/var/cache/apache2] action create
I, [2015-04-24T11:38:20.473513 #9300]  INFO -- default-precise32:     - change owner from 'www-data' to 'root'
I, [2015-04-24T11:38:20.476865 #9300]  INFO -- default-precise32:     - change group from 'www-data' to 'root'
I, [2015-04-24T11:38:20.486484 #9300]  INFO -- default-precise32:   * directory[/var/lock/apache2] action create (up to date)
I, [2015-04-24T11:38:20.490451 #9300]  INFO -- default-precise32:   * template[/etc/sysconfig/apache2] action create (skipped due to only_if)
I, [2015-04-24T11:38:20.504463 #9300]  INFO -- default-precise32:   * template[/etc/apache2/envvars] action create
I, [2015-04-24T11:38:20.506428 #9300]  INFO -- default-precise32:     - update content in file /etc/apache2/envvars from 57ed3f to ed0ad7
I, [2015-04-24T11:38:20.509442 #9300]  INFO -- default-precise32:     --- /etc/apache2/envvars	2012-02-07 04:16:59.000000000 +0000
I, [2015-04-24T11:38:20.513529 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-nnpcan	2015-04-24 08:38:20.488688033 +0000
I, [2015-04-24T11:38:20.513563 #9300]  INFO -- default-precise32:     @@ -3,30 +3,22 @@
I, [2015-04-24T11:38:20.513585 #9300]  INFO -- default-precise32:      # this won't be correct after changing uid
I, [2015-04-24T11:38:20.513605 #9300]  INFO -- default-precise32:      unset HOME
I, [2015-04-24T11:38:20.513623 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.513642 #9300]  INFO -- default-precise32:     -# for supporting multiple apache2 instances
I, [2015-04-24T11:38:20.513660 #9300]  INFO -- default-precise32:     -if [ "${APACHE_CONFDIR##/etc/apache2-}" != "${APACHE_CONFDIR}" ] ; then
I, [2015-04-24T11:38:20.513705 #9300]  INFO -- default-precise32:     -	SUFFIX="-${APACHE_CONFDIR##/etc/apache2-}"
I, [2015-04-24T11:38:20.513724 #9300]  INFO -- default-precise32:     -else
I, [2015-04-24T11:38:20.513754 #9300]  INFO -- default-precise32:     -	SUFFIX=
I, [2015-04-24T11:38:20.513771 #9300]  INFO -- default-precise32:     -fi
I, [2015-04-24T11:38:20.513789 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:20.513807 #9300]  INFO -- default-precise32:      # Since there is no sane way to get the parsed apache2 config in scripts, some
I, [2015-04-24T11:38:20.513826 #9300]  INFO -- default-precise32:      # settings are defined via environment variables and then used in apache2ctl,
I, [2015-04-24T11:38:20.513844 #9300]  INFO -- default-precise32:      # /etc/init.d/apache2, /etc/logrotate.d/apache2, etc.
I, [2015-04-24T11:38:20.513863 #9300]  INFO -- default-precise32:      export APACHE_RUN_USER=www-data
I, [2015-04-24T11:38:20.513881 #9300]  INFO -- default-precise32:      export APACHE_RUN_GROUP=www-data
I, [2015-04-24T11:38:20.513898 #9300]  INFO -- default-precise32:     -export APACHE_PID_FILE=/var/run/apache2$SUFFIX.pid
I, [2015-04-24T11:38:20.513917 #9300]  INFO -- default-precise32:     -export APACHE_RUN_DIR=/var/run/apache2$SUFFIX
I, [2015-04-24T11:38:20.513935 #9300]  INFO -- default-precise32:     -export APACHE_LOCK_DIR=/var/lock/apache2$SUFFIX
I, [2015-04-24T11:38:20.513953 #9300]  INFO -- default-precise32:     +# temporary state file location. This might be changed to /run in Wheezy+1
I, [2015-04-24T11:38:20.513972 #9300]  INFO -- default-precise32:     +export APACHE_PID_FILE=/var/run/apache2.pid
I, [2015-04-24T11:38:20.513990 #9300]  INFO -- default-precise32:     +export APACHE_RUN_DIR=/var/run/apache2
I, [2015-04-24T11:38:20.514008 #9300]  INFO -- default-precise32:     +export APACHE_LOCK_DIR=/var/lock/apache2
I, [2015-04-24T11:38:20.514026 #9300]  INFO -- default-precise32:      # Only /var/log/apache2 is handled by /etc/logrotate.d/apache2.
I, [2015-04-24T11:38:20.514058 #9300]  INFO -- default-precise32:     -export APACHE_LOG_DIR=/var/log/apache2$SUFFIX
I, [2015-04-24T11:38:20.514077 #9300]  INFO -- default-precise32:     +export APACHE_LOG_DIR=/var/log/apache2
I, [2015-04-24T11:38:20.514095 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.514113 #9300]  INFO -- default-precise32:      ## The locale used by some modules like mod_dav
I, [2015-04-24T11:38:20.514130 #9300]  INFO -- default-precise32:      export LANG=C
I, [2015-04-24T11:38:20.514148 #9300]  INFO -- default-precise32:     -## Uncomment the following line to use the system default locale instead:
I, [2015-04-24T11:38:20.514166 #9300]  INFO -- default-precise32:     -#. /etc/default/locale
I, [2015-04-24T11:38:20.514184 #9300]  INFO -- default-precise32:     +export LC_ALL=C
I, [2015-04-24T11:38:20.514202 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.514225 #9300]  INFO -- default-precise32:     -export LANG
I, [2015-04-24T11:38:20.514244 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.514276 #9300]  INFO -- default-precise32:      ## The command to get the status for 'apache2ctl status'.
I, [2015-04-24T11:38:20.514305 #9300]  INFO -- default-precise32:      ## Some packages providing 'www-browser' need '--dump' instead of '-dump'.
I, [2015-04-24T11:38:20.514329 #9300]  INFO -- default-precise32:     @@ -35,4 +27,13 @@
I, [2015-04-24T11:38:20.514349 #9300]  INFO -- default-precise32:      ## If you need a higher file descriptor limit, uncomment and adjust the
I, [2015-04-24T11:38:20.514368 #9300]  INFO -- default-precise32:      ## following line (default is 8192):
I, [2015-04-24T11:38:20.514385 #9300]  INFO -- default-precise32:      #APACHE_ULIMIT_MAX_FILES='ulimit -n 65536'
I, [2015-04-24T11:38:20.514403 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.514421 #9300]  INFO -- default-precise32:     +## If you would like to pass arguments to the web server, add them below
I, [2015-04-24T11:38:20.514439 #9300]  INFO -- default-precise32:     +## to the APACHE_ARGUMENTS environment.
I, [2015-04-24T11:38:20.514456 #9300]  INFO -- default-precise32:     +#export APACHE_ARGUMENTS=''
I, [2015-04-24T11:38:20.514473 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.514505 #9300]  INFO -- default-precise32:     +## Enable the debug mode for maintainer scripts.
I, [2015-04-24T11:38:20.514524 #9300]  INFO -- default-precise32:     +## This will produce a verbose output on package installations of web server modules and web application
I, [2015-04-24T11:38:20.514542 #9300]  INFO -- default-precise32:     +## installations which interact with Apache
I, [2015-04-24T11:38:20.518153 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:20.537580 #9300]  INFO -- default-precise32:   * template[apache2.conf] action create
I, [2015-04-24T11:38:20.539920 #9300]  INFO -- default-precise32:     - update content in file /etc/apache2/apache2.conf from ad8601 to 9e43cc
I, [2015-04-24T11:38:20.543564 #9300]  INFO -- default-precise32:     --- /etc/apache2/apache2.conf	2012-02-07 04:16:59.000000000 +0000
I, [2015-04-24T11:38:20.547173 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-gs6qul	2015-04-24 08:38:20.520687631 +0000
I, [2015-04-24T11:38:20.550425 #9300]  INFO -- default-precise32:     @@ -1,65 +1,20 @@
I, [2015-04-24T11:38:20.552424 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.554429 #9300]  INFO -- default-precise32:     -# Based upon the NCSA server configuration files originally by Rob McCool.
I, [2015-04-24T11:38:20.556336 #9300]  INFO -- default-precise32:     +# Generated by Chef
I, [2015-04-24T11:38:20.558124 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.559616 #9300]  INFO -- default-precise32:     -# This is the main Apache server configuration file.  It contains the
I, [2015-04-24T11:38:20.562186 #9300]  INFO -- default-precise32:     -# configuration directives that give the server its instructions.
I, [2015-04-24T11:38:20.564430 #9300]  INFO -- default-precise32:     -# See http://httpd.apache.org/docs/2.2/ for detailed information about
I, [2015-04-24T11:38:20.566620 #9300]  INFO -- default-precise32:     -# the directives.
I, [2015-04-24T11:38:20.568611 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:20.570775 #9300]  INFO -- default-precise32:     -# Do NOT simply read the instructions in here without understanding
I, [2015-04-24T11:38:20.572755 #9300]  INFO -- default-precise32:     -# what they do.  They're here only as hints or reminders.  If you are unsure
I, [2015-04-24T11:38:20.575431 #9300]  INFO -- default-precise32:     -# consult the online docs. You have been warned.  
I, [2015-04-24T11:38:20.577338 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:20.579582 #9300]  INFO -- default-precise32:     -# The configuration directives are grouped into three basic sections:
I, [2015-04-24T11:38:20.582463 #9300]  INFO -- default-precise32:     -#  1. Directives that control the operation of the Apache server process as a
I, [2015-04-24T11:38:20.584596 #9300]  INFO -- default-precise32:     -#     whole (the 'global environment').
I, [2015-04-24T11:38:20.586584 #9300]  INFO -- default-precise32:     -#  2. Directives that define the parameters of the 'main' or 'default' server,
I, [2015-04-24T11:38:20.589010 #9300]  INFO -- default-precise32:     -#     which responds to requests that aren't handled by a virtual host.
I, [2015-04-24T11:38:20.591425 #9300]  INFO -- default-precise32:     -#     These directives also provide default values for the settings
I, [2015-04-24T11:38:20.592428 #9300]  INFO -- default-precise32:     -#     of all virtual hosts.
I, [2015-04-24T11:38:20.594576 #9300]  INFO -- default-precise32:     -#  3. Settings for virtual hosts, which allow Web requests to be sent to
I, [2015-04-24T11:38:20.597418 #9300]  INFO -- default-precise32:     -#     different IP addresses or hostnames and have them handled by the
I, [2015-04-24T11:38:20.601733 #9300]  INFO -- default-precise32:     -#     same Apache server process.
I, [2015-04-24T11:38:20.601764 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:20.601786 #9300]  INFO -- default-precise32:     -# Configuration and logfile names: If the filenames you specify for many
I, [2015-04-24T11:38:20.601806 #9300]  INFO -- default-precise32:     -# of the server's control files begin with "/" (or "drive:/" for Win32), the
I, [2015-04-24T11:38:20.601825 #9300]  INFO -- default-precise32:     -# server will use that explicit path.  If the filenames do *not* begin
I, [2015-04-24T11:38:20.603405 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:20.604419 #9300]  INFO -- default-precise32:     -# with ServerRoot set to "/etc/apache2" will be interpreted by the
I, [2015-04-24T11:38:20.606574 #9300]  INFO -- default-precise32:     -# server as "/etc/apache2/foo.log".
I, [2015-04-24T11:38:20.608704 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:20.611434 #9300]  INFO -- default-precise32:     +# Based on the Ubuntu apache2.conf
I, [2015-04-24T11:38:20.614435 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.614466 #9300]  INFO -- default-precise32:     -### Section 1: Global Environment
I, [2015-04-24T11:38:20.615452 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:20.617343 #9300]  INFO -- default-precise32:     -# The directives in this section affect the overall operation of Apache,
I, [2015-04-24T11:38:20.617375 #9300]  INFO -- default-precise32:     -# such as the number of concurrent requests it can handle or where it
I, [2015-04-24T11:38:20.619432 #9300]  INFO -- default-precise32: -# can find its configuration files.
I, [2015-04-24T11:38:20.621433 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:20.623602 #9300]  INFO -- default-precise32:     +ServerRoot "/etc/apache2"
I, [2015-04-24T11:38:20.626430 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.628602 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.630596 #9300]  INFO -- default-precise32:     -# ServerRoot: The top of the directory tree under which the server's
I, [2015-04-24T11:38:20.632617 #9300]  INFO -- default-precise32:     -# configuration, error, and log files are kept.
I, [2015-04-24T11:38:20.634606 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:20.637121 #9300]  INFO -- default-precise32:     -# NOTE!  If you intend to place this on an NFS (or otherwise network)
I, [2015-04-24T11:38:20.639576 #9300]  INFO -- default-precise32:     -# mounted filesystem then please read the LockFile documentation (available
I, [2015-04-24T11:38:20.641577 #9300]  INFO -- default-precise32:     -# at <URL:http://httpd.apache.org/docs/2.2/mod/mpm_common.html#lockfile>);
I, [2015-04-24T11:38:20.643526 #9300]  INFO -- default-precise32:     -# you will save yourself a lot of trouble.
I, [2015-04-24T11:38:20.645422 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:20.647243 #9300]  INFO -- default-precise32:     -# Do NOT add a slash at the end of the directory path.
I, [2015-04-24T11:38:20.648482 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:20.650473 #9300]  INFO -- default-precise32:     -#ServerRoot "/etc/apache2"
I, [2015-04-24T11:38:20.652429 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:20.652462 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:20.698601 #9300]  INFO -- default-precise32:      # The accept serialization lock file MUST BE STORED ON A LOCAL DISK.
I, [2015-04-24T11:38:20.698671 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.698696 #9300]  INFO -- default-precise32:     -LockFile ${APACHE_LOCK_DIR}/accept.lock
I, [2015-04-24T11:38:20.698718 #9300]  INFO -- default-precise32:     +LockFile /var/lock/apache2/accept.lock
I, [2015-04-24T11:38:20.698741 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.698761 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.698788 #9300]  INFO -- default-precise32:      # PidFile: The file in which the server should record its process
I, [2015-04-24T11:38:20.698809 #9300]  INFO -- default-precise32:      # identification number when it starts.
I, [2015-04-24T11:38:20.698828 #9300]  INFO -- default-precise32:     -# This needs to be set in /etc/apache2/envvars
I, [2015-04-24T11:38:20.698847 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.698865 #9300]  INFO -- default-precise32:     -PidFile ${APACHE_PID_FILE}
I, [2015-04-24T11:38:20.698884 #9300]  INFO -- default-precise32:     +PidFile /var/run/apache2.pid
I, [2015-04-24T11:38:20.698902 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.698929 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.698948 #9300]  INFO -- default-precise32:      # Timeout: The number of seconds before receives and sends time out.
I, [2015-04-24T11:38:20.698966 #9300]  INFO -- default-precise32:     @@ -85,65 +40,12 @@
I, [2015-04-24T11:38:20.698984 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.699001 #9300]  INFO -- default-precise32:      KeepAliveTimeout 5
I, [2015-04-24T11:38:20.699019 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.699037 #9300]  INFO -- default-precise32:     -##
I, [2015-04-24T11:38:20.699055 #9300]  INFO -- default-precise32:     -## Server-Pool Size Regulation (MPM specific)
I, [2015-04-24T11:38:20.699079 #9300]  INFO -- default-precise32:     -## 
I, [2015-04-24T11:38:20.699097 #9300]  INFO -- default-precise32:     +#<IfModule unixd_module>
I, [2015-04-24T11:38:20.699115 #9300]  INFO -- default-precise32:     +User www-data
I, [2015-04-24T11:38:20.699132 #9300]  INFO -- default-precise32:     +Group www-data
I, [2015-04-24T11:38:20.699150 #9300]  INFO -- default-precise32:     +#</IfModule>
I, [2015-04-24T11:38:20.699167 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.699193 #9300]  INFO -- default-precise32:     -# prefork MPM
I, [2015-04-24T11:38:20.699211 #9300]  INFO -- default-precise32:     -# StartServers: number of server processes to start
I, [2015-04-24T11:38:20.699230 #9300]  INFO -- default-precise32:     -# MinSpareServers: minimum number of server processes which are kept spare
I, [2015-04-24T11:38:20.699248 #9300]  INFO -- default-precise32:     -# MaxSpareServers: maximum number of server processes which are kept spare
I, [2015-04-24T11:38:20.699283 #9300]  INFO -- default-precise32:     -# MaxClients: maximum number of server processes allowed to start
I, [2015-04-24T11:38:20.699303 #9300]  INFO -- default-precise32:     -# MaxRequestsPerChild: maximum number of requests a server process serves
I, [2015-04-24T11:38:20.699326 #9300]  INFO -- default-precise32:     -<IfModule mpm_prefork_module>
I, [2015-04-24T11:38:20.699347 #9300]  INFO -- default-precise32:     -    StartServers          5
I, [2015-04-24T11:38:20.699365 #9300]  INFO -- default-precise32:     -    MinSpareServers       5
I, [2015-04-24T11:38:20.699383 #9300]  INFO -- default-precise32:     -    MaxSpareServers      10
I, [2015-04-24T11:38:20.699421 #9300]  INFO -- default-precise32:     -    MaxClients          150
I, [2015-04-24T11:38:20.699440 #9300]  INFO -- default-precise32:     -    MaxRequestsPerChild   0
I, [2015-04-24T11:38:20.699458 #9300]  INFO -- default-precise32:     -</IfModule>
I, [2015-04-24T11:38:20.699475 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.699493 #9300]  INFO -- default-precise32:     -# worker MPM
I, [2015-04-24T11:38:20.699511 #9300]  INFO -- default-precise32:     -# StartServers: initial number of server processes to start
I, [2015-04-24T11:38:20.699529 #9300]  INFO -- default-precise32:     -# MinSpareThreads: minimum number of worker threads which are kept spare
I, [2015-04-24T11:38:20.699547 #9300]  INFO -- default-precise32:     -# MaxSpareThreads: maximum number of worker threads which are kept spare
I, [2015-04-24T11:38:20.699566 #9300]  INFO -- default-precise32:     -# ThreadLimit: ThreadsPerChild can be changed to this maximum value during a
I, [2015-04-24T11:38:20.699584 #9300]  INFO -- default-precise32:     -#              graceful restart. ThreadLimit can only be changed by stopping
I, [2015-04-24T11:38:20.699603 #9300]  INFO -- default-precise32:     -#              and starting Apache.
I, [2015-04-24T11:38:20.699621 #9300]  INFO -- default-precise32:     -# ThreadsPerChild: constant number of worker threads in each server process
I, [2015-04-24T11:38:20.699640 #9300]  INFO -- default-precise32:     -# MaxClients: maximum number of simultaneous client connections
I, [2015-04-24T11:38:20.699662 #9300]  INFO -- default-precise32:     -# MaxRequestsPerChild: maximum number of requests a server process serves
I, [2015-04-24T11:38:20.699681 #9300]  INFO -- default-precise32:     -<IfModule mpm_worker_module>
I, [2015-04-24T11:38:20.699699 #9300]  INFO -- default-precise32:     -    StartServers          2
I, [2015-04-24T11:38:20.699727 #9300]  INFO -- default-precise32:     -    MinSpareThreads      25
I, [2015-04-24T11:38:20.699746 #9300]  INFO -- default-precise32:     -    MaxSpareThreads      75 
I, [2015-04-24T11:38:20.699772 #9300]  INFO -- default-precise32:     -    ThreadLimit          64
I, [2015-04-24T11:38:20.699793 #9300]  INFO -- default-precise32:     -    ThreadsPerChild      25
I, [2015-04-24T11:38:20.699811 #9300]  INFO -- default-precise32:     -    MaxClients          150
I, [2015-04-24T11:38:20.699829 #9300]  INFO -- default-precise32:     -    MaxRequestsPerChild   0
I, [2015-04-24T11:38:20.699847 #9300]  INFO -- default-precise32:     -</IfModule>
I, [2015-04-24T11:38:20.699864 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:20.699882 #9300]  INFO -- default-precise32:     -# event MPM
I, [2015-04-24T11:38:20.699899 #9300]  INFO -- default-precise32:     -# StartServers: initial number of server processes to start
I, [2015-04-24T11:38:20.699918 #9300]  INFO -- default-precise32:     -# MinSpareThreads: minimum number of worker threads which are kept spare
I, [2015-04-24T11:38:20.699936 #9300]  INFO -- default-precise32:     -# MaxSpareThreads: maximum number of worker threads which are kept spare
I, [2015-04-24T11:38:20.699954 #9300]  INFO -- default-precise32:     -# ThreadsPerChild: constant number of worker threads in each server process
I, [2015-04-24T11:38:20.699976 #9300]  INFO -- default-precise32:     -# MaxClients: maximum number of simultaneous client connections
I, [2015-04-24T11:38:20.699997 #9300]  INFO -- default-precise32:     -# MaxRequestsPerChild: maximum number of requests a server process serves
I, [2015-04-24T11:38:20.700016 #9300]  INFO -- default-precise32:     -<IfModule mpm_event_module>
I, [2015-04-24T11:38:20.700034 #9300]  INFO -- default-precise32:     -    StartServers          2
I, [2015-04-24T11:38:20.700057 #9300]  INFO -- default-precise32:     -    MinSpareThreads      25
I, [2015-04-24T11:38:20.700075 #9300]  INFO -- default-precise32:     -    MaxSpareThreads      75 
I, [2015-04-24T11:38:20.700094 #9300]  INFO -- default-precise32:     -    ThreadLimit          64
I, [2015-04-24T11:38:20.700116 #9300]  INFO -- default-precise32:     -    ThreadsPerChild      25
I, [2015-04-24T11:38:20.700141 #9300]  INFO -- default-precise32:     -    MaxClients          150
I, [2015-04-24T11:38:20.700159 #9300]  INFO -- default-precise32:     -    MaxRequestsPerChild   0
I, [2015-04-24T11:38:20.700176 #9300]  INFO -- default-precise32:     -</IfModule>
I, [2015-04-24T11:38:20.700194 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:20.700211 #9300]  INFO -- default-precise32:     -# These need to be set in /etc/apache2/envvars
I, [2015-04-24T11:38:20.700229 #9300]  INFO -- default-precise32:     -User ${APACHE_RUN_USER}
I, [2015-04-24T11:38:20.700247 #9300]  INFO -- default-precise32:     -Group ${APACHE_RUN_GROUP}
I, [2015-04-24T11:38:20.700282 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:20.700300 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.700323 #9300]  INFO -- default-precise32:      # AccessFileName: The name of the file to look for in each directory
I, [2015-04-24T11:38:20.700346 #9300]  INFO -- default-precise32:      # for additional configuration directives.  See also the AllowOverride
I, [2015-04-24T11:38:20.700365 #9300]  INFO -- default-precise32:     @@ -153,13 +55,12 @@
I, [2015-04-24T11:38:20.700387 #9300]  INFO -- default-precise32:      AccessFileName .htaccess
I, [2015-04-24T11:38:20.700404 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.700422 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.700440 #9300]  INFO -- default-precise32:     -# The following lines prevent .htaccess and .htpasswd files from being 
I, [2015-04-24T11:38:20.700463 #9300]  INFO -- default-precise32:     -# viewed by Web clients. 
I, [2015-04-24T11:38:20.700482 #9300]  INFO -- default-precise32:     +# The following lines prevent .htaccess and .htpasswd files from being
I, [2015-04-24T11:38:20.700503 #9300]  INFO -- default-precise32:     +# viewed by Web clients.
I, [2015-04-24T11:38:20.700521 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.700541 #9300]  INFO -- default-precise32:      <Files ~ "^\.ht">
I, [2015-04-24T11:38:20.700574 #9300]  INFO -- default-precise32:   Order allow,deny
I, [2015-04-24T11:38:20.700598 #9300]  INFO -- default-precise32:   Deny from all
I, [2015-04-24T11:38:20.700622 #9300]  INFO -- default-precise32:     -    Satisfy all
I, [2015-04-24T11:38:20.700640 #9300]  INFO -- default-precise32:      </Files>
I, [2015-04-24T11:38:20.700658 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.700675 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.700693 #9300]  INFO -- default-precise32:     @@ -171,16 +72,8 @@
I, [2015-04-24T11:38:20.700714 #9300]  INFO -- default-precise32:      # keep browsers from trying to display binary files as though they are
I, [2015-04-24T11:38:20.700732 #9300]  INFO -- default-precise32:      # text.
I, [2015-04-24T11:38:20.700750 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.700771 #9300]  INFO -- default-precise32:     -# It is also possible to omit any default MIME type and let the
I, [2015-04-24T11:38:20.702924 #9300]  INFO -- default-precise32: ad. Typically the
I, [2015-04-24T11:38:20.702953 #9300]  INFO -- default-precise32:     -# browser will decide based on the file's extension then. In cases
I, [2015-04-24T11:38:20.702973 #9300]  INFO -- default-precise32:     -# where no good assumption can be made, letting the default MIME type
I, [2015-04-24T11:38:20.702992 #9300]  INFO -- default-precise32:     -# unset is suggested  instead of forcing the browser to accept
I, [2015-04-24T11:38:20.703011 #9300]  INFO -- default-precise32:     -# incorrect  metadata.
I, [2015-04-24T11:38:20.703028 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:20.703046 #9300]  INFO -- default-precise32:     -DefaultType None
I, [2015-04-24T11:38:20.703074 #9300]  INFO -- default-precise32:     +DefaultType text/plain
I, [2015-04-24T11:38:20.703092 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.703109 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:20.703130 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.703149 #9300]  INFO -- default-precise32:      # HostnameLookups: Log the names of clients or just their IP addresses
I, [2015-04-24T11:38:20.703168 #9300]  INFO -- default-precise32:      # e.g., www.apache.org (on) or 204.62.129.132 (off).
I, [2015-04-24T11:38:20.703187 #9300]  INFO -- default-precise32:     @@ -197,7 +90,7 @@
I, [2015-04-24T11:38:20.703224 #9300]  INFO -- default-precise32:      # logged here.  If you *do* define an error logfile for a <VirtualHost>
I, [2015-04-24T11:38:20.703245 #9300]  INFO -- default-precise32:      # container, that host's errors will be logged there and not here.
I, [2015-04-24T11:38:20.703286 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.703308 #9300]  INFO -- default-precise32:     -ErrorLog ${APACHE_LOG_DIR}/error.log
I, [2015-04-24T11:38:20.703334 #9300]  INFO -- default-precise32:     +ErrorLog /var/log/apache2/error.log
I, [2015-04-24T11:38:20.703356 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.703374 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.703392 #9300]  INFO -- default-precise32:      # LogLevel: Control the number of messages logged to the error_log.
I, [2015-04-24T11:38:20.703413 #9300]  INFO -- default-precise32:     @@ -206,33 +99,93 @@
I, [2015-04-24T11:38:20.703431 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.703455 #9300]  INFO -- default-precise32:      LogLevel warn
I, [2015-04-24T11:38:20.703485 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.703504 #9300]  INFO -- default-precise32:     +# COOK-1021: Dummy LoadModule directive to aid module installations
I, [2015-04-24T11:38:20.703523 #9300]  INFO -- default-precise32:     +#LoadModule dummy_module modules/mod_dummy.so
I, [2015-04-24T11:38:20.703542 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.703560 #9300]  INFO -- default-precise32:      # Include module configuration:
I, [2015-04-24T11:38:20.703578 #9300]  INFO -- default-precise32:     -Include mods-enabled/*.load
I, [2015-04-24T11:38:20.703604 #9300]  INFO -- default-precise32:     -Include mods-enabled/*.conf
I, [2015-04-24T11:38:20.703623 #9300]  INFO -- default-precise32:     +Include /etc/apache2/mods-enabled/*.load
I, [2015-04-24T11:38:20.703642 #9300]  INFO -- default-precise32:     +Include /etc/apache2/mods-enabled/*.conf
I, [2015-04-24T11:38:20.703660 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.703678 #9300]  INFO -- default-precise32:     -# Include all the user configurations:
I, [2015-04-24T11:38:20.703696 #9300]  INFO -- default-precise32:     -Include httpd.conf
I, [2015-04-24T11:38:20.703714 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.703732 #9300]  INFO -- default-precise32:      # Include ports listing
I, [2015-04-24T11:38:20.703755 #9300]  INFO -- default-precise32:     -Include ports.conf
I, [2015-04-24T11:38:20.703785 #9300]  INFO -- default-precise32:     +Include /etc/apache2/ports.conf
I, [2015-04-24T11:38:20.703803 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.703820 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.703843 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.703861 #9300]  INFO -- default-precise32:      # The following directives define some format nicknames for use with
I, [2015-04-24T11:38:20.703880 #9300]  INFO -- default-precise32:      # a CustomLog directive (see below).
I, [2015-04-24T11:38:20.703898 #9300]  INFO -- default-precise32:     -# If you are behind a reverse proxy, you might want to change %h into %{X-Forwarded-For}i
I, [2015-04-24T11:38:20.703916 #9300]  INFO -- default-precise32:      #
I, [2015-04-24T11:38:20.703942 #9300]  INFO -- default-precise32:      LogFormat "%v:%p %h %l %u %t \"%r\" %>s %O \"%{Referer}i\" \"%{User-Agent}i\"" vhost_combined
I, [2015-04-24T11:38:20.703961 #9300]  INFO -- default-precise32:     -LogFormat "%h %l %u %t \"%r\" %>s %O \"%{Referer}i\" \"%{User-Agent}i\"" combined
I, [2015-04-24T11:38:20.703983 #9300]  INFO -- default-precise32:     -LogFormat "%h %l %u %t \"%r\" %>s %O" common
I, [2015-04-24T11:38:20.704002 #9300]  INFO -- default-precise32:     +LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
I, [2015-04-24T11:38:20.705153 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:20.705403 #9300]  INFO -- default-precise32:      LogFormat "%{Referer}i -> %U" referer
I, [2015-04-24T11:38:20.705637 #9300]  INFO -- default-precise32:      LogFormat "%{User-agent}i" agent
I, [2015-04-24T11:38:20.706909 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.707116 #9300]  INFO -- default-precise32:     +# Customizable error responses come in three flavors:
I, [2015-04-24T11:38:20.707361 #9300]  INFO -- default-precise32:     +# 1) plain text 2) local redirects 3) external redirects
I, [2015-04-24T11:38:20.707574 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.707790 #9300]  INFO -- default-precise32:     +# Some examples:
I, [2015-04-24T11:38:20.708018 #9300]  INFO -- default-precise32:     +#ErrorDocument 500 "The server made a boo boo."
I, [2015-04-24T11:38:20.708213 #9300]  INFO -- default-precise32:     +#ErrorDocument 404 /missing.html
I, [2015-04-24T11:38:20.708460 #9300]  INFO -- default-precise32:     +#ErrorDocument 404 "/cgi-bin/missing_handler.pl"
I, [2015-04-24T11:38:20.708674 #9300]  INFO -- default-precise32:     +#ErrorDocument 402 http://www.example.com/subscription_info.html
I, [2015-04-24T11:38:20.708890 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.709097 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.709338 #9300]  INFO -- default-precise32:     -# Include of directories ignores editors' and dpkg's backup files,
I, [2015-04-24T11:38:20.709557 #9300]  INFO -- default-precise32:     -# see README.Debian for details.
I, [2015-04-24T11:38:20.709768 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.709983 #9300]  INFO -- default-precise32:     +# Putting this all together, we can internationalize error responses.
I, [2015-04-24T11:38:20.710181 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.710428 #9300]  INFO -- default-precise32:     +# We use Alias to redirect any /error/HTTP_<error>.html.var response to
I, [2015-04-24T11:38:20.710651 #9300]  INFO -- default-precise32:     +# our collection of by-error message multi-language collections.  We use
I, [2015-04-24T11:38:20.710850 #9300]  INFO -- default-precise32:     +# includes to substitute the appropriate text.
I, [2015-04-24T11:38:20.711073 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.738483 #9300]  INFO -- default-precise32:     +# You can modify the messages' appearance without changing any of the
I, [2015-04-24T11:38:20.738757 #9300]  INFO -- default-precise32:     +# default HTTP_<error>.html.var files by adding the line:
I, [2015-04-24T11:38:20.738988 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.739197 #9300]  INFO -- default-precise32:     +#   Alias /error/include/ "/your/include/path/"
I, [2015-04-24T11:38:20.739450 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.739633 #9300]  INFO -- default-precise32:     +# which allows you to create your own set of files by starting with the
I, [2015-04-24T11:38:20.739833 #9300]  INFO -- default-precise32:     +# /usr/share/apache2/error/include/ files and copying them to /your/include/path/,
I, [2015-04-24T11:38:20.740016 #9300]  INFO -- default-precise32:     +# even on a per-VirtualHost basis.  The default include files will display
I, [2015-04-24T11:38:20.740215 #9300]  INFO -- default-precise32:     +# your Apache version number and your ServerAdmin email address regardless
I, [2015-04-24T11:38:20.740443 #9300]  INFO -- default-precise32:     +# of the setting of ServerSignature.
I, [2015-04-24T11:38:20.740624 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.740818 #9300]  INFO -- default-precise32:     +# The internationalized error documents require mod_alias, mod_include
I, [2015-04-24T11:38:20.741023 #9300]  INFO -- default-precise32:     +# and mod_negotiation.  To activate them, uncomment the following 30 lines.
I, [2015-04-24T11:38:20.741200 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.741425 #9300]  INFO -- default-precise32:     +#    Alias /error/ "/usr/share/apache2/error/"
I, [2015-04-24T11:38:20.741603 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.741800 #9300]  INFO -- default-precise32:     +#    <Directory "/usr/share/apache2/error">
I, [2015-04-24T11:38:20.741977 #9300]  INFO -- default-precise32:     +#        AllowOverride None
I, [2015-04-24T11:38:20.742171 #9300]  INFO -- default-precise32:     +#        Options IncludesNoExec
I, [2015-04-24T11:38:20.742462 #9300]  INFO -- default-precise32:     +#        AddOutputFilter Includes html
I, [2015-04-24T11:38:20.747175 #9300]  INFO -- default-precise32:     +#        AddHandler type-map var
I, [2015-04-24T11:38:20.749907 #9300]  INFO -- default-precise32:     +#        Order allow,deny
I, [2015-04-24T11:38:20.751903 #9300]  INFO -- default-precise32:     +#        Allow from all
I, [2015-04-24T11:38:20.754178 #9300]  INFO -- default-precise32:     +#        LanguagePriority en cs de es fr it nl sv pt-br ro
I, [2015-04-24T11:38:20.755928 #9300]  INFO -- default-precise32:     +#        ForceLanguagePriority Prefer Fallback
I, [2015-04-24T11:38:20.757768 #9300]  INFO -- default-precise32:     +#    </Directory>
I, [2015-04-24T11:38:20.760387 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.763888 #9300]  INFO -- default-precise32:     +#    ErrorDocument 400 /error/HTTP_BAD_REQUEST.html.var
I, [2015-04-24T11:38:20.765759 #9300]  INFO -- default-precise32:     +#    ErrorDocument 401 /error/HTTP_UNAUTHORIZED.html.var
I, [2015-04-24T11:38:20.767643 #9300]  INFO -- default-precise32:     +#    ErrorDocument 403 /error/HTTP_FORBIDDEN.html.var
I, [2015-04-24T11:38:20.769813 #9300]  INFO -- default-precise32:     +#    ErrorDocument 404 /error/HTTP_NOT_FOUND.html.var
I, [2015-04-24T11:38:20.771476 #9300]  INFO -- default-precise32:     +#    ErrorDocument 405 /error/HTTP_METHOD_NOT_ALLOWED.html.var
I, [2015-04-24T11:38:20.773266 #9300]  INFO -- default-precise32:     +#    ErrorDocument 408 /error/HTTP_REQUEST_TIME_OUT.html.var
I, [2015-04-24T11:38:20.775337 #9300]  INFO -- default-precise32:     +#    ErrorDocument 410 /error/HTTP_GONE.html.var
I, [2015-04-24T11:38:20.777234 #9300]  INFO -- default-precise32:     +#    ErrorDocument 411 /error/HTTP_LENGTH_REQUIRED.html.var
I, [2015-04-24T11:38:20.779153 #9300]  INFO -- default-precise32:     +#    ErrorDocument 412 /error/HTTP_PRECONDITION_FAILED.html.var
I, [2015-04-24T11:38:20.780962 #9300]  INFO -- default-precise32:     +#    ErrorDocument 413 /error/HTTP_REQUEST_ENTITY_TOO_LARGE.html.var
I, [2015-04-24T11:38:20.782904 #9300]  INFO -- default-precise32:     +#    ErrorDocument 414 /error/HTTP_REQUEST_URI_TOO_LARGE.html.var
I, [2015-04-24T11:38:20.784782 #9300]  INFO -- default-precise32:     +#    ErrorDocument 415 /error/HTTP_UNSUPPORTED_MEDIA_TYPE.html.var
I, [2015-04-24T11:38:20.786664 #9300]  INFO -- default-precise32:     +#    ErrorDocument 500 /error/HTTP_INTERNAL_SERVER_ERROR.html.var
I, [2015-04-24T11:38:20.788354 #9300]  INFO -- default-precise32:     +#    ErrorDocument 501 /error/HTTP_NOT_IMPLEMENTED.html.var
I, [2015-04-24T11:38:20.790371 #9300]  INFO -- default-precise32:     +#    ErrorDocument 502 /error/HTTP_BAD_GATEWAY.html.var
I, [2015-04-24T11:38:20.793077 #9300]  INFO -- default-precise32:     +#    ErrorDocument 503 /error/HTTP_SERVICE_UNAVAILABLE.html.var
I, [2015-04-24T11:38:20.796173 #9300]  INFO -- default-precise32:     +#    ErrorDocument 506 /error/HTTP_VARIANT_ALSO_VARIES.html.var
I, [2015-04-24T11:38:20.797962 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.800188 #9300]  INFO -- default-precise32:      # Include generic snippets of statements
I, [2015-04-24T11:38:20.802913 #9300]  INFO -- default-precise32:     -Include conf.d/
I, [2015-04-24T11:38:20.805221 #9300]  INFO -- default-precise32:     +Include /etc/apache2/conf-enabled/*.conf
I, [2015-04-24T11:38:20.807112 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:20.809322 #9300]  INFO -- default-precise32:      # Include the virtual host configurations:
I, [2015-04-24T11:38:20.812167 #9300]  INFO -- default-precise32:     -Include sites-enabled/
I, [2015-04-24T11:38:20.818133 #9300]  INFO -- default-precise32:     +Include /etc/apache2/sites-enabled/*.conf
I, [2015-04-24T11:38:20.822864 #9300]  INFO -- default-precise32:   * file[/etc/apache2/conf-available/security] action delete (up to date)
I, [2015-04-24T11:38:20.828957 #9300]  INFO -- default-precise32:   * template[/etc/apache2/conf-available/security.conf] action create
I, [2015-04-24T11:38:20.835188 #9300]  INFO -- default-precise32:     - create new file /etc/apache2/conf-available/security.conf
I, [2015-04-24T11:38:20.838206 #9300]  INFO -- default-precise32:     - update content in file /etc/apache2/conf-available/security.conf from none to 595bd1
I, [2015-04-24T11:38:20.842435 #9300]  INFO -- default-precise32:     --- /etc/apache2/conf-available/security.conf	2015-04-24 08:38:20.820683859 +0000
I, [2015-04-24T11:38:20.846366 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-6nfdyi	2015-04-24 08:38:20.820683859 +0000
I, [2015-04-24T11:38:20.849171 #9300]  INFO -- default-precise32:     @@ -1 +1,46 @@
I, [2015-04-24T11:38:20.851896 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.854246 #9300]  INFO -- default-precise32:     +# Disable access to the entire file system except for the directories that
I, [2015-04-24T11:38:20.856345 #9300]  INFO -- default-precise32:     +# are explicitly allowed later.
I, [2015-04-24T11:38:20.859009 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.861137 #9300]  INFO -- default-precise32:     +# This currently breaks the configurations that come with some web application
I, [2015-04-24T11:38:20.863718 #9300]  INFO -- default-precise32:     +# Debian packages. It will be made the default for the release after lenny.
I, [2015-04-24T11:38:20.866113 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.868607 #9300]  INFO -- default-precise32:     +#<Directory />
I, [2015-04-24T11:38:20.872465 #9300]  INFO -- default-precise32:     +#	AllowOverride None
I, [2015-04-24T11:38:20.876679 #9300]  INFO -- default-precise32:     +#	Order Deny,Allow
I, [2015-04-24T11:38:20.881040 #9300]  INFO -- default-precise32:     +#	Deny from all
I, [2015-04-24T11:38:20.884168 #9300]  INFO -- default-precise32:     +#</Directory>
I, [2015-04-24T11:38:20.886106 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.888293 #9300]  INFO -- default-precise32:     +# Changing the following options will not really affect the security of the
I, [2015-04-24T11:38:20.891189 #9300]  INFO -- default-precise32:     +# server, but might make attacks slightly more difficult in some cases.
I, [2015-04-24T11:38:20.893058 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.895264 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.897298 #9300]  INFO -- default-precise32:     +# ServerTokens
I, [2015-04-24T11:38:20.899879 #9300]  INFO -- default-precise32:     +# This directive configures what you return as the Server HTTP response
I, [2015-04-24T11:38:20.902433 #9300]  INFO -- default-precise32:     +# Header. The default is 'Full' which sends information about the OS-Type
I, [2015-04-24T11:38:20.904877 #9300]  INFO -- default-precise32:     +# and compiled in modules.
I, [2015-04-24T11:38:20.907193 #9300]  INFO -- default-precise32:     +# Set to one of:  Full | OS | Minimal | Minor | Major | Prod
I, [2015-04-24T11:38:20.909895 #9300]  INFO -- default-precise32:     +# where Full conveys the most information, and Prod the least.
I, [2015-04-24T11:38:20.912337 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.914949 #9300]  INFO -- default-precise32:     +ServerTokens Prod
I, [2015-04-24T11:38:20.917179 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.919811 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.922169 #9300]  INFO -- default-precise32:     +# Optionally add a line containing the server version and virtual host
I, [2015-04-24T11:38:20.924357 #9300]  INFO -- default-precise32:     +# name to server-generated pages (internal error documents, FTP directory
I, [2015-04-24T11:38:20.926991 #9300]  INFO -- default-precise32:     +# listings, mod_status and mod_info output etc., but not CGI generated
I, [2015-04-24T11:38:20.974648 #9300]  INFO -- default-precise32:     +# documents or custom error documents).
I, [2015-04-24T11:38:20.974937 #9300]  INFO -- default-precise32:     +# Set to "EMail" to also include a mailto: link to the ServerAdmin.
I, [2015-04-24T11:38:20.975167 #9300]  INFO -- default-precise32:     +# Set to one of:  On | Off | EMail
I, [2015-04-24T11:38:20.975425 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.975658 #9300]  INFO -- default-precise32:     +ServerSignature On
I, [2015-04-24T11:38:20.975880 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:20.976093 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.976314 #9300]  INFO -- default-precise32:     +# Allow TRACE method
I, [2015-04-24T11:38:20.976539 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.976740 #9300]  INFO -- default-precise32:     +# Set to "extended" to also reflect the request body (only for testing and
I, [2015-04-24T11:38:20.977011 #9300]  INFO -- default-precise32:     +# diagnostic purposes).
I, [2015-04-24T11:38:20.977244 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.977460 #9300]  INFO -- default-precise32:     +# Set to one of:  On | Off | extended
I, [2015-04-24T11:38:20.977685 #9300]  INFO -- default-precise32:     +#
I, [2015-04-24T11:38:20.977888 #9300]  INFO -- default-precise32:     +TraceEnable Off
I, [2015-04-24T11:38:20.978139 #9300]  INFO -- default-precise32:     - change mode from '' to '0644'
I, [2015-04-24T11:38:20.978385 #9300]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:38:20.978599 #9300]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:38:22.470417 #9300]  INFO -- default-precise32:   * execute[a2enconf security.conf] action run
I, [2015-04-24T11:38:22.475205 #9300]  INFO -- default-precise32:     - execute /usr/sbin/a2enconf security.conf
I, [2015-04-24T11:38:22.495212 #9300]  INFO -- default-precise32:   * file[/etc/apache2/conf-available/charset] action delete (up to date)
I, [2015-04-24T11:38:22.519979 #9300]  INFO -- default-precise32:   * template[/etc/apache2/conf-available/charset.conf] action create
I, [2015-04-24T11:38:22.539290 #9300]  INFO -- default-precise32:     - create new file /etc/apache2/conf-available/charset.conf
I, [2015-04-24T11:38:22.542811 #9300]  INFO -- default-precise32:     - update content in file /etc/apache2/conf-available/charset.conf from none to 543c6c
I, [2015-04-24T11:38:22.552185 #9300]  INFO -- default-precise32:     --- /etc/apache2/conf-available/charset.conf	2015-04-24 08:38:22.512662589 +0000
I, [2015-04-24T11:38:22.556616 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-28auj8	2015-04-24 08:38:22.508662640 +0000
I, [2015-04-24T11:38:22.560116 #9300]  INFO -- default-precise32:     @@ -1 +1,7 @@
I, [2015-04-24T11:38:22.563417 #9300]  INFO -- default-precise32:     +# Read the documentation before enabling AddDefaultCharset.
I, [2015-04-24T11:38:22.566138 #9300]  INFO -- default-precise32:     +# In general, it is only a good idea if you know that all your files
I, [2015-04-24T11:38:22.569164 #9300]  INFO -- default-precise32:     +# have this encoding. It will override any encoding given in the files
I, [2015-04-24T11:38:22.571733 #9300]  INFO -- default-precise32:     +# in meta http-equiv or xml encoding tags.
I, [2015-04-24T11:38:22.574755 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:22.586457 #9300]  INFO -- default-precise32:     +#AddDefaultCharset UTF-8
I, [2015-04-24T11:38:22.589947 #9300]  INFO -- default-precise32:     - change mode from '' to '0644'
I, [2015-04-24T11:38:22.592516 #9300]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:38:22.599187 #9300]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:38:23.377743 #9300]  INFO -- default-precise32:   * execute[a2enconf charset.conf] action run
I, [2015-04-24T11:38:23.386586 #9300]  INFO -- default-precise32:     - execute /usr/sbin/a2enconf charset.conf
I, [2015-04-24T11:38:23.428157 #9300]  INFO -- default-precise32:   * file[/etc/apache2/ports] action delete (up to date)
I, [2015-04-24T11:38:23.526998 #9300]  INFO -- default-precise32:   * template[/etc/apache2/ports.conf] action create
I, [2015-04-24T11:38:23.530178 #9300]  INFO -- default-precise32:     - update content in file /etc/apache2/ports.conf from 69cde6 to 251243
I, [2015-04-24T11:38:23.534618 #9300]  INFO -- default-precise32:     --- /etc/apache2/ports.conf	2012-02-07 04:16:59.000000000 +0000
I, [2015-04-24T11:38:23.539525 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-fqm8j5	2015-04-24 08:38:23.480650420 +0000
I, [2015-04-24T11:38:23.542168 #9300]  INFO -- default-precise32:     @@ -1,24 +1,6 @@
I, [2015-04-24T11:38:23.544728 #9300]  INFO -- default-precise32:     -# If you just change the port or add more ports here, you will likely also
I, [2015-04-24T11:38:23.546970 #9300]  INFO -- default-precise32:     -# have to change the VirtualHost statement in
I, [2015-04-24T11:38:23.549193 #9300]  INFO -- default-precise32:     -# /etc/apache2/sites-enabled/000-default
I, [2015-04-24T11:38:23.552178 #9300]  INFO -- default-precise32:     -# This is also true if you have upgraded from before 2.2.9-3 (i.e. from
I, [2015-04-24T11:38:23.556076 #9300]  INFO -- default-precise32:     -# Debian etch). See /usr/share/doc/apache2.2-common/NEWS.Debian.gz and
I, [2015-04-24T11:38:23.558196 #9300]  INFO -- default-precise32:     -# README.Debian.gz
I, [2015-04-24T11:38:23.560187 #9300]  INFO -- default-precise32:     +# This file was generated by Chef for default-precise32.
I, [2015-04-24T11:38:23.562762 #9300]  INFO -- default-precise32:     +# Do NOT modify this file by hand!
I, [2015-04-24T11:38:23.565022 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:23.567335 #9300]  INFO -- default-precise32:     +Listen *:80
I, [2015-04-24T11:38:23.570184 #9300]  INFO -- default-precise32:      NameVirtualHost *:80
I, [2015-04-24T11:38:23.571930 #9300]  INFO -- default-precise32:     -Listen 80
I, [2015-04-24T11:38:23.574204 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:23.577080 #9300]  INFO -- default-precise32:     -<IfModule mod_ssl.c>
I, [2015-04-24T11:38:23.579204 #9300]  INFO -- default-precise32:     -    # If you add NameVirtualHost *:443 here, you will also have to change
I, [2015-04-24T11:38:23.581588 #9300]  INFO -- default-precise32:     -    # the VirtualHost statement in /etc/apache2/sites-available/default-ssl
I, [2015-04-24T11:38:23.585209 #9300]  INFO -- default-precise32:     -    # to <VirtualHost *:443>
I, [2015-04-24T11:38:23.585247 #9300]  INFO -- default-precise32:     -    # Server Name Indication for SSL named virtual hosts is currently not
I, [2015-04-24T11:38:23.587633 #9300]  INFO -- default-precise32:     -    # supported by MSIE on Windows XP.
I, [2015-04-24T11:38:23.589873 #9300]  INFO -- default-precise32:     -    Listen 443
I, [2015-04-24T11:38:23.592884 #9300]  INFO -- default-precise32:     -</IfModule>
I, [2015-04-24T11:38:23.594201 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:23.595894 #9300]  INFO -- default-precise32:     -<IfModule mod_gnutls.c>
I, [2015-04-24T11:38:23.598175 #9300]  INFO -- default-precise32:     -    Listen 443
I, [2015-04-24T11:38:23.600673 #9300]  INFO -- default-precise32:     -</IfModule>
I, [2015-04-24T11:38:23.610204 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:23.612198 #9300]  INFO -- default-precise32: Recipe: apache2::mod_status
I, [2015-04-24T11:38:23.650343 #9300]  INFO -- default-precise32:   * template[/etc/apache2/mods-available/status.conf] action create
I, [2015-04-24T11:38:23.653059 #9300]  INFO -- default-precise32:     - update content in file /etc/apache2/mods-available/status.conf from 5f6b3c to 7736cd
I, [2015-04-24T11:38:23.656776 #9300]  INFO -- default-precise32:     --- /etc/apache2/mods-available/status.conf	2012-02-07 04:16:59.000000000 +0000
I, [2015-04-24T11:38:23.661196 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-1ryd7lm	2015-04-24 08:38:23.620648659 +0000
I, [2015-04-24T11:38:23.662932 #9300]  INFO -- default-precise32:     @@ -1,31 +1,23 @@
I, [2015-04-24T11:38:23.665807 #9300]  INFO -- default-precise32:      <IfModule mod_status.c>
I, [2015-04-24T11:38:23.668317 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:23.671775 #9300]  INFO -- default-precise32:     -# Allow server status reports generated by mod_status,
I, [2015-04-24T11:38:23.674170 #9300]  INFO -- default-precise32:     -# with the URL of http://servername/server-status
I, [2015-04-24T11:38:23.676345 #9300]  INFO -- default-precise32:     -# Uncomment and change the "192.0.2.0/24" to allow access from other hosts.
I, [2015-04-24T11:38:23.679206 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:23.684202 #9300]  INFO -- default-precise32:     -<Location /server-status>
I, [2015-04-24T11:38:23.686752 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:23.689212 #9300]  INFO -- default-precise32:     +  # Allow server status reports generated by mod_status,
I, [2015-04-24T11:38:23.692169 #9300]  INFO -- default-precise32:     +  # with the URL of http://servername/server-status
I, [2015-04-24T11:38:23.694173 #9300]  INFO -- default-precise32:     +  # Uncomment and change the ".example.com" to allow
I, [2015-04-24T11:38:23.696219 #9300]  INFO -- default-precise32:     +  # access from other hosts.
I, [2015-04-24T11:38:23.698136 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:23.701551 #9300]  INFO -- default-precise32:     +  <Location /server-status>
I, [2015-04-24T11:38:23.704185 #9300]  INFO -- default-precise32:   SetHandler server-status
I, [2015-04-24T11:38:23.706196 #9300]  INFO -- default-precise32:   Order deny,allow
I, [2015-04-24T11:38:23.708203 #9300]  INFO -- default-precise32:   Deny from all
I, [2015-04-24T11:38:23.710491 #9300]  INFO -- default-precise32:   Allow from 127.0.0.1 ::1
I, [2015-04-24T11:38:23.712485 #9300]  INFO -- default-precise32:     -#    Allow from 192.0.2.0/24
I, [2015-04-24T11:38:23.714962 #9300]  INFO -- default-precise32:     -</Location>
I, [2015-04-24T11:38:23.717868 #9300]  INFO -- default-precise32:     +  </Location>
I, [2015-04-24T11:38:23.719979 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:23.722334 #9300]  INFO -- default-precise32:     -# Keep track of extended status information for each request
I, [2015-04-24T11:38:23.725213 #9300]  INFO -- default-precise32:     -ExtendedStatus On
I, [2015-04-24T11:38:23.726929 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:23.729447 #9300]  INFO -- default-precise32:     -# Determine if mod_status displays the first 63 characters of a request or
I, [2015-04-24T11:38:23.732170 #9300]  INFO -- default-precise32:     -# the last 63, assuming the request itself is greater than 63 chars.
I, [2015-04-24T11:38:23.734898 #9300]  INFO -- default-precise32:     -# Default: Off
I, [2015-04-24T11:38:23.737026 #9300]  INFO -- default-precise32:     -#SeeRequestTail On
I, [2015-04-24T11:38:23.739329 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:23.741561 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:23.744413 #9300]  INFO -- default-precise32:     -<IfModule mod_proxy.c>
I, [2015-04-24T11:38:23.747114 #9300]  INFO -- default-precise32:     -    # Show Proxy LoadBalancer status in mod_status
I, [2015-04-24T11:38:23.749725 #9300]  INFO -- default-precise32:     -    ProxyStatus On
I, [2015-04-24T11:38:23.752172 #9300]  INFO -- default-precise32:     -</IfModule>
I, [2015-04-24T11:38:23.754167 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:23.756363 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:23.758969 #9300]  INFO -- default-precise32:     +  # ExtendedStatus controls whether Apache will generate "full" status
I, [2015-04-24T11:38:23.762107 #9300]  INFO -- default-precise32:     +  # information (ExtendedStatus On) or just basic information (ExtendedStatus
I, [2015-04-24T11:38:23.764538 #9300]  INFO -- default-precise32:     +  # Off) when the "server-status" handler is called. The default is Off.
I, [2015-04-24T11:38:23.766924 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:23.770175 #9300]  INFO -- default-precise32:     +  ExtendedStatus Off
I, [2015-04-24T11:38:23.771523 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:23.776577 #9300]  INFO -- default-precise32:      </IfModule>
I, [2015-04-24T11:38:23.792969 #9300]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/status.load] action create (up to date)
I, [2015-04-24T11:38:23.798222 #9300]  INFO -- default-precise32:   * execute[a2enmod status] action run (skipped due to not_if)
I, [2015-04-24T11:38:23.800297 #9300]  INFO -- default-precise32: Recipe: apache2::mod_alias
I, [2015-04-24T11:38:23.832325 #9300]  INFO -- default-precise32:   * template[/etc/apache2/mods-available/alias.conf] action create
I, [2015-04-24T11:38:23.835201 #9300]  INFO -- default-precise32:     - update content in file /etc/apache2/mods-available/alias.conf from 541075 to 43605a
I, [2015-04-24T11:38:23.839378 #9300]  INFO -- default-precise32:     --- /etc/apache2/mods-available/alias.conf	2012-02-07 04:16:59.000000000 +0000
I, [2015-04-24T11:38:23.843416 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-lpjp2q	2015-04-24 08:38:23.804646346 +0000
I, [2015-04-24T11:38:23.845721 #9300]  INFO -- default-precise32:     @@ -1,25 +1,24 @@
I, [2015-04-24T11:38:23.848185 #9300]  INFO -- default-precise32:      <IfModule alias_module>
I, [2015-04-24T11:38:23.850349 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:23.853249 #9300]  INFO -- default-precise32:     -# Aliases: Add here as many aliases as you need (with no limit). The format is 
I, [2015-04-24T11:38:23.855327 #9300]  INFO -- default-precise32:     -# Alias fakename realname
I, [2015-04-24T11:38:23.857998 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:23.861685 #9300]  INFO -- default-precise32:     -# Note that if you include a trailing / on fakename then the server will
I, [2015-04-24T11:38:23.864192 #9300]  INFO -- default-precise32:     -# require it to be present in the URL.  So "/icons" isn't aliased in this
I, [2015-04-24T11:38:23.866197 #9300]  INFO -- default-precise32:     -# example, only "/icons/".  If the fakename is slash-terminated, then the 
I, [2015-04-24T11:38:23.868168 #9300]  INFO -- default-precise32:     -# realname must also be slash terminated, and if the fakename omits the 
I, [2015-04-24T11:38:23.871167 #9300]  INFO -- default-precise32:     -# trailing slash, the realname must also omit it.
I, [2015-04-24T11:38:23.875366 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:23.877303 #9300]  INFO -- default-precise32:     -# We include the /icons/ alias for FancyIndexed directory listings.  If
I, [2015-04-24T11:38:23.880198 #9300]  INFO -- default-precise32:     -# you do not use FancyIndexing, you may comment this out.
I, [2015-04-24T11:38:23.882375 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:23.885130 #9300]  INFO -- default-precise32:     -Alias /icons/ "/usr/share/apache2/icons/"
I, [2015-04-24T11:38:23.887341 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:23.890021 #9300]  INFO -- default-precise32:     +  # Aliases: Add here as many aliases as you need (with no limit). The format is
I, [2015-04-24T11:38:23.892216 #9300]  INFO -- default-precise32:     +  # Alias fakename realname
I, [2015-04-24T11:38:23.894935 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:23.897170 #9300]  INFO -- default-precise32:     +  # Note that if you include a trailing / on fakename then the server will
I, [2015-04-24T11:38:23.899179 #9300]  INFO -- default-precise32:     +  # require it to be present in the URL.  So "/icons" isn't aliased in this
I, [2015-04-24T11:38:23.902179 #9300]  INFO -- default-precise32:     +  # example, only "/icons/".  If the fakename is slash-terminated, then the
I, [2015-04-24T11:38:23.904171 #9300]  INFO -- default-precise32:     +  # realname must also be slash terminated, and if the fakename omits the
I, [2015-04-24T11:38:23.906307 #9300]  INFO -- default-precise32:     +  # trailing slash, the realname must also omit it.
I, [2015-04-24T11:38:23.908335 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:23.910949 #9300]  INFO -- default-precise32:     +  # We include the /icons/ alias for FancyIndexed directory listings.  If
I, [2015-04-24T11:38:23.912215 #9300]  INFO -- default-precise32:     +  # you do not use FancyIndexing, you may comment this out.
I, [2015-04-24T11:38:23.914205 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:23.918336 #9300]  INFO -- default-precise32:     +  Alias /icons/ "/usr/share/apache2/icons/"
I, [2015-04-24T11:38:23.919191 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:23.922062 #9300]  INFO -- default-precise32:     -<Directory "/usr/share/apache2/icons">
I, [2015-04-24T11:38:23.924169 #9300]  INFO -- default-precise32:     -    Options FollowSymlinks
I, [2015-04-24T11:38:23.926958 #9300]  INFO -- default-precise32:     +  <Directory "/usr/share/apache2/icons">
I, [2015-04-24T11:38:23.928803 #9300]  INFO -- default-precise32:     +    Options Indexes MultiViews
I, [2015-04-24T11:38:23.931193 #9300]  INFO -- default-precise32:   AllowOverride None
I, [2015-04-24T11:38:23.933280 #9300]  INFO -- default-precise32:   Order allow,deny
I, [2015-04-24T11:38:23.936344 #9300]  INFO -- default-precise32:   Allow from all
I, [2015-04-24T11:38:23.939183 #9300]  INFO -- default-precise32:     -</Directory>
I, [2015-04-24T11:38:23.940994 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:23.943379 #9300]  INFO -- default-precise32:     +  </Directory>
I, [2015-04-24T11:38:23.948028 #9300]  INFO -- default-precise32:      </IfModule>
I, [2015-04-24T11:38:23.961253 #9300]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/alias.load] action create (up to date)
I, [2015-04-24T11:38:23.966207 #9300]  INFO -- default-precise32:   * execute[a2enmod alias] action run (skipped due to not_if)
I, [2015-04-24T11:38:23.968194 #9300]  INFO -- default-precise32: Recipe: apache2::mod_auth_basic
I, [2015-04-24T11:38:23.981560 #9300]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/auth_basic.load] action create (up to date)
I, [2015-04-24T11:38:23.986133 #9300]  INFO -- default-precise32:   * execute[a2enmod auth_basic] action run (skipped due to not_if)
I, [2015-04-24T11:38:23.988182 #9300]  INFO -- default-precise32: Recipe: apache2::mod_authn_file
I, [2015-04-24T11:38:24.002102 #9300]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/authn_file.load] action create (up to date)
I, [2015-04-24T11:38:24.007032 #9300]  INFO -- default-precise32:   * execute[a2enmod authn_file] action run (skipped due to not_if)
I, [2015-04-24T11:38:24.008359 #9300]  INFO -- default-precise32: Recipe: apache2::mod_authz_core
I, [2015-04-24T11:38:24.023036 #9300]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/authz_default.load] action create (up to date)
I, [2015-04-24T11:38:24.026188 #9300]  INFO -- default-precise32:   * execute[a2enmod authz_default] action run (skipped due to not_if)
I, [2015-04-24T11:38:24.051238 #9300]  INFO -- default-precise32: Recipe: apache2::mod_authz_groupfile
I, [2015-04-24T11:38:24.060366 #9300]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/authz_groupfile.load] action create (up to date)
I, [2015-04-24T11:38:24.064195 #9300]  INFO -- default-precise32:   * execute[a2enmod authz_groupfile] action run (skipped due to not_if)
I, [2015-04-24T11:38:24.066203 #9300]  INFO -- default-precise32: Recipe: apache2::mod_authz_host
I, [2015-04-24T11:38:24.075202 #9300]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/authz_host.load] action create (up to date)
I, [2015-04-24T11:38:24.079257 #9300]  INFO -- default-precise32:   * execute[a2enmod authz_host] action run (skipped due to not_if)
I, [2015-04-24T11:38:24.080189 #9300]  INFO -- default-precise32: Recipe: apache2::mod_authz_user
I, [2015-04-24T11:38:24.090195 #9300]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/authz_user.load] action create (up to date)
I, [2015-04-24T11:38:24.093191 #9300]  INFO -- default-precise32:   * execute[a2enmod authz_user] action run (skipped due to not_if)
I, [2015-04-24T11:38:24.095184 #9300]  INFO -- default-precise32: Recipe: apache2::mod_autoindex
I, [2015-04-24T11:38:24.119407 #9300]  INFO -- default-precise32:   * template[/etc/apache2/mods-available/autoindex.conf] action create
I, [2015-04-24T11:38:24.122368 #9300]  INFO -- default-precise32:     - update content in file /etc/apache2/mods-available/autoindex.conf from e9cb73 to 8e7e44
I, [2015-04-24T11:38:24.126198 #9300]  INFO -- default-precise32:     --- /etc/apache2/mods-available/autoindex.conf	2012-02-07 04:16:59.000000000 +0000
I, [2015-04-24T11:38:24.130196 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-1nkwebd	2015-04-24 08:38:24.100642624 +0000
I, [2015-04-24T11:38:24.132379 #9300]  INFO -- default-precise32:     @@ -1,102 +1,101 @@
I, [2015-04-24T11:38:24.135198 #9300]  INFO -- default-precise32:      <IfModule mod_autoindex.c>
I, [2015-04-24T11:38:24.136195 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.139187 #9300]  INFO -- default-precise32:     -# Directives controlling the display of server-generated directory listings.
I, [2015-04-24T11:38:24.141199 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.143270 #9300]  INFO -- default-precise32: +  #
I, [2015-04-24T11:38:24.145202 #9300]  INFO -- default-precise32:     +  # Directives controlling the display of server-generated directory listings.
I, [2015-04-24T11:38:24.147755 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.151073 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:24.152179 #9300]  INFO -- default-precise32: -#
I, [2015-04-24T11:38:24.154944 #9300]  INFO -- default-precise32:     -# IndexOptions: Controls the appearance of server-generated directory
I, [2015-04-24T11:38:24.157205 #9300]  INFO -- default-precise32:     -# listings.
I, [2015-04-24T11:38:24.159868 #9300]  INFO -- default-precise32:     -# Remove/replace the "Charset=UTF-8" if you don't use UTF-8 for your filenames.
I, [2015-04-24T11:38:24.162241 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.164814 #9300]  INFO -- default-precise32:     -IndexOptions FancyIndexing VersionSort HTMLTable NameWidth=* DescriptionWidth=* Charset=UTF-8
I, [2015-04-24T11:38:24.167070 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.169202 #9300]  INFO -- default-precise32:     +  # IndexOptions: Controls the appearance of server-generated directory
I, [2015-04-24T11:38:24.171850 #9300]  INFO -- default-precise32:     +  # listings.
I, [2015-04-24T11:38:24.174621 #9300]  INFO -- default-precise32:     +  # Remove/replace the "Charset=UTF-8" if you don't use UTF-8 for your filenames.
I, [2015-04-24T11:38:24.214466 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.214741 #9300]  INFO -- default-precise32:     +  IndexOptions FancyIndexing VersionSort HTMLTable NameWidth=* DescriptionWidth=* Charset=UTF-8
I, [2015-04-24T11:38:24.214968 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:24.215191 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.215405 #9300]  INFO -- default-precise32:     -# AddIcon* directives tell the server which icon to show for different
I, [2015-04-24T11:38:24.215632 #9300]  INFO -- default-precise32:     -# files or filename extensions.  These are only displayed for
I, [2015-04-24T11:38:24.215845 #9300]  INFO -- default-precise32:     -# FancyIndexed directories.
I, [2015-04-24T11:38:24.216064 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.216286 #9300]  INFO -- default-precise32:     -AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip x-bzip2
I, [2015-04-24T11:38:24.216492 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.216705 #9300]  INFO -- default-precise32:     +  # AddIcon* directives tell the server which icon to show for different
I, [2015-04-24T11:38:24.216932 #9300]  INFO -- default-precise32:     +  # files or filename extensions.  These are only displayed for
I, [2015-04-24T11:38:24.217170 #9300]  INFO -- default-precise32:     +  # FancyIndexed directories.
I, [2015-04-24T11:38:24.217388 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.217596 #9300]  INFO -- default-precise32:     +  AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip x-bzip2
I, [2015-04-24T11:38:24.217801 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:24.218070 #9300]  INFO -- default-precise32:     -AddIconByType (TXT,/icons/text.gif) text/*
I, [2015-04-24T11:38:24.218403 #9300]  INFO -- default-precise32:     -AddIconByType (IMG,/icons/image2.gif) image/*
I, [2015-04-24T11:38:24.218642 #9300]  INFO -- default-precise32:     -AddIconByType (SND,/icons/sound2.gif) audio/*
I, [2015-04-24T11:38:24.218874 #9300]  INFO -- default-precise32:     -AddIconByType (VID,/icons/movie.gif) video/*
I, [2015-04-24T11:38:24.223581 #9300]  INFO -- default-precise32:     +  AddIconByType (TXT,/icons/text.gif) text/*
I, [2015-04-24T11:38:24.228337 #9300]  INFO -- default-precise32:     +  AddIconByType (IMG,/icons/image2.gif) image/*
I, [2015-04-24T11:38:24.231356 #9300]  INFO -- default-precise32:     +  AddIconByType (SND,/icons/sound2.gif) audio/*
I, [2015-04-24T11:38:24.233192 #9300]  INFO -- default-precise32:     +  AddIconByType (VID,/icons/movie.gif) video/*
I, [2015-04-24T11:38:24.235234 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:24.237117 #9300]  INFO -- default-precise32:     -AddIcon /icons/binary.gif .bin .exe
I, [2015-04-24T11:38:24.239145 #9300]  INFO -- default-precise32:     -AddIcon /icons/binhex.gif .hqx
I, [2015-04-24T11:38:24.241025 #9300]  INFO -- default-precise32:     -AddIcon /icons/tar.gif .tar
I, [2015-04-24T11:38:24.243079 #9300]  INFO -- default-precise32:     -AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
I, [2015-04-24T11:38:24.246881 #9300]  INFO -- default-precise32:     -AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
I, [2015-04-24T11:38:24.247159 #9300]  INFO -- default-precise32:     -AddIcon /icons/a.gif .ps .ai .eps
I, [2015-04-24T11:38:24.248612 #9300]  INFO -- default-precise32:     -AddIcon /icons/layout.gif .html .shtml .htm .pdf
I, [2015-04-24T11:38:24.250562 #9300]  INFO -- default-precise32:     -AddIcon /icons/text.gif .txt
I, [2015-04-24T11:38:24.252596 #9300]  INFO -- default-precise32:     -AddIcon /icons/c.gif .c
I, [2015-04-24T11:38:24.254407 #9300]  INFO -- default-precise32:     -AddIcon /icons/p.gif .pl .py
I, [2015-04-24T11:38:24.256122 #9300]  INFO -- default-precise32:     -AddIcon /icons/f.gif .for
I, [2015-04-24T11:38:24.258055 #9300]  INFO -- default-precise32:     -AddIcon /icons/dvi.gif .dvi
I, [2015-04-24T11:38:24.259607 #9300]  INFO -- default-precise32:     -AddIcon /icons/uuencoded.gif .uu
I, [2015-04-24T11:38:24.262444 #9300]  INFO -- default-precise32:     -AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
I, [2015-04-24T11:38:24.264471 #9300]  INFO -- default-precise32:     -AddIcon /icons/tex.gif .tex
I, [2015-04-24T11:38:24.266528 #9300]  INFO -- default-precise32:     -# It's a suffix rule, so simply matching "core" matches "score" as well !
I, [2015-04-24T11:38:24.268756 #9300]  INFO -- default-precise32:     -AddIcon /icons/bomb.gif /core
I, [2015-04-24T11:38:24.270567 #9300]  INFO -- default-precise32:     -AddIcon (SND,/icons/sound2.gif) .ogg
I, [2015-04-24T11:38:24.272882 #9300]  INFO -- default-precise32:     -AddIcon (VID,/icons/movie.gif) .ogm
I, [2015-04-24T11:38:24.275216 #9300]  INFO -- default-precise32:     +  AddIcon /icons/binary.gif .bin .exe
I, [2015-04-24T11:38:24.277987 #9300]  INFO -- default-precise32:     +  AddIcon /icons/binhex.gif .hqx
I, [2015-04-24T11:38:24.280439 #9300]  INFO -- default-precise32:     +  AddIcon /icons/tar.gif .tar
I, [2015-04-24T11:38:24.282915 #9300]  INFO -- default-precise32:     +  AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
I, [2015-04-24T11:38:24.285411 #9300]  INFO -- default-precise32:     +  AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
I, [2015-04-24T11:38:24.288068 #9300]  INFO -- default-precise32:     +  AddIcon /icons/a.gif .ps .ai .eps
I, [2015-04-24T11:38:24.290923 #9300]  INFO -- default-precise32:     +  AddIcon /icons/layout.gif .html .shtml .htm .pdf
I, [2015-04-24T11:38:24.293407 #9300]  INFO -- default-precise32:     +  AddIcon /icons/text.gif .txt
I, [2015-04-24T11:38:24.296194 #9300]  INFO -- default-precise32:     +  AddIcon /icons/c.gif .c
I, [2015-04-24T11:38:24.298597 #9300]  INFO -- default-precise32:     +  AddIcon /icons/p.gif .pl .py
I, [2015-04-24T11:38:24.301109 #9300]  INFO -- default-precise32:     +  AddIcon /icons/f.gif .for
I, [2015-04-24T11:38:24.303406 #9300]  INFO -- default-precise32:     +  AddIcon /icons/dvi.gif .dvi
I, [2015-04-24T11:38:24.306117 #9300]  INFO -- default-precise32:     +  AddIcon /icons/uuencoded.gif .uu
I, [2015-04-24T11:38:24.308296 #9300]  INFO -- default-precise32:     +  AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
I, [2015-04-24T11:38:24.311049 #9300]  INFO -- default-precise32:     +  AddIcon /icons/tex.gif .tex
I, [2015-04-24T11:38:24.313636 #9300]  INFO -- default-precise32:     +  # It's a suffix rule, so simply matching "core" matches "score" as well !
I, [2015-04-24T11:38:24.316212 #9300]  INFO -- default-precise32:     +  AddIcon /icons/bomb.gif /core
I, [2015-04-24T11:38:24.318840 #9300]  INFO -- default-precise32:     +  AddIcon (SND,/icons/sound2.gif) .ogg
I, [2015-04-24T11:38:24.321425 #9300]  INFO -- default-precise32:     +  AddIcon (VID,/icons/movie.gif) .ogm
I, [2015-04-24T11:38:24.324008 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:24.326596 #9300]  INFO -- default-precise32:     -AddIcon /icons/back.gif ..
I, [2015-04-24T11:38:24.329328 #9300]  INFO -- default-precise32:     -AddIcon /icons/hand.right.gif README
I, [2015-04-24T11:38:24.331890 #9300]  INFO -- default-precise32:     -AddIcon /icons/folder.gif ^^DIRECTORY^^
I, [2015-04-24T11:38:24.334273 #9300]  INFO -- default-precise32:     -AddIcon /icons/blank.gif ^^BLANKICON^^
I, [2015-04-24T11:38:24.336994 #9300]  INFO -- default-precise32:     +  AddIcon /icons/back.gif ..
I, [2015-04-24T11:38:24.339555 #9300]  INFO -- default-precise32:     +  AddIcon /icons/hand.right.gif README
I, [2015-04-24T11:38:24.342415 #9300]  INFO -- default-precise32:     +  AddIcon /icons/folder.gif ^^DIRECTORY^^
I, [2015-04-24T11:38:24.345382 #9300]  INFO -- default-precise32:     +  AddIcon /icons/blank.gif ^^BLANKICON^^
I, [2015-04-24T11:38:24.345423 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:24.348030 #9300]  INFO -- default-precise32:     -# Default icons for OpenDocument format
I, [2015-04-24T11:38:24.350399 #9300]  INFO -- default-precise32:     -AddIcon /icons/odf6odt-20x22.png .odt
I, [2015-04-24T11:38:24.352767 #9300]  INFO -- default-precise32:     -AddIcon /icons/odf6ods-20x22.png .ods
I, [2015-04-24T11:38:24.355175 #9300]  INFO -- default-precise32:     -AddIcon /icons/odf6odp-20x22.png .odp
I, [2015-04-24T11:38:24.357880 #9300]  INFO -- default-precise32:     -AddIcon /icons/odf6odg-20x22.png .odg
I, [2015-04-24T11:38:24.360400 #9300]  INFO -- default-precise32:     -AddIcon /icons/odf6odc-20x22.png .odc
I, [2015-04-24T11:38:24.362848 #9300]  INFO -- default-precise32:     -AddIcon /icons/odf6odf-20x22.png .odf
I, [2015-04-24T11:38:24.365453 #9300]  INFO -- default-precise32:     -AddIcon /icons/odf6odb-20x22.png .odb
I, [2015-04-24T11:38:24.368475 #9300]  INFO -- default-precise32:     -AddIcon /icons/odf6odi-20x22.png .odi
I, [2015-04-24T11:38:24.371315 #9300]  INFO -- default-precise32:     -AddIcon /icons/odf6odm-20x22.png .odm
I, [2015-04-24T11:38:24.373983 #9300]  INFO -- default-precise32:     +  # Default icons for OpenDocument format
I, [2015-04-24T11:38:24.376202 #9300]  INFO -- default-precise32:     +  AddIcon /icons/odf6odt-20x22.png .odt
I, [2015-04-24T11:38:24.379008 #9300]  INFO -- default-precise32:     +  AddIcon /icons/odf6ods-20x22.png .ods
I, [2015-04-24T11:38:24.381131 #9300]  INFO -- default-precise32:     +  AddIcon /icons/odf6odp-20x22.png .odp
I, [2015-04-24T11:38:24.383861 #9300]  INFO -- default-precise32:     +  AddIcon /icons/odf6odg-20x22.png .odg
I, [2015-04-24T11:38:24.386440 #9300]  INFO -- default-precise32:     +  AddIcon /icons/odf6odc-20x22.png .odc
I, [2015-04-24T11:38:24.389144 #9300]  INFO -- default-precise32:     +  AddIcon /icons/odf6odf-20x22.png .odf
I, [2015-04-24T11:38:24.391428 #9300]  INFO -- default-precise32:     +  AddIcon /icons/odf6odb-20x22.png .odb
I, [2015-04-24T11:38:24.394147 #9300]  INFO -- default-precise32:     +  AddIcon /icons/odf6odi-20x22.png .odi
I, [2015-04-24T11:38:24.396326 #9300]  INFO -- default-precise32:     +  AddIcon /icons/odf6odm-20x22.png .odm
I, [2015-04-24T11:38:24.398984 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:24.401807 #9300]  INFO -- default-precise32:     -AddIcon /icons/odf6ott-20x22.png .ott
I, [2015-04-24T11:38:24.404452 #9300]  INFO -- default-precise32:     -AddIcon /icons/odf6ots-20x22.png .ots
I, [2015-04-24T11:38:24.407221 #9300]  INFO -- default-precise32:     -AddIcon /icons/odf6otp-20x22.png .otp
I, [2015-04-24T11:38:24.409721 #9300]  INFO -- default-precise32:     -AddIcon /icons/odf6otg-20x22.png .otg
I, [2015-04-24T11:38:24.412180 #9300]  INFO -- default-precise32:     -AddIcon /icons/odf6otc-20x22.png .otc
I, [2015-04-24T11:38:24.414588 #9300]  INFO -- default-precise32:     -AddIcon /icons/odf6otf-20x22.png .otf
I, [2015-04-24T11:38:24.416702 #9300]  INFO -- default-precise32:     -AddIcon /icons/odf6oti-20x22.png .oti
I, [2015-04-24T11:38:24.419269 #9300]  INFO -- default-precise32:     -AddIcon /icons/odf6oth-20x22.png .oth
I, [2015-04-24T11:38:24.421864 #9300]  INFO -- default-precise32:     +  AddIcon /icons/odf6ott-20x22.png .ott
I, [2015-04-24T11:38:24.424711 #9300]  INFO -- default-precise32:     +  AddIcon /icons/odf6ots-20x22.png .ots
I, [2015-04-24T11:38:24.427070 #9300]  INFO -- default-precise32:     +  AddIcon /icons/odf6otp-20x22.png .otp
I, [2015-04-24T11:38:24.429582 #9300]  INFO -- default-precise32:     +  AddIcon /icons/odf6otg-20x22.png .otg
I, [2015-04-24T11:38:24.432451 #9300]  INFO -- default-precise32:     +  AddIcon /icons/odf6otc-20x22.png .otc
I, [2015-04-24T11:38:24.435213 #9300]  INFO -- default-precise32:     +  AddIcon /icons/odf6otf-20x22.png .otf
I, [2015-04-24T11:38:24.437799 #9300]  INFO -- default-precise32:     +  AddIcon /icons/odf6oti-20x22.png .oti
I, [2015-04-24T11:38:24.440328 #9300]  INFO -- default-precise32:     +  AddIcon /icons/odf6oth-20x22.png .oth
I, [2015-04-24T11:38:24.442382 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:24.444840 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.447194 #9300]  INFO -- default-precise32:     -# DefaultIcon is which icon to show for files which do not have an icon
I, [2015-04-24T11:38:24.450646 #9300]  INFO -- default-precise32:     -# explicitly set.
I, [2015-04-24T11:38:24.453113 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.455992 #9300]  INFO -- default-precise32:     -DefaultIcon /icons/unknown.gif
I, [2015-04-24T11:38:24.458424 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.460562 #9300]  INFO -- default-precise32:     +  # DefaultIcon is which icon to show for files which do not have an icon
I, [2015-04-24T11:38:24.462971 #9300]  INFO -- default-precise32:     +  # explicitly set.
I, [2015-04-24T11:38:24.465477 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.468071 #9300]  INFO -- default-precise32:     +  DefaultIcon /icons/unknown.gif
I, [2015-04-24T11:38:24.470830 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:24.473294 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.476065 #9300]  INFO -- default-precise32:     -# AddDescription allows you to place a short description after a file in
I, [2015-04-24T11:38:24.478347 #9300]  INFO -- default-precise32:     -# server-generated indexes.  These are only displayed for FancyIndexed
I, [2015-04-24T11:38:24.480298 #9300]  INFO -- default-precise32:     -# directories.
I, [2015-04-24T11:38:24.482824 #9300]  INFO -- default-precise32:     -# Format: AddDescription "description" filename
I, [2015-04-24T11:38:24.485315 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.487944 #9300]  INFO -- default-precise32:     -#AddDescription "GZIP compressed document" .gz
I, [2015-04-24T11:38:24.490232 #9300]  INFO -- default-precise32:     -#AddDescription "tar archive" .tar
I, [2015-04-24T11:38:24.492860 #9300]  INFO -- default-precise32:     -#AddDescription "GZIP compressed tar archive" .tgz
I, [2015-04-24T11:38:24.495417 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.498212 #9300]  INFO -- default-precise32:     +  # AddDescription allows you to place a short description after a file in
I, [2015-04-24T11:38:24.500583 #9300]  INFO -- default-precise32:     +  # server-generated indexes.  These are only displayed for FancyIndexed
I, [2015-04-24T11:38:24.503287 #9300]  INFO -- default-precise32:     +  # directories.
I, [2015-04-24T11:38:24.505972 #9300]  INFO -- default-precise32:     +  # Format: AddDescription "description" filename
I, [2015-04-24T11:38:24.508182 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.510478 #9300]  INFO -- default-precise32:     +  #AddDescription "GZIP compressed document" .gz
I, [2015-04-24T11:38:24.513047 #9300]  INFO -- default-precise32:     +  #AddDescription "tar archive" .tar
I, [2015-04-24T11:38:24.515924 #9300]  INFO -- default-precise32:     +  #AddDescription "GZIP compressed tar archive" .tgz
I, [2015-04-24T11:38:24.518393 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:24.520584 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.523041 #9300]  INFO -- default-precise32:     -# ReadmeName is the name of the README file the server will look for by
I, [2015-04-24T11:38:24.525417 #9300]  INFO -- default-precise32:     -# default, and append to directory listings.
I, [2015-04-24T11:38:24.527597 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.530314 #9300]  INFO -- default-precise32:     -# HeaderName is the name of a file which should be prepended to
I, [2015-04-24T11:38:24.532576 #9300]  INFO -- default-precise32:     -# directory indexes. 
I, [2015-04-24T11:38:24.535202 #9300]  INFO -- default-precise32:     -ReadmeName README.html
I, [2015-04-24T11:38:24.537369 #9300]  INFO -- default-precise32:     -HeaderName HEADER.html
I, [2015-04-24T11:38:24.540229 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.542574 #9300]  INFO -- default-precise32:     +  # ReadmeName is the name of the README file the server will look for by
I, [2015-04-24T11:38:24.545203 #9300]  INFO -- default-precise32:     +  # default, and append to directory listings.
I, [2015-04-24T11:38:24.547392 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.549933 #9300]  INFO -- default-precise32:     +  # HeaderName is the name of a file which should be prepended to
I, [2015-04-24T11:38:24.552297 #9300]  INFO -- default-precise32:     +  # directory indexes.
I, [2015-04-24T11:38:24.554774 #9300]  INFO -- default-precise32:     +  ReadmeName README.html
I, [2015-04-24T11:38:24.556713 #9300]  INFO -- default-precise32:     +  HeaderName HEADER.html
I, [2015-04-24T11:38:24.559128 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:24.561216 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.563890 #9300]  INFO -- default-precise32:     -# IndexIgnore is a set of filenames which directory indexing should ignore
I, [2015-04-24T11:38:24.566452 #9300]  INFO -- default-precise32:     -# and not include in the listing.  Shell-style wildcarding is permitted.
I, [2015-04-24T11:38:24.569228 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.571550 #9300]  INFO -- default-precise32:     -IndexIgnore .??* *~ *# RCS CVS *,v *,t 
I, [2015-04-24T11:38:24.575239 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:24.577969 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.580289 #9300]  INFO -- default-precise32:     +  # IndexIgnore is a set of filenames which directory indexing should ignore
I, [2015-04-24T11:38:24.582738 #9300]  INFO -- default-precise32:     +  # and not include in the listing.  Shell-style wildcarding is permitted.
I, [2015-04-24T11:38:24.585171 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.587449 #9300]  INFO -- default-precise32:     +  IndexIgnore .??* *~ *# RCS CVS *,v *,t
I, [2015-04-24T11:38:24.591396 #9300]  INFO -- default-precise32:      </IfModule>
I, [2015-04-24T11:38:24.608845 #9300]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/autoindex.load] action create (up to date)
I, [2015-04-24T11:38:24.617434 #9300]  INFO -- default-precise32:   * execute[a2enmod autoindex] action run (skipped due to not_if)
I, [2015-04-24T11:38:24.619433 #9300]  INFO -- default-precise32: Recipe: apache2::mod_dir
I, [2015-04-24T11:38:24.635615 #9300]  INFO -- default-precise32:   * template[/etc/apache2/mods-available/dir.conf] action create
I, [2015-04-24T11:38:24.638437 #9300]  INFO -- default-precise32:     - update content in file /etc/apache2/mods-available/dir.conf from f8a5bd to 5d2651
I, [2015-04-24T11:38:24.642283 #9300]  INFO -- default-precise32:     --- /etc/apache2/mods-available/dir.conf	2012-02-07 04:17:00.000000000 +0000
I, [2015-04-24T11:38:24.646439 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-1n57gwz	2015-04-24 08:38:24.620636089 +0000
I, [2015-04-24T11:38:24.648339 #9300]  INFO -- default-precise32:     @@ -1,6 +1,4 @@
I, [2015-04-24T11:38:24.650442 #9300]  INFO -- default-precise32:      <IfModule mod_dir.c>
I, [2015-04-24T11:38:24.652419 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:24.654552 #9300]  INFO -- default-precise32:     -          DirectoryIndex index.html index.cgi index.pl index.php index.xhtml index.htm
I, [2015-04-24T11:38:24.657424 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:24.659006 #9300]  INFO -- default-precise32:     +  DirectoryIndex index.html index.cgi index.pl index.php index.xhtml index.htm
I, [2015-04-24T11:38:24.663500 #9300]  INFO -- default-precise32:      </IfModule>
I, [2015-04-24T11:38:24.672450 #9300]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/dir.load] action create (up to date)
I, [2015-04-24T11:38:24.675573 #9300]  INFO -- default-precise32:   * execute[a2enmod dir] action run (skipped due to not_if)
I, [2015-04-24T11:38:24.677269 #9300]  INFO -- default-precise32: Recipe: apache2::mod_env
I, [2015-04-24T11:38:24.685432 #9300]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/env.load] action create (up to date)
I, [2015-04-24T11:38:24.688820 #9300]  INFO -- default-precise32:   * execute[a2enmod env] action run (skipped due to not_if)
I, [2015-04-24T11:38:24.690337 #9300]  INFO -- default-precise32: Recipe: apache2::mod_mime
I, [2015-04-24T11:38:24.727608 #9300]  INFO -- default-precise32:   * template[/etc/apache2/mods-available/mime.conf] action create
I, [2015-04-24T11:38:24.730437 #9300]  INFO -- default-precise32:     - update content in file /etc/apache2/mods-available/mime.conf from 43438f to 76e7d0
I, [2015-04-24T11:38:24.734447 #9300]  INFO -- default-precise32:     --- /etc/apache2/mods-available/mime.conf	2012-02-07 04:16:59.000000000 +0000
I, [2015-04-24T11:38:24.736719 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-8buot6	2015-04-24 08:38:24.692635184 +0000
I, [2015-04-24T11:38:24.739353 #9300]  INFO -- default-precise32:     @@ -1,247 +1,193 @@
I, [2015-04-24T11:38:24.742417 #9300]  INFO -- default-precise32:      <IfModule mod_mime.c>
I, [2015-04-24T11:38:24.744415 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.745421 #9300]  INFO -- default-precise32:     +  # TypesConfig points to the file containing the list of mappings from
I, [2015-04-24T11:38:24.748424 #9300]  INFO -- default-precise32:     +  # filename extension to MIME-type.
I, [2015-04-24T11:38:24.748456 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.748478 #9300]  INFO -- default-precise32:     +  TypesConfig /etc/mime.types
I, [2015-04-24T11:38:24.750169 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:24.752862 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.755430 #9300]  INFO -- default-precise32:     -# TypesConfig points to the file containing the list of mappings from
I, [2015-04-24T11:38:24.758444 #9300]  INFO -- default-precise32:     -# filename extension to MIME-type.
I, [2015-04-24T11:38:24.760422 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.762588 #9300]  INFO -- default-precise32:     -TypesConfig /etc/mime.types
I, [2015-04-24T11:38:24.764593 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.766730 #9300]  INFO -- default-precise32:     +  # AddType allows you to add to or override the MIME configuration
I, [2015-04-24T11:38:24.769076 #9300]  INFO -- default-precise32:     +  # file mime.types for specific file types.
I, [2015-04-24T11:38:24.771442 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.773446 #9300]  INFO -- default-precise32:     +  #AddType application/x-gzip .tgz
I, [2015-04-24T11:38:24.775547 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.777606 #9300]  INFO -- default-precise32:     +  # AddEncoding allows you to have certain browsers uncompress
I, [2015-04-24T11:38:24.779590 #9300]  INFO -- default-precise32:     +  # information on the fly. Note: Not all browsers support this.
I, [2015-04-24T11:38:24.781487 #9300]  INFO -- default-precise32:     +  # Despite the name similarity, the following Add* directives have
I, [2015-04-24T11:38:24.784484 #9300]  INFO -- default-precise32: +  # nothing to do with the FancyIndexing customization directives above.
I, [2015-04-24T11:38:24.784522 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.784543 #9300]  INFO -- default-precise32:     +  #AddEncoding x-compress .Z
I, [2015-04-24T11:38:24.785423 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:24.787137 #9300]  INFO -- default-precise32: +  #AddEncoding x-bzip2 .bz2
I, [2015-04-24T11:38:24.789488 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.789522 #9300]  INFO -- default-precise32:     +  # If the AddEncoding directives above are commented-out, then you
I, [2015-04-24T11:38:24.790612 #9300]  INFO -- default-precise32: +  # probably should define those extensions to indicate media types:
I, [2015-04-24T11:38:24.792960 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:24.794501 #9300]  INFO -- default-precise32:     +  AddType application/x-compress .Z
I, [2015-04-24T11:38:24.796490 #9300]  INFO -- default-precise32:     +  AddType application/x-gzip .gz .tgz
I, [2015-04-24T11:38:24.796524 #9300]  INFO -- default-precise32:     +  AddType application/x-bzip2 .bz2
I, [2015-04-24T11:38:24.797972 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:24.799676 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.802331 #9300]  INFO -- default-precise32:     -# AddType allows you to add to or override the MIME configuration
I, [2015-04-24T11:38:24.803547 #9300]  INFO -- default-precise32:     -# file mime.types for specific file types.
I, [2015-04-24T11:38:24.805259 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.806539 #9300]  INFO -- default-precise32:     -#AddType application/x-gzip .tgz
I, [2015-04-24T11:38:24.808503 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.810480 #9300]  INFO -- default-precise32:     -# AddEncoding allows you to have certain browsers uncompress
I, [2015-04-24T11:38:24.811535 #9300]  INFO -- default-precise32: -# information on the fly. Note: Not all browsers support this.
I, [2015-04-24T11:38:24.814555 #9300]  INFO -- default-precise32:     -# Despite the name similarity, the following Add* directives have
I, [2015-04-24T11:38:24.816525 #9300]  INFO -- default-precise32:     -# nothing to do with the FancyIndexing customization directives above.
I, [2015-04-24T11:38:24.817474 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.819491 #9300]  INFO -- default-precise32: -#AddEncoding x-compress .Z
I, [2015-04-24T11:38:24.821536 #9300]  INFO -- default-precise32: -#AddEncoding x-gzip .gz .tgz
I, [2015-04-24T11:38:24.821740 #9300]  INFO -- default-precise32: -#AddEncoding x-bzip2 .bz2
I, [2015-04-24T11:38:24.823526 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.826420 #9300]  INFO -- default-precise32:     -# If the AddEncoding directives above are commented-out, then you
I, [2015-04-24T11:38:24.828416 #9300]  INFO -- default-precise32:     -# probably should define those extensions to indicate media types:
I, [2015-04-24T11:38:24.831415 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.833285 #9300]  INFO -- default-precise32:     -AddType application/x-compress .Z
I, [2015-04-24T11:38:24.835457 #9300]  INFO -- default-precise32:     -AddType application/x-gzip .gz .tgz
I, [2015-04-24T11:38:24.838100 #9300]  INFO -- default-precise32:     -AddType application/x-bzip2 .bz2
I, [2015-04-24T11:38:24.840276 #9300]  INFO -- default-precise32:     +  AddType image/svg+xml svg svgz
I, [2015-04-24T11:38:24.842579 #9300]  INFO -- default-precise32:     +  AddEncoding gzip svgz
I, [2015-04-24T11:38:24.845063 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:24.847376 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.849503 #9300]  INFO -- default-precise32:     -# DefaultLanguage and AddLanguage allows you to specify the language of 
I, [2015-04-24T11:38:24.851749 #9300]  INFO -- default-precise32:     -# a document. You can then use content negotiation to give a browser a 
I, [2015-04-24T11:38:24.854373 #9300]  INFO -- default-precise32:     -# file in a language the user can understand.
I, [2015-04-24T11:38:24.856616 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.859236 #9300]  INFO -- default-precise32:     -# Specify a default language. This means that all data
I, [2015-04-24T11:38:24.861809 #9300]  INFO -- default-precise32:     -# going out without a specific language tag (see below) will 
I, [2015-04-24T11:38:24.864306 #9300]  INFO -- default-precise32:     -# be marked with this one. You probably do NOT want to set
I, [2015-04-24T11:38:24.866592 #9300]  INFO -- default-precise32:     -# this unless you are sure it is correct for all cases.
I, [2015-04-24T11:38:24.868732 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.871434 #9300]  INFO -- default-precise32:     -# * It is generally better to not mark a page as 
I, [2015-04-24T11:38:24.874279 #9300]  INFO -- default-precise32:     -# * being a certain language than marking it with the wrong
I, [2015-04-24T11:38:24.876474 #9300]  INFO -- default-precise32:     -# * language!
I, [2015-04-24T11:38:24.878981 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.881321 #9300]  INFO -- default-precise32:     -# DefaultLanguage nl
I, [2015-04-24T11:38:24.883414 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.886110 #9300]  INFO -- default-precise32:     -# Note 1: The suffix does not have to be the same as the language
I, [2015-04-24T11:38:24.888552 #9300]  INFO -- default-precise32:     -# keyword --- those with documents in Polish (whose net-standard
I, [2015-04-24T11:38:24.890756 #9300]  INFO -- default-precise32:     -# language code is pl) may wish to use "AddLanguage pl .po" to
I, [2015-04-24T11:38:24.893645 #9300]  INFO -- default-precise32:     -# avoid the ambiguity with the common suffix for perl scripts.
I, [2015-04-24T11:38:24.895983 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.898501 #9300]  INFO -- default-precise32:     -# Note 2: The example entries below illustrate that in some cases 
I, [2015-04-24T11:38:24.900551 #9300]  INFO -- default-precise32:     -# the two character 'Language' abbreviation is not identical to 
I, [2015-04-24T11:38:24.903383 #9300]  INFO -- default-precise32:     -# the two character 'Country' code for its country,
I, [2015-04-24T11:38:24.905496 #9300]  INFO -- default-precise32:     -# E.g. 'Danmark/dk' versus 'Danish/da'.
I, [2015-04-24T11:38:24.907740 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.910236 #9300]  INFO -- default-precise32:     -# Note 3: In the case of 'ltz' we violate the RFC by using a three char
I, [2015-04-24T11:38:24.912409 #9300]  INFO -- default-precise32:     -# specifier. There is 'work in progress' to fix this and get
I, [2015-04-24T11:38:24.915107 #9300]  INFO -- default-precise32:     -# the reference data for rfc1766 cleaned up.
I, [2015-04-24T11:38:24.917419 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.919827 #9300]  INFO -- default-precise32:     -# Catalan (ca) - Croatian (hr) - Czech (cs) - Danish (da) - Dutch (nl)
I, [2015-04-24T11:38:24.922370 #9300]  INFO -- default-precise32:     -# English (en) - Esperanto (eo) - Estonian (et) - French (fr) - German (de)
I, [2015-04-24T11:38:24.924598 #9300]  INFO -- default-precise32:     -# Greek-Modern (el) - Hebrew (he) - Italian (it) - Japanese (ja)
I, [2015-04-24T11:38:24.927215 #9300]  INFO -- default-precise32:     -# Korean (ko) - Luxembourgeois* (ltz) - Norwegian Nynorsk (nn)
I, [2015-04-24T11:38:24.929854 #9300]  INFO -- default-precise32:     -# Norwegian (no) - Polish (pl) - Portugese (pt)
I, [2015-04-24T11:38:24.932462 #9300]  INFO -- default-precise32:     -# Brazilian Portuguese (pt-BR) - Russian (ru) - Swedish (sv)
I, [2015-04-24T11:38:24.935012 #9300]  INFO -- default-precise32:     -# Simplified Chinese (zh-CN) - Spanish (es) - Traditional Chinese (zh-TW)
I, [2015-04-24T11:38:24.937211 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:24.939824 #9300]  INFO -- default-precise32:     -AddLanguage am .amh
I, [2015-04-24T11:38:24.941758 #9300]  INFO -- default-precise32:     -AddLanguage ar .ara
I, [2015-04-24T11:38:24.944229 #9300]  INFO -- default-precise32:     -AddLanguage be .be
I, [2015-04-24T11:38:24.946738 #9300]  INFO -- default-precise32:     -AddLanguage bg .bg
I, [2015-04-24T11:38:24.948977 #9300]  INFO -- default-precise32:     -AddLanguage bn .bn
I, [2015-04-24T11:38:24.951412 #9300]  INFO -- default-precise32:     -AddLanguage br .br
I, [2015-04-24T11:38:24.954460 #9300]  INFO -- default-precise32:     -AddLanguage bs .bs
I, [2015-04-24T11:38:24.968224 #9300]  INFO -- default-precise32:     -AddLanguage ca .ca
I, [2015-04-24T11:38:24.968312 #9300]  INFO -- default-precise32:     -AddLanguage cs .cz .cs
I, [2015-04-24T11:38:24.968339 #9300]  INFO -- default-precise32:     -AddLanguage cy .cy
I, [2015-04-24T11:38:24.968360 #9300]  INFO -- default-precise32:     -AddLanguage da .dk
I, [2015-04-24T11:38:24.968380 #9300]  INFO -- default-precise32:     -AddLanguage de .de
I, [2015-04-24T11:38:24.968400 #9300]  INFO -- default-precise32:     -AddLanguage dz .dz
I, [2015-04-24T11:38:24.968420 #9300]  INFO -- default-precise32:     -AddLanguage el .el
I, [2015-04-24T11:38:24.968440 #9300]  INFO -- default-precise32:     -AddLanguage en .en
I, [2015-04-24T11:38:24.968459 #9300]  INFO -- default-precise32:     -AddLanguage eo .eo
I, [2015-04-24T11:38:24.968479 #9300]  INFO -- default-precise32:     -# es is ecmascript in /etc/mime.types
I, [2015-04-24T11:38:24.968498 #9300]  INFO -- default-precise32:     -RemoveType  es
I, [2015-04-24T11:38:24.968517 #9300]  INFO -- default-precise32:     -AddLanguage es .es
I, [2015-04-24T11:38:24.968536 #9300]  INFO -- default-precise32:     -AddLanguage et .et
I, [2015-04-24T11:38:24.968583 #9300]  INFO -- default-precise32:     -AddLanguage eu .eu
I, [2015-04-24T11:38:24.968617 #9300]  INFO -- default-precise32:     -AddLanguage fa .fa
I, [2015-04-24T11:38:24.968637 #9300]  INFO -- default-precise32:     -AddLanguage fi .fi
I, [2015-04-24T11:38:24.968655 #9300]  INFO -- default-precise32:     -AddLanguage fr .fr
I, [2015-04-24T11:38:24.968674 #9300]  INFO -- default-precise32:     -AddLanguage ga .ga
I, [2015-04-24T11:38:24.968692 #9300]  INFO -- default-precise32:     -AddLanguage gl .glg
I, [2015-04-24T11:38:24.968710 #9300]  INFO -- default-precise32:     -AddLanguage gu .gu
I, [2015-04-24T11:38:24.968729 #9300]  INFO -- default-precise32:     -AddLanguage he .he
I, [2015-04-24T11:38:24.968747 #9300]  INFO -- default-precise32:     -AddLanguage hi .hi
I, [2015-04-24T11:38:24.968765 #9300]  INFO -- default-precise32:     -AddLanguage hr .hr
I, [2015-04-24T11:38:24.968783 #9300]  INFO -- default-precise32:     -AddLanguage hu .hu
I, [2015-04-24T11:38:24.969105 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:24.971159 #9300]  INFO -- default-precise32:     -AddLanguage id .id
I, [2015-04-24T11:38:24.973671 #9300]  INFO -- default-precise32:     -AddLanguage is .is
I, [2015-04-24T11:38:24.975840 #9300]  INFO -- default-precise32:     -AddLanguage it .it
I, [2015-04-24T11:38:24.977880 #9300]  INFO -- default-precise32:     -AddLanguage ja .ja
I, [2015-04-24T11:38:24.979829 #9300]  INFO -- default-precise32:     -AddLanguage ka .ka
I, [2015-04-24T11:38:24.981795 #9300]  INFO -- default-precise32:     -AddLanguage kk .kk
I, [2015-04-24T11:38:24.983978 #9300]  INFO -- default-precise32:     -AddLanguage km .km
I, [2015-04-24T11:38:24.986193 #9300]  INFO -- default-precise32:     -AddLanguage kn .kn
I, [2015-04-24T11:38:24.988676 #9300]  INFO -- default-precise32:     -AddLanguage ko .ko
I, [2015-04-24T11:38:24.990937 #9300]  INFO -- default-precise32:     -AddLanguage ku .ku
I, [2015-04-24T11:38:24.993602 #9300]  INFO -- default-precise32:     -AddLanguage lo .lo
I, [2015-04-24T11:38:24.997535 #9300]  INFO -- default-precise32:     -AddLanguage lt .lt
I, [2015-04-24T11:38:24.999788 #9300]  INFO -- default-precise32:     -AddLanguage ltz .ltz
I, [2015-04-24T11:38:25.002047 #9300]  INFO -- default-precise32:     -AddLanguage lv .lv
I, [2015-04-24T11:38:25.005360 #9300]  INFO -- default-precise32:     -AddLanguage mg .mg
I, [2015-04-24T11:38:25.006776 #9300]  INFO -- default-precise32:     -AddLanguage mk .mk
I, [2015-04-24T11:38:25.008986 #9300]  INFO -- default-precise32:     -AddLanguage ml .ml
I, [2015-04-24T11:38:25.011207 #9300]  INFO -- default-precise32:     -AddLanguage mr .mr
I, [2015-04-24T11:38:25.013794 #9300]  INFO -- default-precise32:     -AddLanguage ms .msa
I, [2015-04-24T11:38:25.015991 #9300]  INFO -- default-precise32:     -AddLanguage nb .nob
I, [2015-04-24T11:38:25.018476 #9300]  INFO -- default-precise32:     -AddLanguage ne .ne
I, [2015-04-24T11:38:25.020576 #9300]  INFO -- default-precise32:     -AddLanguage nl .nl
I, [2015-04-24T11:38:25.023385 #9300]  INFO -- default-precise32:     -AddLanguage nn .nn
I, [2015-04-24T11:38:25.027685 #9300]  INFO -- default-precise32:     -AddLanguage no .no
I, [2015-04-24T11:38:25.029806 #9300]  INFO -- default-precise32:     -AddLanguage pa .pa
I, [2015-04-24T11:38:25.031785 #9300]  INFO -- default-precise32:     -AddLanguage pl .po
I, [2015-04-24T11:38:25.034220 #9300]  INFO -- default-precise32:     -AddLanguage pt-BR .pt-br
I, [2015-04-24T11:38:25.036657 #9300]  INFO -- default-precise32:     -AddLanguage pt .pt
I, [2015-04-24T11:38:25.038965 #9300]  INFO -- default-precise32:     -AddLanguage ro .ro
I, [2015-04-24T11:38:25.040979 #9300]  INFO -- default-precise32:     -AddLanguage ru .ru
I, [2015-04-24T11:38:25.043040 #9300]  INFO -- default-precise32:     -AddLanguage sa .sa
I, [2015-04-24T11:38:25.044960 #9300]  INFO -- default-precise32:     -AddLanguage se .se
I, [2015-04-24T11:38:25.047437 #9300]  INFO -- default-precise32:     -AddLanguage si .si
I, [2015-04-24T11:38:25.049792 #9300]  INFO -- default-precise32:     -AddLanguage sk .sk
I, [2015-04-24T11:38:25.051782 #9300]  INFO -- default-precise32:     -AddLanguage sl .sl
I, [2015-04-24T11:38:25.055311 #9300]  INFO -- default-precise32:     -AddLanguage sq .sq
I, [2015-04-24T11:38:25.056203 #9300]  INFO -- default-precise32:     -AddLanguage sr .sr
I, [2015-04-24T11:38:25.058715 #9300]  INFO -- default-precise32:     -AddLanguage sv .sv
I, [2015-04-24T11:38:25.060709 #9300]  INFO -- default-precise32:     -AddLanguage ta .ta
I, [2015-04-24T11:38:25.063175 #9300]  INFO -- default-precise32:     -AddLanguage te .te
I, [2015-04-24T11:38:25.065221 #9300]  INFO -- default-precise32:     -AddLanguage th .th
I, [2015-04-24T11:38:25.067691 #9300]  INFO -- default-precise32:     -AddLanguage tl .tl
I, [2015-04-24T11:38:25.069892 #9300]  INFO -- default-precise32:     -RemoveType  tr
I, [2015-04-24T11:38:25.072072 #9300]  INFO -- default-precise32:     -# tr is troff in /etc/mime.types
I, [2015-04-24T11:38:25.074123 #9300]  INFO -- default-precise32:     -AddLanguage tr .tr
I, [2015-04-24T11:38:25.075807 #9300]  INFO -- default-precise32:     -AddLanguage uk .uk
I, [2015-04-24T11:38:25.078195 #9300]  INFO -- default-precise32:     -AddLanguage ur .ur
I, [2015-04-24T11:38:25.080424 #9300]  INFO -- default-precise32:     -AddLanguage vi .vi
I, [2015-04-24T11:38:25.084871 #9300]  INFO -- default-precise32:     -AddLanguage wo .wo
I, [2015-04-24T11:38:25.085448 #9300]  INFO -- default-precise32:     -AddLanguage xh .xh
I, [2015-04-24T11:38:25.087879 #9300]  INFO -- default-precise32:     -AddLanguage zh-CN .zh-cn
I, [2015-04-24T11:38:25.090268 #9300]  INFO -- default-precise32:     -AddLanguage zh-TW .zh-tw
I, [2015-04-24T11:38:25.092481 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.094809 #9300]  INFO -- default-precise32:     +  # DefaultLanguage and AddLanguage allows you to specify the language of
I, [2015-04-24T11:38:25.096841 #9300]  INFO -- default-precise32:     +  # a document. You can then use content negotiation to give a browser a
I, [2015-04-24T11:38:25.099192 #9300]  INFO -- default-precise32:     +  # file in a language the user can understand.
I, [2015-04-24T11:38:25.101446 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.103678 #9300]  INFO -- default-precise32:     +  # Specify a default language. This means that all data
I, [2015-04-24T11:38:25.105753 #9300]  INFO -- default-precise32:     +  # going out without a specific language tag (see below) will
I, [2015-04-24T11:38:25.107944 #9300]  INFO -- default-precise32:     +  # be marked with this one. You probably do NOT want to set
I, [2015-04-24T11:38:25.110024 #9300]  INFO -- default-precise32:     +  # this unless you are sure it is correct for all cases.
I, [2015-04-24T11:38:25.111984 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.114340 #9300]  INFO -- default-precise32:     +  # * It is generally better to not mark a page as
I, [2015-04-24T11:38:25.116929 #9300]  INFO -- default-precise32:     +  # * being a certain language than marking it with the wrong
I, [2015-04-24T11:38:25.120119 #9300]  INFO -- default-precise32:     +  # * language!
I, [2015-04-24T11:38:25.122732 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.125123 #9300]  INFO -- default-precise32:     +  # DefaultLanguage nl
I, [2015-04-24T11:38:25.127514 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.129955 #9300]  INFO -- default-precise32:     +  # Note 1: The suffix does not have to be the same as the language
I, [2015-04-24T11:38:25.132041 #9300]  INFO -- default-precise32:     +  # keyword --- those with documents in Polish (whose net-standard
I, [2015-04-24T11:38:25.134402 #9300]  INFO -- default-precise32:     +  # language code is pl) may wish to use "AddLanguage pl .po" to
I, [2015-04-24T11:38:25.136627 #9300]  INFO -- default-precise32:     +  # avoid the ambiguity with the common suffix for perl scripts.
I, [2015-04-24T11:38:25.139407 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.140938 #9300]  INFO -- default-precise32:     +  # Note 2: The example entries below illustrate that in some cases
I, [2015-04-24T11:38:25.145040 #9300]  INFO -- default-precise32:     +  # the two character 'Language' abbreviation is not identical to
I, [2015-04-24T11:38:25.145550 #9300]  INFO -- default-precise32:     +  # the two character 'Country' code for its country,
I, [2015-04-24T11:38:25.147520 #9300]  INFO -- default-precise32:     +  # E.g. 'Danmark/dk' versus 'Danish/da'.
I, [2015-04-24T11:38:25.149790 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.151970 #9300]  INFO -- default-precise32:     +  # Note 3: In the case of 'ltz' we violate the RFC by using a three char
I, [2015-04-24T11:38:25.154176 #9300]  INFO -- default-precise32:     +  # specifier. There is 'work in progress' to fix this and get
I, [2015-04-24T11:38:25.157803 #9300]  INFO -- default-precise32:     +  # the reference data for rfc1766 cleaned up.
I, [2015-04-24T11:38:25.159745 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.161939 #9300]  INFO -- default-precise32:     +  # Catalan (ca) - Croatian (hr) - Czech (cs) - Danish (da) - Dutch (nl)
I, [2015-04-24T11:38:25.163915 #9300]  INFO -- default-precise32:     +  # English (en) - Esperanto (eo) - Estonian (et) - French (fr) - German (de)
I, [2015-04-24T11:38:25.166201 #9300]  INFO -- default-precise32:     +  # Greek-Modern (el) - Hebrew (he) - Italian (it) - Japanese (ja)
I, [2015-04-24T11:38:25.168103 #9300]  INFO -- default-precise32:     +  # Korean (ko) - Luxembourgeois* (ltz) - Norwegian Nynorsk (nn)
I, [2015-04-24T11:38:25.170128 #9300]  INFO -- default-precise32:     +  # Norwegian (no) - Polish (pl) - Portugese (pt)
I, [2015-04-24T11:38:25.172847 #9300]  INFO -- default-precise32:     +  # Brazilian Portuguese (pt-BR) - Russian (ru) - Swedish (sv)
I, [2015-04-24T11:38:25.174873 #9300]  INFO -- default-precise32:     +  # Simplified Chinese (zh-CN) - Spanish (es) - Traditional Chinese (zh-TW)
I, [2015-04-24T11:38:25.177155 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.179701 #9300]  INFO -- default-precise32:     +  AddLanguage ca .ca
I, [2015-04-24T11:38:25.182220 #9300]  INFO -- default-precise32:     +  AddLanguage cs .cz .cs
I, [2015-04-24T11:38:25.184811 #9300]  INFO -- default-precise32:     +  AddLanguage da .dk
I, [2015-04-24T11:38:25.187571 #9300]  INFO -- default-precise32:     +  AddLanguage de .de
I, [2015-04-24T11:38:25.190400 #9300]  INFO -- default-precise32:     +  AddLanguage el .el
I, [2015-04-24T11:38:25.193065 #9300]  INFO -- default-precise32:     +  AddLanguage en .en
I, [2015-04-24T11:38:25.195958 #9300]  INFO -- default-precise32:     +  AddLanguage eo .eo
I, [2015-04-24T11:38:25.198599 #9300]  INFO -- default-precise32:     +  # See README.Debian for Spanish
I, [2015-04-24T11:38:25.200979 #9300]  INFO -- default-precise32:     +  AddLanguage es .es
I, [2015-04-24T11:38:25.203890 #9300]  INFO -- default-precise32:     +  AddLanguage et .et
I, [2015-04-24T11:38:25.206622 #9300]  INFO -- default-precise32:     +  AddLanguage fr .fr
I, [2015-04-24T11:38:25.208898 #9300]  INFO -- default-precise32:     +  AddLanguage he .he
I, [2015-04-24T11:38:25.211743 #9300]  INFO -- default-precise32:     +  AddLanguage hr .hr
I, [2015-04-24T11:38:25.214182 #9300]  INFO -- default-precise32:     +  AddLanguage it .it
I, [2015-04-24T11:38:25.216839 #9300]  INFO -- default-precise32:     +  AddLanguage ja .ja
I, [2015-04-24T11:38:25.219326 #9300]  INFO -- default-precise32:     +  AddLanguage ko .ko
I, [2015-04-24T11:38:25.222438 #9300]  INFO -- default-precise32:     +  AddLanguage ltz .ltz
I, [2015-04-24T11:38:25.225213 #9300]  INFO -- default-precise32:     +  AddLanguage nl .nl
I, [2015-04-24T11:38:25.227998 #9300]  INFO -- default-precise32:     +  AddLanguage nn .nn
I, [2015-04-24T11:38:25.230335 #9300]  INFO -- default-precise32:     +  AddLanguage no .no
I, [2015-04-24T11:38:25.232865 #9300]  INFO -- default-precise32:     +  AddLanguage pl .po
I, [2015-04-24T11:38:25.235325 #9300]  INFO -- default-precise32:     +  AddLanguage pt .pt
I, [2015-04-24T11:38:25.237444 #9300]  INFO -- default-precise32:     +  AddLanguage pt-BR .pt-br
I, [2015-04-24T11:38:25.239986 #9300]  INFO -- default-precise32:     +  AddLanguage ru .ru
I, [2015-04-24T11:38:25.242291 #9300]  INFO -- default-precise32:     +  AddLanguage sv .sv
I, [2015-04-24T11:38:25.244679 #9300]  INFO -- default-precise32:     +  # See README.Debian for Turkish
I, [2015-04-24T11:38:25.247084 #9300]  INFO -- default-precise32:     +  AddLanguage tr .tr
I, [2015-04-24T11:38:25.249435 #9300]  INFO -- default-precise32:     +  AddLanguage zh-CN .zh-cn
I, [2015-04-24T11:38:25.251829 #9300]  INFO -- default-precise32:     +  AddLanguage zh-TW .zh-tw
I, [2015-04-24T11:38:25.254298 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:25.257175 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.259829 #9300]  INFO -- default-precise32:     -# Commonly used filename extensions to character sets. You probably
I, [2015-04-24T11:38:25.262703 #9300]  INFO -- default-precise32:     -# want to avoid clashes with the language extensions, unless you
I, [2015-04-24T11:38:25.265218 #9300]  INFO -- default-precise32:     -# are good at carefully testing your setup after each change.
I, [2015-04-24T11:38:25.268089 #9300]  INFO -- default-precise32:     -# See http://www.iana.org/assignments/character-sets for the
I, [2015-04-24T11:38:25.270362 #9300]  INFO -- default-precise32:     -# official list of charset names and their respective RFCs.
I, [2015-04-24T11:38:25.272809 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.275278 #9300]  INFO -- default-precise32:     -AddCharset us-ascii    .ascii .us-ascii
I, [2015-04-24T11:38:25.277886 #9300]  INFO -- default-precise32:     -AddCharset ISO-8859-1  .iso8859-1  .latin1
I, [2015-04-24T11:38:25.280094 #9300]  INFO -- default-precise32:     -AddCharset ISO-8859-2  .iso8859-2  .latin2 .cen
I, [2015-04-24T11:38:25.282684 #9300]  INFO -- default-precise32:     -AddCharset ISO-8859-3  .iso8859-3  .latin3
I, [2015-04-24T11:38:25.285447 #9300]  INFO -- default-precise32:     -AddCharset ISO-8859-4  .iso8859-4  .latin4
I, [2015-04-24T11:38:25.287972 #9300]  INFO -- default-precise32:     -AddCharset ISO-8859-5  .iso8859-5  .cyr .iso-ru
I, [2015-04-24T11:38:25.290680 #9300]  INFO -- default-precise32:     -AddCharset ISO-8859-6  .iso8859-6  .arb .arabic
I, [2015-04-24T11:38:25.293134 #9300]  INFO -- default-precise32:     -AddCharset ISO-8859-7  .iso8859-7  .grk .greek
I, [2015-04-24T11:38:25.295481 #9300]  INFO -- default-precise32:     -AddCharset ISO-8859-8  .iso8859-8  .heb .hebrew
I, [2015-04-24T11:38:25.298161 #9300]  INFO -- default-precise32:     -AddCharset ISO-8859-9  .iso8859-9  .latin5 .trk
I, [2015-04-24T11:38:25.300331 #9300]  INFO -- default-precise32:     -AddCharset ISO-8859-10  .iso8859-10  .latin6
I, [2015-04-24T11:38:25.303104 #9300]  INFO -- default-precise32:     -AddCharset ISO-8859-13  .iso8859-13
I, [2015-04-24T11:38:25.305641 #9300]  INFO -- default-precise32:     -AddCharset ISO-8859-14  .iso8859-14  .latin8
I, [2015-04-24T11:38:25.307843 #9300]  INFO -- default-precise32:     -AddCharset ISO-8859-15  .iso8859-15  .latin9
I, [2015-04-24T11:38:25.310077 #9300]  INFO -- default-precise32:     -AddCharset ISO-8859-16  .iso8859-16  .latin10
I, [2015-04-24T11:38:25.312170 #9300]  INFO -- default-precise32:     -AddCharset ISO-2022-JP .iso2022-jp .jis
I, [2015-04-24T11:38:25.314815 #9300]  INFO -- default-precise32:     -AddCharset ISO-2022-KR .iso2022-kr .kis
I, [2015-04-24T11:38:25.317168 #9300]  INFO -- default-precise32:     -AddCharset ISO-2022-CN .iso2022-cn .cis
I, [2015-04-24T11:38:25.320685 #9300]  INFO -- default-precise32:     -AddCharset Big5        .Big5       .big5 .b5
I, [2015-04-24T11:38:25.325070 #9300]  INFO -- default-precise32:     -AddCharset cn-Big5     .cn-big5
I, [2015-04-24T11:38:25.327333 #9300]  INFO -- default-precise32:     -# For russian, more than one charset is used (depends on client, mostly):
I, [2015-04-24T11:38:25.329124 #9300]  INFO -- default-precise32:     -AddCharset WINDOWS-1251 .cp-1251   .win-1251
I, [2015-04-24T11:38:25.331516 #9300]  INFO -- default-precise32:     -AddCharset CP866       .cp866
I, [2015-04-24T11:38:25.334173 #9300]  INFO -- default-precise32:     -AddCharset KOI8      .koi8
I, [2015-04-24T11:38:25.336156 #9300]  INFO -- default-precise32:     -AddCharset KOI8-E      .koi8-e
I, [2015-04-24T11:38:25.338296 #9300]  INFO -- default-precise32:     -AddCharset KOI8-r      .koi8-r .koi8-ru
I, [2015-04-24T11:38:25.339985 #9300]  INFO -- default-precise32:     -AddCharset KOI8-U      .koi8-u
I, [2015-04-24T11:38:25.341600 #9300]  INFO -- default-precise32:     -AddCharset KOI8-ru     .koi8-uk .ua
I, [2015-04-24T11:38:25.343398 #9300]  INFO -- default-precise32:     -AddCharset ISO-10646-UCS-2 .ucs2
I, [2015-04-24T11:38:25.344845 #9300]  INFO -- default-precise32:     -AddCharset ISO-10646-UCS-4 .ucs4
I, [2015-04-24T11:38:25.346550 #9300]  INFO -- default-precise32:     -AddCharset UTF-7       .utf7
I, [2015-04-24T11:38:25.348426 #9300]  INFO -- default-precise32:     -AddCharset UTF-8       .utf8
I, [2015-04-24T11:38:25.352405 #9300]  INFO -- default-precise32:     -AddCharset UTF-16      .utf16
I, [2015-04-24T11:38:25.352662 #9300]  INFO -- default-precise32:     -AddCharset UTF-16BE    .utf16be
I, [2015-04-24T11:38:25.354136 #9300]  INFO -- default-precise32:     -AddCharset UTF-16LE    .utf16le
I, [2015-04-24T11:38:25.356825 #9300]  INFO -- default-precise32:     -AddCharset UTF-32      .utf32
I, [2015-04-24T11:38:25.358570 #9300]  INFO -- default-precise32:     -AddCharset UTF-32BE    .utf32be
I, [2015-04-24T11:38:25.360224 #9300]  INFO -- default-precise32:     -AddCharset UTF-32LE    .utf32le
I, [2015-04-24T11:38:25.362175 #9300]  INFO -- default-precise32:     -AddCharset euc-cn      .euc-cn
I, [2015-04-24T11:38:25.363618 #9300]  INFO -- default-precise32:     -AddCharset euc-gb      .euc-gb
I, [2015-04-24T11:38:25.365466 #9300]  INFO -- default-precise32:     -AddCharset euc-jp      .euc-jp
I, [2015-04-24T11:38:25.367401 #9300]  INFO -- default-precise32:     -AddCharset euc-kr      .euc-kr
I, [2015-04-24T11:38:25.369028 #9300]  INFO -- default-precise32:     -#Not sure how euc-tw got in - IANA doesn't list it???
I, [2015-04-24T11:38:25.370585 #9300]  INFO -- default-precise32:     -AddCharset EUC-TW      .euc-tw
I, [2015-04-24T11:38:25.372265 #9300]  INFO -- default-precise32:     -AddCharset gb2312      .gb2312 .gb
I, [2015-04-24T11:38:25.374225 #9300]  INFO -- default-precise32:     -AddCharset iso-10646-ucs-2 .ucs-2 .iso-10646-ucs-2
I, [2015-04-24T11:38:25.376118 #9300]  INFO -- default-precise32:     -AddCharset iso-10646-ucs-4 .ucs-4 .iso-10646-ucs-4
I, [2015-04-24T11:38:25.378183 #9300]  INFO -- default-precise32:     -AddCharset shift_jis   .shift_jis .sjis
I, [2015-04-24T11:38:25.380486 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.382237 #9300]  INFO -- default-precise32:     +  # Commonly used filename extensions to character sets. You probably
I, [2015-04-24T11:38:25.391597 #9300]  INFO -- default-precise32:     +  # want to avoid clashes with the language extensions, unless you
I, [2015-04-24T11:38:25.395910 #9300]  INFO -- default-precise32:     +  # are good at carefully testing your setup after each change.
I, [2015-04-24T11:38:25.400069 #9300]  INFO -- default-precise32:     +  # See http://www.iana.org/assignments/character-sets for the
I, [2015-04-24T11:38:25.402331 #9300]  INFO -- default-precise32:     +  # official list of charset names and their respective RFCs.
I, [2015-04-24T11:38:25.405061 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.407566 #9300]  INFO -- default-precise32:     +  AddCharset us-ascii    .ascii .us-ascii
I, [2015-04-24T11:38:25.410135 #9300]  INFO -- default-precise32:     +  AddCharset ISO-8859-1  .iso8859-1  .latin1
I, [2015-04-24T11:38:25.412838 #9300]  INFO -- default-precise32:     +  AddCharset ISO-8859-2  .iso8859-2  .latin2 .cen
I, [2015-04-24T11:38:25.415352 #9300]  INFO -- default-precise32:     +  AddCharset ISO-8859-3  .iso8859-3  .latin3
I, [2015-04-24T11:38:25.418145 #9300]  INFO -- default-precise32:     +  AddCharset ISO-8859-4  .iso8859-4  .latin4
I, [2015-04-24T11:38:25.420781 #9300]  INFO -- default-precise32:     +  AddCharset ISO-8859-5  .iso8859-5  .cyr .iso-ru
I, [2015-04-24T11:38:25.423250 #9300]  INFO -- default-precise32:     +  AddCharset ISO-8859-6  .iso8859-6  .arb .arabic
I, [2015-04-24T11:38:25.425474 #9300]  INFO -- default-precise32:     +  AddCharset ISO-8859-7  .iso8859-7  .grk .greek
I, [2015-04-24T11:38:25.428078 #9300]  INFO -- default-precise32:     +  AddCharset ISO-8859-8  .iso8859-8  .heb .hebrew
I, [2015-04-24T11:38:25.430330 #9300]  INFO -- default-precise32:     +  AddCharset ISO-8859-9  .iso8859-9  .latin5 .trk
I, [2015-04-24T11:38:25.433194 #9300]  INFO -- default-precise32:     +  AddCharset ISO-8859-10  .iso8859-10  .latin6
I, [2015-04-24T11:38:25.435837 #9300]  INFO -- default-precise32:     +  AddCharset ISO-8859-13  .iso8859-13
I, [2015-04-24T11:38:25.438240 #9300]  INFO -- default-precise32:     +  AddCharset ISO-8859-14  .iso8859-14  .latin8
I, [2015-04-24T11:38:25.440354 #9300]  INFO -- default-precise32:     +  AddCharset ISO-8859-15  .iso8859-15  .latin9
I, [2015-04-24T11:38:25.442982 #9300]  INFO -- default-precise32:     +  AddCharset ISO-8859-16  .iso8859-16  .latin10
I, [2015-04-24T11:38:25.445318 #9300]  INFO -- default-precise32:     +  AddCharset ISO-2022-JP .iso2022-jp .jis
I, [2015-04-24T11:38:25.448515 #9300]  INFO -- default-precise32:     +  AddCharset ISO-2022-KR .iso2022-kr .kis
I, [2015-04-24T11:38:25.450940 #9300]  INFO -- default-precise32:     +  AddCharset ISO-2022-CN .iso2022-cn .cis
I, [2015-04-24T11:38:25.453625 #9300]  INFO -- default-precise32:     +  AddCharset Big5        .Big5       .big5 .b5
I, [2015-04-24T11:38:25.455942 #9300]  INFO -- default-precise32:     +  AddCharset cn-Big5     .cn-big5
I, [2015-04-24T11:38:25.458814 #9300]  INFO -- default-precise32:     +  # For russian, more than one charset is used (depends on client, mostly):
I, [2015-04-24T11:38:25.461199 #9300]  INFO -- default-precise32:     +  AddCharset WINDOWS-1251 .cp-1251   .win-1251
I, [2015-04-24T11:38:25.463977 #9300]  INFO -- default-precise32:     +  AddCharset CP866       .cp866
I, [2015-04-24T11:38:25.466750 #9300]  INFO -- default-precise32:     +  AddCharset KOI8      .koi8
I, [2015-04-24T11:38:25.469705 #9300]  INFO -- default-precise32:     +  AddCharset KOI8-E      .koi8-e
I, [2015-04-24T11:38:25.471987 #9300]  INFO -- default-precise32:     +  AddCharset KOI8-r      .koi8-r .koi8-ru
I, [2015-04-24T11:38:25.474813 #9300]  INFO -- default-precise32:     +  AddCharset KOI8-U      .koi8-u
I, [2015-04-24T11:38:25.477064 #9300]  INFO -- default-precise32:     +  AddCharset KOI8-ru     .koi8-uk .ua
I, [2015-04-24T11:38:25.479825 #9300]  INFO -- default-precise32:     +  AddCharset ISO-10646-UCS-2 .ucs2
I, [2015-04-24T11:38:25.482171 #9300]  INFO -- default-precise32:     +  AddCharset ISO-10646-UCS-4 .ucs4
I, [2015-04-24T11:38:25.484705 #9300]  INFO -- default-precise32:     +  AddCharset UTF-7       .utf7
I, [2015-04-24T11:38:25.487224 #9300]  INFO -- default-precise32:     +  AddCharset UTF-8       .utf8
I, [2015-04-24T11:38:25.489872 #9300]  INFO -- default-precise32:     +  AddCharset UTF-16      .utf16
I, [2015-04-24T11:38:25.492124 #9300]  INFO -- default-precise32:     +  AddCharset UTF-16BE    .utf16be
I, [2015-04-24T11:38:25.494329 #9300]  INFO -- default-precise32:     +  AddCharset UTF-16LE    .utf16le
I, [2015-04-24T11:38:25.496470 #9300]  INFO -- default-precise32:     +  AddCharset UTF-32      .utf32
I, [2015-04-24T11:38:25.499094 #9300]  INFO -- default-precise32:     +  AddCharset UTF-32BE    .utf32be
I, [2015-04-24T11:38:25.501348 #9300]  INFO -- default-precise32:     +  AddCharset UTF-32LE    .utf32le
I, [2015-04-24T11:38:25.503853 #9300]  INFO -- default-precise32:     +  AddCharset euc-cn      .euc-cn
I, [2015-04-24T11:38:25.506345 #9300]  INFO -- default-precise32:     +  AddCharset euc-gb      .euc-gb
I, [2015-04-24T11:38:25.509028 #9300]  INFO -- default-precise32:     +  AddCharset euc-jp      .euc-jp
I, [2015-04-24T11:38:25.511325 #9300]  INFO -- default-precise32:     +  AddCharset euc-kr      .euc-kr
I, [2015-04-24T11:38:25.514124 #9300]  INFO -- default-precise32:     +  #Not sure how euc-tw got in - IANA doesn't list it???
I, [2015-04-24T11:38:25.516333 #9300]  INFO -- default-precise32:     +  AddCharset EUC-TW      .euc-tw
I, [2015-04-24T11:38:25.519643 #9300]  INFO -- default-precise32:     +  AddCharset gb2312      .gb2312 .gb
I, [2015-04-24T11:38:25.522591 #9300]  INFO -- default-precise32:     +  AddCharset iso-10646-ucs-2 .ucs-2 .iso-10646-ucs-2
I, [2015-04-24T11:38:25.525172 #9300]  INFO -- default-precise32:     +  AddCharset iso-10646-ucs-4 .ucs-4 .iso-10646-ucs-4
I, [2015-04-24T11:38:25.527818 #9300]  INFO -- default-precise32:     +  AddCharset shift_jis   .shift_jis .sjis
I, [2015-04-24T11:38:25.530601 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:25.532894 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.535482 #9300]  INFO -- default-precise32:     -# AddHandler allows you to map certain file extensions to "handlers":
I, [2015-04-24T11:38:25.537926 #9300]  INFO -- default-precise32:     -# actions unrelated to filetype. These can be either built into the server
I, [2015-04-24T11:38:25.540059 #9300]  INFO -- default-precise32:     -# or added with the Action directive (see below)
I, [2015-04-24T11:38:25.542561 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.544800 #9300]  INFO -- default-precise32:     -# To use CGI scripts outside of ScriptAliased directories:
I, [2015-04-24T11:38:25.547130 #9300]  INFO -- default-precise32:     -# (You will also need to add "ExecCGI" to the "Options" directive.)
I, [2015-04-24T11:38:25.549209 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.551783 #9300]  INFO -- default-precise32:     -#AddHandler cgi-script .cgi
I, [2015-04-24T11:38:25.554373 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.556460 #9300]  INFO -- default-precise32:     +  # AddHandler allows you to map certain file extensions to "handlers":
I, [2015-04-24T11:38:25.559333 #9300]  INFO -- default-precise32:     +  # actions unrelated to filetype. These can be either built into the server
I, [2015-04-24T11:38:25.562172 #9300]  INFO -- default-precise32:     +  # or added with the Action directive (see below)
I, [2015-04-24T11:38:25.565169 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.567850 #9300]  INFO -- default-precise32:     +  # To use CGI scripts outside of ScriptAliased directories:
I, [2015-04-24T11:38:25.570170 #9300]  INFO -- default-precise32:     +  # (You will also need to add "ExecCGI" to the "Options" directive.)
I, [2015-04-24T11:38:25.572638 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.575690 #9300]  INFO -- default-precise32:     +  #AddHandler cgi-script .cgi
I, [2015-04-24T11:38:25.577965 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:25.580451 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.583156 #9300]  INFO -- default-precise32:     -# For files that include their own HTTP headers:
I, [2015-04-24T11:38:25.585921 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.589213 #9300]  INFO -- default-precise32:     -#AddHandler send-as-is asis
I, [2015-04-24T11:38:25.590925 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.593491 #9300]  INFO -- default-precise32:     +  # For files that include their own HTTP headers:
I, [2015-04-24T11:38:25.595685 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.597595 #9300]  INFO -- default-precise32:     +  #AddHandler send-as-is asis
I, [2015-04-24T11:38:25.599815 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:25.602032 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.604198 #9300]  INFO -- default-precise32:     -# For server-parsed imagemap files:
I, [2015-04-24T11:38:25.606785 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.609090 #9300]  INFO -- default-precise32:     -#AddHandler imap-file map
I, [2015-04-24T11:38:25.611336 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.614119 #9300]  INFO -- default-precise32:     +  # For server-parsed imagemap files:
I, [2015-04-24T11:38:25.616738 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.619472 #9300]  INFO -- default-precise32:     +  #AddHandler imap-file map
I, [2015-04-24T11:38:25.622196 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:25.625200 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.627975 #9300]  INFO -- default-precise32:     -# For type maps (negotiated resources):
I, [2015-04-24T11:38:25.630654 #9300]  INFO -- default-precise32:     -# (This is enabled by default to allow the Apache "It Worked" page
I, [2015-04-24T11:38:25.632891 #9300]  INFO -- default-precise32:     -#  to be distributed in multiple languages.)
I, [2015-04-24T11:38:25.635698 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.637956 #9300]  INFO -- default-precise32:     -AddHandler type-map var
I, [2015-04-24T11:38:25.640540 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.642881 #9300]  INFO -- default-precise32:     +  # For type maps (negotiated resources):
I, [2015-04-24T11:38:25.645111 #9300]  INFO -- default-precise32:     +  # (This is enabled by default to allow the Apache "It Worked" page
I, [2015-04-24T11:38:25.647751 #9300]  INFO -- default-precise32:     +  #  to be distributed in multiple languages.)
I, [2015-04-24T11:38:25.650799 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.653436 #9300]  INFO -- default-precise32:     +  AddHandler type-map var
I, [2015-04-24T11:38:25.655925 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:25.658579 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.660514 #9300]  INFO -- default-precise32:     -# Filters allow you to process content before it is sent to the client.
I, [2015-04-24T11:38:25.663107 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.665183 #9300]  INFO -- default-precise32:     -# To parse .shtml files for server-side includes (SSI):
I, [2015-04-24T11:38:25.667930 #9300]  INFO -- default-precise32:     -# (You will also need to add "Includes" to the "Options" directive.)
I, [2015-04-24T11:38:25.670187 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.672763 #9300]  INFO -- default-precise32:     -AddType text/html .shtml
I, [2015-04-24T11:38:25.675314 #9300]  INFO -- default-precise32:     -AddOutputFilter INCLUDES .shtml
I, [2015-04-24T11:38:25.677814 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:25.680105 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.683033 #9300]  INFO -- default-precise32:     +  # Filters allow you to process content before it is sent to the client.
I, [2015-04-24T11:38:25.687759 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.690196 #9300]  INFO -- default-precise32:     +  # To parse .shtml files for server-side includes (SSI):
I, [2015-04-24T11:38:25.692751 #9300]  INFO -- default-precise32:     +  # (You will also need to add "Includes" to the "Options" directive.)
I, [2015-04-24T11:38:25.694906 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.697178 #9300]  INFO -- default-precise32:     +  AddType text/html .shtml
I, [2015-04-24T11:38:25.699309 #9300]  INFO -- default-precise32:     +  AddOutputFilter INCLUDES .shtml
I, [2015-04-24T11:38:25.703193 #9300]  INFO -- default-precise32:      </IfModule>
I, [2015-04-24T11:38:25.712280 #9300]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/mime.load] action create (up to date)
I, [2015-04-24T11:38:25.716078 #9300]  INFO -- default-precise32:   * execute[a2enmod mime] action run (skipped due to not_if)
I, [2015-04-24T11:38:25.718021 #9300]  INFO -- default-precise32: Recipe: apache2::mod_negotiation
I, [2015-04-24T11:38:25.733371 #9300]  INFO -- default-precise32:   * template[/etc/apache2/mods-available/negotiation.conf] action create
I, [2015-04-24T11:38:25.735835 #9300]  INFO -- default-precise32:     - update content in file /etc/apache2/mods-available/negotiation.conf from ca1d73 to 3ad8fd
I, [2015-04-24T11:38:25.739180 #9300]  INFO -- default-precise32:     --- /etc/apache2/mods-available/negotiation.conf	2012-02-07 04:17:00.000000000 +0000
I, [2015-04-24T11:38:25.742233 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-ec82vi	2015-04-24 08:38:25.716622308 +0000
I, [2015-04-24T11:38:25.744354 #9300]  INFO -- default-precise32:     @@ -1,19 +1,18 @@
I, [2015-04-24T11:38:25.750304 #9300]  INFO -- default-precise32:      <IfModule mod_negotiation.c>
I, [2015-04-24T11:38:25.750342 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.750364 #9300]  INFO -- default-precise32:     -# LanguagePriority allows you to give precedence to some languages
I, [2015-04-24T11:38:25.750385 #9300]  INFO -- default-precise32:     -# in case of a tie during content negotiation.
I, [2015-04-24T11:38:25.750403 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.750423 #9300]  INFO -- default-precise32:     -# Just list the languages in decreasing order of preference. We have
I, [2015-04-24T11:38:25.750443 #9300]  INFO -- default-precise32:     -# more or less alphabetized them here. You probably want to change this.
I, [2015-04-24T11:38:25.750471 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.750491 #9300]  INFO -- default-precise32:     -LanguagePriority en ca cs da de el eo es et fr he hr it ja ko ltz nl nn no pl pt pt-BR ru sv tr zh-CN zh-TW
I, [2015-04-24T11:38:25.750510 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.750529 #9300]  INFO -- default-precise32:     +  # LanguagePriority allows you to give precedence to some languages
I, [2015-04-24T11:38:25.750549 #9300]  INFO -- default-precise32:     +  # in case of a tie during content negotiation.
I, [2015-04-24T11:38:25.750568 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.750587 #9300]  INFO -- default-precise32:     +  # Just list the languages in decreasing order of preference. We have
I, [2015-04-24T11:38:25.750606 #9300]  INFO -- default-precise32:     +  # more or less alphabetized them here. You probably want to change this.
I, [2015-04-24T11:38:25.750625 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.750644 #9300]  INFO -- default-precise32:     +  LanguagePriority en ca cs da de el eo es et fr he hr it ja ko ltz nl nn no pl pt pt-BR ru sv tr zh-CN zh-TW
I, [2015-04-24T11:38:25.750663 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:25.750681 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.750700 #9300]  INFO -- default-precise32:     -# ForceLanguagePriority allows you to serve a result page rather than
I, [2015-04-24T11:38:25.750719 #9300]  INFO -- default-precise32:     -# MULTIPLE CHOICES (Prefer) [in case of a tie] or NOT ACCEPTABLE (Fallback)
I, [2015-04-24T11:38:25.750738 #9300]  INFO -- default-precise32:     -# [in case no accepted languages matched the available variants]
I, [2015-04-24T11:38:25.750756 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.750774 #9300]  INFO -- default-precise32:     -ForceLanguagePriority Prefer Fallback
I, [2015-04-24T11:38:25.750793 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:25.750811 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.750830 #9300]  INFO -- default-precise32:     +  # ForceLanguagePriority allows you to serve a result page rather than
I, [2015-04-24T11:38:25.750849 #9300]  INFO -- default-precise32:     +  # MULTIPLE CHOICES (Prefer) [in case of a tie] or NOT ACCEPTABLE (Fallback)
I, [2015-04-24T11:38:25.750868 #9300]  INFO -- default-precise32:     +  # [in case no accepted languages matched the available variants]
I, [2015-04-24T11:38:25.750887 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.750906 #9300]  INFO -- default-precise32:     +  ForceLanguagePriority Prefer Fallback
I, [2015-04-24T11:38:25.750943 #9300]  INFO -- default-precise32:      </IfModule>
I, [2015-04-24T11:38:25.756477 #9300]  INFO -- default-precise32:  (up to date)
I, [2015-04-24T11:38:25.760310 #9300]  INFO -- default-precise32:   * execute[a2enmod negotiation] action run (skipped due to not_if)
I, [2015-04-24T11:38:25.760995 #9300]  INFO -- default-precise32: Recipe: apache2::mod_setenvif
I, [2015-04-24T11:38:25.777158 #9300]  INFO -- default-precise32:   * template[/etc/apache2/mods-available/setenvif.conf] action create
I, [2015-04-24T11:38:25.778370 #9300]  INFO -- default-precise32:     - update content in file /etc/apache2/mods-available/setenvif.conf from 1798c3 to fb5a27
I, [2015-04-24T11:38:25.781224 #9300]  INFO -- default-precise32:     --- /etc/apache2/mods-available/setenvif.conf	2012-02-07 04:17:00.000000000 +0000
I, [2015-04-24T11:38:25.785282 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-1etl4mb	2015-04-24 08:38:25.760621755 +0000
I, [2015-04-24T11:38:25.787290 #9300]  INFO -- default-precise32:     @@ -1,31 +1,29 @@
I, [2015-04-24T11:38:25.788417 #9300]  INFO -- default-precise32:      <IfModule mod_setenvif.c>
I, [2015-04-24T11:38:25.790682 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.792953 #9300]  INFO -- default-precise32:     +  # The following directives modify normal HTTP response behavior to
I, [2015-04-24T11:38:25.795239 #9300]  INFO -- default-precise32:     +  # handle known problems with browser implementations.
I, [2015-04-24T11:38:25.799268 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.799525 #9300]  INFO -- default-precise32:     +  BrowserMatch "Mozilla/2" nokeepalive
I, [2015-04-24T11:38:25.800841 #9300]  INFO -- default-precise32:     +  BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0
I, [2015-04-24T11:38:25.803182 #9300]  INFO -- default-precise32:     +  BrowserMatch "RealPlayer 4\.0" force-response-1.0
I, [2015-04-24T11:38:25.804858 #9300]  INFO -- default-precise32:     +  BrowserMatch "Java/1\.0" force-response-1.0
I, [2015-04-24T11:38:25.807277 #9300]  INFO -- default-precise32:     +  BrowserMatch "JDK/1\.0" force-response-1.0
I, [2015-04-24T11:38:25.808734 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:25.812158 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.814290 #9300]  INFO -- default-precise32:     -# The following directives modify normal HTTP response behavior to
I, [2015-04-24T11:38:25.815368 #9300]  INFO -- default-precise32:     -# handle known problems with browser implementations.
I, [2015-04-24T11:38:25.817791 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.820059 #9300]  INFO -- default-precise32:     -BrowserMatch "Mozilla/2" nokeepalive
I, [2015-04-24T11:38:25.822275 #9300]  INFO -- default-precise32:     -BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0
I, [2015-04-24T11:38:25.824231 #9300]  INFO -- default-precise32:     -BrowserMatch "RealPlayer 4\.0" force-response-1.0
I, [2015-04-24T11:38:25.828770 #9300]  INFO -- default-precise32:     -BrowserMatch "Java/1\.0" force-response-1.0
I, [2015-04-24T11:38:25.829212 #9300]  INFO -- default-precise32:     -BrowserMatch "JDK/1\.0" force-response-1.0
I, [2015-04-24T11:38:25.829523 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:25.831286 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.833184 #9300]  INFO -- default-precise32:     -# The following directive disables redirects on non-GET requests for
I, [2015-04-24T11:38:25.835209 #9300]  INFO -- default-precise32:     -# a directory that does not include the trailing slash.  This fixes a 
I, [2015-04-24T11:38:25.835781 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:25.838060 #9300]  INFO -- default-precise32:     -# redirects for folders with DAV methods.
I, [2015-04-24T11:38:25.840205 #9300]  INFO -- default-precise32:     -# Same deal with Apple's DAV filesystem and Gnome VFS support for DAV.
I, [2015-04-24T11:38:25.840235 #9300]  INFO -- default-precise32:     -#
I, [2015-04-24T11:38:25.842228 #9300]  INFO -- default-precise32:     -BrowserMatch "Microsoft Data Access Internet Publishing Provider" redirect-carefully
I, [2015-04-24T11:38:25.844187 #9300]  INFO -- default-precise32:     -BrowserMatch "MS FrontPage" redirect-carefully
I, [2015-04-24T11:38:25.844216 #9300]  INFO -- default-precise32:     -BrowserMatch "^WebDrive" redirect-carefully
I, [2015-04-24T11:38:25.845956 #9300]  INFO -- default-precise32: -BrowserMatch "^WebDAVFS/1.[012]" redirect-carefully
I, [2015-04-24T11:38:25.847144 #9300]  INFO -- default-precise32:     -BrowserMatch "^gnome-vfs/1.0" redirect-carefully
I, [2015-04-24T11:38:25.848198 #9300]  INFO -- default-precise32:     -BrowserMatch "^gvfs/1" redirect-carefully
I, [2015-04-24T11:38:25.851201 #9300]  INFO -- default-precise32:     -BrowserMatch "^XML Spy" redirect-carefully
I, [2015-04-24T11:38:25.852191 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:25.852225 #9300]  INFO -- default-precise32:     -BrowserMatch " Konqueror/4" redirect-carefully
I, [2015-04-24T11:38:25.855014 #9300]  INFO -- default-precise32:     -
I, [2015-04-24T11:38:25.858819 #9300]  INFO -- default-precise32: +  #
I, [2015-04-24T11:38:25.859068 #9300]  INFO -- default-precise32:     +  # The following directive disables redirects on non-GET requests for
I, [2015-04-24T11:38:25.860114 #9300]  INFO -- default-precise32:     +  # a directory that does not include the trailing slash.  This fixes a
I, [2015-04-24T11:38:25.862207 #9300]  INFO -- default-precise32:     +  # problem with Microsoft WebFolders which does not appropriately handle
I, [2015-04-24T11:38:25.862238 #9300]  INFO -- default-precise32:     +  # redirects for folders with DAV methods.
I, [2015-04-24T11:38:25.864039 #9300]  INFO -- default-precise32:     +  # Same deal with Apple's DAV filesystem and Gnome VFS support for DAV.
I, [2015-04-24T11:38:25.866191 #9300]  INFO -- default-precise32:     +  #
I, [2015-04-24T11:38:25.866220 #9300]  INFO -- default-precise32:     +  BrowserMatch "Microsoft Data Access Internet Publishing Provider" redirect-carefully
I, [2015-04-24T11:38:25.868192 #9300]  INFO -- default-precise32:     +  BrowserMatch "MS FrontPage" redirect-carefully
I, [2015-04-24T11:38:25.869203 #9300]  INFO -- default-precise32: +  BrowserMatch "^WebDrive" redirect-carefully
I, [2015-04-24T11:38:25.870236 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:25.871922 #9300]  INFO -- default-precise32:     +  BrowserMatch "^gnome-vfs/1.0" redirect-carefully
I, [2015-04-24T11:38:25.873247 #9300]  INFO -- default-precise32:     +  BrowserMatch "^gvfs/1" redirect-carefully
I, [2015-04-24T11:38:25.875315 #9300]  INFO -- default-precise32:     +  BrowserMatch "^XML Spy" redirect-carefully
I, [2015-04-24T11:38:25.876976 #9300]  INFO -- default-precise32:     +  BrowserMatch "^Dreamweaver-WebDAV-SCM1" redirect-carefully
I, [2015-04-24T11:38:25.878193 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:25.882117 #9300]  INFO -- default-precise32:      </IfModule>
I, [2015-04-24T11:38:25.891152 #9300]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/setenvif.load] action create (up to date)
I, [2015-04-24T11:38:25.894220 #9300]  INFO -- default-precise32:   * execute[a2enmod setenvif] action run (skipped due to not_if)
I, [2015-04-24T11:38:25.895327 #9300]  INFO -- default-precise32: Recipe: apache2::mod_rewrite
I, [2015-04-24T11:38:25.903344 #9300]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/rewrite.load] action create (up to date)
I, [2015-04-24T11:38:26.365703 #9300]  INFO -- default-precise32:   * execute[a2enmod rewrite] action run
I, [2015-04-24T11:38:26.371671 #9300]  INFO -- default-precise32:     - execute /usr/sbin/a2enmod rewrite
I, [2015-04-24T11:38:26.376023 #9300]  INFO -- default-precise32: Recipe: apache2::mod_deflate
I, [2015-04-24T11:38:26.426343 #9300]  INFO -- default-precise32:   * template[/etc/apache2/mods-available/deflate.conf] action create
I, [2015-04-24T11:38:26.428603 #9300]  INFO -- default-precise32:     - update content in file /etc/apache2/mods-available/deflate.conf from 4f3582 to c8749f
I, [2015-04-24T11:38:26.432642 #9300]  INFO -- default-precise32:     --- /etc/apache2/mods-available/deflate.conf	2012-02-07 04:16:59.000000000 +0000
I, [2015-04-24T11:38:26.436194 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-1chcu62	2015-04-24 08:38:26.400613710 +0000
I, [2015-04-24T11:38:26.438496 #9300]  INFO -- default-precise32:     @@ -1,10 +1,19 @@
I, [2015-04-24T11:38:26.440726 #9300]  INFO -- default-precise32:      <IfModule mod_deflate.c>
I, [2015-04-24T11:38:26.442980 #9300]  INFO -- default-precise32:     -          # these are known to be safe with MSIE 6
I, [2015-04-24T11:38:26.445240 #9300]  INFO -- default-precise32:     -          AddOutputFilterByType DEFLATE text/html text/plain text/xml
I, [2015-04-24T11:38:26.447222 #9300]  INFO -- default-precise32:     +  <IfModule mod_filter.c>
I, [2015-04-24T11:38:26.450673 #9300]  INFO -- default-precise32:     +     # these are known to be safe with MSIE 6
I, [2015-04-24T11:38:26.454712 #9300]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE text/html text/plain text/xml
I, [2015-04-24T11:38:26.456510 #9300]  INFO -- default-precise32:      
I, [2015-04-24T11:38:26.459633 #9300]  INFO -- default-precise32:     -          # everything else may cause problems with MSIE 6
I, [2015-04-24T11:38:26.462175 #9300]  INFO -- default-precise32:     -          AddOutputFilterByType DEFLATE text/css
I, [2015-04-24T11:38:26.465059 #9300]  INFO -- default-precise32:     -          AddOutputFilterByType DEFLATE application/x-javascript application/javascript application/ecmascript
I, [2015-04-24T11:38:26.467750 #9300]  INFO -- default-precise32:     -          AddOutputFilterByType DEFLATE application/rss+xml
I, [2015-04-24T11:38:26.470472 #9300]  INFO -- default-precise32:     +     # everything else may cause problems with MSIE 6
I, [2015-04-24T11:38:26.473159 #9300]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE text/css
I, [2015-04-24T11:38:26.475868 #9300]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE application/x-javascript application/javascript application/ecmascript
I, [2015-04-24T11:38:26.478587 #9300]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE application/rss+xml
I, [2015-04-24T11:38:26.481753 #9300]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE application/xml
I, [2015-04-24T11:38:26.484175 #9300]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE application/xhtml+xml
I, [2015-04-24T11:38:26.487140 #9300]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE image/svg+xml
I, [2015-04-24T11:38:26.489404 #9300]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE application/atom_xml
I, [2015-04-24T11:38:26.492105 #9300]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE application/x-httpd-php
I, [2015-04-24T11:38:26.494807 #9300]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE application/x-httpd-fastphp
I, [2015-04-24T11:38:26.497510 #9300]  INFO -- default-precise32:     +     AddOutputFilterByType DEFLATE application/x-httpd-eruby
I, [2015-04-24T11:38:26.500198 #9300]  INFO -- default-precise32:     +  </IfModule>
I, [2015-04-24T11:38:26.506121 #9300]  INFO -- default-precise32:      </IfModule>
I, [2015-04-24T11:38:26.519615 #9300]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/deflate.load] action create (up to date)
I, [2015-04-24T11:38:26.525027 #9300]  INFO -- default-precise32:   * execute[a2enmod deflate] action run (skipped due to not_if)
I, [2015-04-24T11:38:26.526906 #9300]  INFO -- default-precise32: Recipe: apache2::mod_headers
I, [2015-04-24T11:38:26.537208 #9300]  INFO -- default-precise32:   * file[/etc/apache2/mods-available/headers.load] action create (up to date)
I, [2015-04-24T11:38:27.408545 #9300]  INFO -- default-precise32:   * execute[a2enmod headers] action run
I, [2015-04-24T11:38:27.413539 #9300]  INFO -- default-precise32:     - execute /usr/sbin/a2enmod headers
I, [2015-04-24T11:38:27.419495 #9300]  INFO -- default-precise32: Recipe: apache2::default
I, [2015-04-24T11:38:27.456357 #9300]  INFO -- default-precise32:   * template[/etc/apache2/sites-available/default.conf] action create
I, [2015-04-24T11:38:27.481502 #9300]  INFO -- default-precise32:     - create new file /etc/apache2/sites-available/default.conf
I, [2015-04-24T11:38:27.484808 #9300]  INFO -- default-precise32:     - update content in file /etc/apache2/sites-available/default.conf from none to 73a103
I, [2015-04-24T11:38:27.489494 #9300]  INFO -- default-precise32:     --- /etc/apache2/sites-available/default.conf	2015-04-24 08:38:27.448600536 +0000
I, [2015-04-24T11:38:27.507932 #9300]  INFO -- default-precise32:     +++ /tmp/chef-rendered-template20150424-1339-kgaqy7	2015-04-24 08:38:27.444600587 +0000
I, [2015-04-24T11:38:27.507995 #9300]  INFO -- default-precise32:     @@ -1 +1,44 @@
I, [2015-04-24T11:38:27.508016 #9300]  INFO -- default-precise32:     +<VirtualHost *:80>
I, [2015-04-24T11:38:27.508035 #9300]  INFO -- default-precise32:     +  ServerAdmin ops@example.com
I, [2015-04-24T11:38:27.508054 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:27.508072 #9300]  INFO -- default-precise32:     +  DocumentRoot /var/www/
I, [2015-04-24T11:38:27.508090 #9300]  INFO -- default-precise32:     +  <Directory />
I, [2015-04-24T11:38:27.508109 #9300]  INFO -- default-precise32:     +    Options FollowSymLinks
I, [2015-04-24T11:38:27.508127 #9300]  INFO -- default-precise32:     +    AllowOverride None
I, [2015-04-24T11:38:27.508145 #9300]  INFO -- default-precise32:     +  </Directory>
I, [2015-04-24T11:38:27.508163 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:27.508181 #9300]  INFO -- default-precise32:     +  <Directory /var/www/>
I, [2015-04-24T11:38:27.508199 #9300]  INFO -- default-precise32:     +    Options Indexes FollowSymLinks MultiViews
I, [2015-04-24T11:38:27.508218 #9300]  INFO -- default-precise32:     +    AllowOverride None
I, [2015-04-24T11:38:27.508236 #9300]  INFO -- default-precise32:     +    Order allow,deny
I, [2015-04-24T11:38:27.508254 #9300]  INFO -- default-precise32:     +    Allow from all
I, [2015-04-24T11:38:27.508288 #9300]  INFO -- default-precise32:     +  </Directory>
I, [2015-04-24T11:38:27.508306 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:27.508325 #9300]  INFO -- default-precise32:     +  ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
I, [2015-04-24T11:38:27.508343 #9300]  INFO -- default-precise32:     +  <Directory "/usr/lib/cgi-bin">
I, [2015-04-24T11:38:27.508792 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:27.511493 #9300]  INFO -- default-precise32:     +    Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
I, [2015-04-24T11:38:27.514172 #9300]  INFO -- default-precise32:     +    Order allow,deny
I, [2015-04-24T11:38:27.516736 #9300]  INFO -- default-precise32:     +    Allow from all
I, [2015-04-24T11:38:27.519554 #9300]  INFO -- default-precise32:     +  </Directory>
I, [2015-04-24T11:38:27.522236 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:27.525214 #9300]  INFO -- default-precise32:     +  ErrorLog /var/log/apache2/error.log
I, [2015-04-24T11:38:27.527710 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:27.531732 #9300]  INFO -- default-precise32:     +  # Possible values include: debug, info, notice, warn, error, crit,
I, [2015-04-24T11:38:27.534529 #9300]  INFO -- default-precise32:     +  # alert, emerg.
I, [2015-04-24T11:38:27.536783 #9300]  INFO -- default-precise32:     +  LogLevel warn
I, [2015-04-24T11:38:27.539837 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:27.542650 #9300]  INFO -- default-precise32:     +  CustomLog /var/log/apache2/access.log combined
I, [2015-04-24T11:38:27.544708 #9300]  INFO -- default-precise32:     +  ServerSignature On
I, [2015-04-24T11:38:27.546810 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:27.549133 #9300]  INFO -- default-precise32:     +  Alias /doc/ "/usr/share/doc/"
I, [2015-04-24T11:38:27.551225 #9300]  INFO -- default-precise32:     +  <Directory "/usr/share/doc/">
I, [2015-04-24T11:38:27.555933 #9300]  INFO -- default-precise32:     +    Options Indexes MultiViews FollowSymLinks
I, [2015-04-24T11:38:27.556308 #9300]  INFO -- default-precise32:     +    AllowOverride None
I, [2015-04-24T11:38:27.558526 #9300]  INFO -- default-precise32:     +    Order deny,allow
I, [2015-04-24T11:38:27.560991 #9300]  INFO -- default-precise32:     +    Deny from all
I, [2015-04-24T11:38:27.563429 #9300]  INFO -- default-precise32:     +    Allow from 127.0.0.0/255.0.0.0 ::1/128
I, [2015-04-24T11:38:27.564544 #9300]  INFO -- default-precise32:     +  </Directory>
I, [2015-04-24T11:38:27.567090 #9300]  INFO -- default-precise32:     +
I, [2015-04-24T11:38:27.574273 #9300]  INFO -- default-precise32:     +</VirtualHost>
I, [2015-04-24T11:38:27.576238 #9300]  INFO -- default-precise32:     - change mode from '' to '0644'
I, [2015-04-24T11:38:27.579102 #9300]  INFO -- default-precise32:     - change owner from '' to 'root'
I, [2015-04-24T11:38:27.585075 #9300]  INFO -- default-precise32:     - change group from '' to 'root'
I, [2015-04-24T11:38:27.589943 #9300]  INFO -- default-precise32:   * execute[a2dissite default.conf] action run (skipped due to only_if)
I, [2015-04-24T11:38:27.593967 #9300]  INFO -- default-precise32:   * execute[a2dissite 000-default.conf] action run (skipped due to only_if)
I, [2015-04-24T11:38:29.052217 #9300]  INFO -- default-precise32:   * service[apache2] action enable (up to date)
I, [2015-04-24T11:38:29.790423 #9300]  INFO -- default-precise32:   * service[apache2] action start (up to date)
I, [2015-04-24T11:38:32.297119 #9300]  INFO -- default-precise32:   * service[apache2] action reload
I, [2015-04-24T11:38:32.309373 #9300]  INFO -- default-precise32:     - reload service service[apache2]
I, [2015-04-24T11:38:32.325181 #9300]  INFO -- default-precise32: 
I, [2015-04-24T11:38:32.330956 #9300]  INFO -- default-precise32: Running handlers:
I, [2015-04-24T11:38:32.334479 #9300]  INFO -- default-precise32: Running handlers complete
I, [2015-04-24T11:38:32.341961 #9300]  INFO -- default-precise32: Chef Client finished, 37/67 resources updated in 97.133546013 seconds
I, [2015-04-24T11:38:33.744076 #9300]  INFO -- default-precise32: Finished converging <default-precise32> (3m49.91s).
I, [2015-04-24T11:38:33.744209 #9300]  INFO -- default-precise32: -----> Setting up <default-precise32>...
I, [2015-04-24T11:38:40.181570 #9300]  INFO -- default-precise32: Fetching: thor-0.19.0.gemFetching: thor-0.19.0.gem ( 18%)Fetching: thor-0.19.0.gem ( 36%)Fetching: thor-0.19.0.gem ( 54%)Fetching: thor-0.19.0.gem ( 72%)Fetching: thor-0.19.0.gem ( 89%)Fetching: thor-0.19.0.gem (100%)Fetching: thor-0.19.0.gem (100%)
I, [2015-04-24T11:38:40.408027 #9300]  INFO -- default-precise32: Successfully installed thor-0.19.0
I, [2015-04-24T11:38:41.127439 #9300]  INFO -- default-precise32: Fetching: busser-0.7.1.gemFetching: busser-0.7.1.gem ( 66%)Fetching: busser-0.7.1.gem (100%)Fetching: busser-0.7.1.gem (100%)
I, [2015-04-24T11:38:41.232148 #9300]  INFO -- default-precise32: Successfully installed busser-0.7.1
I, [2015-04-24T11:38:41.234175 #9300]  INFO -- default-precise32: 2 gems installed
I, [2015-04-24T11:38:42.148229 #9300]  INFO -- default-precise32: -----> Setting up Busser
I, [2015-04-24T11:38:42.150183 #9300]  INFO -- default-precise32: Creating BUSSER_ROOT in /tmp/busser
I, [2015-04-24T11:38:42.154215 #9300]  INFO -- default-precise32: Creating busser binstub
I, [2015-04-24T11:38:56.507579 #9300]  INFO -- default-precise32: Plugin bats installed (version 0.3.0)
I, [2015-04-24T11:38:56.525294 #9300]  INFO -- default-precise32: -----> Running postinstall for bats plugin
I, [2015-04-24T11:38:56.897368 #9300]  INFO -- default-precise32: Installed Bats to /tmp/busser/vendor/bats/bin/bats
I, [2015-04-24T11:38:57.373852 #9300]  INFO -- default-precise32: Finished setting up <default-precise32> (0m23.63s).
I, [2015-04-24T11:38:57.373974 #9300]  INFO -- default-precise32: -----> Verifying <default-precise32>...
I, [2015-04-24T11:38:58.720474 #9300]  INFO -- default-precise32: Suite path directory /tmp/busser/suites does not exist, skipping.
I, [2015-04-24T11:38:59.547992 #9300]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats (mode=0644)
I, [2015-04-24T11:39:01.963553 #9300]  INFO -- default-precise32: Uploading /tmp/busser/suites/bats/apache_test.bats~ (mode=0644)
I, [2015-04-24T11:39:04.380158 #9300]  INFO -- default-precise32: -----> Running bats test suite
I, [2015-04-24T11:39:06.335231 #9300]  INFO -- default-precise32: [1G   apache binary is found in PATH[K[77G1/3[2G[1G ✓ apache binary is found in PATH[K
I, [2015-04-24T11:39:07.008499 #9300]  INFO -- default-precise32: [0m[1G   apache config is valid[K[77G2/3[2G[1G ✓ apache config is valid[K
I, [2015-04-24T11:39:07.600233 #9300]  INFO -- default-precise32: [0m[1G   apache is running[K[77G3/3[2G[1G ✓ apache is running[K
I, [2015-04-24T11:39:07.601188 #9300]  INFO -- default-precise32: [0m
I, [2015-04-24T11:39:07.603189 #9300]  INFO -- default-precise32: 3 tests, 0 failures
I, [2015-04-24T11:39:07.847100 #9300]  INFO -- default-precise32: Finished verifying <default-precise32> (0m10.47s).
I, [2015-04-24T11:39:07.847598 #9300]  INFO -- default-precise32: -----> Destroying <default-precise32>...
I, [2015-04-24T11:39:11.698922 #9300]  INFO -- default-precise32: Vagrant instance <default-precise32> destroyed.
I, [2015-04-24T11:39:11.700325 #9300]  INFO -- default-precise32: Finished destroying <default-precise32> (0m3.85s).
I, [2015-04-24T11:39:11.701117 #9300]  INFO -- default-precise32: Finished testing <default-precise32> (6m0.89s).
